<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to d3po</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>(function() {
  // If window.HTMLWidgets is already defined, then use it; otherwise create a
  // new object. This allows preceding code to set options that affect the
  // initialization process (though none currently exist).
  window.HTMLWidgets = window.HTMLWidgets || {};

  // See if we're running in a viewer pane. If not, we're in a web browser.
  var viewerMode = window.HTMLWidgets.viewerMode =
      /\bviewer_pane=1\b/.test(window.location);

  // See if we're running in Shiny mode. If not, it's a static document.
  // Note that static widgets can appear in both Shiny and static modes, but
  // obviously, Shiny widgets can only appear in Shiny apps/documents.
  var shinyMode = window.HTMLWidgets.shinyMode =
      typeof(window.Shiny) !== "undefined" && !!window.Shiny.outputBindings;

  // We can't count on jQuery being available, so we implement our own
  // version if necessary.
  function querySelectorAll(scope, selector) {
    if (typeof(jQuery) !== "undefined" && scope instanceof jQuery) {
      return scope.find(selector);
    }
    if (scope.querySelectorAll) {
      return scope.querySelectorAll(selector);
    }
  }

  function asArray(value) {
    if (value === null)
      return [];
    if ($.isArray(value))
      return value;
    return [value];
  }

  // Implement jQuery's extend
  function extend(target /*, ... */) {
    if (arguments.length == 1) {
      return target;
    }
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];
      for (var prop in source) {
        if (source.hasOwnProperty(prop)) {
          target[prop] = source[prop];
        }
      }
    }
    return target;
  }

  // IE8 doesn't support Array.forEach.
  function forEach(values, callback, thisArg) {
    if (values.forEach) {
      values.forEach(callback, thisArg);
    } else {
      for (var i = 0; i < values.length; i++) {
        callback.call(thisArg, values[i], i, values);
      }
    }
  }

  // Replaces the specified method with the return value of funcSource.
  //
  // Note that funcSource should not BE the new method, it should be a function
  // that RETURNS the new method. funcSource receives a single argument that is
  // the overridden method, it can be called from the new method. The overridden
  // method can be called like a regular function, it has the target permanently
  // bound to it so "this" will work correctly.
  function overrideMethod(target, methodName, funcSource) {
    var superFunc = target[methodName] || function() {};
    var superFuncBound = function() {
      return superFunc.apply(target, arguments);
    };
    target[methodName] = funcSource(superFuncBound);
  }

  // Add a method to delegator that, when invoked, calls
  // delegatee.methodName. If there is no such method on
  // the delegatee, but there was one on delegator before
  // delegateMethod was called, then the original version
  // is invoked instead.
  // For example:
  //
  // var a = {
  //   method1: function() { console.log('a1'); }
  //   method2: function() { console.log('a2'); }
  // };
  // var b = {
  //   method1: function() { console.log('b1'); }
  // };
  // delegateMethod(a, b, "method1");
  // delegateMethod(a, b, "method2");
  // a.method1();
  // a.method2();
  //
  // The output would be "b1", "a2".
  function delegateMethod(delegator, delegatee, methodName) {
    var inherited = delegator[methodName];
    delegator[methodName] = function() {
      var target = delegatee;
      var method = delegatee[methodName];

      // The method doesn't exist on the delegatee. Instead,
      // call the method on the delegator, if it exists.
      if (!method) {
        target = delegator;
        method = inherited;
      }

      if (method) {
        return method.apply(target, arguments);
      }
    };
  }

  // Implement a vague facsimilie of jQuery's data method
  function elementData(el, name, value) {
    if (arguments.length == 2) {
      return el["htmlwidget_data_" + name];
    } else if (arguments.length == 3) {
      el["htmlwidget_data_" + name] = value;
      return el;
    } else {
      throw new Error("Wrong number of arguments for elementData: " +
        arguments.length);
    }
  }

  // http://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex
  function escapeRegExp(str) {
    return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");
  }

  function hasClass(el, className) {
    var re = new RegExp("\\b" + escapeRegExp(className) + "\\b");
    return re.test(el.className);
  }

  // elements - array (or array-like object) of HTML elements
  // className - class name to test for
  // include - if true, only return elements with given className;
  //   if false, only return elements *without* given className
  function filterByClass(elements, className, include) {
    var results = [];
    for (var i = 0; i < elements.length; i++) {
      if (hasClass(elements[i], className) == include)
        results.push(elements[i]);
    }
    return results;
  }

  function on(obj, eventName, func) {
    if (obj.addEventListener) {
      obj.addEventListener(eventName, func, false);
    } else if (obj.attachEvent) {
      obj.attachEvent(eventName, func);
    }
  }

  function off(obj, eventName, func) {
    if (obj.removeEventListener)
      obj.removeEventListener(eventName, func, false);
    else if (obj.detachEvent) {
      obj.detachEvent(eventName, func);
    }
  }

  // Translate array of values to top/right/bottom/left, as usual with
  // the "padding" CSS property
  // https://developer.mozilla.org/en-US/docs/Web/CSS/padding
  function unpackPadding(value) {
    if (typeof(value) === "number")
      value = [value];
    if (value.length === 1) {
      return {top: value[0], right: value[0], bottom: value[0], left: value[0]};
    }
    if (value.length === 2) {
      return {top: value[0], right: value[1], bottom: value[0], left: value[1]};
    }
    if (value.length === 3) {
      return {top: value[0], right: value[1], bottom: value[2], left: value[1]};
    }
    if (value.length === 4) {
      return {top: value[0], right: value[1], bottom: value[2], left: value[3]};
    }
  }

  // Convert an unpacked padding object to a CSS value
  function paddingToCss(paddingObj) {
    return paddingObj.top + "px " + paddingObj.right + "px " + paddingObj.bottom + "px " + paddingObj.left + "px";
  }

  // Makes a number suitable for CSS
  function px(x) {
    if (typeof(x) === "number")
      return x + "px";
    else
      return x;
  }

  // Retrieves runtime widget sizing information for an element.
  // The return value is either null, or an object with fill, padding,
  // defaultWidth, defaultHeight fields.
  function sizingPolicy(el) {
    var sizingEl = document.querySelector("script[data-for='" + el.id + "'][type='application/htmlwidget-sizing']");
    if (!sizingEl)
      return null;
    var sp = JSON.parse(sizingEl.textContent || sizingEl.text || "{}");
    if (viewerMode) {
      return sp.viewer;
    } else {
      return sp.browser;
    }
  }

  // @param tasks Array of strings (or falsy value, in which case no-op).
  //   Each element must be a valid JavaScript expression that yields a
  //   function. Or, can be an array of objects with "code" and "data"
  //   properties; in this case, the "code" property should be a string
  //   of JS that's an expr that yields a function, and "data" should be
  //   an object that will be added as an additional argument when that
  //   function is called.
  // @param target The object that will be "this" for each function
  //   execution.
  // @param args Array of arguments to be passed to the functions. (The
  //   same arguments will be passed to all functions.)
  function evalAndRun(tasks, target, args) {
    if (tasks) {
      forEach(tasks, function(task) {
        var theseArgs = args;
        if (typeof(task) === "object") {
          theseArgs = theseArgs.concat([task.data]);
          task = task.code;
        }
        var taskFunc = tryEval(task);
        if (typeof(taskFunc) !== "function") {
          throw new Error("Task must be a function! Source:\n" + task);
        }
        taskFunc.apply(target, theseArgs);
      });
    }
  }

  // Attempt eval() both with and without enclosing in parentheses.
  // Note that enclosing coerces a function declaration into
  // an expression that eval() can parse
  // (otherwise, a SyntaxError is thrown)
  function tryEval(code) {
    var result = null;
    try {
      result = eval("(" + code + ")");
    } catch(error) {
      if (!(error instanceof SyntaxError)) {
        throw error;
      }
      try {
        result = eval(code);
      } catch(e) {
        if (e instanceof SyntaxError) {
          throw error;
        } else {
          throw e;
        }
      }
    }
    return result;
  }

  function initSizing(el) {
    var sizing = sizingPolicy(el);
    if (!sizing)
      return;

    var cel = document.getElementById("htmlwidget_container");
    if (!cel)
      return;

    if (typeof(sizing.padding) !== "undefined") {
      document.body.style.margin = "0";
      document.body.style.padding = paddingToCss(unpackPadding(sizing.padding));
    }

    if (sizing.fill) {
      document.body.style.overflow = "hidden";
      document.body.style.width = "100%";
      document.body.style.height = "100%";
      document.documentElement.style.width = "100%";
      document.documentElement.style.height = "100%";
      cel.style.position = "absolute";
      var pad = unpackPadding(sizing.padding);
      cel.style.top = pad.top + "px";
      cel.style.right = pad.right + "px";
      cel.style.bottom = pad.bottom + "px";
      cel.style.left = pad.left + "px";
      el.style.width = "100%";
      el.style.height = "100%";

      return {
        getWidth: function() { return cel.getBoundingClientRect().width; },
        getHeight: function() { return cel.getBoundingClientRect().height; }
      };

    } else {
      el.style.width = px(sizing.width);
      el.style.height = px(sizing.height);

      return {
        getWidth: function() { return cel.getBoundingClientRect().width; },
        getHeight: function() { return cel.getBoundingClientRect().height; }
      };
    }
  }

  // Default implementations for methods
  var defaults = {
    find: function(scope) {
      return querySelectorAll(scope, "." + this.name);
    },
    renderError: function(el, err) {
      var $el = $(el);

      this.clearError(el);

      // Add all these error classes, as Shiny does
      var errClass = "shiny-output-error";
      if (err.type !== null) {
        // use the classes of the error condition as CSS class names
        errClass = errClass + " " + $.map(asArray(err.type), function(type) {
          return errClass + "-" + type;
        }).join(" ");
      }
      errClass = errClass + " htmlwidgets-error";

      // Is el inline or block? If inline or inline-block, just display:none it
      // and add an inline error.
      var display = $el.css("display");
      $el.data("restore-display-mode", display);

      if (display === "inline" || display === "inline-block") {
        $el.hide();
        if (err.message !== "") {
          var errorSpan = $("<span>").addClass(errClass);
          errorSpan.text(err.message);
          $el.after(errorSpan);
        }
      } else if (display === "block") {
        // If block, add an error just after the el, set visibility:none on the
        // el, and position the error to be on top of the el.
        // Mark it with a unique ID and CSS class so we can remove it later.
        $el.css("visibility", "hidden");
        if (err.message !== "") {
          var errorDiv = $("<div>").addClass(errClass).css("position", "absolute")
            .css("top", el.offsetTop)
            .css("left", el.offsetLeft)
            // setting width can push out the page size, forcing otherwise
            // unnecessary scrollbars to appear and making it impossible for
            // the element to shrink; so use max-width instead
            .css("maxWidth", el.offsetWidth)
            .css("height", el.offsetHeight);
          errorDiv.text(err.message);
          $el.after(errorDiv);

          // Really dumb way to keep the size/position of the error in sync with
          // the parent element as the window is resized or whatever.
          var intId = setInterval(function() {
            if (!errorDiv[0].parentElement) {
              clearInterval(intId);
              return;
            }
            errorDiv
              .css("top", el.offsetTop)
              .css("left", el.offsetLeft)
              .css("maxWidth", el.offsetWidth)
              .css("height", el.offsetHeight);
          }, 500);
        }
      }
    },
    clearError: function(el) {
      var $el = $(el);
      var display = $el.data("restore-display-mode");
      $el.data("restore-display-mode", null);

      if (display === "inline" || display === "inline-block") {
        if (display)
          $el.css("display", display);
        $(el.nextSibling).filter(".htmlwidgets-error").remove();
      } else if (display === "block"){
        $el.css("visibility", "inherit");
        $(el.nextSibling).filter(".htmlwidgets-error").remove();
      }
    },
    sizing: {}
  };

  // Called by widget bindings to register a new type of widget. The definition
  // object can contain the following properties:
  // - name (required) - A string indicating the binding name, which will be
  //   used by default as the CSS classname to look for.
  // - initialize (optional) - A function(el) that will be called once per
  //   widget element; if a value is returned, it will be passed as the third
  //   value to renderValue.
  // - renderValue (required) - A function(el, data, initValue) that will be
  //   called with data. Static contexts will cause this to be called once per
  //   element; Shiny apps will cause this to be called multiple times per
  //   element, as the data changes.
  window.HTMLWidgets.widget = function(definition) {
    if (!definition.name) {
      throw new Error("Widget must have a name");
    }
    if (!definition.type) {
      throw new Error("Widget must have a type");
    }
    // Currently we only support output widgets
    if (definition.type !== "output") {
      throw new Error("Unrecognized widget type '" + definition.type + "'");
    }
    // TODO: Verify that .name is a valid CSS classname

    // Support new-style instance-bound definitions. Old-style class-bound
    // definitions have one widget "object" per widget per type/class of
    // widget; the renderValue and resize methods on such widget objects
    // take el and instance arguments, because the widget object can't
    // store them. New-style instance-bound definitions have one widget
    // object per widget instance; the definition that's passed in doesn't
    // provide renderValue or resize methods at all, just the single method
    //   factory(el, width, height)
    // which returns an object that has renderValue(x) and resize(w, h).
    // This enables a far more natural programming style for the widget
    // author, who can store per-instance state using either OO-style
    // instance fields or functional-style closure variables (I guess this
    // is in contrast to what can only be called C-style pseudo-OO which is
    // what we required before).
    if (definition.factory) {
      definition = createLegacyDefinitionAdapter(definition);
    }

    if (!definition.renderValue) {
      throw new Error("Widget must have a renderValue function");
    }

    // For static rendering (non-Shiny), use a simple widget registration
    // scheme. We also use this scheme for Shiny apps/documents that also
    // contain static widgets.
    window.HTMLWidgets.widgets = window.HTMLWidgets.widgets || [];
    // Merge defaults into the definition; don't mutate the original definition.
    var staticBinding = extend({}, defaults, definition);
    overrideMethod(staticBinding, "find", function(superfunc) {
      return function(scope) {
        var results = superfunc(scope);
        // Filter out Shiny outputs, we only want the static kind
        return filterByClass(results, "html-widget-output", false);
      };
    });
    window.HTMLWidgets.widgets.push(staticBinding);

    if (shinyMode) {
      // Shiny is running. Register the definition with an output binding.
      // The definition itself will not be the output binding, instead
      // we will make an output binding object that delegates to the
      // definition. This is because we foolishly used the same method
      // name (renderValue) for htmlwidgets definition and Shiny bindings
      // but they actually have quite different semantics (the Shiny
      // bindings receive data that includes lots of metadata that it
      // strips off before calling htmlwidgets renderValue). We can't
      // just ignore the difference because in some widgets it's helpful
      // to call this.renderValue() from inside of resize(), and if
      // we're not delegating, then that call will go to the Shiny
      // version instead of the htmlwidgets version.

      // Merge defaults with definition, without mutating either.
      var bindingDef = extend({}, defaults, definition);

      // This object will be our actual Shiny binding.
      var shinyBinding = new Shiny.OutputBinding();

      // With a few exceptions, we'll want to simply use the bindingDef's
      // version of methods if they are available, otherwise fall back to
      // Shiny's defaults. NOTE: If Shiny's output bindings gain additional
      // methods in the future, and we want them to be overrideable by
      // HTMLWidget binding definitions, then we'll need to add them to this
      // list.
      delegateMethod(shinyBinding, bindingDef, "getId");
      delegateMethod(shinyBinding, bindingDef, "onValueChange");
      delegateMethod(shinyBinding, bindingDef, "onValueError");
      delegateMethod(shinyBinding, bindingDef, "renderError");
      delegateMethod(shinyBinding, bindingDef, "clearError");
      delegateMethod(shinyBinding, bindingDef, "showProgress");

      // The find, renderValue, and resize are handled differently, because we
      // want to actually decorate the behavior of the bindingDef methods.

      shinyBinding.find = function(scope) {
        var results = bindingDef.find(scope);

        // Only return elements that are Shiny outputs, not static ones
        var dynamicResults = results.filter(".html-widget-output");

        // It's possible that whatever caused Shiny to think there might be
        // new dynamic outputs, also caused there to be new static outputs.
        // Since there might be lots of different htmlwidgets bindings, we
        // schedule execution for later--no need to staticRender multiple
        // times.
        if (results.length !== dynamicResults.length)
          scheduleStaticRender();

        return dynamicResults;
      };

      // Wrap renderValue to handle initialization, which unfortunately isn't
      // supported natively by Shiny at the time of this writing.

      shinyBinding.renderValue = function(el, data) {
        Shiny.renderDependencies(data.deps);
        // Resolve strings marked as javascript literals to objects
        if (!(data.evals instanceof Array)) data.evals = [data.evals];
        for (var i = 0; data.evals && i < data.evals.length; i++) {
          window.HTMLWidgets.evaluateStringMember(data.x, data.evals[i]);
        }
        if (!bindingDef.renderOnNullValue) {
          if (data.x === null) {
            el.style.visibility = "hidden";
            return;
          } else {
            el.style.visibility = "inherit";
          }
        }
        if (!elementData(el, "initialized")) {
          initSizing(el);

          elementData(el, "initialized", true);
          if (bindingDef.initialize) {
            var rect = el.getBoundingClientRect();
            var result = bindingDef.initialize(el, rect.width, rect.height);
            elementData(el, "init_result", result);
          }
        }
        bindingDef.renderValue(el, data.x, elementData(el, "init_result"));
        evalAndRun(data.jsHooks.render, elementData(el, "init_result"), [el, data.x]);
      };

      // Only override resize if bindingDef implements it
      if (bindingDef.resize) {
        shinyBinding.resize = function(el, width, height) {
          // Shiny can call resize before initialize/renderValue have been
          // called, which doesn't make sense for widgets.
          if (elementData(el, "initialized")) {
            bindingDef.resize(el, width, height, elementData(el, "init_result"));
          }
        };
      }

      Shiny.outputBindings.register(shinyBinding, bindingDef.name);
    }
  };

  var scheduleStaticRenderTimerId = null;
  function scheduleStaticRender() {
    if (!scheduleStaticRenderTimerId) {
      scheduleStaticRenderTimerId = setTimeout(function() {
        scheduleStaticRenderTimerId = null;
        window.HTMLWidgets.staticRender();
      }, 1);
    }
  }

  // Render static widgets after the document finishes loading
  // Statically render all elements that are of this widget's class
  window.HTMLWidgets.staticRender = function() {
    var bindings = window.HTMLWidgets.widgets || [];
    forEach(bindings, function(binding) {
      var matches = binding.find(document.documentElement);
      forEach(matches, function(el) {
        var sizeObj = initSizing(el, binding);

        var getSize = function(el) {
          if (sizeObj) {
            return {w: sizeObj.getWidth(), h: sizeObj.getHeight()}
          } else {
            var rect = el.getBoundingClientRect();
            return {w: rect.width, h: rect.height}
          }
        };

        if (hasClass(el, "html-widget-static-bound"))
          return;
        el.className = el.className + " html-widget-static-bound";

        var initResult;
        if (binding.initialize) {
          var size = getSize(el);
          initResult = binding.initialize(el, size.w, size.h);
          elementData(el, "init_result", initResult);
        }

        if (binding.resize) {
          var lastSize = getSize(el);
          var resizeHandler = function(e) {
            var size = getSize(el);
            if (size.w === 0 && size.h === 0)
              return;
            if (size.w === lastSize.w && size.h === lastSize.h)
              return;
            lastSize = size;
            binding.resize(el, size.w, size.h, initResult);
          };

          on(window, "resize", resizeHandler);

          // This is needed for cases where we're running in a Shiny
          // app, but the widget itself is not a Shiny output, but
          // rather a simple static widget. One example of this is
          // an rmarkdown document that has runtime:shiny and widget
          // that isn't in a render function. Shiny only knows to
          // call resize handlers for Shiny outputs, not for static
          // widgets, so we do it ourselves.
          if (window.jQuery) {
            window.jQuery(document).on(
              "shown.htmlwidgets shown.bs.tab.htmlwidgets shown.bs.collapse.htmlwidgets",
              resizeHandler
            );
            window.jQuery(document).on(
              "hidden.htmlwidgets hidden.bs.tab.htmlwidgets hidden.bs.collapse.htmlwidgets",
              resizeHandler
            );
          }

          // This is needed for the specific case of ioslides, which
          // flips slides between display:none and display:block.
          // Ideally we would not have to have ioslide-specific code
          // here, but rather have ioslides raise a generic event,
          // but the rmarkdown package just went to CRAN so the
          // window to getting that fixed may be long.
          if (window.addEventListener) {
            // It's OK to limit this to window.addEventListener
            // browsers because ioslides itself only supports
            // such browsers.
            on(document, "slideenter", resizeHandler);
            on(document, "slideleave", resizeHandler);
          }
        }

        var scriptData = document.querySelector("script[data-for='" + el.id + "'][type='application/json']");
        if (scriptData) {
          var data = JSON.parse(scriptData.textContent || scriptData.text);
          // Resolve strings marked as javascript literals to objects
          if (!(data.evals instanceof Array)) data.evals = [data.evals];
          for (var k = 0; data.evals && k < data.evals.length; k++) {
            window.HTMLWidgets.evaluateStringMember(data.x, data.evals[k]);
          }
          binding.renderValue(el, data.x, initResult);
          evalAndRun(data.jsHooks.render, initResult, [el, data.x]);
        }
      });
    });

    invokePostRenderHandlers();
  }


  function has_jQuery3() {
    if (!window.jQuery) {
      return false;
    }
    var $version = window.jQuery.fn.jquery;
    var $major_version = parseInt($version.split(".")[0]);
    return $major_version >= 3;
  }

  /*
  / Shiny 1.4 bumped jQuery from 1.x to 3.x which means jQuery's
  / on-ready handler (i.e., $(fn)) is now asyncronous (i.e., it now
  / really means $(setTimeout(fn)).
  / https://jquery.com/upgrade-guide/3.0/#breaking-change-document-ready-handlers-are-now-asynchronous
  /
  / Since Shiny uses $() to schedule initShiny, shiny>=1.4 calls initShiny
  / one tick later than it did before, which means staticRender() is
  / called renderValue() earlier than (advanced) widget authors might be expecting.
  / https://github.com/rstudio/shiny/issues/2630
  /
  / For a concrete example, leaflet has some methods (e.g., updateBounds)
  / which reference Shiny methods registered in initShiny (e.g., setInputValue).
  / Since leaflet is privy to this life-cycle, it knows to use setTimeout() to
  / delay execution of those methods (until Shiny methods are ready)
  / https://github.com/rstudio/leaflet/blob/18ec981/javascript/src/index.js#L266-L268
  /
  / Ideally widget authors wouldn't need to use this setTimeout() hack that
  / leaflet uses to call Shiny methods on a staticRender(). In the long run,
  / the logic initShiny should be broken up so that method registration happens
  / right away, but binding happens later.
  */
  function maybeStaticRenderLater() {
    if (shinyMode && has_jQuery3()) {
      window.jQuery(window.HTMLWidgets.staticRender);
    } else {
      window.HTMLWidgets.staticRender();
    }
  }

  if (document.addEventListener) {
    document.addEventListener("DOMContentLoaded", function() {
      document.removeEventListener("DOMContentLoaded", arguments.callee, false);
      maybeStaticRenderLater();
    }, false);
  } else if (document.attachEvent) {
    document.attachEvent("onreadystatechange", function() {
      if (document.readyState === "complete") {
        document.detachEvent("onreadystatechange", arguments.callee);
        maybeStaticRenderLater();
      }
    });
  }


  window.HTMLWidgets.getAttachmentUrl = function(depname, key) {
    // If no key, default to the first item
    if (typeof(key) === "undefined")
      key = 1;

    var link = document.getElementById(depname + "-" + key + "-attachment");
    if (!link) {
      throw new Error("Attachment " + depname + "/" + key + " not found in document");
    }
    return link.getAttribute("href");
  };

  window.HTMLWidgets.dataframeToD3 = function(df) {
    var names = [];
    var length;
    for (var name in df) {
        if (df.hasOwnProperty(name))
            names.push(name);
        if (typeof(df[name]) !== "object" || typeof(df[name].length) === "undefined") {
            throw new Error("All fields must be arrays");
        } else if (typeof(length) !== "undefined" && length !== df[name].length) {
            throw new Error("All fields must be arrays of the same length");
        }
        length = df[name].length;
    }
    var results = [];
    var item;
    for (var row = 0; row < length; row++) {
        item = {};
        for (var col = 0; col < names.length; col++) {
            item[names[col]] = df[names[col]][row];
        }
        results.push(item);
    }
    return results;
  };

  window.HTMLWidgets.transposeArray2D = function(array) {
      if (array.length === 0) return array;
      var newArray = array[0].map(function(col, i) {
          return array.map(function(row) {
              return row[i]
          })
      });
      return newArray;
  };
  // Split value at splitChar, but allow splitChar to be escaped
  // using escapeChar. Any other characters escaped by escapeChar
  // will be included as usual (including escapeChar itself).
  function splitWithEscape(value, splitChar, escapeChar) {
    var results = [];
    var escapeMode = false;
    var currentResult = "";
    for (var pos = 0; pos < value.length; pos++) {
      if (!escapeMode) {
        if (value[pos] === splitChar) {
          results.push(currentResult);
          currentResult = "";
        } else if (value[pos] === escapeChar) {
          escapeMode = true;
        } else {
          currentResult += value[pos];
        }
      } else {
        currentResult += value[pos];
        escapeMode = false;
      }
    }
    if (currentResult !== "") {
      results.push(currentResult);
    }
    return results;
  }
  // Function authored by Yihui/JJ Allaire
  window.HTMLWidgets.evaluateStringMember = function(o, member) {
    var parts = splitWithEscape(member, '.', '\\');
    for (var i = 0, l = parts.length; i < l; i++) {
      var part = parts[i];
      // part may be a character or 'numeric' member name
      if (o !== null && typeof o === "object" && part in o) {
        if (i == (l - 1)) { // if we are at the end of the line then evalulate
          if (typeof o[part] === "string")
            o[part] = tryEval(o[part]);
        } else { // otherwise continue to next embedded object
          o = o[part];
        }
      }
    }
  };

  // Retrieve the HTMLWidget instance (i.e. the return value of an
  // HTMLWidget binding's initialize() or factory() function)
  // associated with an element, or null if none.
  window.HTMLWidgets.getInstance = function(el) {
    return elementData(el, "init_result");
  };

  // Finds the first element in the scope that matches the selector,
  // and returns the HTMLWidget instance (i.e. the return value of
  // an HTMLWidget binding's initialize() or factory() function)
  // associated with that element, if any. If no element matches the
  // selector, or the first matching element has no HTMLWidget
  // instance associated with it, then null is returned.
  //
  // The scope argument is optional, and defaults to window.document.
  window.HTMLWidgets.find = function(scope, selector) {
    if (arguments.length == 1) {
      selector = scope;
      scope = document;
    }

    var el = scope.querySelector(selector);
    if (el === null) {
      return null;
    } else {
      return window.HTMLWidgets.getInstance(el);
    }
  };

  // Finds all elements in the scope that match the selector, and
  // returns the HTMLWidget instances (i.e. the return values of
  // an HTMLWidget binding's initialize() or factory() function)
  // associated with the elements, in an array. If elements that
  // match the selector don't have an associated HTMLWidget
  // instance, the returned array will contain nulls.
  //
  // The scope argument is optional, and defaults to window.document.
  window.HTMLWidgets.findAll = function(scope, selector) {
    if (arguments.length == 1) {
      selector = scope;
      scope = document;
    }

    var nodes = scope.querySelectorAll(selector);
    var results = [];
    for (var i = 0; i < nodes.length; i++) {
      results.push(window.HTMLWidgets.getInstance(nodes[i]));
    }
    return results;
  };

  var postRenderHandlers = [];
  function invokePostRenderHandlers() {
    while (postRenderHandlers.length) {
      var handler = postRenderHandlers.shift();
      if (handler) {
        handler();
      }
    }
  }

  // Register the given callback function to be invoked after the
  // next time static widgets are rendered.
  window.HTMLWidgets.addPostRenderHandler = function(callback) {
    postRenderHandlers.push(callback);
  };

  // Takes a new-style instance-bound definition, and returns an
  // old-style class-bound definition. This saves us from having
  // to rewrite all the logic in this file to accomodate both
  // types of definitions.
  function createLegacyDefinitionAdapter(defn) {
    var result = {
      name: defn.name,
      type: defn.type,
      initialize: function(el, width, height) {
        return defn.factory(el, width, height);
      },
      renderValue: function(el, x, instance) {
        return instance.renderValue(x);
      },
      resize: function(el, width, height, instance) {
        return instance.resize(width, height);
      }
    };

    if (defn.find)
      result.find = defn.find;
    if (defn.renderError)
      result.renderError = defn.renderError;
    if (defn.clearError)
      result.clearError = defn.clearError;

    return result;
  }
})();
</script>
<script>!function(){function n(n){return n&&(n.ownerDocument||n.document||n).documentElement}function t(n){return n&&(n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView)}function e(n,t){return t>n?-1:n>t?1:n>=t?0:NaN}function r(n){return null===n?NaN:+n}function i(n){return!isNaN(n)}function u(n){return{left:function(t,e,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);i>r;){var u=r+i>>>1;n(t[u],e)<0?r=u+1:i=u}return r},right:function(t,e,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);i>r;){var u=r+i>>>1;n(t[u],e)>0?i=u:r=u+1}return r}}}function o(n){return n.length}function a(n){for(var t=1;n*t%1;)t*=10;return t}function l(n,t){for(var e in t)Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}function c(){this._=Object.create(null)}function f(n){return(n+="")===bo||n[0]===_o?_o+n:n}function s(n){return(n+="")[0]===_o?n.slice(1):n}function h(n){return f(n)in this._}function p(n){return(n=f(n))in this._&&delete this._[n]}function g(){var n=[];for(var t in this._)n.push(s(t));return n}function v(){var n=0;for(var t in this._)++n;return n}function d(){for(var n in this._)return!1;return!0}function y(){this._=Object.create(null)}function m(n){return n}function M(n,t,e){return function(){var r=e.apply(t,arguments);return r===t?n:r}}function x(n,t){if(t in n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e=0,r=wo.length;r>e;++e){var i=wo[e]+t;if(i in n)return i}}function b(){}function _(){}function w(n){function t(){for(var t,r=e,i=-1,u=r.length;++i<u;)(t=r[i].on)&&t.apply(this,arguments);return n}var e=[],r=new c;return t.on=function(t,i){var u,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,e=e.slice(0,u=e.indexOf(o)).concat(e.slice(u+1)),r.remove(t)),i&&e.push(r.set(t,{on:i})),n)},t}function S(){ao.event.preventDefault()}function k(){for(var n,t=ao.event;n=t.sourceEvent;)t=n;return t}function N(n){for(var t=new _,e=0,r=arguments.length;++e<r;)t[arguments[e]]=w(t);return t.of=function(e,r){return function(i){try{var u=i.sourceEvent=ao.event;i.target=n,ao.event=i,t[i.type].apply(e,r)}finally{ao.event=u}}},t}function E(n){return ko(n,Co),n}function A(n){return"function"==typeof n?n:function(){return No(n,this)}}function C(n){return"function"==typeof n?n:function(){return Eo(n,this)}}function z(n,t){function e(){this.removeAttribute(n)}function r(){this.removeAttributeNS(n.space,n.local)}function i(){this.setAttribute(n,t)}function u(){this.setAttributeNS(n.space,n.local,t)}function o(){var e=t.apply(this,arguments);null==e?this.removeAttribute(n):this.setAttribute(n,e)}function a(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}return n=ao.ns.qualify(n),null==t?n.local?r:e:"function"==typeof t?n.local?a:o:n.local?u:i}function L(n){return n.trim().replace(/\s+/g," ")}function q(n){return new RegExp("(?:^|\\s+)"+ao.requote(n)+"(?:\\s+|$)","g")}function T(n){return(n+"").trim().split(/^|\s+/)}function R(n,t){function e(){for(var e=-1;++e<i;)n[e](this,t)}function r(){for(var e=-1,r=t.apply(this,arguments);++e<i;)n[e](this,r)}n=T(n).map(D);var i=n.length;return"function"==typeof t?r:e}function D(n){var t=q(n);return function(e,r){if(i=e.classList)return r?i.add(n):i.remove(n);var i=e.getAttribute("class")||"";r?(t.lastIndex=0,t.test(i)||e.setAttribute("class",L(i+" "+n))):e.setAttribute("class",L(i.replace(t," ")))}}function P(n,t,e){function r(){this.style.removeProperty(n)}function i(){this.style.setProperty(n,t,e)}function u(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,e)}return null==t?r:"function"==typeof t?u:i}function U(n,t){function e(){delete this[n]}function r(){this[n]=t}function i(){var e=t.apply(this,arguments);null==e?delete this[n]:this[n]=e}return null==t?e:"function"==typeof t?i:r}function j(n){function t(){var t=this.ownerDocument,e=this.namespaceURI;return e===zo&&t.documentElement.namespaceURI===zo?t.createElement(n):t.createElementNS(e,n)}function e(){return this.ownerDocument.createElementNS(n.space,n.local)}return"function"==typeof n?n:(n=ao.ns.qualify(n)).local?e:t}function F(){var n=this.parentNode;n&&n.removeChild(this)}function H(n){return{__data__:n}}function O(n){return function(){return Ao(this,n)}}function I(n){return arguments.length||(n=e),function(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}}function Y(n,t){for(var e=0,r=n.length;r>e;e++)for(var i,u=n[e],o=0,a=u.length;a>o;o++)(i=u[o])&&t(i,o,e);return n}function Z(n){return ko(n,qo),n}function V(n){var t,e;return function(r,i,u){var o,a=n[u].update,l=a.length;for(u!=e&&(e=u,t=0),i>=t&&(t=i+1);!(o=a[t])&&++t<l;);return o}}function X(n,t,e){function r(){var t=this[o];t&&(this.removeEventListener(n,t,t.$),delete this[o])}function i(){var i=l(t,co(arguments));r.call(this),this.addEventListener(n,this[o]=i,i.$=e),i._=t}function u(){var t,e=new RegExp("^__on([^.]+)"+ao.requote(n)+"$");for(var r in this)if(t=r.match(e)){var i=this[r];this.removeEventListener(t[1],i,i.$),delete this[r]}}var o="__on"+n,a=n.indexOf("."),l=$;a>0&&(n=n.slice(0,a));var c=To.get(n);return c&&(n=c,l=B),a?t?i:r:t?b:u}function $(n,t){return function(e){var r=ao.event;ao.event=e,t[0]=this.__data__;try{n.apply(this,t)}finally{ao.event=r}}}function B(n,t){var e=$(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||e.call(t,n)}}function W(e){var r=".dragsuppress-"+ ++Do,i="click"+r,u=ao.select(t(e)).on("touchmove"+r,S).on("dragstart"+r,S).on("selectstart"+r,S);if(null==Ro&&(Ro="onselectstart"in e?!1:x(e.style,"userSelect")),Ro){var o=n(e).style,a=o[Ro];o[Ro]="none"}return function(n){if(u.on(r,null),Ro&&(o[Ro]=a),n){var t=function(){u.on(i,null)};u.on(i,function(){S(),t()},!0),setTimeout(t,0)}}}function J(n,e){e.changedTouches&&(e=e.changedTouches[0]);var r=n.ownerSVGElement||n;if(r.createSVGPoint){var i=r.createSVGPoint();if(0>Po){var u=t(n);if(u.scrollX||u.scrollY){r=ao.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=r[0][0].getScreenCTM();Po=!(o.f||o.e),r.remove()}}return Po?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),i=i.matrixTransform(n.getScreenCTM().inverse()),[i.x,i.y]}var a=n.getBoundingClientRect();return[e.clientX-a.left-n.clientLeft,e.clientY-a.top-n.clientTop]}function G(){return ao.event.changedTouches[0].identifier}function K(n){return n>0?1:0>n?-1:0}function Q(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(t[1]-n[1])*(e[0]-n[0])}function nn(n){return n>1?0:-1>n?Fo:Math.acos(n)}function tn(n){return n>1?Io:-1>n?-Io:Math.asin(n)}function en(n){return((n=Math.exp(n))-1/n)/2}function rn(n){return((n=Math.exp(n))+1/n)/2}function un(n){return((n=Math.exp(2*n))-1)/(n+1)}function on(n){return(n=Math.sin(n/2))*n}function an(){}function ln(n,t,e){return this instanceof ln?(this.h=+n,this.s=+t,void(this.l=+e)):arguments.length<2?n instanceof ln?new ln(n.h,n.s,n.l):_n(""+n,wn,ln):new ln(n,t,e)}function cn(n,t,e){function r(n){return n>360?n-=360:0>n&&(n+=360),60>n?u+(o-u)*n/60:180>n?o:240>n?u+(o-u)*(240-n)/60:u}function i(n){return Math.round(255*r(n))}var u,o;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,e=0>e?0:e>1?1:e,o=.5>=e?e*(1+t):e+t-e*t,u=2*e-o,new mn(i(n+120),i(n),i(n-120))}function fn(n,t,e){return this instanceof fn?(this.h=+n,this.c=+t,void(this.l=+e)):arguments.length<2?n instanceof fn?new fn(n.h,n.c,n.l):n instanceof hn?gn(n.l,n.a,n.b):gn((n=Sn((n=ao.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new fn(n,t,e)}function sn(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new hn(e,Math.cos(n*=Yo)*t,Math.sin(n)*t)}function hn(n,t,e){return this instanceof hn?(this.l=+n,this.a=+t,void(this.b=+e)):arguments.length<2?n instanceof hn?new hn(n.l,n.a,n.b):n instanceof fn?sn(n.h,n.c,n.l):Sn((n=mn(n)).r,n.g,n.b):new hn(n,t,e)}function pn(n,t,e){var r=(n+16)/116,i=r+t/500,u=r-e/200;return i=vn(i)*na,r=vn(r)*ta,u=vn(u)*ea,new mn(yn(3.2404542*i-1.5371385*r-.4985314*u),yn(-.969266*i+1.8760108*r+.041556*u),yn(.0556434*i-.2040259*r+1.0572252*u))}function gn(n,t,e){return n>0?new fn(Math.atan2(e,t)*Zo,Math.sqrt(t*t+e*e),n):new fn(NaN,NaN,n)}function vn(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function dn(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function yn(n){return Math.round(255*(.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function mn(n,t,e){return this instanceof mn?(this.r=~~n,this.g=~~t,void(this.b=~~e)):arguments.length<2?n instanceof mn?new mn(n.r,n.g,n.b):_n(""+n,mn,cn):new mn(n,t,e)}function Mn(n){return new mn(n>>16,n>>8&255,255&n)}function xn(n){return Mn(n)+""}function bn(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function _n(n,t,e){var r,i,u,o=0,a=0,l=0;if(r=/([a-z]+)\((.*)\)/.exec(n=n.toLowerCase()))switch(i=r[2].split(","),r[1]){case"hsl":return e(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return t(Nn(i[0]),Nn(i[1]),Nn(i[2]))}return(u=ua.get(n))?t(u.r,u.g,u.b):(null==n||"#"!==n.charAt(0)||isNaN(u=parseInt(n.slice(1),16))||(4===n.length?(o=(3840&u)>>4,o=o>>4|o,a=240&u,a=a>>4|a,l=15&u,l=l<<4|l):7===n.length&&(o=(16711680&u)>>16,a=(65280&u)>>8,l=255&u)),t(o,a,l))}function wn(n,t,e){var r,i,u=Math.min(n/=255,t/=255,e/=255),o=Math.max(n,t,e),a=o-u,l=(o+u)/2;return a?(i=.5>l?a/(o+u):a/(2-o-u),r=n==o?(t-e)/a+(e>t?6:0):t==o?(e-n)/a+2:(n-t)/a+4,r*=60):(r=NaN,i=l>0&&1>l?0:r),new ln(r,i,l)}function Sn(n,t,e){n=kn(n),t=kn(t),e=kn(e);var r=dn((.4124564*n+.3575761*t+.1804375*e)/na),i=dn((.2126729*n+.7151522*t+.072175*e)/ta),u=dn((.0193339*n+.119192*t+.9503041*e)/ea);return hn(116*i-16,500*(r-i),200*(i-u))}function kn(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Nn(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function En(n){return"function"==typeof n?n:function(){return n}}function An(n){return function(t,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),Cn(t,e,n,r)}}function Cn(n,t,e,r){function i(){var n,t=l.status;if(!t&&Ln(l)||t>=200&&300>t||304===t){try{n=e.call(u,l)}catch(r){return void o.error.call(u,r)}o.load.call(u,n)}else o.error.call(u,l)}var u={},o=ao.dispatch("beforesend","progress","load","error"),a={},l=new XMLHttpRequest,c=null;return!this.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(n)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=i:l.onreadystatechange=function(){l.readyState>3&&i()},l.onprogress=function(n){var t=ao.event;ao.event=n;try{o.progress.call(u,l)}finally{ao.event=t}},u.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?a[n]:(null==t?delete a[n]:a[n]=t+"",u)},u.mimeType=function(n){return arguments.length?(t=null==n?null:n+"",u):t},u.responseType=function(n){return arguments.length?(c=n,u):c},u.response=function(n){return e=n,u},["get","post"].forEach(function(n){u[n]=function(){return u.send.apply(u,[n].concat(co(arguments)))}}),u.send=function(e,r,i){if(2===arguments.length&&"function"==typeof r&&(i=r,r=null),l.open(e,n,!0),null==t||"accept"in a||(a.accept=t+",*/*"),l.setRequestHeader)for(var f in a)l.setRequestHeader(f,a[f]);return null!=t&&l.overrideMimeType&&l.overrideMimeType(t),null!=c&&(l.responseType=c),null!=i&&u.on("error",i).on("load",function(n){i(null,n)}),o.beforesend.call(u,l),l.send(null==r?null:r),u},u.abort=function(){return l.abort(),u},ao.rebind(u,o,"on"),null==r?u:u.get(zn(r))}function zn(n){return 1===n.length?function(t,e){n(null==t?e:null)}:n}function Ln(n){var t=n.responseType;return t&&"text"!==t?n.response:n.responseText}function qn(n,t,e){var r=arguments.length;2>r&&(t=0),3>r&&(e=Date.now());var i=e+t,u={c:n,t:i,n:null};return aa?aa.n=u:oa=u,aa=u,la||(ca=clearTimeout(ca),la=1,fa(Tn)),u}function Tn(){var n=Rn(),t=Dn()-n;t>24?(isFinite(t)&&(clearTimeout(ca),ca=setTimeout(Tn,t)),la=0):(la=1,fa(Tn))}function Rn(){for(var n=Date.now(),t=oa;t;)n>=t.t&&t.c(n-t.t)&&(t.c=null),t=t.n;return n}function Dn(){for(var n,t=oa,e=1/0;t;)t.c?(t.t<e&&(e=t.t),t=(n=t).n):t=n?n.n=t.n:oa=t.n;return aa=n,e}function Pn(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function Un(n,t){var e=Math.pow(10,3*xo(8-t));return{scale:t>8?function(n){return n/e}:function(n){return n*e},symbol:n}}function jn(n){var t=n.decimal,e=n.thousands,r=n.grouping,i=n.currency,u=r&&e?function(n,t){for(var i=n.length,u=[],o=0,a=r[0],l=0;i>0&&a>0&&(l+a+1>t&&(a=Math.max(1,t-l)),u.push(n.substring(i-=a,i+a)),!((l+=a+1)>t));)a=r[o=(o+1)%r.length];return u.reverse().join(e)}:m;return function(n){var e=ha.exec(n),r=e[1]||" ",o=e[2]||">",a=e[3]||"-",l=e[4]||"",c=e[5],f=+e[6],s=e[7],h=e[8],p=e[9],g=1,v="",d="",y=!1,m=!0;switch(h&&(h=+h.substring(1)),(c||"0"===r&&"="===o)&&(c=r="0",o="="),p){case"n":s=!0,p="g";break;case"%":g=100,d="%",p="f";break;case"p":g=100,d="%",p="r";break;case"b":case"o":case"x":case"X":"#"===l&&(v="0"+p.toLowerCase());case"c":m=!1;case"d":y=!0,h=0;break;case"s":g=-1,p="r"}"$"===l&&(v=i[0],d=i[1]),"r"!=p||h||(p="g"),null!=h&&("g"==p?h=Math.max(1,Math.min(21,h)):"e"!=p&&"f"!=p||(h=Math.max(0,Math.min(20,h)))),p=pa.get(p)||Fn;var M=c&&s;return function(n){var e=d;if(y&&n%1)return"";var i=0>n||0===n&&0>1/n?(n=-n,"-"):"-"===a?"":a;if(0>g){var l=ao.formatPrefix(n,h);n=l.scale(n),e=l.symbol+d}else n*=g;n=p(n,h);var x,b,_=n.lastIndexOf(".");if(0>_){var w=m?n.lastIndexOf("e"):-1;0>w?(x=n,b=""):(x=n.substring(0,w),b=n.substring(w))}else x=n.substring(0,_),b=t+n.substring(_+1);!c&&s&&(x=u(x,1/0));var S=v.length+x.length+b.length+(M?0:i.length),k=f>S?new Array(S=f-S+1).join(r):"";return M&&(x=u(k+x,k.length?f-b.length:1/0)),i+=v,n=x+b,("<"===o?i+n+k:">"===o?k+i+n:"^"===o?k.substring(0,S>>=1)+i+n+k.substring(S):i+(M?n:k+n))+e}}}function Fn(n){return n+""}function Hn(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function On(n,t,e){function r(t){var e=n(t),r=u(e,1);return r-t>t-e?e:r}function i(e){return t(e=n(new va(e-1)),1),e}function u(n,e){return t(n=new va(+n),e),n}function o(n,r,u){var o=i(n),a=[];if(u>1)for(;r>o;)e(o)%u||a.push(new Date(+o)),t(o,1);else for(;r>o;)a.push(new Date(+o)),t(o,1);return a}function a(n,t,e){try{va=Hn;var r=new Hn;return r._=n,o(r,t,e)}finally{va=Date}}n.floor=n,n.round=r,n.ceil=i,n.offset=u,n.range=o;var l=n.utc=In(n);return l.floor=l,l.round=In(r),l.ceil=In(i),l.offset=In(u),l.range=a,n}function In(n){return function(t,e){try{va=Hn;var r=new Hn;return r._=t,n(r,e)._}finally{va=Date}}}function Yn(n){function t(n){function t(t){for(var e,i,u,o=[],a=-1,l=0;++a<r;)37===n.charCodeAt(a)&&(o.push(n.slice(l,a)),null!=(i=ya[e=n.charAt(++a)])&&(e=n.charAt(++a)),(u=A[e])&&(e=u(t,null==i?"e"===e?" ":"0":i)),o.push(e),l=a+1);return o.push(n.slice(l,a)),o.join("")}var r=n.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},i=e(r,n,t,0);if(i!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var u=null!=r.Z&&va!==Hn,o=new(u?Hn:va);return"j"in r?o.setFullYear(r.y,0,r.j):"W"in r||"U"in r?("w"in r||(r.w="W"in r?1:0),o.setFullYear(r.y,0,1),o.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(o.getDay()+5)%7:r.w+7*r.U-(o.getDay()+6)%7)):o.setFullYear(r.y,r.m,r.d),o.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L),u?o._:o},t.toString=function(){return n},t}function e(n,t,e,r){for(var i,u,o,a=0,l=t.length,c=e.length;l>a;){if(r>=c)return-1;if(i=t.charCodeAt(a++),37===i){if(o=t.charAt(a++),u=C[o in ya?t.charAt(a++):o],!u||(r=u(n,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}function r(n,t,e){_.lastIndex=0;var r=_.exec(t.slice(e));return r?(n.w=w.get(r[0].toLowerCase()),e+r[0].length):-1}function i(n,t,e){x.lastIndex=0;var r=x.exec(t.slice(e));return r?(n.w=b.get(r[0].toLowerCase()),e+r[0].length):-1}function u(n,t,e){N.lastIndex=0;var r=N.exec(t.slice(e));return r?(n.m=E.get(r[0].toLowerCase()),e+r[0].length):-1}function o(n,t,e){S.lastIndex=0;var r=S.exec(t.slice(e));return r?(n.m=k.get(r[0].toLowerCase()),e+r[0].length):-1}function a(n,t,r){return e(n,A.c.toString(),t,r)}function l(n,t,r){return e(n,A.x.toString(),t,r)}function c(n,t,r){return e(n,A.X.toString(),t,r)}function f(n,t,e){var r=M.get(t.slice(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)}var s=n.dateTime,h=n.date,p=n.time,g=n.periods,v=n.days,d=n.shortDays,y=n.months,m=n.shortMonths;t.utc=function(n){function e(n){try{va=Hn;var t=new va;return t._=n,r(t)}finally{va=Date}}var r=t(n);return e.parse=function(n){try{va=Hn;var t=r.parse(n);return t&&t._}finally{va=Date}},e.toString=r.toString,e},t.multi=t.utc.multi=ct;var M=ao.map(),x=Vn(v),b=Xn(v),_=Vn(d),w=Xn(d),S=Vn(y),k=Xn(y),N=Vn(m),E=Xn(m);g.forEach(function(n,t){M.set(n.toLowerCase(),t)});var A={a:function(n){return d[n.getDay()]},A:function(n){return v[n.getDay()]},b:function(n){return m[n.getMonth()]},B:function(n){return y[n.getMonth()]},c:t(s),d:function(n,t){return Zn(n.getDate(),t,2)},e:function(n,t){return Zn(n.getDate(),t,2)},H:function(n,t){return Zn(n.getHours(),t,2)},I:function(n,t){return Zn(n.getHours()%12||12,t,2)},j:function(n,t){return Zn(1+ga.dayOfYear(n),t,3)},L:function(n,t){return Zn(n.getMilliseconds(),t,3)},m:function(n,t){return Zn(n.getMonth()+1,t,2)},M:function(n,t){return Zn(n.getMinutes(),t,2)},p:function(n){return g[+(n.getHours()>=12)]},S:function(n,t){return Zn(n.getSeconds(),t,2)},U:function(n,t){return Zn(ga.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return Zn(ga.mondayOfYear(n),t,2)},x:t(h),X:t(p),y:function(n,t){return Zn(n.getFullYear()%100,t,2)},Y:function(n,t){return Zn(n.getFullYear()%1e4,t,4)},Z:at,"%":function(){return"%"}},C={a:r,A:i,b:u,B:o,c:a,d:tt,e:tt,H:rt,I:rt,j:et,L:ot,m:nt,M:it,p:f,S:ut,U:Bn,w:$n,W:Wn,x:l,X:c,y:Gn,Y:Jn,Z:Kn,"%":lt};return t}function Zn(n,t,e){var r=0>n?"-":"",i=(r?-n:n)+"",u=i.length;return r+(e>u?new Array(e-u+1).join(t)+i:i)}function Vn(n){return new RegExp("^(?:"+n.map(ao.requote).join("|")+")","i")}function Xn(n){for(var t=new c,e=-1,r=n.length;++e<r;)t.set(n[e].toLowerCase(),e);return t}function $n(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function Bn(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e));return r?(n.U=+r[0],e+r[0].length):-1}function Wn(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e));return r?(n.W=+r[0],e+r[0].length):-1}function Jn(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function Gn(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e,e+2));return r?(n.y=Qn(+r[0]),e+r[0].length):-1}function Kn(n,t,e){return/^[+-]\d{4}$/.test(t=t.slice(e,e+5))?(n.Z=-t,e+5):-1}function Qn(n){return n+(n>68?1900:2e3)}function nt(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function tt(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function et(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function rt(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function it(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function ut(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function ot(n,t,e){ma.lastIndex=0;var r=ma.exec(t.slice(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function at(n){var t=n.getTimezoneOffset(),e=t>0?"-":"+",r=xo(t)/60|0,i=xo(t)%60;return e+Zn(r,"0",2)+Zn(i,"0",2)}function lt(n,t,e){Ma.lastIndex=0;var r=Ma.exec(t.slice(e,e+1));return r?e+r[0].length:-1}function ct(n){for(var t=n.length,e=-1;++e<t;)n[e][0]=this(n[e][0]);return function(t){for(var e=0,r=n[e];!r[1](t);)r=n[++e];return r[0](t)}}function ft(){}function st(n,t,e){var r=e.s=n+t,i=r-n,u=r-i;e.t=n-u+(t-i)}function ht(n,t){n&&wa.hasOwnProperty(n.type)&&wa[n.type](n,t)}function pt(n,t,e){var r,i=-1,u=n.length-e;for(t.lineStart();++i<u;)r=n[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function gt(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)pt(n[e],t,1);t.polygonEnd()}function vt(){function n(n,t){n*=Yo,t=t*Yo/2+Fo/4;var e=n-r,o=e>=0?1:-1,a=o*e,l=Math.cos(t),c=Math.sin(t),f=u*c,s=i*l+f*Math.cos(a),h=f*o*Math.sin(a);ka.add(Math.atan2(h,s)),r=n,i=l,u=c}var t,e,r,i,u;Na.point=function(o,a){Na.point=n,r=(t=o)*Yo,i=Math.cos(a=(e=a)*Yo/2+Fo/4),u=Math.sin(a)},Na.lineEnd=function(){n(t,e)}}function dt(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function yt(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function mt(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Mt(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function xt(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function bt(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function _t(n){return[Math.atan2(n[1],n[0]),tn(n[2])]}function wt(n,t){return xo(n[0]-t[0])<Uo&&xo(n[1]-t[1])<Uo}function St(n,t){n*=Yo;var e=Math.cos(t*=Yo);kt(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function kt(n,t,e){++Ea,Ca+=(n-Ca)/Ea,za+=(t-za)/Ea,La+=(e-La)/Ea}function Nt(){function n(n,i){n*=Yo;var u=Math.cos(i*=Yo),o=u*Math.cos(n),a=u*Math.sin(n),l=Math.sin(i),c=Math.atan2(Math.sqrt((c=e*l-r*a)*c+(c=r*o-t*l)*c+(c=t*a-e*o)*c),t*o+e*a+r*l);Aa+=c,qa+=c*(t+(t=o)),Ta+=c*(e+(e=a)),Ra+=c*(r+(r=l)),kt(t,e,r)}var t,e,r;ja.point=function(i,u){i*=Yo;var o=Math.cos(u*=Yo);t=o*Math.cos(i),e=o*Math.sin(i),r=Math.sin(u),ja.point=n,kt(t,e,r)}}function Et(){ja.point=St}function At(){function n(n,t){n*=Yo;var e=Math.cos(t*=Yo),o=e*Math.cos(n),a=e*Math.sin(n),l=Math.sin(t),c=i*l-u*a,f=u*o-r*l,s=r*a-i*o,h=Math.sqrt(c*c+f*f+s*s),p=r*o+i*a+u*l,g=h&&-nn(p)/h,v=Math.atan2(h,p);Da+=g*c,Pa+=g*f,Ua+=g*s,Aa+=v,qa+=v*(r+(r=o)),Ta+=v*(i+(i=a)),Ra+=v*(u+(u=l)),kt(r,i,u)}var t,e,r,i,u;ja.point=function(o,a){t=o,e=a,ja.point=n,o*=Yo;var l=Math.cos(a*=Yo);r=l*Math.cos(o),i=l*Math.sin(o),u=Math.sin(a),kt(r,i,u)},ja.lineEnd=function(){n(t,e),ja.lineEnd=Et,ja.point=St}}function Ct(n,t){function e(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(e.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),e}function zt(){return!0}function Lt(n,t,e,r,i){var u=[],o=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(wt(e,r)){i.lineStart();for(var a=0;t>a;++a)i.point((e=n[a])[0],e[1]);return void i.lineEnd()}var l=new Tt(e,n,null,!0),c=new Tt(e,null,l,!1);l.o=c,u.push(l),o.push(c),l=new Tt(r,n,null,!1),c=new Tt(r,null,l,!0),l.o=c,u.push(l),o.push(c)}}),o.sort(t),qt(u),qt(o),u.length){for(var a=0,l=e,c=o.length;c>a;++a)o[a].e=l=!l;for(var f,s,h=u[0];;){for(var p=h,g=!0;p.v;)if((p=p.n)===h)return;f=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(g)for(var a=0,c=f.length;c>a;++a)i.point((s=f[a])[0],s[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(g){f=p.p.z;for(var a=f.length-1;a>=0;--a)i.point((s=f[a])[0],s[1])}else r(p.x,p.p.x,-1,i);p=p.p}p=p.o,f=p.z,g=!g}while(!p.v);i.lineEnd()}}}function qt(n){if(t=n.length){for(var t,e,r=0,i=n[0];++r<t;)i.n=e=n[r],e.p=i,i=e;i.n=e=n[0],e.p=i}}function Tt(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Rt(n,t,e,r){return function(i,u){function o(t,e){var r=i(t,e);n(t=r[0],e=r[1])&&u.point(t,e)}function a(n,t){var e=i(n,t);d.point(e[0],e[1])}function l(){m.point=a,d.lineStart()}function c(){m.point=o,d.lineEnd()}function f(n,t){v.push([n,t]);var e=i(n,t);x.point(e[0],e[1])}function s(){x.lineStart(),v=[]}function h(){f(v[0][0],v[0][1]),x.lineEnd();var n,t=x.clean(),e=M.buffer(),r=e.length;if(v.pop(),g.push(v),v=null,r)if(1&t){n=e[0];var i,r=n.length-1,o=-1;if(r>0){for(b||(u.polygonStart(),b=!0),u.lineStart();++o<r;)u.point((i=n[o])[0],i[1]);u.lineEnd()}}else r>1&&2&t&&e.push(e.pop().concat(e.shift())),p.push(e.filter(Dt))}var p,g,v,d=t(u),y=i.invert(r[0],r[1]),m={point:o,lineStart:l,lineEnd:c,polygonStart:function(){m.point=f,m.lineStart=s,m.lineEnd=h,p=[],g=[]},polygonEnd:function(){m.point=o,m.lineStart=l,m.lineEnd=c,p=ao.merge(p);var n=Ot(y,g);p.length?(b||(u.polygonStart(),b=!0),Lt(p,Ut,n,e,u)):n&&(b||(u.polygonStart(),b=!0),u.lineStart(),e(null,null,1,u),u.lineEnd()),b&&(u.polygonEnd(),b=!1),p=g=null},sphere:function(){u.polygonStart(),u.lineStart(),e(null,null,1,u),u.lineEnd(),u.polygonEnd()}},M=Pt(),x=t(M),b=!1;return m}}function Dt(n){return n.length>1}function Pt(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,e){n.push([t,e])},lineEnd:b,buffer:function(){var e=t;return t=[],n=null,e},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function Ut(n,t){return((n=n.x)[0]<0?n[1]-Io-Uo:Io-n[1])-((t=t.x)[0]<0?t[1]-Io-Uo:Io-t[1])}function jt(n){var t,e=NaN,r=NaN,i=NaN;return{lineStart:function(){n.lineStart(),t=1},point:function(u,o){var a=u>0?Fo:-Fo,l=xo(u-e);xo(l-Fo)<Uo?(n.point(e,r=(r+o)/2>0?Io:-Io),n.point(i,r),n.lineEnd(),n.lineStart(),n.point(a,r),n.point(u,r),t=0):i!==a&&l>=Fo&&(xo(e-i)<Uo&&(e-=i*Uo),xo(u-a)<Uo&&(u-=a*Uo),r=Ft(e,r,u,o),n.point(i,r),n.lineEnd(),n.lineStart(),n.point(a,r),t=0),n.point(e=u,r=o),i=a},lineEnd:function(){n.lineEnd(),e=r=NaN},clean:function(){return 2-t}}}function Ft(n,t,e,r){var i,u,o=Math.sin(n-e);return xo(o)>Uo?Math.atan((Math.sin(t)*(u=Math.cos(r))*Math.sin(e)-Math.sin(r)*(i=Math.cos(t))*Math.sin(n))/(i*u*o)):(t+r)/2}function Ht(n,t,e,r){var i;if(null==n)i=e*Io,r.point(-Fo,i),r.point(0,i),r.point(Fo,i),r.point(Fo,0),r.point(Fo,-i),r.point(0,-i),r.point(-Fo,-i),r.point(-Fo,0),r.point(-Fo,i);else if(xo(n[0]-t[0])>Uo){var u=n[0]<t[0]?Fo:-Fo;i=e*u/2,r.point(-u,i),r.point(0,i),r.point(u,i)}else r.point(t[0],t[1])}function Ot(n,t){var e=n[0],r=n[1],i=[Math.sin(e),-Math.cos(e),0],u=0,o=0;ka.reset();for(var a=0,l=t.length;l>a;++a){var c=t[a],f=c.length;if(f)for(var s=c[0],h=s[0],p=s[1]/2+Fo/4,g=Math.sin(p),v=Math.cos(p),d=1;;){d===f&&(d=0),n=c[d];var y=n[0],m=n[1]/2+Fo/4,M=Math.sin(m),x=Math.cos(m),b=y-h,_=b>=0?1:-1,w=_*b,S=w>Fo,k=g*M;if(ka.add(Math.atan2(k*_*Math.sin(w),v*x+k*Math.cos(w))),u+=S?b+_*Ho:b,S^h>=e^y>=e){var N=mt(dt(s),dt(n));bt(N);var E=mt(i,N);bt(E);var A=(S^b>=0?-1:1)*tn(E[2]);(r>A||r===A&&(N[0]||N[1]))&&(o+=S^b>=0?1:-1)}if(!d++)break;h=y,g=M,v=x,s=n}}return(-Uo>u||Uo>u&&-Uo>ka)^1&o}function It(n){function t(n,t){return Math.cos(n)*Math.cos(t)>u}function e(n){var e,u,l,c,f;return{lineStart:function(){c=l=!1,f=1},point:function(s,h){var p,g=[s,h],v=t(s,h),d=o?v?0:i(s,h):v?i(s+(0>s?Fo:-Fo),h):0;if(!e&&(c=l=v)&&n.lineStart(),v!==l&&(p=r(e,g),(wt(e,p)||wt(g,p))&&(g[0]+=Uo,g[1]+=Uo,v=t(g[0],g[1]))),v!==l)f=0,v?(n.lineStart(),p=r(g,e),n.point(p[0],p[1])):(p=r(e,g),n.point(p[0],p[1]),n.lineEnd()),e=p;else if(a&&e&&o^v){var y;d&u||!(y=r(g,e,!0))||(f=0,o?(n.lineStart(),n.point(y[0][0],y[0][1]),n.point(y[1][0],y[1][1]),n.lineEnd()):(n.point(y[1][0],y[1][1]),n.lineEnd(),n.lineStart(),n.point(y[0][0],y[0][1])))}!v||e&&wt(e,g)||n.point(g[0],g[1]),e=g,l=v,u=d},lineEnd:function(){l&&n.lineEnd(),e=null},clean:function(){return f|(c&&l)<<1}}}function r(n,t,e){var r=dt(n),i=dt(t),o=[1,0,0],a=mt(r,i),l=yt(a,a),c=a[0],f=l-c*c;if(!f)return!e&&n;var s=u*l/f,h=-u*c/f,p=mt(o,a),g=xt(o,s),v=xt(a,h);Mt(g,v);var d=p,y=yt(g,d),m=yt(d,d),M=y*y-m*(yt(g,g)-1);if(!(0>M)){var x=Math.sqrt(M),b=xt(d,(-y-x)/m);if(Mt(b,g),b=_t(b),!e)return b;var _,w=n[0],S=t[0],k=n[1],N=t[1];w>S&&(_=w,w=S,S=_);var E=S-w,A=xo(E-Fo)<Uo,C=A||Uo>E;if(!A&&k>N&&(_=k,k=N,N=_),C?A?k+N>0^b[1]<(xo(b[0]-w)<Uo?k:N):k<=b[1]&&b[1]<=N:E>Fo^(w<=b[0]&&b[0]<=S)){var z=xt(d,(-y+x)/m);return Mt(z,g),[b,_t(z)]}}}function i(t,e){var r=o?n:Fo-n,i=0;return-r>t?i|=1:t>r&&(i|=2),-r>e?i|=4:e>r&&(i|=8),i}var u=Math.cos(n),o=u>0,a=xo(u)>Uo,l=ve(n,6*Yo);return Rt(t,e,l,o?[0,-n]:[-Fo,n-Fo])}function Yt(n,t,e,r){return function(i){var u,o=i.a,a=i.b,l=o.x,c=o.y,f=a.x,s=a.y,h=0,p=1,g=f-l,v=s-c;if(u=n-l,g||!(u>0)){if(u/=g,0>g){if(h>u)return;p>u&&(p=u)}else if(g>0){if(u>p)return;u>h&&(h=u)}if(u=e-l,g||!(0>u)){if(u/=g,0>g){if(u>p)return;u>h&&(h=u)}else if(g>0){if(h>u)return;p>u&&(p=u)}if(u=t-c,v||!(u>0)){if(u/=v,0>v){if(h>u)return;p>u&&(p=u)}else if(v>0){if(u>p)return;u>h&&(h=u)}if(u=r-c,v||!(0>u)){if(u/=v,0>v){if(u>p)return;u>h&&(h=u)}else if(v>0){if(h>u)return;p>u&&(p=u)}return h>0&&(i.a={x:l+h*g,y:c+h*v}),1>p&&(i.b={x:l+p*g,y:c+p*v}),i}}}}}}function Zt(n,t,e,r){function i(r,i){return xo(r[0]-n)<Uo?i>0?0:3:xo(r[0]-e)<Uo?i>0?2:1:xo(r[1]-t)<Uo?i>0?1:0:i>0?3:2}function u(n,t){return o(n.x,t.x)}function o(n,t){var e=i(n,1),r=i(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}return function(a){function l(n){for(var t=0,e=d.length,r=n[1],i=0;e>i;++i)for(var u,o=1,a=d[i],l=a.length,c=a[0];l>o;++o)u=a[o],c[1]<=r?u[1]>r&&Q(c,u,n)>0&&++t:u[1]<=r&&Q(c,u,n)<0&&--t,c=u;return 0!==t}function c(u,a,l,c){var f=0,s=0;if(null==u||(f=i(u,l))!==(s=i(a,l))||o(u,a)<0^l>0){do c.point(0===f||3===f?n:e,f>1?r:t);while((f=(f+l+4)%4)!==s)}else c.point(a[0],a[1])}function f(i,u){return i>=n&&e>=i&&u>=t&&r>=u}function s(n,t){f(n,t)&&a.point(n,t)}function h(){C.point=g,d&&d.push(y=[]),S=!0,w=!1,b=_=NaN}function p(){v&&(g(m,M),x&&w&&E.rejoin(),v.push(E.buffer())),C.point=s,w&&a.lineEnd()}function g(n,t){n=Math.max(-Ha,Math.min(Ha,n)),t=Math.max(-Ha,Math.min(Ha,t));var e=f(n,t);if(d&&y.push([n,t]),S)m=n,M=t,x=e,S=!1,e&&(a.lineStart(),a.point(n,t));else if(e&&w)a.point(n,t);else{var r={a:{x:b,y:_},b:{x:n,y:t}};A(r)?(w||(a.lineStart(),a.point(r.a.x,r.a.y)),a.point(r.b.x,r.b.y),e||a.lineEnd(),k=!1):e&&(a.lineStart(),a.point(n,t),k=!1)}b=n,_=t,w=e}var v,d,y,m,M,x,b,_,w,S,k,N=a,E=Pt(),A=Yt(n,t,e,r),C={point:s,lineStart:h,lineEnd:p,polygonStart:function(){a=E,v=[],d=[],k=!0},polygonEnd:function(){a=N,v=ao.merge(v);var t=l([n,r]),e=k&&t,i=v.length;(e||i)&&(a.polygonStart(),e&&(a.lineStart(),c(null,null,1,a),a.lineEnd()),i&&Lt(v,u,t,c,a),a.polygonEnd()),v=d=y=null}};return C}}function Vt(n){var t=0,e=Fo/3,r=ae(n),i=r(t,e);return i.parallels=function(n){return arguments.length?r(t=n[0]*Fo/180,e=n[1]*Fo/180):[t/Fo*180,e/Fo*180]},i}function Xt(n,t){function e(n,t){var e=Math.sqrt(u-2*i*Math.sin(t))/i;return[e*Math.sin(n*=i),o-e*Math.cos(n)]}var r=Math.sin(n),i=(r+Math.sin(t))/2,u=1+r*(2*i-r),o=Math.sqrt(u)/i;return e.invert=function(n,t){var e=o-t;return[Math.atan2(n,e)/i,tn((u-(n*n+e*e)*i*i)/(2*i))]},e}function $t(){function n(n,t){Ia+=i*n-r*t,r=n,i=t}var t,e,r,i;$a.point=function(u,o){$a.point=n,t=r=u,e=i=o},$a.lineEnd=function(){n(t,e)}}function Bt(n,t){Ya>n&&(Ya=n),n>Va&&(Va=n),Za>t&&(Za=t),t>Xa&&(Xa=t)}function Wt(){function n(n,t){o.push("M",n,",",t,u)}function t(n,t){o.push("M",n,",",t),a.point=e}function e(n,t){o.push("L",n,",",t)}function r(){a.point=n}function i(){o.push("Z")}var u=Jt(4.5),o=[],a={point:n,lineStart:function(){a.point=t},lineEnd:r,polygonStart:function(){a.lineEnd=i},polygonEnd:function(){a.lineEnd=r,a.point=n},pointRadius:function(n){return u=Jt(n),a},result:function(){if(o.length){var n=o.join("");return o=[],n}}};return a}function Jt(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function Gt(n,t){Ca+=n,za+=t,++La}function Kt(){function n(n,r){var i=n-t,u=r-e,o=Math.sqrt(i*i+u*u);qa+=o*(t+n)/2,Ta+=o*(e+r)/2,Ra+=o,Gt(t=n,e=r)}var t,e;Wa.point=function(r,i){Wa.point=n,Gt(t=r,e=i)}}function Qt(){Wa.point=Gt}function ne(){function n(n,t){var e=n-r,u=t-i,o=Math.sqrt(e*e+u*u);qa+=o*(r+n)/2,Ta+=o*(i+t)/2,Ra+=o,o=i*n-r*t,Da+=o*(r+n),Pa+=o*(i+t),Ua+=3*o,Gt(r=n,i=t)}var t,e,r,i;Wa.point=function(u,o){Wa.point=n,Gt(t=r=u,e=i=o)},Wa.lineEnd=function(){n(t,e)}}function te(n){function t(t,e){n.moveTo(t+o,e),n.arc(t,e,o,0,Ho)}function e(t,e){n.moveTo(t,e),a.point=r}function r(t,e){n.lineTo(t,e)}function i(){a.point=t}function u(){n.closePath()}var o=4.5,a={point:t,lineStart:function(){a.point=e},lineEnd:i,polygonStart:function(){a.lineEnd=u},polygonEnd:function(){a.lineEnd=i,a.point=t},pointRadius:function(n){return o=n,a},result:b};return a}function ee(n){function t(n){return(a?r:e)(n)}function e(t){return ue(t,function(e,r){e=n(e,r),t.point(e[0],e[1])})}function r(t){function e(e,r){e=n(e,r),t.point(e[0],e[1])}function r(){M=NaN,S.point=u,t.lineStart()}function u(e,r){var u=dt([e,r]),o=n(e,r);i(M,x,m,b,_,w,M=o[0],x=o[1],m=e,b=u[0],_=u[1],w=u[2],a,t),t.point(M,x)}function o(){S.point=e,t.lineEnd()}function l(){
r(),S.point=c,S.lineEnd=f}function c(n,t){u(s=n,h=t),p=M,g=x,v=b,d=_,y=w,S.point=u}function f(){i(M,x,m,b,_,w,p,g,s,v,d,y,a,t),S.lineEnd=o,o()}var s,h,p,g,v,d,y,m,M,x,b,_,w,S={point:e,lineStart:r,lineEnd:o,polygonStart:function(){t.polygonStart(),S.lineStart=l},polygonEnd:function(){t.polygonEnd(),S.lineStart=r}};return S}function i(t,e,r,a,l,c,f,s,h,p,g,v,d,y){var m=f-t,M=s-e,x=m*m+M*M;if(x>4*u&&d--){var b=a+p,_=l+g,w=c+v,S=Math.sqrt(b*b+_*_+w*w),k=Math.asin(w/=S),N=xo(xo(w)-1)<Uo||xo(r-h)<Uo?(r+h)/2:Math.atan2(_,b),E=n(N,k),A=E[0],C=E[1],z=A-t,L=C-e,q=M*z-m*L;(q*q/x>u||xo((m*z+M*L)/x-.5)>.3||o>a*p+l*g+c*v)&&(i(t,e,r,a,l,c,A,C,N,b/=S,_/=S,w,d,y),y.point(A,C),i(A,C,N,b,_,w,f,s,h,p,g,v,d,y))}}var u=.5,o=Math.cos(30*Yo),a=16;return t.precision=function(n){return arguments.length?(a=(u=n*n)>0&&16,t):Math.sqrt(u)},t}function re(n){var t=ee(function(t,e){return n([t*Zo,e*Zo])});return function(n){return le(t(n))}}function ie(n){this.stream=n}function ue(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function oe(n){return ae(function(){return n})()}function ae(n){function t(n){return n=a(n[0]*Yo,n[1]*Yo),[n[0]*h+l,c-n[1]*h]}function e(n){return n=a.invert((n[0]-l)/h,(c-n[1])/h),n&&[n[0]*Zo,n[1]*Zo]}function r(){a=Ct(o=se(y,M,x),u);var n=u(v,d);return l=p-n[0]*h,c=g+n[1]*h,i()}function i(){return f&&(f.valid=!1,f=null),t}var u,o,a,l,c,f,s=ee(function(n,t){return n=u(n,t),[n[0]*h+l,c-n[1]*h]}),h=150,p=480,g=250,v=0,d=0,y=0,M=0,x=0,b=Fa,_=m,w=null,S=null;return t.stream=function(n){return f&&(f.valid=!1),f=le(b(o,s(_(n)))),f.valid=!0,f},t.clipAngle=function(n){return arguments.length?(b=null==n?(w=n,Fa):It((w=+n)*Yo),i()):w},t.clipExtent=function(n){return arguments.length?(S=n,_=n?Zt(n[0][0],n[0][1],n[1][0],n[1][1]):m,i()):S},t.scale=function(n){return arguments.length?(h=+n,r()):h},t.translate=function(n){return arguments.length?(p=+n[0],g=+n[1],r()):[p,g]},t.center=function(n){return arguments.length?(v=n[0]%360*Yo,d=n[1]%360*Yo,r()):[v*Zo,d*Zo]},t.rotate=function(n){return arguments.length?(y=n[0]%360*Yo,M=n[1]%360*Yo,x=n.length>2?n[2]%360*Yo:0,r()):[y*Zo,M*Zo,x*Zo]},ao.rebind(t,s,"precision"),function(){return u=n.apply(this,arguments),t.invert=u.invert&&e,r()}}function le(n){return ue(n,function(t,e){n.point(t*Yo,e*Yo)})}function ce(n,t){return[n,t]}function fe(n,t){return[n>Fo?n-Ho:-Fo>n?n+Ho:n,t]}function se(n,t,e){return n?t||e?Ct(pe(n),ge(t,e)):pe(n):t||e?ge(t,e):fe}function he(n){return function(t,e){return t+=n,[t>Fo?t-Ho:-Fo>t?t+Ho:t,e]}}function pe(n){var t=he(n);return t.invert=he(-n),t}function ge(n,t){function e(n,t){var e=Math.cos(t),a=Math.cos(n)*e,l=Math.sin(n)*e,c=Math.sin(t),f=c*r+a*i;return[Math.atan2(l*u-f*o,a*r-c*i),tn(f*u+l*o)]}var r=Math.cos(n),i=Math.sin(n),u=Math.cos(t),o=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),a=Math.cos(n)*e,l=Math.sin(n)*e,c=Math.sin(t),f=c*u-l*o;return[Math.atan2(l*u+c*o,a*r+f*i),tn(f*r-a*i)]},e}function ve(n,t){var e=Math.cos(n),r=Math.sin(n);return function(i,u,o,a){var l=o*t;null!=i?(i=de(e,i),u=de(e,u),(o>0?u>i:i>u)&&(i+=o*Ho)):(i=n+o*Ho,u=n-.5*l);for(var c,f=i;o>0?f>u:u>f;f-=l)a.point((c=_t([e,-r*Math.cos(f),-r*Math.sin(f)]))[0],c[1])}}function de(n,t){var e=dt(t);e[0]-=n,bt(e);var r=nn(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-Uo)%(2*Math.PI)}function ye(n,t,e){var r=ao.range(n,t-Uo,e).concat(t);return function(n){return r.map(function(t){return[n,t]})}}function me(n,t,e){var r=ao.range(n,t-Uo,e).concat(t);return function(n){return r.map(function(t){return[t,n]})}}function Me(n){return n.source}function xe(n){return n.target}function be(n,t,e,r){var i=Math.cos(t),u=Math.sin(t),o=Math.cos(r),a=Math.sin(r),l=i*Math.cos(n),c=i*Math.sin(n),f=o*Math.cos(e),s=o*Math.sin(e),h=2*Math.asin(Math.sqrt(on(r-t)+i*o*on(e-n))),p=1/Math.sin(h),g=h?function(n){var t=Math.sin(n*=h)*p,e=Math.sin(h-n)*p,r=e*l+t*f,i=e*c+t*s,o=e*u+t*a;return[Math.atan2(i,r)*Zo,Math.atan2(o,Math.sqrt(r*r+i*i))*Zo]}:function(){return[n*Zo,t*Zo]};return g.distance=h,g}function _e(){function n(n,i){var u=Math.sin(i*=Yo),o=Math.cos(i),a=xo((n*=Yo)-t),l=Math.cos(a);Ja+=Math.atan2(Math.sqrt((a=o*Math.sin(a))*a+(a=r*u-e*o*l)*a),e*u+r*o*l),t=n,e=u,r=o}var t,e,r;Ga.point=function(i,u){t=i*Yo,e=Math.sin(u*=Yo),r=Math.cos(u),Ga.point=n},Ga.lineEnd=function(){Ga.point=Ga.lineEnd=b}}function we(n,t){function e(t,e){var r=Math.cos(t),i=Math.cos(e),u=n(r*i);return[u*i*Math.sin(t),u*Math.sin(e)]}return e.invert=function(n,e){var r=Math.sqrt(n*n+e*e),i=t(r),u=Math.sin(i),o=Math.cos(i);return[Math.atan2(n*u,r*o),Math.asin(r&&e*u/r)]},e}function Se(n,t){function e(n,t){o>0?-Io+Uo>t&&(t=-Io+Uo):t>Io-Uo&&(t=Io-Uo);var e=o/Math.pow(i(t),u);return[e*Math.sin(u*n),o-e*Math.cos(u*n)]}var r=Math.cos(n),i=function(n){return Math.tan(Fo/4+n/2)},u=n===t?Math.sin(n):Math.log(r/Math.cos(t))/Math.log(i(t)/i(n)),o=r*Math.pow(i(n),u)/u;return u?(e.invert=function(n,t){var e=o-t,r=K(u)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/u,2*Math.atan(Math.pow(o/r,1/u))-Io]},e):Ne}function ke(n,t){function e(n,t){var e=u-t;return[e*Math.sin(i*n),u-e*Math.cos(i*n)]}var r=Math.cos(n),i=n===t?Math.sin(n):(r-Math.cos(t))/(t-n),u=r/i+n;return xo(i)<Uo?ce:(e.invert=function(n,t){var e=u-t;return[Math.atan2(n,e)/i,u-K(i)*Math.sqrt(n*n+e*e)]},e)}function Ne(n,t){return[n,Math.log(Math.tan(Fo/4+t/2))]}function Ee(n){var t,e=oe(n),r=e.scale,i=e.translate,u=e.clipExtent;return e.scale=function(){var n=r.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.translate=function(){var n=i.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.clipExtent=function(n){var o=u.apply(e,arguments);if(o===e){if(t=null==n){var a=Fo*r(),l=i();u([[l[0]-a,l[1]-a],[l[0]+a,l[1]+a]])}}else t&&(o=null);return o},e.clipExtent(null)}function Ae(n,t){return[Math.log(Math.tan(Fo/4+t/2)),-n]}function Ce(n){return n[0]}function ze(n){return n[1]}function Le(n){for(var t=n.length,e=[0,1],r=2,i=2;t>i;i++){for(;r>1&&Q(n[e[r-2]],n[e[r-1]],n[i])<=0;)--r;e[r++]=i}return e.slice(0,r)}function qe(n,t){return n[0]-t[0]||n[1]-t[1]}function Te(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function Re(n,t,e,r){var i=n[0],u=e[0],o=t[0]-i,a=r[0]-u,l=n[1],c=e[1],f=t[1]-l,s=r[1]-c,h=(a*(l-c)-s*(i-u))/(s*o-a*f);return[i+h*o,l+h*f]}function De(n){var t=n[0],e=n[n.length-1];return!(t[0]-e[0]||t[1]-e[1])}function Pe(){rr(this),this.edge=this.site=this.circle=null}function Ue(n){var t=cl.pop()||new Pe;return t.site=n,t}function je(n){Be(n),ol.remove(n),cl.push(n),rr(n)}function Fe(n){var t=n.circle,e=t.x,r=t.cy,i={x:e,y:r},u=n.P,o=n.N,a=[n];je(n);for(var l=u;l.circle&&xo(e-l.circle.x)<Uo&&xo(r-l.circle.cy)<Uo;)u=l.P,a.unshift(l),je(l),l=u;a.unshift(l),Be(l);for(var c=o;c.circle&&xo(e-c.circle.x)<Uo&&xo(r-c.circle.cy)<Uo;)o=c.N,a.push(c),je(c),c=o;a.push(c),Be(c);var f,s=a.length;for(f=1;s>f;++f)c=a[f],l=a[f-1],nr(c.edge,l.site,c.site,i);l=a[0],c=a[s-1],c.edge=Ke(l.site,c.site,null,i),$e(l),$e(c)}function He(n){for(var t,e,r,i,u=n.x,o=n.y,a=ol._;a;)if(r=Oe(a,o)-u,r>Uo)a=a.L;else{if(i=u-Ie(a,o),!(i>Uo)){r>-Uo?(t=a.P,e=a):i>-Uo?(t=a,e=a.N):t=e=a;break}if(!a.R){t=a;break}a=a.R}var l=Ue(n);if(ol.insert(t,l),t||e){if(t===e)return Be(t),e=Ue(t.site),ol.insert(l,e),l.edge=e.edge=Ke(t.site,l.site),$e(t),void $e(e);if(!e)return void(l.edge=Ke(t.site,l.site));Be(t),Be(e);var c=t.site,f=c.x,s=c.y,h=n.x-f,p=n.y-s,g=e.site,v=g.x-f,d=g.y-s,y=2*(h*d-p*v),m=h*h+p*p,M=v*v+d*d,x={x:(d*m-p*M)/y+f,y:(h*M-v*m)/y+s};nr(e.edge,c,g,x),l.edge=Ke(c,n,null,x),e.edge=Ke(n,g,null,x),$e(t),$e(e)}}function Oe(n,t){var e=n.site,r=e.x,i=e.y,u=i-t;if(!u)return r;var o=n.P;if(!o)return-(1/0);e=o.site;var a=e.x,l=e.y,c=l-t;if(!c)return a;var f=a-r,s=1/u-1/c,h=f/c;return s?(-h+Math.sqrt(h*h-2*s*(f*f/(-2*c)-l+c/2+i-u/2)))/s+r:(r+a)/2}function Ie(n,t){var e=n.N;if(e)return Oe(e,t);var r=n.site;return r.y===t?r.x:1/0}function Ye(n){this.site=n,this.edges=[]}function Ze(n){for(var t,e,r,i,u,o,a,l,c,f,s=n[0][0],h=n[1][0],p=n[0][1],g=n[1][1],v=ul,d=v.length;d--;)if(u=v[d],u&&u.prepare())for(a=u.edges,l=a.length,o=0;l>o;)f=a[o].end(),r=f.x,i=f.y,c=a[++o%l].start(),t=c.x,e=c.y,(xo(r-t)>Uo||xo(i-e)>Uo)&&(a.splice(o,0,new tr(Qe(u.site,f,xo(r-s)<Uo&&g-i>Uo?{x:s,y:xo(t-s)<Uo?e:g}:xo(i-g)<Uo&&h-r>Uo?{x:xo(e-g)<Uo?t:h,y:g}:xo(r-h)<Uo&&i-p>Uo?{x:h,y:xo(t-h)<Uo?e:p}:xo(i-p)<Uo&&r-s>Uo?{x:xo(e-p)<Uo?t:s,y:p}:null),u.site,null)),++l)}function Ve(n,t){return t.angle-n.angle}function Xe(){rr(this),this.x=this.y=this.arc=this.site=this.cy=null}function $e(n){var t=n.P,e=n.N;if(t&&e){var r=t.site,i=n.site,u=e.site;if(r!==u){var o=i.x,a=i.y,l=r.x-o,c=r.y-a,f=u.x-o,s=u.y-a,h=2*(l*s-c*f);if(!(h>=-jo)){var p=l*l+c*c,g=f*f+s*s,v=(s*p-c*g)/h,d=(l*g-f*p)/h,s=d+a,y=fl.pop()||new Xe;y.arc=n,y.site=i,y.x=v+o,y.y=s+Math.sqrt(v*v+d*d),y.cy=s,n.circle=y;for(var m=null,M=ll._;M;)if(y.y<M.y||y.y===M.y&&y.x<=M.x){if(!M.L){m=M.P;break}M=M.L}else{if(!M.R){m=M;break}M=M.R}ll.insert(m,y),m||(al=y)}}}}function Be(n){var t=n.circle;t&&(t.P||(al=t.N),ll.remove(t),fl.push(t),rr(t),n.circle=null)}function We(n){for(var t,e=il,r=Yt(n[0][0],n[0][1],n[1][0],n[1][1]),i=e.length;i--;)t=e[i],(!Je(t,n)||!r(t)||xo(t.a.x-t.b.x)<Uo&&xo(t.a.y-t.b.y)<Uo)&&(t.a=t.b=null,e.splice(i,1))}function Je(n,t){var e=n.b;if(e)return!0;var r,i,u=n.a,o=t[0][0],a=t[1][0],l=t[0][1],c=t[1][1],f=n.l,s=n.r,h=f.x,p=f.y,g=s.x,v=s.y,d=(h+g)/2,y=(p+v)/2;if(v===p){if(o>d||d>=a)return;if(h>g){if(u){if(u.y>=c)return}else u={x:d,y:l};e={x:d,y:c}}else{if(u){if(u.y<l)return}else u={x:d,y:c};e={x:d,y:l}}}else if(r=(h-g)/(v-p),i=y-r*d,-1>r||r>1)if(h>g){if(u){if(u.y>=c)return}else u={x:(l-i)/r,y:l};e={x:(c-i)/r,y:c}}else{if(u){if(u.y<l)return}else u={x:(c-i)/r,y:c};e={x:(l-i)/r,y:l}}else if(v>p){if(u){if(u.x>=a)return}else u={x:o,y:r*o+i};e={x:a,y:r*a+i}}else{if(u){if(u.x<o)return}else u={x:a,y:r*a+i};e={x:o,y:r*o+i}}return n.a=u,n.b=e,!0}function Ge(n,t){this.l=n,this.r=t,this.a=this.b=null}function Ke(n,t,e,r){var i=new Ge(n,t);return il.push(i),e&&nr(i,n,t,e),r&&nr(i,t,n,r),ul[n.i].edges.push(new tr(i,n,t)),ul[t.i].edges.push(new tr(i,t,n)),i}function Qe(n,t,e){var r=new Ge(n,null);return r.a=t,r.b=e,il.push(r),r}function nr(n,t,e,r){n.a||n.b?n.l===e?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=e)}function tr(n,t,e){var r=n.a,i=n.b;this.edge=n,this.site=t,this.angle=e?Math.atan2(e.y-t.y,e.x-t.x):n.l===t?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function er(){this._=null}function rr(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function ir(n,t){var e=t,r=t.R,i=e.U;i?i.L===e?i.L=r:i.R=r:n._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function ur(n,t){var e=t,r=t.L,i=e.U;i?i.L===e?i.L=r:i.R=r:n._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function or(n){for(;n.L;)n=n.L;return n}function ar(n,t){var e,r,i,u=n.sort(lr).pop();for(il=[],ul=new Array(n.length),ol=new er,ll=new er;;)if(i=al,u&&(!i||u.y<i.y||u.y===i.y&&u.x<i.x))u.x===e&&u.y===r||(ul[u.i]=new Ye(u),He(u),e=u.x,r=u.y),u=n.pop();else{if(!i)break;Fe(i.arc)}t&&(We(t),Ze(t));var o={cells:ul,edges:il};return ol=ll=il=ul=null,o}function lr(n,t){return t.y-n.y||t.x-n.x}function cr(n,t,e){return(n.x-e.x)*(t.y-n.y)-(n.x-t.x)*(e.y-n.y)}function fr(n){return n.x}function sr(n){return n.y}function hr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function pr(n,t,e,r,i,u){if(!n(t,e,r,i,u)){var o=.5*(e+i),a=.5*(r+u),l=t.nodes;l[0]&&pr(n,l[0],e,r,o,a),l[1]&&pr(n,l[1],o,r,i,a),l[2]&&pr(n,l[2],e,a,o,u),l[3]&&pr(n,l[3],o,a,i,u)}}function gr(n,t,e,r,i,u,o){var a,l=1/0;return function c(n,f,s,h,p){if(!(f>u||s>o||r>h||i>p)){if(g=n.point){var g,v=t-n.x,d=e-n.y,y=v*v+d*d;if(l>y){var m=Math.sqrt(l=y);r=t-m,i=e-m,u=t+m,o=e+m,a=g}}for(var M=n.nodes,x=.5*(f+h),b=.5*(s+p),_=t>=x,w=e>=b,S=w<<1|_,k=S+4;k>S;++S)if(n=M[3&S])switch(3&S){case 0:c(n,f,s,x,b);break;case 1:c(n,x,s,h,b);break;case 2:c(n,f,b,x,p);break;case 3:c(n,x,b,h,p)}}}(n,r,i,u,o),a}function vr(n,t){n=ao.rgb(n),t=ao.rgb(t);var e=n.r,r=n.g,i=n.b,u=t.r-e,o=t.g-r,a=t.b-i;return function(n){return"#"+bn(Math.round(e+u*n))+bn(Math.round(r+o*n))+bn(Math.round(i+a*n))}}function dr(n,t){var e,r={},i={};for(e in n)e in t?r[e]=Mr(n[e],t[e]):i[e]=n[e];for(e in t)e in n||(i[e]=t[e]);return function(n){for(e in r)i[e]=r[e](n);return i}}function yr(n,t){return n=+n,t=+t,function(e){return n*(1-e)+t*e}}function mr(n,t){var e,r,i,u=hl.lastIndex=pl.lastIndex=0,o=-1,a=[],l=[];for(n+="",t+="";(e=hl.exec(n))&&(r=pl.exec(t));)(i=r.index)>u&&(i=t.slice(u,i),a[o]?a[o]+=i:a[++o]=i),(e=e[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:yr(e,r)})),u=pl.lastIndex;return u<t.length&&(i=t.slice(u),a[o]?a[o]+=i:a[++o]=i),a.length<2?l[0]?(t=l[0].x,function(n){return t(n)+""}):function(){return t}:(t=l.length,function(n){for(var e,r=0;t>r;++r)a[(e=l[r]).i]=e.x(n);return a.join("")})}function Mr(n,t){for(var e,r=ao.interpolators.length;--r>=0&&!(e=ao.interpolators[r](n,t)););return e}function xr(n,t){var e,r=[],i=[],u=n.length,o=t.length,a=Math.min(n.length,t.length);for(e=0;a>e;++e)r.push(Mr(n[e],t[e]));for(;u>e;++e)i[e]=n[e];for(;o>e;++e)i[e]=t[e];return function(n){for(e=0;a>e;++e)i[e]=r[e](n);return i}}function br(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function _r(n){return function(t){return 1-n(1-t)}}function wr(n){return function(t){return.5*(.5>t?n(2*t):2-n(2-2*t))}}function Sr(n){return n*n}function kr(n){return n*n*n}function Nr(n){if(0>=n)return 0;if(n>=1)return 1;var t=n*n,e=t*n;return 4*(.5>n?e:3*(n-t)+e-.75)}function Er(n){return function(t){return Math.pow(t,n)}}function Ar(n){return 1-Math.cos(n*Io)}function Cr(n){return Math.pow(2,10*(n-1))}function zr(n){return 1-Math.sqrt(1-n*n)}function Lr(n,t){var e;return arguments.length<2&&(t=.45),arguments.length?e=t/Ho*Math.asin(1/n):(n=1,e=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-e)*Ho/t)}}function qr(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function Tr(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function Rr(n,t){n=ao.hcl(n),t=ao.hcl(t);var e=n.h,r=n.c,i=n.l,u=t.h-e,o=t.c-r,a=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(u)?(u=0,e=isNaN(e)?t.h:e):u>180?u-=360:-180>u&&(u+=360),function(n){return sn(e+u*n,r+o*n,i+a*n)+""}}function Dr(n,t){n=ao.hsl(n),t=ao.hsl(t);var e=n.h,r=n.s,i=n.l,u=t.h-e,o=t.s-r,a=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(u)?(u=0,e=isNaN(e)?t.h:e):u>180?u-=360:-180>u&&(u+=360),function(n){return cn(e+u*n,r+o*n,i+a*n)+""}}function Pr(n,t){n=ao.lab(n),t=ao.lab(t);var e=n.l,r=n.a,i=n.b,u=t.l-e,o=t.a-r,a=t.b-i;return function(n){return pn(e+u*n,r+o*n,i+a*n)+""}}function Ur(n,t){return t-=n,function(e){return Math.round(n+t*e)}}function jr(n){var t=[n.a,n.b],e=[n.c,n.d],r=Hr(t),i=Fr(t,e),u=Hr(Or(e,t,-i))||0;t[0]*e[1]<e[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-e[0],e[1]))*Zo,this.translate=[n.e,n.f],this.scale=[r,u],this.skew=u?Math.atan2(i,u)*Zo:0}function Fr(n,t){return n[0]*t[0]+n[1]*t[1]}function Hr(n){var t=Math.sqrt(Fr(n,n));return t&&(n[0]/=t,n[1]/=t),t}function Or(n,t,e){return n[0]+=e*t[0],n[1]+=e*t[1],n}function Ir(n){return n.length?n.pop()+",":""}function Yr(n,t,e,r){if(n[0]!==t[0]||n[1]!==t[1]){var i=e.push("translate(",null,",",null,")");r.push({i:i-4,x:yr(n[0],t[0])},{i:i-2,x:yr(n[1],t[1])})}else(t[0]||t[1])&&e.push("translate("+t+")")}function Zr(n,t,e,r){n!==t?(n-t>180?t+=360:t-n>180&&(n+=360),r.push({i:e.push(Ir(e)+"rotate(",null,")")-2,x:yr(n,t)})):t&&e.push(Ir(e)+"rotate("+t+")")}function Vr(n,t,e,r){n!==t?r.push({i:e.push(Ir(e)+"skewX(",null,")")-2,x:yr(n,t)}):t&&e.push(Ir(e)+"skewX("+t+")")}function Xr(n,t,e,r){if(n[0]!==t[0]||n[1]!==t[1]){var i=e.push(Ir(e)+"scale(",null,",",null,")");r.push({i:i-4,x:yr(n[0],t[0])},{i:i-2,x:yr(n[1],t[1])})}else 1===t[0]&&1===t[1]||e.push(Ir(e)+"scale("+t+")")}function $r(n,t){var e=[],r=[];return n=ao.transform(n),t=ao.transform(t),Yr(n.translate,t.translate,e,r),Zr(n.rotate,t.rotate,e,r),Vr(n.skew,t.skew,e,r),Xr(n.scale,t.scale,e,r),n=t=null,function(n){for(var t,i=-1,u=r.length;++i<u;)e[(t=r[i]).i]=t.x(n);return e.join("")}}function Br(n,t){return t=(t-=n=+n)||1/t,function(e){return(e-n)/t}}function Wr(n,t){return t=(t-=n=+n)||1/t,function(e){return Math.max(0,Math.min(1,(e-n)/t))}}function Jr(n){for(var t=n.source,e=n.target,r=Kr(t,e),i=[t];t!==r;)t=t.parent,i.push(t);for(var u=i.length;e!==r;)i.splice(u,0,e),e=e.parent;return i}function Gr(n){for(var t=[],e=n.parent;null!=e;)t.push(n),n=e,e=e.parent;return t.push(n),t}function Kr(n,t){if(n===t)return n;for(var e=Gr(n),r=Gr(t),i=e.pop(),u=r.pop(),o=null;i===u;)o=i,i=e.pop(),u=r.pop();return o}function Qr(n){n.fixed|=2}function ni(n){n.fixed&=-7}function ti(n){n.fixed|=4,n.px=n.x,n.py=n.y}function ei(n){n.fixed&=-5}function ri(n,t,e){var r=0,i=0;if(n.charge=0,!n.leaf)for(var u,o=n.nodes,a=o.length,l=-1;++l<a;)u=o[l],null!=u&&(ri(u,t,e),n.charge+=u.charge,r+=u.charge*u.cx,i+=u.charge*u.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var c=t*e[n.point.index];n.charge+=n.pointCharge=c,r+=c*n.point.x,i+=c*n.point.y}n.cx=r/n.charge,n.cy=i/n.charge}function ii(n,t){return ao.rebind(n,t,"sort","children","value"),n.nodes=n,n.links=fi,n}function ui(n,t){for(var e=[n];null!=(n=e.pop());)if(t(n),(i=n.children)&&(r=i.length))for(var r,i;--r>=0;)e.push(i[r])}function oi(n,t){for(var e=[n],r=[];null!=(n=e.pop());)if(r.push(n),(u=n.children)&&(i=u.length))for(var i,u,o=-1;++o<i;)e.push(u[o]);for(;null!=(n=r.pop());)t(n)}function ai(n){return n.children}function li(n){return n.value}function ci(n,t){return t.value-n.value}function fi(n){return ao.merge(n.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function si(n){return n.x}function hi(n){return n.y}function pi(n,t,e){n.y0=t,n.y=e}function gi(n){return ao.range(n.length)}function vi(n){for(var t=-1,e=n[0].length,r=[];++t<e;)r[t]=0;return r}function di(n){for(var t,e=1,r=0,i=n[0][1],u=n.length;u>e;++e)(t=n[e][1])>i&&(r=e,i=t);return r}function yi(n){return n.reduce(mi,0)}function mi(n,t){return n+t[1]}function Mi(n,t){return xi(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function xi(n,t){for(var e=-1,r=+n[0],i=(n[1]-r)/t,u=[];++e<=t;)u[e]=i*e+r;return u}function bi(n){return[ao.min(n),ao.max(n)]}function _i(n,t){return n.value-t.value}function wi(n,t){var e=n._pack_next;n._pack_next=t,t._pack_prev=n,t._pack_next=e,e._pack_prev=t}function Si(n,t){n._pack_next=t,t._pack_prev=n}function ki(n,t){var e=t.x-n.x,r=t.y-n.y,i=n.r+t.r;return.999*i*i>e*e+r*r}function Ni(n){function t(n){f=Math.min(n.x-n.r,f),s=Math.max(n.x+n.r,s),h=Math.min(n.y-n.r,h),p=Math.max(n.y+n.r,p)}if((e=n.children)&&(c=e.length)){var e,r,i,u,o,a,l,c,f=1/0,s=-(1/0),h=1/0,p=-(1/0);if(e.forEach(Ei),r=e[0],r.x=-r.r,r.y=0,t(r),c>1&&(i=e[1],i.x=i.r,i.y=0,t(i),c>2))for(u=e[2],zi(r,i,u),t(u),wi(r,u),r._pack_prev=u,wi(u,i),i=r._pack_next,o=3;c>o;o++){zi(r,i,u=e[o]);var g=0,v=1,d=1;for(a=i._pack_next;a!==i;a=a._pack_next,v++)if(ki(a,u)){g=1;break}if(1==g)for(l=r._pack_prev;l!==a._pack_prev&&!ki(l,u);l=l._pack_prev,d++);g?(d>v||v==d&&i.r<r.r?Si(r,i=a):Si(r=l,i),o--):(wi(r,u),i=u,t(u))}var y=(f+s)/2,m=(h+p)/2,M=0;for(o=0;c>o;o++)u=e[o],u.x-=y,u.y-=m,M=Math.max(M,u.r+Math.sqrt(u.x*u.x+u.y*u.y));n.r=M,e.forEach(Ai)}}function Ei(n){n._pack_next=n._pack_prev=n}function Ai(n){delete n._pack_next,delete n._pack_prev}function Ci(n,t,e,r){var i=n.children;if(n.x=t+=r*n.x,n.y=e+=r*n.y,n.r*=r,i)for(var u=-1,o=i.length;++u<o;)Ci(i[u],t,e,r)}function zi(n,t,e){var r=n.r+e.r,i=t.x-n.x,u=t.y-n.y;if(r&&(i||u)){var o=t.r+e.r,a=i*i+u*u;o*=o,r*=r;var l=.5+(r-o)/(2*a),c=Math.sqrt(Math.max(0,2*o*(r+a)-(r-=a)*r-o*o))/(2*a);e.x=n.x+l*i+c*u,e.y=n.y+l*u-c*i}else e.x=n.x+r,e.y=n.y}function Li(n,t){return n.parent==t.parent?1:2}function qi(n){var t=n.children;return t.length?t[0]:n.t}function Ti(n){var t,e=n.children;return(t=e.length)?e[t-1]:n.t}function Ri(n,t,e){var r=e/(t.i-n.i);t.c-=r,t.s+=e,n.c+=r,t.z+=e,t.m+=e}function Di(n){for(var t,e=0,r=0,i=n.children,u=i.length;--u>=0;)t=i[u],t.z+=e,t.m+=e,e+=t.s+(r+=t.c)}function Pi(n,t,e){return n.a.parent===t.parent?n.a:e}function Ui(n){return 1+ao.max(n,function(n){return n.y})}function ji(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function Fi(n){var t=n.children;return t&&t.length?Fi(t[0]):n}function Hi(n){var t,e=n.children;return e&&(t=e.length)?Hi(e[t-1]):n}function Oi(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function Ii(n,t){var e=n.x+t[3],r=n.y+t[0],i=n.dx-t[1]-t[3],u=n.dy-t[0]-t[2];return 0>i&&(e+=i/2,i=0),0>u&&(r+=u/2,u=0),{x:e,y:r,dx:i,dy:u}}function Yi(n){var t=n[0],e=n[n.length-1];return e>t?[t,e]:[e,t]}function Zi(n){return n.rangeExtent?n.rangeExtent():Yi(n.range())}function Vi(n,t,e,r){var i=e(n[0],n[1]),u=r(t[0],t[1]);return function(n){return u(i(n))}}function Xi(n,t){var e,r=0,i=n.length-1,u=n[r],o=n[i];return u>o&&(e=r,r=i,i=e,e=u,u=o,o=e),n[r]=t.floor(u),n[i]=t.ceil(o),n}function $i(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:Sl}function Bi(n,t,e,r){var i=[],u=[],o=0,a=Math.min(n.length,t.length)-1;for(n[a]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<=a;)i.push(e(n[o-1],n[o])),u.push(r(t[o-1],t[o]));return function(t){var e=ao.bisect(n,t,1,a)-1;return u[e](i[e](t))}}function Wi(n,t,e,r){function i(){var i=Math.min(n.length,t.length)>2?Bi:Vi,l=r?Wr:Br;return o=i(n,t,l,e),a=i(t,n,l,Mr),u}function u(n){return o(n)}var o,a;return u.invert=function(n){return a(n)},u.domain=function(t){return arguments.length?(n=t.map(Number),i()):n},u.range=function(n){return arguments.length?(t=n,i()):t},u.rangeRound=function(n){return u.range(n).interpolate(Ur)},u.clamp=function(n){return arguments.length?(r=n,i()):r},u.interpolate=function(n){return arguments.length?(e=n,i()):e},u.ticks=function(t){return Qi(n,t)},u.tickFormat=function(t,e){return nu(n,t,e)},u.nice=function(t){return Gi(n,t),i()},u.copy=function(){return Wi(n,t,e,r)},i()}function Ji(n,t){return ao.rebind(n,t,"range","rangeRound","interpolate","clamp")}function Gi(n,t){return Xi(n,$i(Ki(n,t)[2])),Xi(n,$i(Ki(n,t)[2])),n}function Ki(n,t){null==t&&(t=10);var e=Yi(n),r=e[1]-e[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),u=t/r*i;return.15>=u?i*=10:.35>=u?i*=5:.75>=u&&(i*=2),e[0]=Math.ceil(e[0]/i)*i,e[1]=Math.floor(e[1]/i)*i+.5*i,e[2]=i,e}function Qi(n,t){return ao.range.apply(ao,Ki(n,t))}function nu(n,t,e){var r=Ki(n,t);if(e){var i=ha.exec(e);if(i.shift(),"s"===i[8]){var u=ao.formatPrefix(Math.max(xo(r[0]),xo(r[1])));return i[7]||(i[7]="."+tu(u.scale(r[2]))),i[8]="f",e=ao.format(i.join("")),function(n){return e(u.scale(n))+u.symbol}}i[7]||(i[7]="."+eu(i[8],r)),e=i.join("")}else e=",."+tu(r[2])+"f";return ao.format(e)}function tu(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}function eu(n,t){var e=tu(t[2]);return n in kl?Math.abs(e-tu(Math.max(xo(t[0]),xo(t[1]))))+ +("e"!==n):e-2*("%"===n)}function ru(n,t,e,r){function i(n){return(e?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(t)}function u(n){return e?Math.pow(t,n):-Math.pow(t,-n)}function o(t){return n(i(t))}return o.invert=function(t){return u(n.invert(t))},o.domain=function(t){return arguments.length?(e=t[0]>=0,n.domain((r=t.map(Number)).map(i)),o):r},o.base=function(e){return arguments.length?(t=+e,n.domain(r.map(i)),o):t},o.nice=function(){var t=Xi(r.map(i),e?Math:El);return n.domain(t),r=t.map(u),o},o.ticks=function(){var n=Yi(r),o=[],a=n[0],l=n[1],c=Math.floor(i(a)),f=Math.ceil(i(l)),s=t%1?2:t;if(isFinite(f-c)){if(e){for(;f>c;c++)for(var h=1;s>h;h++)o.push(u(c)*h);o.push(u(c))}else for(o.push(u(c));c++<f;)for(var h=s-1;h>0;h--)o.push(u(c)*h);for(c=0;o[c]<a;c++);for(f=o.length;o[f-1]>l;f--);o=o.slice(c,f)}return o},o.tickFormat=function(n,e){if(!arguments.length)return Nl;arguments.length<2?e=Nl:"function"!=typeof e&&(e=ao.format(e));var r=Math.max(1,t*n/o.ticks().length);return function(n){var o=n/u(Math.round(i(n)));return t-.5>o*t&&(o*=t),r>=o?e(n):""}},o.copy=function(){return ru(n.copy(),t,e,r)},Ji(o,n)}function iu(n,t,e){function r(t){return n(i(t))}var i=uu(t),u=uu(1/t);return r.invert=function(t){return u(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((e=t.map(Number)).map(i)),r):e},r.ticks=function(n){return Qi(e,n)},r.tickFormat=function(n,t){return nu(e,n,t)},r.nice=function(n){return r.domain(Gi(e,n))},r.exponent=function(o){return arguments.length?(i=uu(t=o),u=uu(1/t),n.domain(e.map(i)),r):t},r.copy=function(){return iu(n.copy(),t,e)},Ji(r,n)}function uu(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function ou(n,t){function e(e){return u[((i.get(e)||("range"===t.t?i.set(e,n.push(e)):NaN))-1)%u.length]}function r(t,e){return ao.range(n.length).map(function(n){return t+e*n})}var i,u,o;return e.domain=function(r){if(!arguments.length)return n;n=[],i=new c;for(var u,o=-1,a=r.length;++o<a;)i.has(u=r[o])||i.set(u,n.push(u));return e[t.t].apply(e,t.a)},e.range=function(n){return arguments.length?(u=n,o=0,t={t:"range",a:arguments},e):u},e.rangePoints=function(i,a){arguments.length<2&&(a=0);var l=i[0],c=i[1],f=n.length<2?(l=(l+c)/2,0):(c-l)/(n.length-1+a);return u=r(l+f*a/2,f),o=0,t={t:"rangePoints",a:arguments},e},e.rangeRoundPoints=function(i,a){arguments.length<2&&(a=0);var l=i[0],c=i[1],f=n.length<2?(l=c=Math.round((l+c)/2),0):(c-l)/(n.length-1+a)|0;return u=r(l+Math.round(f*a/2+(c-l-(n.length-1+a)*f)/2),f),o=0,t={t:"rangeRoundPoints",a:arguments},e},e.rangeBands=function(i,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=i[1]<i[0],f=i[c-0],s=i[1-c],h=(s-f)/(n.length-a+2*l);return u=r(f+h*l,h),c&&u.reverse(),o=h*(1-a),t={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(i,a,l){arguments.length<2&&(a=0),arguments.length<3&&(l=a);var c=i[1]<i[0],f=i[c-0],s=i[1-c],h=Math.floor((s-f)/(n.length-a+2*l));return u=r(f+Math.round((s-f-(n.length-a)*h)/2),h),c&&u.reverse(),o=Math.round(h*(1-a)),t={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return o},e.rangeExtent=function(){return Yi(t.a[0])},e.copy=function(){return ou(n,t)},e.domain(n)}function au(n,t){function u(){var e=0,r=t.length;for(a=[];++e<r;)a[e-1]=ao.quantile(n,e/r);return o}function o(n){return isNaN(n=+n)?void 0:t[ao.bisect(a,n)]}var a;return o.domain=function(t){return arguments.length?(n=t.map(r).filter(i).sort(e),u()):n},o.range=function(n){return arguments.length?(t=n,u()):t},o.quantiles=function(){return a},o.invertExtent=function(e){return e=t.indexOf(e),0>e?[NaN,NaN]:[e>0?a[e-1]:n[0],e<a.length?a[e]:n[n.length-1]]},o.copy=function(){return au(n,t)},u()}function lu(n,t,e){function r(t){return e[Math.max(0,Math.min(o,Math.floor(u*(t-n))))]}function i(){return u=e.length/(t-n),o=e.length-1,r}var u,o;return r.domain=function(e){return arguments.length?(n=+e[0],t=+e[e.length-1],i()):[n,t]},r.range=function(n){return arguments.length?(e=n,i()):e},r.invertExtent=function(t){return t=e.indexOf(t),t=0>t?NaN:t/u+n,[t,t+1/u]},r.copy=function(){return lu(n,t,e)},i()}function cu(n,t){function e(e){return e>=e?t[ao.bisect(n,e)]:void 0}return e.domain=function(t){return arguments.length?(n=t,e):n},e.range=function(n){return arguments.length?(t=n,e):t},e.invertExtent=function(e){return e=t.indexOf(e),[n[e-1],n[e]]},e.copy=function(){return cu(n,t)},e}function fu(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(e){return arguments.length?(n=e.map(t),t):n},t.ticks=function(t){return Qi(n,t)},t.tickFormat=function(t,e){return nu(n,t,e)},t.copy=function(){return fu(n)},t}function su(){return 0}function hu(n){return n.innerRadius}function pu(n){return n.outerRadius}function gu(n){return n.startAngle}function vu(n){return n.endAngle}function du(n){return n&&n.padAngle}function yu(n,t,e,r){return(n-e)*t-(t-r)*n>0?0:1}function mu(n,t,e,r,i){var u=n[0]-t[0],o=n[1]-t[1],a=(i?r:-r)/Math.sqrt(u*u+o*o),l=a*o,c=-a*u,f=n[0]+l,s=n[1]+c,h=t[0]+l,p=t[1]+c,g=(f+h)/2,v=(s+p)/2,d=h-f,y=p-s,m=d*d+y*y,M=e-r,x=f*p-h*s,b=(0>y?-1:1)*Math.sqrt(Math.max(0,M*M*m-x*x)),_=(x*y-d*b)/m,w=(-x*d-y*b)/m,S=(x*y+d*b)/m,k=(-x*d+y*b)/m,N=_-g,E=w-v,A=S-g,C=k-v;return N*N+E*E>A*A+C*C&&(_=S,w=k),[[_-l,w-c],[_*e/M,w*e/M]]}function Mu(n){function t(t){function o(){c.push("M",u(n(f),a))}for(var l,c=[],f=[],s=-1,h=t.length,p=En(e),g=En(r);++s<h;)i.call(this,l=t[s],s)?f.push([+p.call(this,l,s),+g.call(this,l,s)]):f.length&&(o(),f=[]);return f.length&&o(),c.length?c.join(""):null}var e=Ce,r=ze,i=zt,u=xu,o=u.key,a=.7;return t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t.defined=function(n){return arguments.length?(i=n,t):i},t.interpolate=function(n){return arguments.length?(o="function"==typeof n?u=n:(u=Tl.get(n)||xu).key,t):o},t.tension=function(n){return arguments.length?(a=n,t):a},t}function xu(n){return n.length>1?n.join("L"):n+"Z"}function bu(n){return n.join("L")+"Z"}function _u(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1]);return e>1&&i.push("H",r[0]),i.join("")}function wu(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("V",(r=n[t])[1],"H",r[0]);return i.join("")}function Su(n){for(var t=0,e=n.length,r=n[0],i=[r[0],",",r[1]];++t<e;)i.push("H",(r=n[t])[0],"V",r[1]);return i.join("")}function ku(n,t){return n.length<4?xu(n):n[1]+Au(n.slice(1,-1),Cu(n,t))}function Nu(n,t){return n.length<3?bu(n):n[0]+Au((n.push(n[0]),n),Cu([n[n.length-2]].concat(n,[n[1]]),t))}function Eu(n,t){return n.length<3?xu(n):n[0]+Au(n,Cu(n,t))}function Au(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return xu(n);var e=n.length!=t.length,r="",i=n[0],u=n[1],o=t[0],a=o,l=1;if(e&&(r+="Q"+(u[0]-2*o[0]/3)+","+(u[1]-2*o[1]/3)+","+u[0]+","+u[1],i=n[1],l=2),t.length>1){a=t[1],u=n[l],l++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(u[0]-a[0])+","+(u[1]-a[1])+","+u[0]+","+u[1];for(var c=2;c<t.length;c++,l++)u=n[l],a=t[c],r+="S"+(u[0]-a[0])+","+(u[1]-a[1])+","+u[0]+","+u[1]}if(e){var f=n[l];r+="Q"+(u[0]+2*a[0]/3)+","+(u[1]+2*a[1]/3)+","+f[0]+","+f[1]}return r}function Cu(n,t){for(var e,r=[],i=(1-t)/2,u=n[0],o=n[1],a=1,l=n.length;++a<l;)e=u,u=o,o=n[a],r.push([i*(o[0]-e[0]),i*(o[1]-e[1])]);return r}function zu(n){if(n.length<3)return xu(n);var t=1,e=n.length,r=n[0],i=r[0],u=r[1],o=[i,i,i,(r=n[1])[0]],a=[u,u,u,r[1]],l=[i,",",u,"L",Ru(Pl,o),",",Ru(Pl,a)];for(n.push(n[e-1]);++t<=e;)r=n[t],o.shift(),o.push(r[0]),a.shift(),a.push(r[1]),Du(l,o,a);return n.pop(),l.push("L",r),l.join("")}function Lu(n){if(n.length<4)return xu(n);for(var t,e=[],r=-1,i=n.length,u=[0],o=[0];++r<3;)t=n[r],u.push(t[0]),o.push(t[1]);for(e.push(Ru(Pl,u)+","+Ru(Pl,o)),--r;++r<i;)t=n[r],u.shift(),u.push(t[0]),o.shift(),o.push(t[1]),Du(e,u,o);return e.join("")}function qu(n){for(var t,e,r=-1,i=n.length,u=i+4,o=[],a=[];++r<4;)e=n[r%i],o.push(e[0]),a.push(e[1]);for(t=[Ru(Pl,o),",",Ru(Pl,a)],--r;++r<u;)e=n[r%i],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),Du(t,o,a);return t.join("")}function Tu(n,t){var e=n.length-1;if(e)for(var r,i,u=n[0][0],o=n[0][1],a=n[e][0]-u,l=n[e][1]-o,c=-1;++c<=e;)r=n[c],i=c/e,r[0]=t*r[0]+(1-t)*(u+i*a),r[1]=t*r[1]+(1-t)*(o+i*l);return zu(n)}function Ru(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function Du(n,t,e){n.push("C",Ru(Rl,t),",",Ru(Rl,e),",",Ru(Dl,t),",",Ru(Dl,e),",",Ru(Pl,t),",",Ru(Pl,e))}function Pu(n,t){return(t[1]-n[1])/(t[0]-n[0])}function Uu(n){for(var t=0,e=n.length-1,r=[],i=n[0],u=n[1],o=r[0]=Pu(i,u);++t<e;)r[t]=(o+(o=Pu(i=u,u=n[t+1])))/2;return r[t]=o,r}function ju(n){for(var t,e,r,i,u=[],o=Uu(n),a=-1,l=n.length-1;++a<l;)t=Pu(n[a],n[a+1]),xo(t)<Uo?o[a]=o[a+1]=0:(e=o[a]/t,r=o[a+1]/t,i=e*e+r*r,i>9&&(i=3*t/Math.sqrt(i),o[a]=i*e,o[a+1]=i*r));for(a=-1;++a<=l;)i=(n[Math.min(l,a+1)][0]-n[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),u.push([i||0,o[a]*i||0]);return u}function Fu(n){return n.length<3?xu(n):n[0]+Au(n,ju(n))}function Hu(n){for(var t,e,r,i=-1,u=n.length;++i<u;)t=n[i],e=t[0],r=t[1]-Io,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r);return n}function Ou(n){function t(t){function l(){v.push("M",a(n(y),s),f,c(n(d.reverse()),s),"Z")}for(var h,p,g,v=[],d=[],y=[],m=-1,M=t.length,x=En(e),b=En(i),_=e===r?function(){
return p}:En(r),w=i===u?function(){return g}:En(u);++m<M;)o.call(this,h=t[m],m)?(d.push([p=+x.call(this,h,m),g=+b.call(this,h,m)]),y.push([+_.call(this,h,m),+w.call(this,h,m)])):d.length&&(l(),d=[],y=[]);return d.length&&l(),v.length?v.join(""):null}var e=Ce,r=Ce,i=0,u=ze,o=zt,a=xu,l=a.key,c=a,f="L",s=.7;return t.x=function(n){return arguments.length?(e=r=n,t):r},t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(i=u=n,t):u},t.y0=function(n){return arguments.length?(i=n,t):i},t.y1=function(n){return arguments.length?(u=n,t):u},t.defined=function(n){return arguments.length?(o=n,t):o},t.interpolate=function(n){return arguments.length?(l="function"==typeof n?a=n:(a=Tl.get(n)||xu).key,c=a.reverse||a,f=a.closed?"M":"L",t):l},t.tension=function(n){return arguments.length?(s=n,t):s},t}function Iu(n){return n.radius}function Yu(n){return[n.x,n.y]}function Zu(n){return function(){var t=n.apply(this,arguments),e=t[0],r=t[1]-Io;return[e*Math.cos(r),e*Math.sin(r)]}}function Vu(){return 64}function Xu(){return"circle"}function $u(n){var t=Math.sqrt(n/Fo);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Bu(n){return function(){var t,e,r;(t=this[n])&&(r=t[e=t.active])&&(r.timer.c=null,r.timer.t=NaN,--t.count?delete t[e]:delete this[n],t.active+=.5,r.event&&r.event.interrupt.call(this,this.__data__,r.index))}}function Wu(n,t,e){return ko(n,Yl),n.namespace=t,n.id=e,n}function Ju(n,t,e,r){var i=n.id,u=n.namespace;return Y(n,"function"==typeof e?function(n,o,a){n[u][i].tween.set(t,r(e.call(n,n.__data__,o,a)))}:(e=r(e),function(n){n[u][i].tween.set(t,e)}))}function Gu(n){return null==n&&(n=""),function(){this.textContent=n}}function Ku(n){return null==n?"__transition__":"__transition_"+n+"__"}function Qu(n,t,e,r,i){function u(n){var t=v.delay;return f.t=t+l,n>=t?o(n-t):void(f.c=o)}function o(e){var i=g.active,u=g[i];u&&(u.timer.c=null,u.timer.t=NaN,--g.count,delete g[i],u.event&&u.event.interrupt.call(n,n.__data__,u.index));for(var o in g)if(r>+o){var c=g[o];c.timer.c=null,c.timer.t=NaN,--g.count,delete g[o]}f.c=a,qn(function(){return f.c&&a(e||1)&&(f.c=null,f.t=NaN),1},0,l),g.active=r,v.event&&v.event.start.call(n,n.__data__,t),p=[],v.tween.forEach(function(e,r){(r=r.call(n,n.__data__,t))&&p.push(r)}),h=v.ease,s=v.duration}function a(i){for(var u=i/s,o=h(u),a=p.length;a>0;)p[--a].call(n,o);return u>=1?(v.event&&v.event.end.call(n,n.__data__,t),--g.count?delete g[r]:delete n[e],1):void 0}var l,f,s,h,p,g=n[e]||(n[e]={active:0,count:0}),v=g[r];v||(l=i.time,f=qn(u,0,l),v=g[r]={tween:new c,time:l,timer:f,delay:i.delay,duration:i.duration,ease:i.ease,index:t},i=null,++g.count)}function no(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate("+(isFinite(r)?r:e(n))+",0)"})}function to(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate(0,"+(isFinite(r)?r:e(n))+")"})}function eo(n){return n.toISOString()}function ro(n,t,e){function r(t){return n(t)}function i(n,e){var r=n[1]-n[0],i=r/e,u=ao.bisect(Kl,i);return u==Kl.length?[t.year,Ki(n.map(function(n){return n/31536e6}),e)[2]]:u?t[i/Kl[u-1]<Kl[u]/i?u-1:u]:[tc,Ki(n,e)[2]]}return r.invert=function(t){return io(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain(t),r):n.domain().map(io)},r.nice=function(n,t){function e(e){return!isNaN(e)&&!n.range(e,io(+e+1),t).length}var u=r.domain(),o=Yi(u),a=null==n?i(o,10):"number"==typeof n&&i(o,n);return a&&(n=a[0],t=a[1]),r.domain(Xi(u,t>1?{floor:function(t){for(;e(t=n.floor(t));)t=io(t-1);return t},ceil:function(t){for(;e(t=n.ceil(t));)t=io(+t+1);return t}}:n))},r.ticks=function(n,t){var e=Yi(r.domain()),u=null==n?i(e,10):"number"==typeof n?i(e,n):!n.range&&[{range:n},t];return u&&(n=u[0],t=u[1]),n.range(e[0],io(+e[1]+1),1>t?1:t)},r.tickFormat=function(){return e},r.copy=function(){return ro(n.copy(),t,e)},Ji(r,n)}function io(n){return new Date(n)}function uo(n){return JSON.parse(n.responseText)}function oo(n){var t=fo.createRange();return t.selectNode(fo.body),t.createContextualFragment(n.responseText)}var ao={version:"3.5.17"},lo=[].slice,co=function(n){return lo.call(n)},fo=this.document;if(fo)try{co(fo.documentElement.childNodes)[0].nodeType}catch(so){co=function(n){for(var t=n.length,e=new Array(t);t--;)e[t]=n[t];return e}}if(Date.now||(Date.now=function(){return+new Date}),fo)try{fo.createElement("DIV").style.setProperty("opacity",0,"")}catch(ho){var po=this.Element.prototype,go=po.setAttribute,vo=po.setAttributeNS,yo=this.CSSStyleDeclaration.prototype,mo=yo.setProperty;po.setAttribute=function(n,t){go.call(this,n,t+"")},po.setAttributeNS=function(n,t,e){vo.call(this,n,t,e+"")},yo.setProperty=function(n,t,e){mo.call(this,n,t+"",e)}}ao.ascending=e,ao.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:NaN},ao.min=function(n,t){var e,r,i=-1,u=n.length;if(1===arguments.length){for(;++i<u;)if(null!=(r=n[i])&&r>=r){e=r;break}for(;++i<u;)null!=(r=n[i])&&e>r&&(e=r)}else{for(;++i<u;)if(null!=(r=t.call(n,n[i],i))&&r>=r){e=r;break}for(;++i<u;)null!=(r=t.call(n,n[i],i))&&e>r&&(e=r)}return e},ao.max=function(n,t){var e,r,i=-1,u=n.length;if(1===arguments.length){for(;++i<u;)if(null!=(r=n[i])&&r>=r){e=r;break}for(;++i<u;)null!=(r=n[i])&&r>e&&(e=r)}else{for(;++i<u;)if(null!=(r=t.call(n,n[i],i))&&r>=r){e=r;break}for(;++i<u;)null!=(r=t.call(n,n[i],i))&&r>e&&(e=r)}return e},ao.extent=function(n,t){var e,r,i,u=-1,o=n.length;if(1===arguments.length){for(;++u<o;)if(null!=(r=n[u])&&r>=r){e=i=r;break}for(;++u<o;)null!=(r=n[u])&&(e>r&&(e=r),r>i&&(i=r))}else{for(;++u<o;)if(null!=(r=t.call(n,n[u],u))&&r>=r){e=i=r;break}for(;++u<o;)null!=(r=t.call(n,n[u],u))&&(e>r&&(e=r),r>i&&(i=r))}return[e,i]},ao.sum=function(n,t){var e,r=0,u=n.length,o=-1;if(1===arguments.length)for(;++o<u;)i(e=+n[o])&&(r+=e);else for(;++o<u;)i(e=+t.call(n,n[o],o))&&(r+=e);return r},ao.mean=function(n,t){var e,u=0,o=n.length,a=-1,l=o;if(1===arguments.length)for(;++a<o;)i(e=r(n[a]))?u+=e:--l;else for(;++a<o;)i(e=r(t.call(n,n[a],a)))?u+=e:--l;return l?u/l:void 0},ao.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),i=+n[r-1],u=e-r;return u?i+u*(n[r]-i):i},ao.median=function(n,t){var u,o=[],a=n.length,l=-1;if(1===arguments.length)for(;++l<a;)i(u=r(n[l]))&&o.push(u);else for(;++l<a;)i(u=r(t.call(n,n[l],l)))&&o.push(u);return o.length?ao.quantile(o.sort(e),.5):void 0},ao.variance=function(n,t){var e,u,o=n.length,a=0,l=0,c=-1,f=0;if(1===arguments.length)for(;++c<o;)i(e=r(n[c]))&&(u=e-a,a+=u/++f,l+=u*(e-a));else for(;++c<o;)i(e=r(t.call(n,n[c],c)))&&(u=e-a,a+=u/++f,l+=u*(e-a));return f>1?l/(f-1):void 0},ao.deviation=function(){var n=ao.variance.apply(this,arguments);return n?Math.sqrt(n):n};var Mo=u(e);ao.bisectLeft=Mo.left,ao.bisect=ao.bisectRight=Mo.right,ao.bisector=function(n){return u(1===n.length?function(t,r){return e(n(t),r)}:n)},ao.shuffle=function(n,t,e){(u=arguments.length)<3&&(e=n.length,2>u&&(t=0));for(var r,i,u=e-t;u;)i=Math.random()*u--|0,r=n[u+t],n[u+t]=n[i+t],n[i+t]=r;return n},ao.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;)r[e]=n[t[e]];return r},ao.pairs=function(n){for(var t,e=0,r=n.length-1,i=n[0],u=new Array(0>r?0:r);r>e;)u[e]=[t=i,i=n[++e]];return u},ao.transpose=function(n){if(!(i=n.length))return[];for(var t=-1,e=ao.min(n,o),r=new Array(e);++t<e;)for(var i,u=-1,a=r[t]=new Array(i);++u<i;)a[u]=n[u][t];return r},ao.zip=function(){return ao.transpose(arguments)},ao.keys=function(n){var t=[];for(var e in n)t.push(e);return t},ao.values=function(n){var t=[];for(var e in n)t.push(n[e]);return t},ao.entries=function(n){var t=[];for(var e in n)t.push({key:e,value:n[e]});return t},ao.merge=function(n){for(var t,e,r,i=n.length,u=-1,o=0;++u<i;)o+=n[u].length;for(e=new Array(o);--i>=0;)for(r=n[i],t=r.length;--t>=0;)e[--o]=r[t];return e};var xo=Math.abs;ao.range=function(n,t,e){if(arguments.length<3&&(e=1,arguments.length<2&&(t=n,n=0)),(t-n)/e===1/0)throw new Error("infinite range");var r,i=[],u=a(xo(e)),o=-1;if(n*=u,t*=u,e*=u,0>e)for(;(r=n+e*++o)>t;)i.push(r/u);else for(;(r=n+e*++o)<t;)i.push(r/u);return i},ao.map=function(n,t){var e=new c;if(n instanceof c)n.forEach(function(n,t){e.set(n,t)});else if(Array.isArray(n)){var r,i=-1,u=n.length;if(1===arguments.length)for(;++i<u;)e.set(i,n[i]);else for(;++i<u;)e.set(t.call(n,r=n[i],i),r)}else for(var o in n)e.set(o,n[o]);return e};var bo="__proto__",_o="\x00";l(c,{has:h,get:function(n){return this._[f(n)]},set:function(n,t){return this._[f(n)]=t},remove:p,keys:g,values:function(){var n=[];for(var t in this._)n.push(this._[t]);return n},entries:function(){var n=[];for(var t in this._)n.push({key:s(t),value:this._[t]});return n},size:v,empty:d,forEach:function(n){for(var t in this._)n.call(this,s(t),this._[t])}}),ao.nest=function(){function n(t,o,a){if(a>=u.length)return r?r.call(i,o):e?o.sort(e):o;for(var l,f,s,h,p=-1,g=o.length,v=u[a++],d=new c;++p<g;)(h=d.get(l=v(f=o[p])))?h.push(f):d.set(l,[f]);return t?(f=t(),s=function(e,r){f.set(e,n(t,r,a))}):(f={},s=function(e,r){f[e]=n(t,r,a)}),d.forEach(s),f}function t(n,e){if(e>=u.length)return n;var r=[],i=o[e++];return n.forEach(function(n,i){r.push({key:n,values:t(i,e)})}),i?r.sort(function(n,t){return i(n.key,t.key)}):r}var e,r,i={},u=[],o=[];return i.map=function(t,e){return n(e,t,0)},i.entries=function(e){return t(n(ao.map,e,0),0)},i.key=function(n){return u.push(n),i},i.sortKeys=function(n){return o[u.length-1]=n,i},i.sortValues=function(n){return e=n,i},i.rollup=function(n){return r=n,i},i},ao.set=function(n){var t=new y;if(n)for(var e=0,r=n.length;r>e;++e)t.add(n[e]);return t},l(y,{has:h,add:function(n){return this._[f(n+="")]=!0,n},remove:p,values:g,size:v,empty:d,forEach:function(n){for(var t in this._)n.call(this,s(t))}}),ao.behavior={},ao.rebind=function(n,t){for(var e,r=1,i=arguments.length;++r<i;)n[e=arguments[r]]=M(n,t,t[e]);return n};var wo=["webkit","ms","moz","Moz","o","O"];ao.dispatch=function(){for(var n=new _,t=-1,e=arguments.length;++t<e;)n[arguments[t]]=w(n);return n},_.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(e>=0&&(r=n.slice(e+1),n=n.slice(0,e)),n)return arguments.length<2?this[n].on(r):this[n].on(r,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(r,null);return this}},ao.event=null,ao.requote=function(n){return n.replace(So,"\\$&")};var So=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ko={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)n[e]=t[e]},No=function(n,t){return t.querySelector(n)},Eo=function(n,t){return t.querySelectorAll(n)},Ao=function(n,t){var e=n.matches||n[x(n,"matchesSelector")];return(Ao=function(n,t){return e.call(n,t)})(n,t)};"function"==typeof Sizzle&&(No=function(n,t){return Sizzle(n,t)[0]||null},Eo=Sizzle,Ao=Sizzle.matchesSelector),ao.selection=function(){return ao.select(fo.documentElement)};var Co=ao.selection.prototype=[];Co.select=function(n){var t,e,r,i,u=[];n=A(n);for(var o=-1,a=this.length;++o<a;){u.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var l=-1,c=r.length;++l<c;)(i=r[l])?(t.push(e=n.call(i,i.__data__,l,o)),e&&"__data__"in i&&(e.__data__=i.__data__)):t.push(null)}return E(u)},Co.selectAll=function(n){var t,e,r=[];n=C(n);for(var i=-1,u=this.length;++i<u;)for(var o=this[i],a=-1,l=o.length;++a<l;)(e=o[a])&&(r.push(t=co(n.call(e,e.__data__,a,i))),t.parentNode=e);return E(r)};var zo="http://www.w3.org/1999/xhtml",Lo={svg:"http://www.w3.org/2000/svg",xhtml:zo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};ao.ns={prefix:Lo,qualify:function(n){var t=n.indexOf(":"),e=n;return t>=0&&"xmlns"!==(e=n.slice(0,t))&&(n=n.slice(t+1)),Lo.hasOwnProperty(e)?{space:Lo[e],local:n}:n}},Co.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return n=ao.ns.qualify(n),n.local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n)this.each(z(t,n[t]));return this}return this.each(z(n,t))},Co.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=T(n)).length,i=-1;if(t=e.classList){for(;++i<r;)if(!t.contains(n[i]))return!1}else for(t=e.getAttribute("class");++i<r;)if(!q(n[i]).test(t))return!1;return!0}for(t in n)this.each(R(t,n[t]));return this}return this.each(R(n,t))},Co.style=function(n,e,r){var i=arguments.length;if(3>i){if("string"!=typeof n){2>i&&(e="");for(r in n)this.each(P(r,n[r],e));return this}if(2>i){var u=this.node();return t(u).getComputedStyle(u,null).getPropertyValue(n)}r=""}return this.each(P(n,e,r))},Co.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(U(t,n[t]));return this}return this.each(U(n,t))},Co.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},Co.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},Co.append=function(n){return n=j(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},Co.insert=function(n,t){return n=j(n),t=A(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})},Co.remove=function(){return this.each(F)},Co.data=function(n,t){function e(n,e){var r,i,u,o=n.length,s=e.length,h=Math.min(o,s),p=new Array(s),g=new Array(s),v=new Array(o);if(t){var d,y=new c,m=new Array(o);for(r=-1;++r<o;)(i=n[r])&&(y.has(d=t.call(i,i.__data__,r))?v[r]=i:y.set(d,i),m[r]=d);for(r=-1;++r<s;)(i=y.get(d=t.call(e,u=e[r],r)))?i!==!0&&(p[r]=i,i.__data__=u):g[r]=H(u),y.set(d,!0);for(r=-1;++r<o;)r in m&&y.get(m[r])!==!0&&(v[r]=n[r])}else{for(r=-1;++r<h;)i=n[r],u=e[r],i?(i.__data__=u,p[r]=i):g[r]=H(u);for(;s>r;++r)g[r]=H(e[r]);for(;o>r;++r)v[r]=n[r]}g.update=p,g.parentNode=p.parentNode=v.parentNode=n.parentNode,a.push(g),l.push(p),f.push(v)}var r,i,u=-1,o=this.length;if(!arguments.length){for(n=new Array(o=(r=this[0]).length);++u<o;)(i=r[u])&&(n[u]=i.__data__);return n}var a=Z([]),l=E([]),f=E([]);if("function"==typeof n)for(;++u<o;)e(r=this[u],n.call(r,r.parentNode.__data__,u));else for(;++u<o;)e(r=this[u],n);return l.enter=function(){return a},l.exit=function(){return f},l},Co.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},Co.filter=function(n){var t,e,r,i=[];"function"!=typeof n&&(n=O(n));for(var u=0,o=this.length;o>u;u++){i.push(t=[]),t.parentNode=(e=this[u]).parentNode;for(var a=0,l=e.length;l>a;a++)(r=e[a])&&n.call(r,r.__data__,a,u)&&t.push(r)}return E(i)},Co.order=function(){for(var n=-1,t=this.length;++n<t;)for(var e,r=this[n],i=r.length-1,u=r[i];--i>=0;)(e=r[i])&&(u&&u!==e.nextSibling&&u.parentNode.insertBefore(e,u),u=e);return this},Co.sort=function(n){n=I.apply(this,arguments);for(var t=-1,e=this.length;++t<e;)this[t].sort(n);return this.order()},Co.each=function(n){return Y(this,function(t,e,r){n.call(t,t.__data__,e,r)})},Co.call=function(n){var t=co(arguments);return n.apply(t[0]=this,t),this},Co.empty=function(){return!this.node()},Co.node=function(){for(var n=0,t=this.length;t>n;n++)for(var e=this[n],r=0,i=e.length;i>r;r++){var u=e[r];if(u)return u}return null},Co.size=function(){var n=0;return Y(this,function(){++n}),n};var qo=[];ao.selection.enter=Z,ao.selection.enter.prototype=qo,qo.append=Co.append,qo.empty=Co.empty,qo.node=Co.node,qo.call=Co.call,qo.size=Co.size,qo.select=function(n){for(var t,e,r,i,u,o=[],a=-1,l=this.length;++a<l;){r=(i=this[a]).update,o.push(t=[]),t.parentNode=i.parentNode;for(var c=-1,f=i.length;++c<f;)(u=i[c])?(t.push(r[c]=e=n.call(i.parentNode,u.__data__,c,a)),e.__data__=u.__data__):t.push(null)}return E(o)},qo.insert=function(n,t){return arguments.length<2&&(t=V(this)),Co.insert.call(this,n,t)},ao.select=function(t){var e;return"string"==typeof t?(e=[No(t,fo)],e.parentNode=fo.documentElement):(e=[t],e.parentNode=n(t)),E([e])},ao.selectAll=function(n){var t;return"string"==typeof n?(t=co(Eo(n,fo)),t.parentNode=fo.documentElement):(t=co(n),t.parentNode=null),E([t])},Co.on=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(e in n)this.each(X(e,n[e],t));return this}if(2>r)return(r=this.node()["__on"+n])&&r._;e=!1}return this.each(X(n,t,e))};var To=ao.map({mouseenter:"mouseover",mouseleave:"mouseout"});fo&&To.forEach(function(n){"on"+n in fo&&To.remove(n)});var Ro,Do=0;ao.mouse=function(n){return J(n,k())};var Po=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;ao.touch=function(n,t,e){if(arguments.length<3&&(e=t,t=k().changedTouches),t)for(var r,i=0,u=t.length;u>i;++i)if((r=t[i]).identifier===e)return J(n,r)},ao.behavior.drag=function(){function n(){this.on("mousedown.drag",u).on("touchstart.drag",o)}function e(n,t,e,u,o){return function(){function a(){var n,e,r=t(h,v);r&&(n=r[0]-M[0],e=r[1]-M[1],g|=n|e,M=r,p({type:"drag",x:r[0]+c[0],y:r[1]+c[1],dx:n,dy:e}))}function l(){t(h,v)&&(y.on(u+d,null).on(o+d,null),m(g),p({type:"dragend"}))}var c,f=this,s=ao.event.target.correspondingElement||ao.event.target,h=f.parentNode,p=r.of(f,arguments),g=0,v=n(),d=".drag"+(null==v?"":"-"+v),y=ao.select(e(s)).on(u+d,a).on(o+d,l),m=W(s),M=t(h,v);i?(c=i.apply(f,arguments),c=[c.x-M[0],c.y-M[1]]):c=[0,0],p({type:"dragstart"})}}var r=N(n,"drag","dragstart","dragend"),i=null,u=e(b,ao.mouse,t,"mousemove","mouseup"),o=e(G,ao.touch,m,"touchmove","touchend");return n.origin=function(t){return arguments.length?(i=t,n):i},ao.rebind(n,r,"on")},ao.touches=function(n,t){return arguments.length<2&&(t=k().touches),t?co(t).map(function(t){var e=J(n,t);return e.identifier=t.identifier,e}):[]};var Uo=1e-6,jo=Uo*Uo,Fo=Math.PI,Ho=2*Fo,Oo=Ho-Uo,Io=Fo/2,Yo=Fo/180,Zo=180/Fo,Vo=Math.SQRT2,Xo=2,$o=4;ao.interpolateZoom=function(n,t){var e,r,i=n[0],u=n[1],o=n[2],a=t[0],l=t[1],c=t[2],f=a-i,s=l-u,h=f*f+s*s;if(jo>h)r=Math.log(c/o)/Vo,e=function(n){return[i+n*f,u+n*s,o*Math.exp(Vo*n*r)]};else{var p=Math.sqrt(h),g=(c*c-o*o+$o*h)/(2*o*Xo*p),v=(c*c-o*o-$o*h)/(2*c*Xo*p),d=Math.log(Math.sqrt(g*g+1)-g),y=Math.log(Math.sqrt(v*v+1)-v);r=(y-d)/Vo,e=function(n){var t=n*r,e=rn(d),a=o/(Xo*p)*(e*un(Vo*t+d)-en(d));return[i+a*f,u+a*s,o*e/rn(Vo*t+d)]}}return e.duration=1e3*r,e},ao.behavior.zoom=function(){function n(n){n.on(L,s).on(Wo+".zoom",p).on("dblclick.zoom",g).on(R,h)}function e(n){return[(n[0]-k.x)/k.k,(n[1]-k.y)/k.k]}function r(n){return[n[0]*k.k+k.x,n[1]*k.k+k.y]}function i(n){k.k=Math.max(A[0],Math.min(A[1],n))}function u(n,t){t=r(t),k.x+=n[0]-t[0],k.y+=n[1]-t[1]}function o(t,e,r,o){t.__chart__={x:k.x,y:k.y,k:k.k},i(Math.pow(2,o)),u(d=e,r),t=ao.select(t),C>0&&(t=t.transition().duration(C)),t.call(n.event)}function a(){b&&b.domain(x.range().map(function(n){return(n-k.x)/k.k}).map(x.invert)),w&&w.domain(_.range().map(function(n){return(n-k.y)/k.k}).map(_.invert))}function l(n){z++||n({type:"zoomstart"})}function c(n){a(),n({type:"zoom",scale:k.k,translate:[k.x,k.y]})}function f(n){--z||(n({type:"zoomend"}),d=null)}function s(){function n(){a=1,u(ao.mouse(i),h),c(o)}function r(){s.on(q,null).on(T,null),p(a),f(o)}var i=this,o=D.of(i,arguments),a=0,s=ao.select(t(i)).on(q,n).on(T,r),h=e(ao.mouse(i)),p=W(i);Il.call(i),l(o)}function h(){function n(){var n=ao.touches(g);return p=k.k,n.forEach(function(n){n.identifier in d&&(d[n.identifier]=e(n))}),n}function t(){var t=ao.event.target;ao.select(t).on(x,r).on(b,a),_.push(t);for(var e=ao.event.changedTouches,i=0,u=e.length;u>i;++i)d[e[i].identifier]=null;var l=n(),c=Date.now();if(1===l.length){if(500>c-M){var f=l[0];o(g,f,d[f.identifier],Math.floor(Math.log(k.k)/Math.LN2)+1),S()}M=c}else if(l.length>1){var f=l[0],s=l[1],h=f[0]-s[0],p=f[1]-s[1];y=h*h+p*p}}function r(){var n,t,e,r,o=ao.touches(g);Il.call(g);for(var a=0,l=o.length;l>a;++a,r=null)if(e=o[a],r=d[e.identifier]){if(t)break;n=e,t=r}if(r){var f=(f=e[0]-n[0])*f+(f=e[1]-n[1])*f,s=y&&Math.sqrt(f/y);n=[(n[0]+e[0])/2,(n[1]+e[1])/2],t=[(t[0]+r[0])/2,(t[1]+r[1])/2],i(s*p)}M=null,u(n,t),c(v)}function a(){if(ao.event.touches.length){for(var t=ao.event.changedTouches,e=0,r=t.length;r>e;++e)delete d[t[e].identifier];for(var i in d)return void n()}ao.selectAll(_).on(m,null),w.on(L,s).on(R,h),N(),f(v)}var p,g=this,v=D.of(g,arguments),d={},y=0,m=".zoom-"+ao.event.changedTouches[0].identifier,x="touchmove"+m,b="touchend"+m,_=[],w=ao.select(g),N=W(g);t(),l(v),w.on(L,null).on(R,t)}function p(){var n=D.of(this,arguments);m?clearTimeout(m):(Il.call(this),v=e(d=y||ao.mouse(this)),l(n)),m=setTimeout(function(){m=null,f(n)},50),S(),i(Math.pow(2,.002*Bo())*k.k),u(d,v),c(n)}function g(){var n=ao.mouse(this),t=Math.log(k.k)/Math.LN2;o(this,n,e(n),ao.event.shiftKey?Math.ceil(t)-1:Math.floor(t)+1)}var v,d,y,m,M,x,b,_,w,k={x:0,y:0,k:1},E=[960,500],A=Jo,C=250,z=0,L="mousedown.zoom",q="mousemove.zoom",T="mouseup.zoom",R="touchstart.zoom",D=N(n,"zoomstart","zoom","zoomend");return Wo||(Wo="onwheel"in fo?(Bo=function(){return-ao.event.deltaY*(ao.event.deltaMode?120:1)},"wheel"):"onmousewheel"in fo?(Bo=function(){return ao.event.wheelDelta},"mousewheel"):(Bo=function(){return-ao.event.detail},"MozMousePixelScroll")),n.event=function(n){n.each(function(){var n=D.of(this,arguments),t=k;Hl?ao.select(this).transition().each("start.zoom",function(){k=this.__chart__||{x:0,y:0,k:1},l(n)}).tween("zoom:zoom",function(){var e=E[0],r=E[1],i=d?d[0]:e/2,u=d?d[1]:r/2,o=ao.interpolateZoom([(i-k.x)/k.k,(u-k.y)/k.k,e/k.k],[(i-t.x)/t.k,(u-t.y)/t.k,e/t.k]);return function(t){var r=o(t),a=e/r[2];this.__chart__=k={x:i-r[0]*a,y:u-r[1]*a,k:a},c(n)}}).each("interrupt.zoom",function(){f(n)}).each("end.zoom",function(){f(n)}):(this.__chart__=k,l(n),c(n),f(n))})},n.translate=function(t){return arguments.length?(k={x:+t[0],y:+t[1],k:k.k},a(),n):[k.x,k.y]},n.scale=function(t){return arguments.length?(k={x:k.x,y:k.y,k:null},i(+t),a(),n):k.k},n.scaleExtent=function(t){return arguments.length?(A=null==t?Jo:[+t[0],+t[1]],n):A},n.center=function(t){return arguments.length?(y=t&&[+t[0],+t[1]],n):y},n.size=function(t){return arguments.length?(E=t&&[+t[0],+t[1]],n):E},n.duration=function(t){return arguments.length?(C=+t,n):C},n.x=function(t){return arguments.length?(b=t,x=t.copy(),k={x:0,y:0,k:1},n):b},n.y=function(t){return arguments.length?(w=t,_=t.copy(),k={x:0,y:0,k:1},n):w},ao.rebind(n,D,"on")};var Bo,Wo,Jo=[0,1/0];ao.color=an,an.prototype.toString=function(){return this.rgb()+""},ao.hsl=ln;var Go=ln.prototype=new an;Go.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new ln(this.h,this.s,this.l/n)},Go.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new ln(this.h,this.s,n*this.l)},Go.rgb=function(){return cn(this.h,this.s,this.l)},ao.hcl=fn;var Ko=fn.prototype=new an;Ko.brighter=function(n){return new fn(this.h,this.c,Math.min(100,this.l+Qo*(arguments.length?n:1)))},Ko.darker=function(n){return new fn(this.h,this.c,Math.max(0,this.l-Qo*(arguments.length?n:1)))},Ko.rgb=function(){return sn(this.h,this.c,this.l).rgb()},ao.lab=hn;var Qo=18,na=.95047,ta=1,ea=1.08883,ra=hn.prototype=new an;ra.brighter=function(n){return new hn(Math.min(100,this.l+Qo*(arguments.length?n:1)),this.a,this.b)},ra.darker=function(n){return new hn(Math.max(0,this.l-Qo*(arguments.length?n:1)),this.a,this.b)},ra.rgb=function(){return pn(this.l,this.a,this.b)},ao.rgb=mn;var ia=mn.prototype=new an;ia.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b,i=30;return t||e||r?(t&&i>t&&(t=i),e&&i>e&&(e=i),r&&i>r&&(r=i),new mn(Math.min(255,t/n),Math.min(255,e/n),Math.min(255,r/n))):new mn(i,i,i)},ia.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new mn(n*this.r,n*this.g,n*this.b)},ia.hsl=function(){return wn(this.r,this.g,this.b)},ia.toString=function(){return"#"+bn(this.r)+bn(this.g)+bn(this.b)};var ua=ao.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});ua.forEach(function(n,t){ua.set(n,Mn(t))}),ao.functor=En,ao.xhr=An(m),ao.dsv=function(n,t){function e(n,e,u){arguments.length<3&&(u=e,e=null);var o=Cn(n,t,null==e?r:i(e),u);return o.row=function(n){return arguments.length?o.response(null==(e=n)?r:i(n)):e},o}function r(n){return e.parse(n.responseText)}function i(n){return function(t){return e.parse(t.responseText,n)}}function u(t){return t.map(o).join(n)}function o(n){return a.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var a=new RegExp('["'+n+"\n]"),l=n.charCodeAt(0);return e.parse=function(n,t){var r;return e.parseRows(n,function(n,e){if(r)return r(n,e-1);var i=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,e){return t(i(n),e)}:i})},e.parseRows=function(n,t){function e(){if(f>=c)return o;if(i)return i=!1,u;var t=f;if(34===n.charCodeAt(t)){for(var e=t;e++<c;)if(34===n.charCodeAt(e)){if(34!==n.charCodeAt(e+1))break;++e}f=e+2;var r=n.charCodeAt(e+1);return 13===r?(i=!0,10===n.charCodeAt(e+2)&&++f):10===r&&(i=!0),n.slice(t+1,e).replace(/""/g,'"')}for(;c>f;){var r=n.charCodeAt(f++),a=1;if(10===r)i=!0;else if(13===r)i=!0,10===n.charCodeAt(f)&&(++f,++a);else if(r!==l)continue;return n.slice(t,f-a)}return n.slice(t)}for(var r,i,u={},o={},a=[],c=n.length,f=0,s=0;(r=e())!==o;){for(var h=[];r!==u&&r!==o;)h.push(r),r=e();t&&null==(h=t(h,s++))||a.push(h)}return a},e.format=function(t){if(Array.isArray(t[0]))return e.formatRows(t);var r=new y,i=[];return t.forEach(function(n){for(var t in n)r.has(t)||i.push(r.add(t))}),[i.map(o).join(n)].concat(t.map(function(t){return i.map(function(n){return o(t[n])}).join(n)})).join("\n")},e.formatRows=function(n){return n.map(u).join("\n")},e},ao.csv=ao.dsv(",","text/csv"),ao.tsv=ao.dsv("	","text/tab-separated-values");var oa,aa,la,ca,fa=this[x(this,"requestAnimationFrame")]||function(n){setTimeout(n,17)};ao.timer=function(){qn.apply(this,arguments)},ao.timer.flush=function(){Rn(),Dn()},ao.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};var sa=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(Un);ao.formatPrefix=function(n,t){var e=0;return(n=+n)&&(0>n&&(n*=-1),t&&(n=ao.round(n,Pn(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),sa[8+e/3]};var ha=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,pa=ao.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=ao.round(n,Pn(n,t))).toFixed(Math.max(0,Math.min(20,Pn(n*(1+1e-15),t))))}}),ga=ao.time={},va=Date;Hn.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){da.setUTCDate.apply(this._,arguments)},setDay:function(){da.setUTCDay.apply(this._,arguments)},setFullYear:function(){da.setUTCFullYear.apply(this._,arguments)},setHours:function(){da.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){da.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){da.setUTCMinutes.apply(this._,arguments)},setMonth:function(){da.setUTCMonth.apply(this._,arguments)},setSeconds:function(){da.setUTCSeconds.apply(this._,arguments)},setTime:function(){da.setTime.apply(this._,arguments)}};var da=Date.prototype;ga.year=On(function(n){return n=ga.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),ga.years=ga.year.range,ga.years.utc=ga.year.utc.range,ga.day=On(function(n){var t=new va(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),ga.days=ga.day.range,ga.days.utc=ga.day.utc.range,ga.dayOfYear=function(n){var t=ga.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,t){t=7-t;var e=ga[n]=On(function(n){return(n=ga.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var e=ga.year(n).getDay();return Math.floor((ga.dayOfYear(n)+(e+t)%7)/7)-(e!==t)});ga[n+"s"]=e.range,ga[n+"s"].utc=e.utc.range,ga[n+"OfYear"]=function(n){var e=ga.year(n).getDay();return Math.floor((ga.dayOfYear(n)+(e+t)%7)/7)}}),ga.week=ga.sunday,ga.weeks=ga.sunday.range,ga.weeks.utc=ga.sunday.utc.range,ga.weekOfYear=ga.sundayOfYear;var ya={"-":"",_:" ",0:"0"},ma=/^\s*\d+/,Ma=/^%/;ao.locale=function(n){return{numberFormat:jn(n),timeFormat:Yn(n)}};var xa=ao.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],
shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});ao.format=xa.numberFormat,ao.geo={},ft.prototype={s:0,t:0,add:function(n){st(n,this.t,ba),st(ba.s,this.s,this),this.s?this.t+=ba.t:this.s=ba.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ba=new ft;ao.geo.stream=function(n,t){n&&_a.hasOwnProperty(n.type)?_a[n.type](n,t):ht(n,t)};var _a={Feature:function(n,t){ht(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,i=e.length;++r<i;)ht(e[r].geometry,t)}},wa={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){pt(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)pt(e[r],t,0)},Polygon:function(n,t){gt(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)gt(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,i=e.length;++r<i;)ht(e[r],t)}};ao.geo.area=function(n){return Sa=0,ao.geo.stream(n,Na),Sa};var Sa,ka=new ft,Na={sphere:function(){Sa+=4*Fo},point:b,lineStart:b,lineEnd:b,polygonStart:function(){ka.reset(),Na.lineStart=vt},polygonEnd:function(){var n=2*ka;Sa+=0>n?4*Fo+n:n,Na.lineStart=Na.lineEnd=Na.point=b}};ao.geo.bounds=function(){function n(n,t){M.push(x=[f=n,h=n]),s>t&&(s=t),t>p&&(p=t)}function t(t,e){var r=dt([t*Yo,e*Yo]);if(y){var i=mt(y,r),u=[i[1],-i[0],0],o=mt(u,i);bt(o),o=_t(o);var l=t-g,c=l>0?1:-1,v=o[0]*Zo*c,d=xo(l)>180;if(d^(v>c*g&&c*t>v)){var m=o[1]*Zo;m>p&&(p=m)}else if(v=(v+360)%360-180,d^(v>c*g&&c*t>v)){var m=-o[1]*Zo;s>m&&(s=m)}else s>e&&(s=e),e>p&&(p=e);d?g>t?a(f,t)>a(f,h)&&(h=t):a(t,h)>a(f,h)&&(f=t):h>=f?(f>t&&(f=t),t>h&&(h=t)):t>g?a(f,t)>a(f,h)&&(h=t):a(t,h)>a(f,h)&&(f=t)}else n(t,e);y=r,g=t}function e(){b.point=t}function r(){x[0]=f,x[1]=h,b.point=n,y=null}function i(n,e){if(y){var r=n-g;m+=xo(r)>180?r+(r>0?360:-360):r}else v=n,d=e;Na.point(n,e),t(n,e)}function u(){Na.lineStart()}function o(){i(v,d),Na.lineEnd(),xo(m)>Uo&&(f=-(h=180)),x[0]=f,x[1]=h,y=null}function a(n,t){return(t-=n)<0?t+360:t}function l(n,t){return n[0]-t[0]}function c(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var f,s,h,p,g,v,d,y,m,M,x,b={point:n,lineStart:e,lineEnd:r,polygonStart:function(){b.point=i,b.lineStart=u,b.lineEnd=o,m=0,Na.polygonStart()},polygonEnd:function(){Na.polygonEnd(),b.point=n,b.lineStart=e,b.lineEnd=r,0>ka?(f=-(h=180),s=-(p=90)):m>Uo?p=90:-Uo>m&&(s=-90),x[0]=f,x[1]=h}};return function(n){p=h=-(f=s=1/0),M=[],ao.geo.stream(n,b);var t=M.length;if(t){M.sort(l);for(var e,r=1,i=M[0],u=[i];t>r;++r)e=M[r],c(e[0],i)||c(e[1],i)?(a(i[0],e[1])>a(i[0],i[1])&&(i[1]=e[1]),a(e[0],i[1])>a(i[0],i[1])&&(i[0]=e[0])):u.push(i=e);for(var o,e,g=-(1/0),t=u.length-1,r=0,i=u[t];t>=r;i=e,++r)e=u[r],(o=a(i[1],e[0]))>g&&(g=o,f=e[0],h=i[1])}return M=x=null,f===1/0||s===1/0?[[NaN,NaN],[NaN,NaN]]:[[f,s],[h,p]]}}(),ao.geo.centroid=function(n){Ea=Aa=Ca=za=La=qa=Ta=Ra=Da=Pa=Ua=0,ao.geo.stream(n,ja);var t=Da,e=Pa,r=Ua,i=t*t+e*e+r*r;return jo>i&&(t=qa,e=Ta,r=Ra,Uo>Aa&&(t=Ca,e=za,r=La),i=t*t+e*e+r*r,jo>i)?[NaN,NaN]:[Math.atan2(e,t)*Zo,tn(r/Math.sqrt(i))*Zo]};var Ea,Aa,Ca,za,La,qa,Ta,Ra,Da,Pa,Ua,ja={sphere:b,point:St,lineStart:Nt,lineEnd:Et,polygonStart:function(){ja.lineStart=At},polygonEnd:function(){ja.lineStart=Nt}},Fa=Rt(zt,jt,Ht,[-Fo,-Fo/2]),Ha=1e9;ao.geo.clipExtent=function(){var n,t,e,r,i,u,o={stream:function(n){return i&&(i.valid=!1),i=u(n),i.valid=!0,i},extent:function(a){return arguments.length?(u=Zt(n=+a[0][0],t=+a[0][1],e=+a[1][0],r=+a[1][1]),i&&(i.valid=!1,i=null),o):[[n,t],[e,r]]}};return o.extent([[0,0],[960,500]])},(ao.geo.conicEqualArea=function(){return Vt(Xt)}).raw=Xt,ao.geo.albers=function(){return ao.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},ao.geo.albersUsa=function(){function n(n){var u=n[0],o=n[1];return t=null,e(u,o),t||(r(u,o),t)||i(u,o),t}var t,e,r,i,u=ao.geo.albers(),o=ao.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=ao.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(n,e){t=[n,e]}};return n.invert=function(n){var t=u.scale(),e=u.translate(),r=(n[0]-e[0])/t,i=(n[1]-e[1])/t;return(i>=.12&&.234>i&&r>=-.425&&-.214>r?o:i>=.166&&.234>i&&r>=-.214&&-.115>r?a:u).invert(n)},n.stream=function(n){var t=u.stream(n),e=o.stream(n),r=a.stream(n);return{point:function(n,i){t.point(n,i),e.point(n,i),r.point(n,i)},sphere:function(){t.sphere(),e.sphere(),r.sphere()},lineStart:function(){t.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},n.precision=function(t){return arguments.length?(u.precision(t),o.precision(t),a.precision(t),n):u.precision()},n.scale=function(t){return arguments.length?(u.scale(t),o.scale(.35*t),a.scale(t),n.translate(u.translate())):u.scale()},n.translate=function(t){if(!arguments.length)return u.translate();var c=u.scale(),f=+t[0],s=+t[1];return e=u.translate(t).clipExtent([[f-.455*c,s-.238*c],[f+.455*c,s+.238*c]]).stream(l).point,r=o.translate([f-.307*c,s+.201*c]).clipExtent([[f-.425*c+Uo,s+.12*c+Uo],[f-.214*c-Uo,s+.234*c-Uo]]).stream(l).point,i=a.translate([f-.205*c,s+.212*c]).clipExtent([[f-.214*c+Uo,s+.166*c+Uo],[f-.115*c-Uo,s+.234*c-Uo]]).stream(l).point,n},n.scale(1070)};var Oa,Ia,Ya,Za,Va,Xa,$a={point:b,lineStart:b,lineEnd:b,polygonStart:function(){Ia=0,$a.lineStart=$t},polygonEnd:function(){$a.lineStart=$a.lineEnd=$a.point=b,Oa+=xo(Ia/2)}},Ba={point:Bt,lineStart:b,lineEnd:b,polygonStart:b,polygonEnd:b},Wa={point:Gt,lineStart:Kt,lineEnd:Qt,polygonStart:function(){Wa.lineStart=ne},polygonEnd:function(){Wa.point=Gt,Wa.lineStart=Kt,Wa.lineEnd=Qt}};ao.geo.path=function(){function n(n){return n&&("function"==typeof a&&u.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=i(u)),ao.geo.stream(n,o)),u.result()}function t(){return o=null,n}var e,r,i,u,o,a=4.5;return n.area=function(n){return Oa=0,ao.geo.stream(n,i($a)),Oa},n.centroid=function(n){return Ca=za=La=qa=Ta=Ra=Da=Pa=Ua=0,ao.geo.stream(n,i(Wa)),Ua?[Da/Ua,Pa/Ua]:Ra?[qa/Ra,Ta/Ra]:La?[Ca/La,za/La]:[NaN,NaN]},n.bounds=function(n){return Va=Xa=-(Ya=Za=1/0),ao.geo.stream(n,i(Ba)),[[Ya,Za],[Va,Xa]]},n.projection=function(n){return arguments.length?(i=(e=n)?n.stream||re(n):m,t()):e},n.context=function(n){return arguments.length?(u=null==(r=n)?new Wt:new te(n),"function"!=typeof a&&u.pointRadius(a),t()):r},n.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(u.pointRadius(+t),+t),n):a},n.projection(ao.geo.albersUsa()).context(null)},ao.geo.transform=function(n){return{stream:function(t){var e=new ie(t);for(var r in n)e[r]=n[r];return e}}},ie.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},ao.geo.projection=oe,ao.geo.projectionMutator=ae,(ao.geo.equirectangular=function(){return oe(ce)}).raw=ce.invert=ce,ao.geo.rotation=function(n){function t(t){return t=n(t[0]*Yo,t[1]*Yo),t[0]*=Zo,t[1]*=Zo,t}return n=se(n[0]%360*Yo,n[1]*Yo,n.length>2?n[2]*Yo:0),t.invert=function(t){return t=n.invert(t[0]*Yo,t[1]*Yo),t[0]*=Zo,t[1]*=Zo,t},t},fe.invert=ce,ao.geo.circle=function(){function n(){var n="function"==typeof r?r.apply(this,arguments):r,t=se(-n[0]*Yo,-n[1]*Yo,0).invert,i=[];return e(null,null,1,{point:function(n,e){i.push(n=t(n,e)),n[0]*=Zo,n[1]*=Zo}}),{type:"Polygon",coordinates:[i]}}var t,e,r=[0,0],i=6;return n.origin=function(t){return arguments.length?(r=t,n):r},n.angle=function(r){return arguments.length?(e=ve((t=+r)*Yo,i*Yo),n):t},n.precision=function(r){return arguments.length?(e=ve(t*Yo,(i=+r)*Yo),n):i},n.angle(90)},ao.geo.distance=function(n,t){var e,r=(t[0]-n[0])*Yo,i=n[1]*Yo,u=t[1]*Yo,o=Math.sin(r),a=Math.cos(r),l=Math.sin(i),c=Math.cos(i),f=Math.sin(u),s=Math.cos(u);return Math.atan2(Math.sqrt((e=s*o)*e+(e=c*f-l*s*a)*e),l*f+c*s*a)},ao.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:t()}}function t(){return ao.range(Math.ceil(u/d)*d,i,d).map(h).concat(ao.range(Math.ceil(c/y)*y,l,y).map(p)).concat(ao.range(Math.ceil(r/g)*g,e,g).filter(function(n){return xo(n%d)>Uo}).map(f)).concat(ao.range(Math.ceil(a/v)*v,o,v).filter(function(n){return xo(n%y)>Uo}).map(s))}var e,r,i,u,o,a,l,c,f,s,h,p,g=10,v=g,d=90,y=360,m=2.5;return n.lines=function(){return t().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[h(u).concat(p(l).slice(1),h(i).reverse().slice(1),p(c).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(u=+t[0][0],i=+t[1][0],c=+t[0][1],l=+t[1][1],u>i&&(t=u,u=i,i=t),c>l&&(t=c,c=l,l=t),n.precision(m)):[[u,c],[i,l]]},n.minorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],a=+t[0][1],o=+t[1][1],r>e&&(t=r,r=e,e=t),a>o&&(t=a,a=o,o=t),n.precision(m)):[[r,a],[e,o]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(d=+t[0],y=+t[1],n):[d,y]},n.minorStep=function(t){return arguments.length?(g=+t[0],v=+t[1],n):[g,v]},n.precision=function(t){return arguments.length?(m=+t,f=ye(a,o,90),s=me(r,e,m),h=ye(c,l,90),p=me(u,i,m),n):m},n.majorExtent([[-180,-90+Uo],[180,90-Uo]]).minorExtent([[-180,-80-Uo],[180,80+Uo]])},ao.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),e||i.apply(this,arguments)]}}var t,e,r=Me,i=xe;return n.distance=function(){return ao.geo.distance(t||r.apply(this,arguments),e||i.apply(this,arguments))},n.source=function(e){return arguments.length?(r=e,t="function"==typeof e?null:e,n):r},n.target=function(t){return arguments.length?(i=t,e="function"==typeof t?null:t,n):i},n.precision=function(){return arguments.length?n:0},n},ao.geo.interpolate=function(n,t){return be(n[0]*Yo,n[1]*Yo,t[0]*Yo,t[1]*Yo)},ao.geo.length=function(n){return Ja=0,ao.geo.stream(n,Ga),Ja};var Ja,Ga={sphere:b,point:b,lineStart:_e,lineEnd:b,polygonStart:b,polygonEnd:b},Ka=we(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(ao.geo.azimuthalEqualArea=function(){return oe(Ka)}).raw=Ka;var Qa=we(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},m);(ao.geo.azimuthalEquidistant=function(){return oe(Qa)}).raw=Qa,(ao.geo.conicConformal=function(){return Vt(Se)}).raw=Se,(ao.geo.conicEquidistant=function(){return Vt(ke)}).raw=ke;var nl=we(function(n){return 1/n},Math.atan);(ao.geo.gnomonic=function(){return oe(nl)}).raw=nl,Ne.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-Io]},(ao.geo.mercator=function(){return Ee(Ne)}).raw=Ne;var tl=we(function(){return 1},Math.asin);(ao.geo.orthographic=function(){return oe(tl)}).raw=tl;var el=we(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(ao.geo.stereographic=function(){return oe(el)}).raw=el,Ae.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-Io]},(ao.geo.transverseMercator=function(){var n=Ee(Ae),t=n.center,e=n.rotate;return n.center=function(n){return n?t([-n[1],n[0]]):(n=t(),[n[1],-n[0]])},n.rotate=function(n){return n?e([n[0],n[1],n.length>2?n[2]+90:90]):(n=e(),[n[0],n[1],n[2]-90])},e([0,0,90])}).raw=Ae,ao.geom={},ao.geom.hull=function(n){function t(n){if(n.length<3)return[];var t,i=En(e),u=En(r),o=n.length,a=[],l=[];for(t=0;o>t;t++)a.push([+i.call(this,n[t],t),+u.call(this,n[t],t),t]);for(a.sort(qe),t=0;o>t;t++)l.push([a[t][0],-a[t][1]]);var c=Le(a),f=Le(l),s=f[0]===c[0],h=f[f.length-1]===c[c.length-1],p=[];for(t=c.length-1;t>=0;--t)p.push(n[a[c[t]][2]]);for(t=+s;t<f.length-h;++t)p.push(n[a[f[t]][2]]);return p}var e=Ce,r=ze;return arguments.length?t(n):(t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t)},ao.geom.polygon=function(n){return ko(n,rl),n};var rl=ao.geom.polygon.prototype=[];rl.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],i=0;++t<e;)n=r,r=this[t],i+=n[1]*r[0]-n[0]*r[1];return.5*i},rl.centroid=function(n){var t,e,r=-1,i=this.length,u=0,o=0,a=this[i-1];for(arguments.length||(n=-1/(6*this.area()));++r<i;)t=a,a=this[r],e=t[0]*a[1]-a[0]*t[1],u+=(t[0]+a[0])*e,o+=(t[1]+a[1])*e;return[u*n,o*n]},rl.clip=function(n){for(var t,e,r,i,u,o,a=De(n),l=-1,c=this.length-De(this),f=this[c-1];++l<c;){for(t=n.slice(),n.length=0,i=this[l],u=t[(r=t.length-a)-1],e=-1;++e<r;)o=t[e],Te(o,f,i)?(Te(u,f,i)||n.push(Re(u,o,f,i)),n.push(o)):Te(u,f,i)&&n.push(Re(u,o,f,i)),u=o;a&&n.push(n[0]),f=i}return n};var il,ul,ol,al,ll,cl=[],fl=[];Ye.prototype.prepare=function(){for(var n,t=this.edges,e=t.length;e--;)n=t[e].edge,n.b&&n.a||t.splice(e,1);return t.sort(Ve),t.length},tr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},er.prototype={insert:function(n,t){var e,r,i;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;e=n}else this._?(n=or(this._),t.P=null,t.N=n,n.P=n.L=t,e=n):(t.P=t.N=null,this._=t,e=null);for(t.L=t.R=null,t.U=e,t.C=!0,n=t;e&&e.C;)r=e.U,e===r.L?(i=r.R,i&&i.C?(e.C=i.C=!1,r.C=!0,n=r):(n===e.R&&(ir(this,e),n=e,e=n.U),e.C=!1,r.C=!0,ur(this,r))):(i=r.L,i&&i.C?(e.C=i.C=!1,r.C=!0,n=r):(n===e.L&&(ur(this,e),n=e,e=n.U),e.C=!1,r.C=!0,ir(this,r))),e=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,e,r,i=n.U,u=n.L,o=n.R;if(e=u?o?or(o):u:o,i?i.L===n?i.L=e:i.R=e:this._=e,u&&o?(r=e.C,e.C=n.C,e.L=u,u.U=e,e!==o?(i=e.U,e.U=n.U,n=e.R,i.L=n,e.R=o,o.U=e):(e.U=i,i=e,n=e.R)):(r=n.C,n=e),n&&(n.U=i),!r){if(n&&n.C)return void(n.C=!1);do{if(n===this._)break;if(n===i.L){if(t=i.R,t.C&&(t.C=!1,i.C=!0,ir(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,ur(this,t),t=i.R),t.C=i.C,i.C=t.R.C=!1,ir(this,i),n=this._;break}}else if(t=i.L,t.C&&(t.C=!1,i.C=!0,ur(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,ir(this,t),t=i.L),t.C=i.C,i.C=t.L.C=!1,ur(this,i),n=this._;break}t.C=!0,n=i,i=i.U}while(!n.C);n&&(n.C=!1)}}},ao.geom.voronoi=function(n){function t(n){var t=new Array(n.length),r=a[0][0],i=a[0][1],u=a[1][0],o=a[1][1];return ar(e(n),a).cells.forEach(function(e,a){var l=e.edges,c=e.site,f=t[a]=l.length?l.map(function(n){var t=n.start();return[t.x,t.y]}):c.x>=r&&c.x<=u&&c.y>=i&&c.y<=o?[[r,o],[u,o],[u,i],[r,i]]:[];f.point=n[a]}),t}function e(n){return n.map(function(n,t){return{x:Math.round(u(n,t)/Uo)*Uo,y:Math.round(o(n,t)/Uo)*Uo,i:t}})}var r=Ce,i=ze,u=r,o=i,a=sl;return n?t(n):(t.links=function(n){return ar(e(n)).edges.filter(function(n){return n.l&&n.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},t.triangles=function(n){var t=[];return ar(e(n)).cells.forEach(function(e,r){for(var i,u,o=e.site,a=e.edges.sort(Ve),l=-1,c=a.length,f=a[c-1].edge,s=f.l===o?f.r:f.l;++l<c;)i=f,u=s,f=a[l].edge,s=f.l===o?f.r:f.l,r<u.i&&r<s.i&&cr(o,u,s)<0&&t.push([n[r],n[u.i],n[s.i]])}),t},t.x=function(n){return arguments.length?(u=En(r=n),t):r},t.y=function(n){return arguments.length?(o=En(i=n),t):i},t.clipExtent=function(n){return arguments.length?(a=null==n?sl:n,t):a===sl?null:a},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):a===sl?null:a&&a[1]},t)};var sl=[[-1e6,-1e6],[1e6,1e6]];ao.geom.delaunay=function(n){return ao.geom.voronoi().triangles(n)},ao.geom.quadtree=function(n,t,e,r,i){function u(n){function u(n,t,e,r,i,u,o,a){if(!isNaN(e)&&!isNaN(r))if(n.leaf){var l=n.x,f=n.y;if(null!=l)if(xo(l-e)+xo(f-r)<.01)c(n,t,e,r,i,u,o,a);else{var s=n.point;n.x=n.y=n.point=null,c(n,s,l,f,i,u,o,a),c(n,t,e,r,i,u,o,a)}else n.x=e,n.y=r,n.point=t}else c(n,t,e,r,i,u,o,a)}function c(n,t,e,r,i,o,a,l){var c=.5*(i+a),f=.5*(o+l),s=e>=c,h=r>=f,p=h<<1|s;n.leaf=!1,n=n.nodes[p]||(n.nodes[p]=hr()),s?i=c:a=c,h?o=f:l=f,u(n,t,e,r,i,o,a,l)}var f,s,h,p,g,v,d,y,m,M=En(a),x=En(l);if(null!=t)v=t,d=e,y=r,m=i;else if(y=m=-(v=d=1/0),s=[],h=[],g=n.length,o)for(p=0;g>p;++p)f=n[p],f.x<v&&(v=f.x),f.y<d&&(d=f.y),f.x>y&&(y=f.x),f.y>m&&(m=f.y),s.push(f.x),h.push(f.y);else for(p=0;g>p;++p){var b=+M(f=n[p],p),_=+x(f,p);v>b&&(v=b),d>_&&(d=_),b>y&&(y=b),_>m&&(m=_),s.push(b),h.push(_)}var w=y-v,S=m-d;w>S?m=d+w:y=v+S;var k=hr();if(k.add=function(n){u(k,n,+M(n,++p),+x(n,p),v,d,y,m)},k.visit=function(n){pr(n,k,v,d,y,m)},k.find=function(n){return gr(k,n[0],n[1],v,d,y,m)},p=-1,null==t){for(;++p<g;)u(k,n[p],s[p],h[p],v,d,y,m);--p}else n.forEach(k.add);return s=h=n=f=null,k}var o,a=Ce,l=ze;return(o=arguments.length)?(a=fr,l=sr,3===o&&(i=e,r=t,e=t=0),u(n)):(u.x=function(n){return arguments.length?(a=n,u):a},u.y=function(n){return arguments.length?(l=n,u):l},u.extent=function(n){return arguments.length?(null==n?t=e=r=i=null:(t=+n[0][0],e=+n[0][1],r=+n[1][0],i=+n[1][1]),u):null==t?null:[[t,e],[r,i]]},u.size=function(n){return arguments.length?(null==n?t=e=r=i=null:(t=e=0,r=+n[0],i=+n[1]),u):null==t?null:[r-t,i-e]},u)},ao.interpolateRgb=vr,ao.interpolateObject=dr,ao.interpolateNumber=yr,ao.interpolateString=mr;var hl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pl=new RegExp(hl.source,"g");ao.interpolate=Mr,ao.interpolators=[function(n,t){var e=typeof t;return("string"===e?ua.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?vr:mr:t instanceof an?vr:Array.isArray(t)?xr:"object"===e&&isNaN(t)?dr:yr)(n,t)}],ao.interpolateArray=xr;var gl=function(){return m},vl=ao.map({linear:gl,poly:Er,quad:function(){return Sr},cubic:function(){return kr},sin:function(){return Ar},exp:function(){return Cr},circle:function(){return zr},elastic:Lr,back:qr,bounce:function(){return Tr}}),dl=ao.map({"in":m,out:_r,"in-out":wr,"out-in":function(n){return wr(_r(n))}});ao.ease=function(n){var t=n.indexOf("-"),e=t>=0?n.slice(0,t):n,r=t>=0?n.slice(t+1):"in";return e=vl.get(e)||gl,r=dl.get(r)||m,br(r(e.apply(null,lo.call(arguments,1))))},ao.interpolateHcl=Rr,ao.interpolateHsl=Dr,ao.interpolateLab=Pr,ao.interpolateRound=Ur,ao.transform=function(n){var t=fo.createElementNS(ao.ns.prefix.svg,"g");return(ao.transform=function(n){if(null!=n){t.setAttribute("transform",n);var e=t.transform.baseVal.consolidate()}return new jr(e?e.matrix:yl)})(n)},jr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var yl={a:1,b:0,c:0,d:1,e:0,f:0};ao.interpolateTransform=$r,ao.layout={},ao.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;)t.push(Jr(n[e]));return t}},ao.layout.chord=function(){function n(){var n,c,s,h,p,g={},v=[],d=ao.range(u),y=[];for(e=[],r=[],n=0,h=-1;++h<u;){for(c=0,p=-1;++p<u;)c+=i[h][p];v.push(c),y.push(ao.range(u)),n+=c}for(o&&d.sort(function(n,t){return o(v[n],v[t])}),a&&y.forEach(function(n,t){n.sort(function(n,e){return a(i[t][n],i[t][e])})}),n=(Ho-f*u)/n,c=0,h=-1;++h<u;){for(s=c,p=-1;++p<u;){var m=d[h],M=y[m][p],x=i[m][M],b=c,_=c+=x*n;g[m+"-"+M]={index:m,subindex:M,startAngle:b,endAngle:_,value:x}}r[m]={index:m,startAngle:s,endAngle:c,value:v[m]},c+=f}for(h=-1;++h<u;)for(p=h-1;++p<u;){var w=g[h+"-"+p],S=g[p+"-"+h];(w.value||S.value)&&e.push(w.value<S.value?{source:S,target:w}:{source:w,target:S})}l&&t()}function t(){e.sort(function(n,t){return l((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var e,r,i,u,o,a,l,c={},f=0;return c.matrix=function(n){return arguments.length?(u=(i=n)&&i.length,e=r=null,c):i},c.padding=function(n){return arguments.length?(f=n,e=r=null,c):f},c.sortGroups=function(n){return arguments.length?(o=n,e=r=null,c):o},c.sortSubgroups=function(n){return arguments.length?(a=n,e=null,c):a},c.sortChords=function(n){return arguments.length?(l=n,e&&t(),c):l},c.chords=function(){return e||n(),e},c.groups=function(){return r||n(),r},c},ao.layout.force=function(){function n(n){return function(t,e,r,i){if(t.point!==n){var u=t.cx-n.x,o=t.cy-n.y,a=i-e,l=u*u+o*o;if(l>a*a/y){if(v>l){var c=t.charge/l;n.px-=u*c,n.py-=o*c}return!0}if(t.point&&l&&v>l){var c=t.pointCharge/l;n.px-=u*c,n.py-=o*c}}return!t.charge}}function t(n){n.px=ao.event.x,n.py=ao.event.y,l.resume()}var e,r,i,u,o,a,l={},c=ao.dispatch("start","tick","end"),f=[1,1],s=.9,h=ml,p=Ml,g=-30,v=xl,d=.1,y=.64,M=[],x=[];return l.tick=function(){if((i*=.99)<.005)return e=null,c.end({type:"end",alpha:i=0}),!0;var t,r,l,h,p,v,y,m,b,_=M.length,w=x.length;for(r=0;w>r;++r)l=x[r],h=l.source,p=l.target,m=p.x-h.x,b=p.y-h.y,(v=m*m+b*b)&&(v=i*o[r]*((v=Math.sqrt(v))-u[r])/v,m*=v,b*=v,p.x-=m*(y=h.weight+p.weight?h.weight/(h.weight+p.weight):.5),p.y-=b*y,h.x+=m*(y=1-y),h.y+=b*y);if((y=i*d)&&(m=f[0]/2,b=f[1]/2,r=-1,y))for(;++r<_;)l=M[r],l.x+=(m-l.x)*y,l.y+=(b-l.y)*y;if(g)for(ri(t=ao.geom.quadtree(M),i,a),r=-1;++r<_;)(l=M[r]).fixed||t.visit(n(l));for(r=-1;++r<_;)l=M[r],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*s,l.y-=(l.py-(l.py=l.y))*s);c.tick({type:"tick",alpha:i})},l.nodes=function(n){return arguments.length?(M=n,l):M},l.links=function(n){return arguments.length?(x=n,l):x},l.size=function(n){return arguments.length?(f=n,l):f},l.linkDistance=function(n){return arguments.length?(h="function"==typeof n?n:+n,l):h},l.distance=l.linkDistance,l.linkStrength=function(n){return arguments.length?(p="function"==typeof n?n:+n,l):p},l.friction=function(n){return arguments.length?(s=+n,l):s},l.charge=function(n){return arguments.length?(g="function"==typeof n?n:+n,l):g},l.chargeDistance=function(n){return arguments.length?(v=n*n,l):Math.sqrt(v)},l.gravity=function(n){return arguments.length?(d=+n,l):d},l.theta=function(n){return arguments.length?(y=n*n,l):Math.sqrt(y)},l.alpha=function(n){return arguments.length?(n=+n,i?n>0?i=n:(e.c=null,e.t=NaN,e=null,c.end({type:"end",alpha:i=0})):n>0&&(c.start({type:"start",alpha:i=n}),e=qn(l.tick)),l):i},l.start=function(){function n(n,r){if(!e){for(e=new Array(i),l=0;i>l;++l)e[l]=[];for(l=0;c>l;++l){var u=x[l];e[u.source.index].push(u.target),e[u.target.index].push(u.source)}}for(var o,a=e[t],l=-1,f=a.length;++l<f;)if(!isNaN(o=a[l][n]))return o;return Math.random()*r}var t,e,r,i=M.length,c=x.length,s=f[0],v=f[1];for(t=0;i>t;++t)(r=M[t]).index=t,r.weight=0;for(t=0;c>t;++t)r=x[t],"number"==typeof r.source&&(r.source=M[r.source]),"number"==typeof r.target&&(r.target=M[r.target]),++r.source.weight,++r.target.weight;for(t=0;i>t;++t)r=M[t],isNaN(r.x)&&(r.x=n("x",s)),isNaN(r.y)&&(r.y=n("y",v)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(u=[],"function"==typeof h)for(t=0;c>t;++t)u[t]=+h.call(this,x[t],t);else for(t=0;c>t;++t)u[t]=h;if(o=[],"function"==typeof p)for(t=0;c>t;++t)o[t]=+p.call(this,x[t],t);else for(t=0;c>t;++t)o[t]=p;if(a=[],"function"==typeof g)for(t=0;i>t;++t)a[t]=+g.call(this,M[t],t);else for(t=0;i>t;++t)a[t]=g;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return r||(r=ao.behavior.drag().origin(m).on("dragstart.force",Qr).on("drag.force",t).on("dragend.force",ni)),arguments.length?void this.on("mouseover.force",ti).on("mouseout.force",ei).call(r):r},ao.rebind(l,c,"on")};var ml=20,Ml=1,xl=1/0;ao.layout.hierarchy=function(){function n(i){var u,o=[i],a=[];for(i.depth=0;null!=(u=o.pop());)if(a.push(u),(c=e.call(n,u,u.depth))&&(l=c.length)){for(var l,c,f;--l>=0;)o.push(f=c[l]),f.parent=u,f.depth=u.depth+1;r&&(u.value=0),u.children=c}else r&&(u.value=+r.call(n,u,u.depth)||0),delete u.children;return oi(i,function(n){var e,i;t&&(e=n.children)&&e.sort(t),r&&(i=n.parent)&&(i.value+=n.value)}),a}var t=ci,e=ai,r=li;return n.sort=function(e){return arguments.length?(t=e,n):t},n.children=function(t){return arguments.length?(e=t,n):e},n.value=function(t){return arguments.length?(r=t,n):r},n.revalue=function(t){return r&&(ui(t,function(n){n.children&&(n.value=0)}),oi(t,function(t){var e;t.children||(t.value=+r.call(n,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},n},ao.layout.partition=function(){function n(t,e,r,i){var u=t.children;if(t.x=e,t.y=t.depth*i,t.dx=r,t.dy=i,u&&(o=u.length)){var o,a,l,c=-1;for(r=t.value?r/t.value:0;++c<o;)n(a=u[c],e,l=a.value*r,i),e+=l}}function t(n){var e=n.children,r=0;if(e&&(i=e.length))for(var i,u=-1;++u<i;)r=Math.max(r,t(e[u]));return 1+r}function e(e,u){var o=r.call(this,e,u);return n(o[0],0,i[0],i[1]/t(o[0])),o}var r=ao.layout.hierarchy(),i=[1,1];return e.size=function(n){return arguments.length?(i=n,e):i},ii(e,r)},ao.layout.pie=function(){function n(o){var a,l=o.length,c=o.map(function(e,r){return+t.call(n,e,r)}),f=+("function"==typeof r?r.apply(this,arguments):r),s=("function"==typeof i?i.apply(this,arguments):i)-f,h=Math.min(Math.abs(s)/l,+("function"==typeof u?u.apply(this,arguments):u)),p=h*(0>s?-1:1),g=ao.sum(c),v=g?(s-l*p)/g:0,d=ao.range(l),y=[];return null!=e&&d.sort(e===bl?function(n,t){return c[t]-c[n]}:function(n,t){return e(o[n],o[t])}),d.forEach(function(n){y[n]={data:o[n],value:a=c[n],startAngle:f,endAngle:f+=a*v+p,padAngle:h}}),y}var t=Number,e=bl,r=0,i=Ho,u=0;return n.value=function(e){return arguments.length?(t=e,n):t},n.sort=function(t){return arguments.length?(e=t,n):e},n.startAngle=function(t){return arguments.length?(r=t,n):r},n.endAngle=function(t){return arguments.length?(i=t,n):i},n.padAngle=function(t){return arguments.length?(u=t,n):u},n};var bl={};ao.layout.stack=function(){function n(a,l){if(!(h=a.length))return a;var c=a.map(function(e,r){return t.call(n,e,r)}),f=c.map(function(t){return t.map(function(t,e){return[u.call(n,t,e),o.call(n,t,e)]})}),s=e.call(n,f,l);c=ao.permute(c,s),f=ao.permute(f,s);var h,p,g,v,d=r.call(n,f,l),y=c[0].length;for(g=0;y>g;++g)for(i.call(n,c[0][g],v=d[g],f[0][g][1]),p=1;h>p;++p)i.call(n,c[p][g],v+=f[p-1][g][1],f[p][g][1]);return a}var t=m,e=gi,r=vi,i=pi,u=si,o=hi;return n.values=function(e){return arguments.length?(t=e,n):t},n.order=function(t){return arguments.length?(e="function"==typeof t?t:_l.get(t)||gi,n):e},n.offset=function(t){return arguments.length?(r="function"==typeof t?t:wl.get(t)||vi,n):r},n.x=function(t){return arguments.length?(u=t,n):u},n.y=function(t){return arguments.length?(o=t,n):o},n.out=function(t){return arguments.length?(i=t,n):i},n};var _l=ao.map({"inside-out":function(n){var t,e,r=n.length,i=n.map(di),u=n.map(yi),o=ao.range(r).sort(function(n,t){return i[n]-i[t]}),a=0,l=0,c=[],f=[];for(t=0;r>t;++t)e=o[t],l>a?(a+=u[e],c.push(e)):(l+=u[e],f.push(e));return f.reverse().concat(c)},reverse:function(n){return ao.range(n.length).reverse()},"default":gi}),wl=ao.map({silhouette:function(n){var t,e,r,i=n.length,u=n[0].length,o=[],a=0,l=[];for(e=0;u>e;++e){for(t=0,r=0;i>t;t++)r+=n[t][e][1];r>a&&(a=r),o.push(r)}for(e=0;u>e;++e)l[e]=(a-o[e])/2;return l},wiggle:function(n){var t,e,r,i,u,o,a,l,c,f=n.length,s=n[0],h=s.length,p=[];for(p[0]=l=c=0,e=1;h>e;++e){for(t=0,i=0;f>t;++t)i+=n[t][e][1];for(t=0,u=0,a=s[e][0]-s[e-1][0];f>t;++t){for(r=0,o=(n[t][e][1]-n[t][e-1][1])/(2*a);t>r;++r)o+=(n[r][e][1]-n[r][e-1][1])/a;u+=o*n[t][e][1]}p[e]=l-=i?u/i*a:0,c>l&&(c=l)}for(e=0;h>e;++e)p[e]-=c;return p},expand:function(n){var t,e,r,i=n.length,u=n[0].length,o=1/i,a=[];for(e=0;u>e;++e){for(t=0,r=0;i>t;t++)r+=n[t][e][1];if(r)for(t=0;i>t;t++)n[t][e][1]/=r;else for(t=0;i>t;t++)n[t][e][1]=o}for(e=0;u>e;++e)a[e]=0;return a},zero:vi});ao.layout.histogram=function(){function n(n,u){for(var o,a,l=[],c=n.map(e,this),f=r.call(this,c,u),s=i.call(this,f,c,u),u=-1,h=c.length,p=s.length-1,g=t?1:1/h;++u<p;)o=l[u]=[],o.dx=s[u+1]-(o.x=s[u]),o.y=0;if(p>0)for(u=-1;++u<h;)a=c[u],a>=f[0]&&a<=f[1]&&(o=l[ao.bisect(s,a,1,p)-1],o.y+=g,o.push(n[u]));return l}var t=!0,e=Number,r=bi,i=Mi;return n.value=function(t){return arguments.length?(e=t,n):e},n.range=function(t){return arguments.length?(r=En(t),n):r},n.bins=function(t){return arguments.length?(i="number"==typeof t?function(n){return xi(n,t)}:En(t),n):i},n.frequency=function(e){return arguments.length?(t=!!e,n):t},n},ao.layout.pack=function(){function n(n,u){var o=e.call(this,n,u),a=o[0],l=i[0],c=i[1],f=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(a.x=a.y=0,oi(a,function(n){n.r=+f(n.value)}),oi(a,Ni),r){var s=r*(t?1:Math.max(2*a.r/l,2*a.r/c))/2;oi(a,function(n){n.r+=s}),oi(a,Ni),oi(a,function(n){n.r-=s})}return Ci(a,l/2,c/2,t?1:1/Math.max(2*a.r/l,2*a.r/c)),o}var t,e=ao.layout.hierarchy().sort(_i),r=0,i=[1,1];return n.size=function(t){return arguments.length?(i=t,n):i},n.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,n):t},n.padding=function(t){return arguments.length?(r=+t,n):r},ii(n,e)},ao.layout.tree=function(){function n(n,i){var f=o.call(this,n,i),s=f[0],h=t(s);if(oi(h,e),h.parent.m=-h.z,ui(h,r),c)ui(s,u);else{var p=s,g=s,v=s;ui(s,function(n){n.x<p.x&&(p=n),n.x>g.x&&(g=n),n.depth>v.depth&&(v=n)});var d=a(p,g)/2-p.x,y=l[0]/(g.x+a(g,p)/2+d),m=l[1]/(v.depth||1);ui(s,function(n){n.x=(n.x+d)*y,n.y=n.depth*m})}return f}function t(n){for(var t,e={A:null,children:[n]},r=[e];null!=(t=r.pop());)for(var i,u=t.children,o=0,a=u.length;a>o;++o)r.push((u[o]=i={_:u[o],parent:t,children:(i=u[o].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=i);return e.children[0]}function e(n){var t=n.children,e=n.parent.children,r=n.i?e[n.i-1]:null;if(t.length){Di(n);var u=(t[0].z+t[t.length-1].z)/2;r?(n.z=r.z+a(n._,r._),n.m=n.z-u):n.z=u}else r&&(n.z=r.z+a(n._,r._));n.parent.A=i(n,r,n.parent.A||e[0])}function r(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function i(n,t,e){if(t){for(var r,i=n,u=n,o=t,l=i.parent.children[0],c=i.m,f=u.m,s=o.m,h=l.m;o=Ti(o),i=qi(i),o&&i;)l=qi(l),u=Ti(u),u.a=n,r=o.z+s-i.z-c+a(o._,i._),r>0&&(Ri(Pi(o,n,e),n,r),c+=r,f+=r),s+=o.m,c+=i.m,h+=l.m,f+=u.m;o&&!Ti(u)&&(u.t=o,u.m+=s-f),i&&!qi(l)&&(l.t=i,l.m+=c-h,e=n)}return e}function u(n){n.x*=l[0],n.y=n.depth*l[1]}var o=ao.layout.hierarchy().sort(null).value(null),a=Li,l=[1,1],c=null;return n.separation=function(t){return arguments.length?(a=t,n):a},n.size=function(t){return arguments.length?(c=null==(l=t)?u:null,n):c?null:l},n.nodeSize=function(t){return arguments.length?(c=null==(l=t)?null:u,n):c?l:null},ii(n,o)},ao.layout.cluster=function(){function n(n,u){var o,a=t.call(this,n,u),l=a[0],c=0;oi(l,function(n){var t=n.children;t&&t.length?(n.x=ji(t),n.y=Ui(t)):(n.x=o?c+=e(n,o):0,n.y=0,o=n)});var f=Fi(l),s=Hi(l),h=f.x-e(f,s)/2,p=s.x+e(s,f)/2;return oi(l,i?function(n){n.x=(n.x-l.x)*r[0],n.y=(l.y-n.y)*r[1]}:function(n){n.x=(n.x-h)/(p-h)*r[0],n.y=(1-(l.y?n.y/l.y:1))*r[1]}),a}var t=ao.layout.hierarchy().sort(null).value(null),e=Li,r=[1,1],i=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(i=null==(r=t),n):i?null:r},n.nodeSize=function(t){return arguments.length?(i=null!=(r=t),n):i?r:null},ii(n,t)},ao.layout.treemap=function(){function n(n,t){for(var e,r,i=-1,u=n.length;++i<u;)r=(e=n[i]).value*(0>t?0:t),e.area=isNaN(r)||0>=r?0:r}function t(e){var u=e.children;if(u&&u.length){var o,a,l,c=s(e),f=[],h=u.slice(),g=1/0,v="slice"===p?c.dx:"dice"===p?c.dy:"slice-dice"===p?1&e.depth?c.dy:c.dx:Math.min(c.dx,c.dy);for(n(h,c.dx*c.dy/e.value),f.area=0;(l=h.length)>0;)f.push(o=h[l-1]),f.area+=o.area,"squarify"!==p||(a=r(f,v))<=g?(h.pop(),g=a):(f.area-=f.pop().area,i(f,v,c,!1),v=Math.min(c.dx,c.dy),f.length=f.area=0,g=1/0);f.length&&(i(f,v,c,!0),f.length=f.area=0),u.forEach(t)}}function e(t){var r=t.children;if(r&&r.length){var u,o=s(t),a=r.slice(),l=[];for(n(a,o.dx*o.dy/t.value),l.area=0;u=a.pop();)l.push(u),l.area+=u.area,null!=u.z&&(i(l,u.z?o.dx:o.dy,o,!a.length),l.length=l.area=0);r.forEach(e)}}function r(n,t){for(var e,r=n.area,i=0,u=1/0,o=-1,a=n.length;++o<a;)(e=n[o].area)&&(u>e&&(u=e),e>i&&(i=e));return r*=r,t*=t,r?Math.max(t*i*g/r,r/(t*u*g)):1/0}function i(n,t,e,r){var i,u=-1,o=n.length,a=e.x,c=e.y,f=t?l(n.area/t):0;
if(t==e.dx){for((r||f>e.dy)&&(f=e.dy);++u<o;)i=n[u],i.x=a,i.y=c,i.dy=f,a+=i.dx=Math.min(e.x+e.dx-a,f?l(i.area/f):0);i.z=!0,i.dx+=e.x+e.dx-a,e.y+=f,e.dy-=f}else{for((r||f>e.dx)&&(f=e.dx);++u<o;)i=n[u],i.x=a,i.y=c,i.dx=f,c+=i.dy=Math.min(e.y+e.dy-c,f?l(i.area/f):0);i.z=!1,i.dy+=e.y+e.dy-c,e.x+=f,e.dx-=f}}function u(r){var i=o||a(r),u=i[0];return u.x=u.y=0,u.value?(u.dx=c[0],u.dy=c[1]):u.dx=u.dy=0,o&&a.revalue(u),n([u],u.dx*u.dy/u.value),(o?e:t)(u),h&&(o=i),i}var o,a=ao.layout.hierarchy(),l=Math.round,c=[1,1],f=null,s=Oi,h=!1,p="squarify",g=.5*(1+Math.sqrt(5));return u.size=function(n){return arguments.length?(c=n,u):c},u.padding=function(n){function t(t){var e=n.call(u,t,t.depth);return null==e?Oi(t):Ii(t,"number"==typeof e?[e,e,e,e]:e)}function e(t){return Ii(t,n)}if(!arguments.length)return f;var r;return s=null==(f=n)?Oi:"function"==(r=typeof n)?t:"number"===r?(n=[n,n,n,n],e):e,u},u.round=function(n){return arguments.length?(l=n?Math.round:Number,u):l!=Number},u.sticky=function(n){return arguments.length?(h=n,o=null,u):h},u.ratio=function(n){return arguments.length?(g=n,u):g},u.mode=function(n){return arguments.length?(p=n+"",u):p},ii(u,a)},ao.random={normal:function(n,t){var e=arguments.length;return 2>e&&(t=1),1>e&&(n=0),function(){var e,r,i;do e=2*Math.random()-1,r=2*Math.random()-1,i=e*e+r*r;while(!i||i>1);return n+t*e*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var n=ao.random.normal.apply(ao,arguments);return function(){return Math.exp(n())}},bates:function(n){var t=ao.random.irwinHall(n);return function(){return t()/n}},irwinHall:function(n){return function(){for(var t=0,e=0;n>e;e++)t+=Math.random();return t}}},ao.scale={};var Sl={floor:m,ceil:m};ao.scale.linear=function(){return Wi([0,1],[0,1],Mr,!1)};var kl={s:1,g:1,p:1,r:1,e:1};ao.scale.log=function(){return ru(ao.scale.linear().domain([0,1]),10,!0,[1,10])};var Nl=ao.format(".0e"),El={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};ao.scale.pow=function(){return iu(ao.scale.linear(),1,[0,1])},ao.scale.sqrt=function(){return ao.scale.pow().exponent(.5)},ao.scale.ordinal=function(){return ou([],{t:"range",a:[[]]})},ao.scale.category10=function(){return ao.scale.ordinal().range(Al)},ao.scale.category20=function(){return ao.scale.ordinal().range(Cl)},ao.scale.category20b=function(){return ao.scale.ordinal().range(zl)},ao.scale.category20c=function(){return ao.scale.ordinal().range(Ll)};var Al=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(xn),Cl=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(xn),zl=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(xn),Ll=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(xn);ao.scale.quantile=function(){return au([],[])},ao.scale.quantize=function(){return lu(0,1,[0,1])},ao.scale.threshold=function(){return cu([.5],[0,1])},ao.scale.identity=function(){return fu([0,1])},ao.svg={},ao.svg.arc=function(){function n(){var n=Math.max(0,+e.apply(this,arguments)),c=Math.max(0,+r.apply(this,arguments)),f=o.apply(this,arguments)-Io,s=a.apply(this,arguments)-Io,h=Math.abs(s-f),p=f>s?0:1;if(n>c&&(g=c,c=n,n=g),h>=Oo)return t(c,p)+(n?t(n,1-p):"")+"Z";var g,v,d,y,m,M,x,b,_,w,S,k,N=0,E=0,A=[];if((y=(+l.apply(this,arguments)||0)/2)&&(d=u===ql?Math.sqrt(n*n+c*c):+u.apply(this,arguments),p||(E*=-1),c&&(E=tn(d/c*Math.sin(y))),n&&(N=tn(d/n*Math.sin(y)))),c){m=c*Math.cos(f+E),M=c*Math.sin(f+E),x=c*Math.cos(s-E),b=c*Math.sin(s-E);var C=Math.abs(s-f-2*E)<=Fo?0:1;if(E&&yu(m,M,x,b)===p^C){var z=(f+s)/2;m=c*Math.cos(z),M=c*Math.sin(z),x=b=null}}else m=M=0;if(n){_=n*Math.cos(s-N),w=n*Math.sin(s-N),S=n*Math.cos(f+N),k=n*Math.sin(f+N);var L=Math.abs(f-s+2*N)<=Fo?0:1;if(N&&yu(_,w,S,k)===1-p^L){var q=(f+s)/2;_=n*Math.cos(q),w=n*Math.sin(q),S=k=null}}else _=w=0;if(h>Uo&&(g=Math.min(Math.abs(c-n)/2,+i.apply(this,arguments)))>.001){v=c>n^p?0:1;var T=g,R=g;if(Fo>h){var D=null==S?[_,w]:null==x?[m,M]:Re([m,M],[S,k],[x,b],[_,w]),P=m-D[0],U=M-D[1],j=x-D[0],F=b-D[1],H=1/Math.sin(Math.acos((P*j+U*F)/(Math.sqrt(P*P+U*U)*Math.sqrt(j*j+F*F)))/2),O=Math.sqrt(D[0]*D[0]+D[1]*D[1]);R=Math.min(g,(n-O)/(H-1)),T=Math.min(g,(c-O)/(H+1))}if(null!=x){var I=mu(null==S?[_,w]:[S,k],[m,M],c,T,p),Y=mu([x,b],[_,w],c,T,p);g===T?A.push("M",I[0],"A",T,",",T," 0 0,",v," ",I[1],"A",c,",",c," 0 ",1-p^yu(I[1][0],I[1][1],Y[1][0],Y[1][1]),",",p," ",Y[1],"A",T,",",T," 0 0,",v," ",Y[0]):A.push("M",I[0],"A",T,",",T," 0 1,",v," ",Y[0])}else A.push("M",m,",",M);if(null!=S){var Z=mu([m,M],[S,k],n,-R,p),V=mu([_,w],null==x?[m,M]:[x,b],n,-R,p);g===R?A.push("L",V[0],"A",R,",",R," 0 0,",v," ",V[1],"A",n,",",n," 0 ",p^yu(V[1][0],V[1][1],Z[1][0],Z[1][1]),",",1-p," ",Z[1],"A",R,",",R," 0 0,",v," ",Z[0]):A.push("L",V[0],"A",R,",",R," 0 0,",v," ",Z[0])}else A.push("L",_,",",w)}else A.push("M",m,",",M),null!=x&&A.push("A",c,",",c," 0 ",C,",",p," ",x,",",b),A.push("L",_,",",w),null!=S&&A.push("A",n,",",n," 0 ",L,",",1-p," ",S,",",k);return A.push("Z"),A.join("")}function t(n,t){return"M0,"+n+"A"+n+","+n+" 0 1,"+t+" 0,"+-n+"A"+n+","+n+" 0 1,"+t+" 0,"+n}var e=hu,r=pu,i=su,u=ql,o=gu,a=vu,l=du;return n.innerRadius=function(t){return arguments.length?(e=En(t),n):e},n.outerRadius=function(t){return arguments.length?(r=En(t),n):r},n.cornerRadius=function(t){return arguments.length?(i=En(t),n):i},n.padRadius=function(t){return arguments.length?(u=t==ql?ql:En(t),n):u},n.startAngle=function(t){return arguments.length?(o=En(t),n):o},n.endAngle=function(t){return arguments.length?(a=En(t),n):a},n.padAngle=function(t){return arguments.length?(l=En(t),n):l},n.centroid=function(){var n=(+e.apply(this,arguments)+ +r.apply(this,arguments))/2,t=(+o.apply(this,arguments)+ +a.apply(this,arguments))/2-Io;return[Math.cos(t)*n,Math.sin(t)*n]},n};var ql="auto";ao.svg.line=function(){return Mu(m)};var Tl=ao.map({linear:xu,"linear-closed":bu,step:_u,"step-before":wu,"step-after":Su,basis:zu,"basis-open":Lu,"basis-closed":qu,bundle:Tu,cardinal:Eu,"cardinal-open":ku,"cardinal-closed":Nu,monotone:Fu});Tl.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var Rl=[0,2/3,1/3,0],Dl=[0,1/3,2/3,0],Pl=[0,1/6,2/3,1/6];ao.svg.line.radial=function(){var n=Mu(Hu);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},wu.reverse=Su,Su.reverse=wu,ao.svg.area=function(){return Ou(m)},ao.svg.area.radial=function(){var n=Ou(Hu);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},ao.svg.chord=function(){function n(n,a){var l=t(this,u,n,a),c=t(this,o,n,a);return"M"+l.p0+r(l.r,l.p1,l.a1-l.a0)+(e(l,c)?i(l.r,l.p1,l.r,l.p0):i(l.r,l.p1,c.r,c.p0)+r(c.r,c.p1,c.a1-c.a0)+i(c.r,c.p1,l.r,l.p0))+"Z"}function t(n,t,e,r){var i=t.call(n,e,r),u=a.call(n,i,r),o=l.call(n,i,r)-Io,f=c.call(n,i,r)-Io;return{r:u,a0:o,a1:f,p0:[u*Math.cos(o),u*Math.sin(o)],p1:[u*Math.cos(f),u*Math.sin(f)]}}function e(n,t){return n.a0==t.a0&&n.a1==t.a1}function r(n,t,e){return"A"+n+","+n+" 0 "+ +(e>Fo)+",1 "+t}function i(n,t,e,r){return"Q 0,0 "+r}var u=Me,o=xe,a=Iu,l=gu,c=vu;return n.radius=function(t){return arguments.length?(a=En(t),n):a},n.source=function(t){return arguments.length?(u=En(t),n):u},n.target=function(t){return arguments.length?(o=En(t),n):o},n.startAngle=function(t){return arguments.length?(l=En(t),n):l},n.endAngle=function(t){return arguments.length?(c=En(t),n):c},n},ao.svg.diagonal=function(){function n(n,i){var u=t.call(this,n,i),o=e.call(this,n,i),a=(u.y+o.y)/2,l=[u,{x:u.x,y:a},{x:o.x,y:a},o];return l=l.map(r),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var t=Me,e=xe,r=Yu;return n.source=function(e){return arguments.length?(t=En(e),n):t},n.target=function(t){return arguments.length?(e=En(t),n):e},n.projection=function(t){return arguments.length?(r=t,n):r},n},ao.svg.diagonal.radial=function(){var n=ao.svg.diagonal(),t=Yu,e=n.projection;return n.projection=function(n){return arguments.length?e(Zu(t=n)):t},n},ao.svg.symbol=function(){function n(n,r){return(Ul.get(t.call(this,n,r))||$u)(e.call(this,n,r))}var t=Xu,e=Vu;return n.type=function(e){return arguments.length?(t=En(e),n):t},n.size=function(t){return arguments.length?(e=En(t),n):e},n};var Ul=ao.map({circle:$u,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*Fl)),e=t*Fl;return"M0,"+-t+"L"+e+",0 0,"+t+" "+-e+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/jl),e=t*jl/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/jl),e=t*jl/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});ao.svg.symbolTypes=Ul.keys();var jl=Math.sqrt(3),Fl=Math.tan(30*Yo);Co.transition=function(n){for(var t,e,r=Hl||++Zl,i=Ku(n),u=[],o=Ol||{time:Date.now(),ease:Nr,delay:0,duration:250},a=-1,l=this.length;++a<l;){u.push(t=[]);for(var c=this[a],f=-1,s=c.length;++f<s;)(e=c[f])&&Qu(e,f,i,r,o),t.push(e)}return Wu(u,i,r)},Co.interrupt=function(n){return this.each(null==n?Il:Bu(Ku(n)))};var Hl,Ol,Il=Bu(Ku()),Yl=[],Zl=0;Yl.call=Co.call,Yl.empty=Co.empty,Yl.node=Co.node,Yl.size=Co.size,ao.transition=function(n,t){return n&&n.transition?Hl?n.transition(t):n:ao.selection().transition(n)},ao.transition.prototype=Yl,Yl.select=function(n){var t,e,r,i=this.id,u=this.namespace,o=[];n=A(n);for(var a=-1,l=this.length;++a<l;){o.push(t=[]);for(var c=this[a],f=-1,s=c.length;++f<s;)(r=c[f])&&(e=n.call(r,r.__data__,f,a))?("__data__"in r&&(e.__data__=r.__data__),Qu(e,f,u,i,r[u][i]),t.push(e)):t.push(null)}return Wu(o,u,i)},Yl.selectAll=function(n){var t,e,r,i,u,o=this.id,a=this.namespace,l=[];n=C(n);for(var c=-1,f=this.length;++c<f;)for(var s=this[c],h=-1,p=s.length;++h<p;)if(r=s[h]){u=r[a][o],e=n.call(r,r.__data__,h,c),l.push(t=[]);for(var g=-1,v=e.length;++g<v;)(i=e[g])&&Qu(i,g,a,o,u),t.push(i)}return Wu(l,a,o)},Yl.filter=function(n){var t,e,r,i=[];"function"!=typeof n&&(n=O(n));for(var u=0,o=this.length;o>u;u++){i.push(t=[]);for(var e=this[u],a=0,l=e.length;l>a;a++)(r=e[a])&&n.call(r,r.__data__,a,u)&&t.push(r)}return Wu(i,this.namespace,this.id)},Yl.tween=function(n,t){var e=this.id,r=this.namespace;return arguments.length<2?this.node()[r][e].tween.get(n):Y(this,null==t?function(t){t[r][e].tween.remove(n)}:function(i){i[r][e].tween.set(n,t)})},Yl.attr=function(n,t){function e(){this.removeAttribute(a)}function r(){this.removeAttributeNS(a.space,a.local)}function i(n){return null==n?e:(n+="",function(){var t,e=this.getAttribute(a);return e!==n&&(t=o(e,n),function(n){this.setAttribute(a,t(n))})})}function u(n){return null==n?r:(n+="",function(){var t,e=this.getAttributeNS(a.space,a.local);return e!==n&&(t=o(e,n),function(n){this.setAttributeNS(a.space,a.local,t(n))})})}if(arguments.length<2){for(t in n)this.attr(t,n[t]);return this}var o="transform"==n?$r:Mr,a=ao.ns.qualify(n);return Ju(this,"attr."+n,t,a.local?u:i)},Yl.attrTween=function(n,t){function e(n,e){var r=t.call(this,n,e,this.getAttribute(i));return r&&function(n){this.setAttribute(i,r(n))}}function r(n,e){var r=t.call(this,n,e,this.getAttributeNS(i.space,i.local));return r&&function(n){this.setAttributeNS(i.space,i.local,r(n))}}var i=ao.ns.qualify(n);return this.tween("attr."+n,i.local?r:e)},Yl.style=function(n,e,r){function i(){this.style.removeProperty(n)}function u(e){return null==e?i:(e+="",function(){var i,u=t(this).getComputedStyle(this,null).getPropertyValue(n);return u!==e&&(i=Mr(u,e),function(t){this.style.setProperty(n,i(t),r)})})}var o=arguments.length;if(3>o){if("string"!=typeof n){2>o&&(e="");for(r in n)this.style(r,n[r],e);return this}r=""}return Ju(this,"style."+n,e,u)},Yl.styleTween=function(n,e,r){function i(i,u){var o=e.call(this,i,u,t(this).getComputedStyle(this,null).getPropertyValue(n));return o&&function(t){this.style.setProperty(n,o(t),r)}}return arguments.length<3&&(r=""),this.tween("style."+n,i)},Yl.text=function(n){return Ju(this,"text",n,Gu)},Yl.remove=function(){var n=this.namespace;return this.each("end.transition",function(){var t;this[n].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Yl.ease=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].ease:("function"!=typeof n&&(n=ao.ease.apply(ao,arguments)),Y(this,function(r){r[e][t].ease=n}))},Yl.delay=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].delay:Y(this,"function"==typeof n?function(r,i,u){r[e][t].delay=+n.call(r,r.__data__,i,u)}:(n=+n,function(r){r[e][t].delay=n}))},Yl.duration=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].duration:Y(this,"function"==typeof n?function(r,i,u){r[e][t].duration=Math.max(1,n.call(r,r.__data__,i,u))}:(n=Math.max(1,n),function(r){r[e][t].duration=n}))},Yl.each=function(n,t){var e=this.id,r=this.namespace;if(arguments.length<2){var i=Ol,u=Hl;try{Hl=e,Y(this,function(t,i,u){Ol=t[r][e],n.call(t,t.__data__,i,u)})}finally{Ol=i,Hl=u}}else Y(this,function(i){var u=i[r][e];(u.event||(u.event=ao.dispatch("start","end","interrupt"))).on(n,t)});return this},Yl.transition=function(){for(var n,t,e,r,i=this.id,u=++Zl,o=this.namespace,a=[],l=0,c=this.length;c>l;l++){a.push(n=[]);for(var t=this[l],f=0,s=t.length;s>f;f++)(e=t[f])&&(r=e[o][i],Qu(e,f,o,u,{time:r.time,ease:r.ease,delay:r.delay+r.duration,duration:r.duration})),n.push(e)}return Wu(a,o,u)},ao.svg.axis=function(){function n(n){n.each(function(){var n,c=ao.select(this),f=this.__chart__||e,s=this.__chart__=e.copy(),h=null==l?s.ticks?s.ticks.apply(s,a):s.domain():l,p=null==t?s.tickFormat?s.tickFormat.apply(s,a):m:t,g=c.selectAll(".tick").data(h,s),v=g.enter().insert("g",".domain").attr("class","tick").style("opacity",Uo),d=ao.transition(g.exit()).style("opacity",Uo).remove(),y=ao.transition(g.order()).style("opacity",1),M=Math.max(i,0)+o,x=Zi(s),b=c.selectAll(".domain").data([0]),_=(b.enter().append("path").attr("class","domain"),ao.transition(b));v.append("line"),v.append("text");var w,S,k,N,E=v.select("line"),A=y.select("line"),C=g.select("text").text(p),z=v.select("text"),L=y.select("text"),q="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(n=no,w="x",k="y",S="x2",N="y2",C.attr("dy",0>q?"0em":".71em").style("text-anchor","middle"),_.attr("d","M"+x[0]+","+q*u+"V0H"+x[1]+"V"+q*u)):(n=to,w="y",k="x",S="y2",N="x2",C.attr("dy",".32em").style("text-anchor",0>q?"end":"start"),_.attr("d","M"+q*u+","+x[0]+"H0V"+x[1]+"H"+q*u)),E.attr(N,q*i),z.attr(k,q*M),A.attr(S,0).attr(N,q*i),L.attr(w,0).attr(k,q*M),s.rangeBand){var T=s,R=T.rangeBand()/2;f=s=function(n){return T(n)+R}}else f.rangeBand?f=s:d.call(n,s,f);v.call(n,f,s),y.call(n,s,s)})}var t,e=ao.scale.linear(),r=Vl,i=6,u=6,o=3,a=[10],l=null;return n.scale=function(t){return arguments.length?(e=t,n):e},n.orient=function(t){return arguments.length?(r=t in Xl?t+"":Vl,n):r},n.ticks=function(){return arguments.length?(a=co(arguments),n):a},n.tickValues=function(t){return arguments.length?(l=t,n):l},n.tickFormat=function(e){return arguments.length?(t=e,n):t},n.tickSize=function(t){var e=arguments.length;return e?(i=+t,u=+arguments[e-1],n):i},n.innerTickSize=function(t){return arguments.length?(i=+t,n):i},n.outerTickSize=function(t){return arguments.length?(u=+t,n):u},n.tickPadding=function(t){return arguments.length?(o=+t,n):o},n.tickSubdivide=function(){return arguments.length&&n},n};var Vl="bottom",Xl={top:1,right:1,bottom:1,left:1};ao.svg.brush=function(){function n(t){t.each(function(){var t=ao.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",u).on("touchstart.brush",u),o=t.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=t.selectAll(".resize").data(v,m);a.exit().remove(),a.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return $l[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",n.empty()?"none":null);var l,s=ao.transition(t),h=ao.transition(o);c&&(l=Zi(c),h.attr("x",l[0]).attr("width",l[1]-l[0]),r(s)),f&&(l=Zi(f),h.attr("y",l[0]).attr("height",l[1]-l[0]),i(s)),e(s)})}function e(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+s[+/e$/.test(n)]+","+h[+/^s/.test(n)]+")"})}function r(n){n.select(".extent").attr("x",s[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",s[1]-s[0])}function i(n){n.select(".extent").attr("y",h[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function u(){function u(){32==ao.event.keyCode&&(C||(M=null,L[0]-=s[1],L[1]-=h[1],C=2),S())}function v(){32==ao.event.keyCode&&2==C&&(L[0]+=s[1],L[1]+=h[1],C=0,S())}function d(){var n=ao.mouse(b),t=!1;x&&(n[0]+=x[0],n[1]+=x[1]),C||(ao.event.altKey?(M||(M=[(s[0]+s[1])/2,(h[0]+h[1])/2]),L[0]=s[+(n[0]<M[0])],L[1]=h[+(n[1]<M[1])]):M=null),E&&y(n,c,0)&&(r(k),t=!0),A&&y(n,f,1)&&(i(k),t=!0),t&&(e(k),w({type:"brush",mode:C?"move":"resize"}))}function y(n,t,e){var r,i,u=Zi(t),l=u[0],c=u[1],f=L[e],v=e?h:s,d=v[1]-v[0];return C&&(l-=f,c-=d+f),r=(e?g:p)?Math.max(l,Math.min(c,n[e])):n[e],C?i=(r+=f)+d:(M&&(f=Math.max(l,Math.min(c,2*M[e]-r))),r>f?(i=r,r=f):i=f),v[0]!=r||v[1]!=i?(e?a=null:o=null,v[0]=r,v[1]=i,!0):void 0}function m(){d(),k.style("pointer-events","all").selectAll(".resize").style("display",n.empty()?"none":null),ao.select("body").style("cursor",null),q.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),z(),w({type:"brushend"})}var M,x,b=this,_=ao.select(ao.event.target),w=l.of(b,arguments),k=ao.select(b),N=_.datum(),E=!/^(n|s)$/.test(N)&&c,A=!/^(e|w)$/.test(N)&&f,C=_.classed("extent"),z=W(b),L=ao.mouse(b),q=ao.select(t(b)).on("keydown.brush",u).on("keyup.brush",v);if(ao.event.changedTouches?q.on("touchmove.brush",d).on("touchend.brush",m):q.on("mousemove.brush",d).on("mouseup.brush",m),k.interrupt().selectAll("*").interrupt(),C)L[0]=s[0]-L[0],L[1]=h[0]-L[1];else if(N){var T=+/w$/.test(N),R=+/^n/.test(N);x=[s[1-T]-L[0],h[1-R]-L[1]],L[0]=s[T],L[1]=h[R]}else ao.event.altKey&&(M=L.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null),ao.select("body").style("cursor",_.style("cursor")),w({type:"brushstart"}),d()}var o,a,l=N(n,"brushstart","brush","brushend"),c=null,f=null,s=[0,0],h=[0,0],p=!0,g=!0,v=Bl[0];return n.event=function(n){n.each(function(){var n=l.of(this,arguments),t={x:s,y:h,i:o,j:a},e=this.__chart__||t;this.__chart__=t,Hl?ao.select(this).transition().each("start.brush",function(){o=e.i,a=e.j,s=e.x,h=e.y,n({type:"brushstart"})}).tween("brush:brush",function(){var e=xr(s,t.x),r=xr(h,t.y);return o=a=null,function(i){s=t.x=e(i),h=t.y=r(i),n({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=t.i,a=t.j,n({type:"brush",mode:"resize"}),n({type:"brushend"})}):(n({type:"brushstart"}),n({type:"brush",mode:"resize"}),n({type:"brushend"}))})},n.x=function(t){return arguments.length?(c=t,v=Bl[!c<<1|!f],n):c},n.y=function(t){return arguments.length?(f=t,v=Bl[!c<<1|!f],n):f},n.clamp=function(t){return arguments.length?(c&&f?(p=!!t[0],g=!!t[1]):c?p=!!t:f&&(g=!!t),n):c&&f?[p,g]:c?p:f?g:null},n.extent=function(t){var e,r,i,u,l;return arguments.length?(c&&(e=t[0],r=t[1],f&&(e=e[0],r=r[0]),o=[e,r],c.invert&&(e=c(e),r=c(r)),e>r&&(l=e,e=r,r=l),e==s[0]&&r==s[1]||(s=[e,r])),f&&(i=t[0],u=t[1],c&&(i=i[1],u=u[1]),a=[i,u],f.invert&&(i=f(i),u=f(u)),i>u&&(l=i,i=u,u=l),i==h[0]&&u==h[1]||(h=[i,u])),n):(c&&(o?(e=o[0],r=o[1]):(e=s[0],r=s[1],c.invert&&(e=c.invert(e),r=c.invert(r)),e>r&&(l=e,e=r,r=l))),f&&(a?(i=a[0],u=a[1]):(i=h[0],u=h[1],f.invert&&(i=f.invert(i),u=f.invert(u)),i>u&&(l=i,i=u,u=l))),c&&f?[[e,i],[r,u]]:c?[e,r]:f&&[i,u])},n.clear=function(){return n.empty()||(s=[0,0],h=[0,0],o=a=null),n},n.empty=function(){return!!c&&s[0]==s[1]||!!f&&h[0]==h[1]},ao.rebind(n,l,"on")};var $l={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Bl=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Wl=ga.format=xa.timeFormat,Jl=Wl.utc,Gl=Jl("%Y-%m-%dT%H:%M:%S.%LZ");Wl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?eo:Gl,eo.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},eo.toString=Gl.toString,ga.second=On(function(n){return new va(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),ga.seconds=ga.second.range,ga.seconds.utc=ga.second.utc.range,ga.minute=On(function(n){return new va(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),ga.minutes=ga.minute.range,ga.minutes.utc=ga.minute.utc.range,ga.hour=On(function(n){var t=n.getTimezoneOffset()/60;return new va(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),ga.hours=ga.hour.range,ga.hours.utc=ga.hour.utc.range,ga.month=On(function(n){return n=ga.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),ga.months=ga.month.range,ga.months.utc=ga.month.utc.range;var Kl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Ql=[[ga.second,1],[ga.second,5],[ga.second,15],[ga.second,30],[ga.minute,1],[ga.minute,5],[ga.minute,15],[ga.minute,30],[ga.hour,1],[ga.hour,3],[ga.hour,6],[ga.hour,12],[ga.day,1],[ga.day,2],[ga.week,1],[ga.month,1],[ga.month,3],[ga.year,1]],nc=Wl.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&1!=n.getDate()}],["%b %d",function(n){return 1!=n.getDate()}],["%B",function(n){return n.getMonth()}],["%Y",zt]]),tc={range:function(n,t,e){return ao.range(Math.ceil(n/e)*e,+t,e).map(io)},floor:m,ceil:m};Ql.year=ga.year,ga.scale=function(){return ro(ao.scale.linear(),Ql,nc)};var ec=Ql.map(function(n){return[n[0].utc,n[1]]}),rc=Jl.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],["%b %d",function(n){return 1!=n.getUTCDate()}],["%B",function(n){return n.getUTCMonth()}],["%Y",zt]]);ec.year=ga.year.utc,ga.scale.utc=function(){return ro(ao.scale.linear(),ec,rc)},ao.text=An(function(n){return n.responseText}),ao.json=function(n,t){return Cn(n,"application/json",uo,t)},ao.html=function(n,t){return Cn(n,"text/html",oo,t)},ao.xml=An(function(n){return n.responseXML}),"function"==typeof define&&define.amd?(this.d3=ao,define(ao)):"object"==typeof module&&module.exports?module.exports=ao:this.d3=ao}();</script>
<script>!function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[i]={exports:{}};t[i][0].call(c.exports,(function(e){return a(t[i][1][e]||e)}),c,c.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){"use strict";n.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},n.toByteArray=function(e){for(var t,n=u(e),r=n[0],i=n[1],s=new o(function(e,t,n){return 3*(t+n)/4-n}(0,r,i)),l=0,c=i>0?r-4:r,d=0;d<c;d+=4)t=a[e.charCodeAt(d)]<<18|a[e.charCodeAt(d+1)]<<12|a[e.charCodeAt(d+2)]<<6|a[e.charCodeAt(d+3)],s[l++]=t>>16&255,s[l++]=t>>8&255,s[l++]=255&t;2===i&&(t=a[e.charCodeAt(d)]<<2|a[e.charCodeAt(d+1)]>>4,s[l++]=255&t);1===i&&(t=a[e.charCodeAt(d)]<<10|a[e.charCodeAt(d+1)]<<4|a[e.charCodeAt(d+2)]>>2,s[l++]=t>>8&255,s[l++]=255&t);return s},n.fromByteArray=function(e){for(var t,n=e.length,a=n%3,o=[],i=0,s=n-a;i<s;i+=16383)o.push(c(e,i,i+16383>s?s:i+16383));1===a?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===a&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],a=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=i.length;s<l;++s)r[s]=i[s],a[i.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var a,o,i=[],s=t;s<n;s+=3)a=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(r[(o=a)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return i.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},{}],2:[function(e,t,n){"use strict";function r(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}n.INT_BITS=32,n.INT_MAX=2147483647,n.INT_MIN=-1<<31,n.sign=function(e){return(e>0)-(e<0)},n.abs=function(e){var t=e>>31;return(e^t)-t},n.min=function(e,t){return t^(e^t)&-(e<t)},n.max=function(e,t){return e^(e^t)&-(e<t)},n.isPow2=function(e){return!(e&e-1||!e)},n.log2=function(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1},n.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},n.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},n.countTrailingZeros=r,n.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},n.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},n.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var a=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,a=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--a;e[t]=r<<a&255}}(a),n.reverse=function(e){return a[255&e]<<24|a[e>>>8&255]<<16|a[e>>>16&255]<<8|a[e>>>24&255]},n.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},n.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},n.interleave3=function(e,t,n){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},n.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},n.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>r(e)+1}},{}],3:[function(e,t,n){(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
"use strict";var r=e("base64-js"),a=e("ieee754");n.Buffer=t,n.SlowBuffer=function(e){+e!=e&&(e=0);return t.alloc(+e)},n.INSPECT_MAX_BYTES=50;function o(e){if(e>2147483647)throw new RangeError('The value "'+e+'" is invalid for option "size"');var n=new Uint8Array(e);return n.__proto__=t.prototype,n}function t(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return l(e)}return i(e,t,n)}function i(e,n,r){if("string"==typeof e)return function(e,n){"string"==typeof n&&""!==n||(n="utf8");if(!t.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var r=0|d(e,n),a=o(r),i=a.write(e,n);i!==r&&(a=a.slice(0,i));return a}(e,n);if(ArrayBuffer.isView(e))return u(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(V(e,ArrayBuffer)||e&&V(e.buffer,ArrayBuffer))return function(e,n,r){if(n<0||e.byteLength<n)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<n+(r||0))throw new RangeError('"length" is outside of buffer bounds');var a;a=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);return a.__proto__=t.prototype,a}(e,n,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var a=e.valueOf&&e.valueOf();if(null!=a&&a!==e)return t.from(a,n,r);var i=function(e){if(t.isBuffer(e)){var n=0|c(e.length),r=o(n);return 0===r.length||e.copy(r,0,0,n),r}if(void 0!==e.length)return"number"!=typeof e.length||D(e.length)?o(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return t.from(e[Symbol.toPrimitive]("string"),n,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function l(e){return s(e),o(e<0?0:0|c(e))}function u(e){for(var t=e.length<0?0:0|c(e.length),n=o(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function c(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|e}function d(e,n){if(t.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||V(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,a=arguments.length>2&&!0===arguments[2];if(!a&&0===r)return 0;for(var o=!1;;)switch(n){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return I(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return C(e).length;default:if(o)return a?-1:I(e).length;n=(""+n).toLowerCase(),o=!0}}function f(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,n);case"utf8":case"utf-8":return _(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return z(this,t,n);case"base64":return w(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function p(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function h(e,n,r,a,o){if(0===e.length)return-1;if("string"==typeof r?(a=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),D(r=+r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof n&&(n=t.from(n,a)),t.isBuffer(n))return 0===n.length?-1:v(e,n,r,a,o);if("number"==typeof n)return n&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,n,r):Uint8Array.prototype.lastIndexOf.call(e,n,r):v(e,[n],r,a,o);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,a){var o,i=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;i=2,s/=2,l/=2,n/=2}function u(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(a){var c=-1;for(o=n;o<s;o++)if(u(e,o)===u(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*i}else-1!==c&&(o-=o-c),c=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var d=!0,f=0;f<l;f++)if(u(e,o+f)!==u(t,f)){d=!1;break}if(d)return o}return-1}function g(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r))>a&&(r=a):r=a;var o=t.length;r>o/2&&(r=o/2);for(var i=0;i<r;++i){var s=parseInt(t.substr(2*i,2),16);if(D(s))return i;e[n+i]=s}return i}function m(e,t,n,r){return q(I(t,e.length-n),e,n,r)}function y(e,t,n,r){return q(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function x(e,t,n,r){return y(e,t,n,r)}function b(e,t,n,r){return q(C(t),e,n,r)}function j(e,t,n,r){return q(function(e,t){for(var n,r,a,o=[],i=0;i<e.length&&!((t-=2)<0);++i)n=e.charCodeAt(i),r=n>>8,a=n%256,o.push(a),o.push(r);return o}(t,e.length-n),e,n,r)}function w(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function _(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var o,i,s,l,u=e[a],c=null,d=u>239?4:u>223?3:u>191?2:1;if(a+d<=n)switch(d){case 1:u<128&&(c=u);break;case 2:128==(192&(o=e[a+1]))&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=e[a+1],i=e[a+2],128==(192&o)&&128==(192&i)&&(l=(15&u)<<12|(63&o)<<6|63&i)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=e[a+1],i=e[a+2],s=e[a+3],128==(192&o)&&128==(192&i)&&128==(192&s)&&(l=(15&u)<<18|(63&o)<<12|(63&i)<<6|63&s)>65535&&l<1114112&&(c=l)}null===c?(c=65533,d=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),a+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}n.kMaxLength=2147483647,t.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),t.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(t.prototype,"parent",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.buffer}}),Object.defineProperty(t.prototype,"offset",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),t.poolSize=8192,t.from=function(e,t,n){return i(e,t,n)},t.prototype.__proto__=Uint8Array.prototype,t.__proto__=Uint8Array,t.alloc=function(e,t,n){return function(e,t,n){return s(e),e<=0?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)}(e,t,n)},t.allocUnsafe=function(e){return l(e)},t.allocUnsafeSlow=function(e){return l(e)},t.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==t.prototype},t.compare=function(e,n){if(V(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),V(n,Uint8Array)&&(n=t.from(n,n.offset,n.byteLength)),!t.isBuffer(e)||!t.isBuffer(n))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===n)return 0;for(var r=e.length,a=n.length,o=0,i=Math.min(r,a);o<i;++o)if(e[o]!==n[o]){r=e[o],a=n[o];break}return r<a?-1:a<r?1:0},t.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,n){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return t.alloc(0);var r;if(void 0===n)for(n=0,r=0;r<e.length;++r)n+=e[r].length;var a=t.allocUnsafe(n),o=0;for(r=0;r<e.length;++r){var i=e[r];if(V(i,Uint8Array)&&(i=t.from(i)),!t.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(a,o),o+=i.length}return a},t.byteLength=d,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},t.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},t.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},t.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?_(this,0,e):f.apply(this,arguments)},t.prototype.toLocaleString=t.prototype.toString,t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===t.compare(this,e)},t.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},t.prototype.compare=function(e,n,r,a,o){if(V(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),!t.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===n&&(n=0),void 0===r&&(r=e?e.length:0),void 0===a&&(a=0),void 0===o&&(o=this.length),n<0||r>e.length||a<0||o>this.length)throw new RangeError("out of range index");if(a>=o&&n>=r)return 0;if(a>=o)return-1;if(n>=r)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(a>>>=0),s=(r>>>=0)-(n>>>=0),l=Math.min(i,s),u=this.slice(a,o),c=e.slice(n,r),d=0;d<l;++d)if(u[d]!==c[d]){i=u[d],s=c[d];break}return i<s?-1:s<i?1:0},t.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},t.prototype.indexOf=function(e,t,n){return h(this,e,t,n,!0)},t.prototype.lastIndexOf=function(e,t,n){return h(this,e,t,n,!1)},t.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return g(this,e,t,n);case"utf8":case"utf-8":return m(this,e,t,n);case"ascii":return y(this,e,t,n);case"latin1":case"binary":return x(this,e,t,n);case"base64":return b(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function k(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}function z(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}function A(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var a="",o=t;o<n;++o)a+=N(e[o]);return a}function M(e,t,n){for(var r=e.slice(t,n),a="",o=0;o<r.length;o+=2)a+=String.fromCharCode(r[o]+256*r[o+1]);return a}function O(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function F(e,n,r,a,o,i){if(!t.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>o||n<i)throw new RangeError('"value" argument is out of bounds');if(r+a>e.length)throw new RangeError("Index out of range")}function E(e,t,n,r,a,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function S(e,t,n,r,o){return t=+t,n>>>=0,o||E(e,0,n,4),a.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,o){return t=+t,n>>>=0,o||E(e,0,n,8),a.write(e,t,n,r,52,8),n+8}t.prototype.slice=function(e,n){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(n=void 0===n?r:~~n)<0?(n+=r)<0&&(n=0):n>r&&(n=r),n<e&&(n=e);var a=this.subarray(e,n);return a.__proto__=t.prototype,a},t.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e],a=1,o=0;++o<t&&(a*=256);)r+=this[e+o]*a;return r},t.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e+--t],a=1;t>0&&(a*=256);)r+=this[e+--t]*a;return r},t.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},t.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},t.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},t.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},t.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},t.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=this[e],a=1,o=0;++o<t&&(a*=256);)r+=this[e+o]*a;return r>=(a*=128)&&(r-=Math.pow(2,8*t)),r},t.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||O(e,t,this.length);for(var r=t,a=1,o=this[e+--r];r>0&&(a*=256);)o+=this[e+--r]*a;return o>=(a*=128)&&(o-=Math.pow(2,8*t)),o},t.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},t.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},t.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},t.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},t.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},t.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),a.read(this,e,!0,23,4)},t.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),a.read(this,e,!1,23,4)},t.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),a.read(this,e,!0,52,8)},t.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),a.read(this,e,!1,52,8)},t.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||F(this,e,t,n,Math.pow(2,8*n)-1,0);var a=1,o=0;for(this[t]=255&e;++o<n&&(a*=256);)this[t+o]=e/a&255;return t+n},t.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||F(this,e,t,n,Math.pow(2,8*n)-1,0);var a=n-1,o=1;for(this[t+a]=255&e;--a>=0&&(o*=256);)this[t+a]=e/o&255;return t+n},t.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,1,255,0),this[t]=255&e,t+1},t.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},t.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var a=Math.pow(2,8*n-1);F(this,e,t,n,a-1,-a)}var o=0,i=1,s=0;for(this[t]=255&e;++o<n&&(i*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+n},t.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var a=Math.pow(2,8*n-1);F(this,e,t,n,a-1,-a)}var o=n-1,i=1,s=0;for(this[t+o]=255&e;--o>=0&&(i*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+n},t.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},t.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},t.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeFloatLE=function(e,t,n){return S(this,e,t,!0,n)},t.prototype.writeFloatBE=function(e,t,n){return S(this,e,t,!1,n)},t.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},t.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},t.prototype.copy=function(e,n,r,a){if(!t.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),a||0===a||(a=this.length),n>=e.length&&(n=e.length),n||(n=0),a>0&&a<r&&(a=r),a===r)return 0;if(0===e.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-n<a-r&&(a=e.length-n+r);var o=a-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(n,r,a);else if(this===e&&r<n&&n<a)for(var i=o-1;i>=0;--i)e[i+n]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,a),n);return o},t.prototype.fill=function(e,n,r,a){if("string"==typeof e){if("string"==typeof n?(a=n,n=0,r=this.length):"string"==typeof r&&(a=r,r=this.length),void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!t.isEncoding(a))throw new TypeError("Unknown encoding: "+a);if(1===e.length){var o=e.charCodeAt(0);("utf8"===a&&o<128||"latin1"===a)&&(e=o)}}else"number"==typeof e&&(e&=255);if(n<0||this.length<n||this.length<r)throw new RangeError("Out of range index");if(r<=n)return this;var i;if(n>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=n;i<r;++i)this[i]=e;else{var s=t.isBuffer(e)?e:t.from(e,a),l=s.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-n;++i)this[i+n]=s[i%l]}return this};var T=/[^+/0-9A-Za-z-_]/g;function N(e){return e<16?"0"+e.toString(16):e.toString(16)}function I(e,t){var n;t=t||1/0;for(var r=e.length,a=null,o=[],i=0;i<r;++i){if((n=e.charCodeAt(i))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(i+1===r){(t-=3)>-1&&o.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&o.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function C(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(T,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,n,r){for(var a=0;a<r&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function V(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function D(e){return e!=e}}).call(this,e("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:10}],4:[function(e,t,n){"use strict";var r=e("./lib/thunk.js");function a(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}t.exports=function(e){var t=new a;t.pre=e.pre,t.body=e.body,t.post=e.post;var n=e.args.slice(0);t.argTypes=n;for(var o=0;o<n.length;++o){var i=n[o];if("array"===i||"object"==typeof i&&i.blockIndices){if(t.argTypes[o]="array",t.arrayArgs.push(o),t.arrayBlockIndices.push(i.blockIndices?i.blockIndices:0),t.shimArgs.push("array"+o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array args");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===i)t.scalarArgs.push(o),t.shimArgs.push("scalar"+o);else if("index"===i){if(t.indexArgs.push(o),o<t.pre.args.length&&t.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array index");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array index");if(o<t.post.args.length&&t.post.args[o].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===i){if(t.shapeArgs.push(o),o<t.pre.args.length&&t.pre.args[o].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(o<t.body.args.length&&t.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array shape");if(o<t.post.args.length&&t.post.args[o].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof i||!i.offset)throw new Error("cwise: Unknown argument type "+n[o]);t.argTypes[o]="offset",t.offsetArgs.push({array:i.array,offset:i.offset}),t.offsetArgIndex.push(o)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,r(t)}},{"./lib/thunk.js":6}],5:[function(e,t,n){"use strict";var r=e("uniq");function a(e,t,n){var r,a,o=e.length,i=t.arrayArgs.length,s=t.indexArgs.length>0,l=[],u=[],c=0,d=0;for(r=0;r<o;++r)u.push(["i",r,"=0"].join(""));for(a=0;a<i;++a)for(r=0;r<o;++r)d=c,c=e[r],0===r?u.push(["d",a,"s",r,"=t",a,"p",c].join("")):u.push(["d",a,"s",r,"=(t",a,"p",c,"-s",d,"*t",a,"p",d,")"].join(""));for(u.length>0&&l.push("var "+u.join(",")),r=o-1;r>=0;--r)c=e[r],l.push(["for(i",r,"=0;i",r,"<s",c,";++i",r,"){"].join(""));for(l.push(n),r=0;r<o;++r){for(d=c,c=e[r],a=0;a<i;++a)l.push(["p",a,"+=d",a,"s",r].join(""));s&&(r>0&&l.push(["index[",d,"]-=s",d].join("")),l.push(["++index[",c,"]"].join(""))),l.push("}")}return l.join("\n")}function o(e,t,n){for(var r=e.body,a=[],o=[],i=0;i<e.args.length;++i){var s=e.args[i];if(!(s.count<=0)){var l=new RegExp(s.name,"g"),u="",c=t.arrayArgs.indexOf(i);switch(t.argTypes[i]){case"offset":var d=t.offsetArgIndex.indexOf(i);c=t.offsetArgs[d].array,u="+q"+d;case"array":u="p"+c+u;var f="l"+i,p="a"+c;if(0===t.arrayBlockIndices[c])1===s.count?"generic"===n[c]?s.lvalue?(a.push(["var ",f,"=",p,".get(",u,")"].join("")),r=r.replace(l,f),o.push([p,".set(",u,",",f,")"].join(""))):r=r.replace(l,[p,".get(",u,")"].join("")):r=r.replace(l,[p,"[",u,"]"].join("")):"generic"===n[c]?(a.push(["var ",f,"=",p,".get(",u,")"].join("")),r=r.replace(l,f),s.lvalue&&o.push([p,".set(",u,",",f,")"].join(""))):(a.push(["var ",f,"=",p,"[",u,"]"].join("")),r=r.replace(l,f),s.lvalue&&o.push([p,"[",u,"]=",f].join("")));else{for(var h=[s.name],v=[u],g=0;g<Math.abs(t.arrayBlockIndices[c]);g++)h.push("\\s*\\[([^\\]]+)\\]"),v.push("$"+(g+1)+"*t"+c+"b"+g);if(l=new RegExp(h.join(""),"g"),u=v.join("+"),"generic"===n[c])throw new Error("cwise: Generic arrays not supported in combination with blocks!");r=r.replace(l,[p,"[",u,"]"].join(""))}break;case"scalar":r=r.replace(l,"Y"+t.scalarArgs.indexOf(i));break;case"index":r=r.replace(l,"index");break;case"shape":r=r.replace(l,"shape")}}}return[a.join("\n"),r,o.join("\n")].join("\n").trim()}function i(e){for(var t=new Array(e.length),n=!0,r=0;r<e.length;++r){var a=e[r],o=a.match(/\d+/);o=o?o[0]:"",0===a.charAt(0)?t[r]="u"+a.charAt(1)+o:t[r]=a.charAt(0)+o,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}t.exports=function(e,t){for(var n=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,s=new Array(e.arrayArgs.length),l=new Array(e.arrayArgs.length),u=0;u<e.arrayArgs.length;++u)l[u]=t[2*u],s[u]=t[2*u+1];var c=[],d=[],f=[],p=[],h=[];for(u=0;u<e.arrayArgs.length;++u){e.arrayBlockIndices[u]<0?(f.push(0),p.push(n),c.push(n),d.push(n+e.arrayBlockIndices[u])):(f.push(e.arrayBlockIndices[u]),p.push(e.arrayBlockIndices[u]+n),c.push(0),d.push(e.arrayBlockIndices[u]));for(var v=[],g=0;g<s[u].length;g++)f[u]<=s[u][g]&&s[u][g]<p[u]&&v.push(s[u][g]-f[u]);h.push(v)}var m=["SS"],y=["'use strict'"],x=[];for(g=0;g<n;++g)x.push(["s",g,"=SS[",g,"]"].join(""));for(u=0;u<e.arrayArgs.length;++u){m.push("a"+u),m.push("t"+u),m.push("p"+u);for(g=0;g<n;++g)x.push(["t",u,"p",g,"=t",u,"[",f[u]+g,"]"].join(""));for(g=0;g<Math.abs(e.arrayBlockIndices[u]);++g)x.push(["t",u,"b",g,"=t",u,"[",c[u]+g,"]"].join(""))}for(u=0;u<e.scalarArgs.length;++u)m.push("Y"+u);if(e.shapeArgs.length>0&&x.push("shape=SS.slice(0)"),e.indexArgs.length>0){var b=new Array(n);for(u=0;u<n;++u)b[u]="0";x.push(["index=[",b.join(","),"]"].join(""))}for(u=0;u<e.offsetArgs.length;++u){var j=e.offsetArgs[u],w=[];for(g=0;g<j.offset.length;++g)0!==j.offset[g]&&(1===j.offset[g]?w.push(["t",j.array,"p",g].join("")):w.push([j.offset[g],"*t",j.array,"p",g].join("")));0===w.length?x.push("q"+u+"=0"):x.push(["q",u,"=",w.join("+")].join(""))}var _=r([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));for((x=x.concat(_)).length>0&&y.push("var "+x.join(",")),u=0;u<e.arrayArgs.length;++u)y.push("p"+u+"|=0");e.pre.body.length>3&&y.push(o(e.pre,e,l));var k=o(e.body,e,l),z=function(e){for(var t=0,n=e[0].length;t<n;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}(h);z<n?y.push(function(e,t,n,r){for(var o=t.length,i=n.arrayArgs.length,s=n.blockSize,l=n.indexArgs.length>0,u=[],c=0;c<i;++c)u.push(["var offset",c,"=p",c].join(""));for(c=e;c<o;++c)u.push(["for(var j"+c+"=SS[",t[c],"]|0;j",c,">0;){"].join("")),u.push(["if(j",c,"<",s,"){"].join("")),u.push(["s",t[c],"=j",c].join("")),u.push(["j",c,"=0"].join("")),u.push(["}else{s",t[c],"=",s].join("")),u.push(["j",c,"-=",s,"}"].join("")),l&&u.push(["index[",t[c],"]=j",c].join(""));for(c=0;c<i;++c){for(var d=["offset"+c],f=e;f<o;++f)d.push(["j",f,"*t",c,"p",t[f]].join(""));u.push(["p",c,"=(",d.join("+"),")"].join(""))}for(u.push(a(t,n,r)),c=e;c<o;++c)u.push("}");return u.join("\n")}(z,h[0],e,k)):y.push(a(h[0],e,k)),e.post.body.length>3&&y.push(o(e.post,e,l)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+y.join("\n")+"\n----------");var A=[e.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",z,i(l)].join("");return new Function(["function ",A,"(",m.join(","),"){",y.join("\n"),"} return ",A].join(""))()}},{uniq:26}],6:[function(e,t,n){"use strict";var r=e("./compile.js");t.exports=function(e){var t=["'use strict'","var CACHED={}"],n=[],a=e.funcName+"_cwise_thunk";t.push(["return function ",a,"(",e.shimArgs.join(","),"){"].join(""));for(var o=[],i=[],s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],l=[],u=[],c=0;c<e.arrayArgs.length;++c){var d=e.arrayArgs[c];n.push(["t",d,"=array",d,".dtype,","r",d,"=array",d,".order"].join("")),o.push("t"+d),o.push("r"+d),i.push("t"+d),i.push("r"+d+".join()"),s.push("array"+d+".data"),s.push("array"+d+".stride"),s.push("array"+d+".offset|0"),c>0&&(l.push("array"+e.arrayArgs[0]+".shape.length===array"+d+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[c]))),u.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+d+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[c])+"]"))}for(e.arrayArgs.length>1&&(t.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}")),c=0;c<e.scalarArgs.length;++c)s.push("scalar"+e.scalarArgs[c]);return n.push(["type=[",i.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(r.bind(void 0,e))}},{"./compile.js":5}],7:[function(e,t,n){"use strict";t.exports=function(e,t){switch(void 0===t&&(t=0),typeof e){case"number":if(e>0)return function(e,t){var n,r;for(n=new Array(e),r=0;r<e;++r)n[r]=t;return n}(0|e,t);break;case"object":if("number"==typeof e.length)return function e(t,n,r){var a=0|t[r];if(a<=0)return[];var o,i=new Array(a);if(r===t.length-1)for(o=0;o<a;++o)i[o]=n;else for(o=0;o<a;++o)i[o]=e(t,n,r+1);return i}(e,t,0)}return[]}},{}],8:[function(e,t,n){t.exports=e("./lib/heap")},{"./lib/heap":9}],9:[function(e,t,n){(function(){var e,r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y;a=Math.floor,d=Math.min,r=function(e,t){return e<t?-1:e>t?1:0},c=function(e,t,n,o,i){var s;if(null==n&&(n=0),null==i&&(i=r),n<0)throw new Error("lo must be non-negative");for(null==o&&(o=e.length);n<o;)i(t,e[s=a((n+o)/2)])<0?o=s:n=s+1;return[].splice.apply(e,[n,n-n].concat(t)),t},s=function(e,t,n){return null==n&&(n=r),e.push(t),v(e,0,e.length-1,n)},i=function(e,t){var n,a;return null==t&&(t=r),n=e.pop(),e.length?(a=e[0],e[0]=n,g(e,0,t)):a=n,a},u=function(e,t,n){var a;return null==n&&(n=r),a=e[0],e[0]=t,g(e,0,n),a},l=function(e,t,n){var a;return null==n&&(n=r),e.length&&n(e[0],t)<0&&(t=(a=[e[0],t])[0],e[0]=a[1],g(e,0,n)),t},o=function(e,t){var n,o,i,s,l,u;for(null==t&&(t=r),l=[],o=0,i=(s=function(){u=[];for(var t=0,n=a(e.length/2);0<=n?t<n:t>n;0<=n?t++:t--)u.push(t);return u}.apply(this).reverse()).length;o<i;o++)n=s[o],l.push(g(e,n,t));return l},h=function(e,t,n){var a;if(null==n&&(n=r),-1!==(a=e.indexOf(t)))return v(e,0,a,n),g(e,a,n)},f=function(e,t,n){var a,i,s,u,c;if(null==n&&(n=r),!(i=e.slice(0,t)).length)return i;for(o(i,n),s=0,u=(c=e.slice(t)).length;s<u;s++)a=c[s],l(i,a,n);return i.sort(n).reverse()},p=function(e,t,n){var a,s,l,u,f,p,h,v,g;if(null==n&&(n=r),10*t<=e.length){if(!(l=e.slice(0,t).sort(n)).length)return l;for(s=l[l.length-1],u=0,p=(h=e.slice(t)).length;u<p;u++)n(a=h[u],s)<0&&(c(l,a,0,null,n),l.pop(),s=l[l.length-1]);return l}for(o(e,n),g=[],f=0,v=d(t,e.length);0<=v?f<v:f>v;0<=v?++f:--f)g.push(i(e,n));return g},v=function(e,t,n,a){var o,i,s;for(null==a&&(a=r),o=e[n];n>t&&a(o,i=e[s=n-1>>1])<0;)e[n]=i,n=s;return e[n]=o},g=function(e,t,n){var a,o,i,s,l;for(null==n&&(n=r),o=e.length,l=t,i=e[t],a=2*t+1;a<o;)(s=a+1)<o&&!(n(e[a],e[s])<0)&&(a=s),e[t]=e[a],a=2*(t=a)+1;return e[t]=i,v(e,l,t,n)},e=function(){function e(e){this.cmp=null!=e?e:r,this.nodes=[]}return e.push=s,e.pop=i,e.replace=u,e.pushpop=l,e.heapify=o,e.updateItem=h,e.nlargest=f,e.nsmallest=p,e.prototype.push=function(e){return s(this.nodes,e,this.cmp)},e.prototype.pop=function(){return i(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return u(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return l(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return o(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return h(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return(t=new e).nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),m=this,y=function(){return e},"function"==typeof define&&define.amd?define([],y):"object"==typeof n?t.exports=y():m.Heap=y()}).call(this)},{}],10:[function(e,t,n){n.read=function(e,t,n,r,a){var o,i,s=8*a-r-1,l=(1<<s)-1,u=l>>1,c=-7,d=n?a-1:0,f=n?-1:1,p=e[t+d];for(d+=f,o=p&(1<<-c)-1,p>>=-c,c+=s;c>0;o=256*o+e[t+d],d+=f,c-=8);for(i=o&(1<<-c)-1,o>>=-c,c+=r;c>0;i=256*i+e[t+d],d+=f,c-=8);if(0===o)o=1-u;else{if(o===l)return i?NaN:1/0*(p?-1:1);i+=Math.pow(2,r),o-=u}return(p?-1:1)*i*Math.pow(2,o-r)},n.write=function(e,t,n,r,a,o){var i,s,l,u=8*o-a-1,c=(1<<u)-1,d=c>>1,f=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,h=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,i=c):(i=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-i))<1&&(i--,l*=2),(t+=i+d>=1?f/l:f*Math.pow(2,1-d))*l>=2&&(i++,l/=2),i+d>=c?(s=0,i=c):i+d>=1?(s=(t*l-1)*Math.pow(2,a),i+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,a),i=0));a>=8;e[n+p]=255&s,p+=h,s/=256,a-=8);for(i=i<<a|s,u+=a;u>0;e[n+p]=255&i,p+=h,i/=256,u-=8);e[n+p-h]|=128*v}},{}],11:[function(e,t,n){"use strict";var r=e("bit-twiddle");function a(e){var t=(r.nextPow2(e+1)>>>1)-1,n=e-t;return r.nextPow2(n)-1>=t?t:(t>>>1)+n}function o(e,t){if(e<=0)return 0;var n=a(e);return t>n?o(e-n-1,t-n-1):t===n?r.log2(e):o(n,t)}n.root=a,n.begin=function(e){return 0},n.end=function(e){return e-1},n.height=o,n.prev=function(e,t){return Math.max(t-1,0)},n.next=function(e,t){return Math.min(t+1,e-1)},n.parent=function e(t,n){if(t<=0)return-1;var r,o=a(t);return n>o?(r=e(t-o-1,n-o-1))<0?o:r+o+1:n===o?-1:(r=e(o,n))<0?o:r},n.left=function e(t,n){if(t<=0)return 0;var r=a(t);return n>r?e(t-r-1,n-r-1)+r+1:n===r?a(n):e(r,n)},n.right=function e(t,n){if(t<=0)return 0;var r=a(t);return n>r?e(t-r-1,n-r-1)+r+1:n===r?a(t-r-1)+r+1:e(r,n)},n.leaf=function(e,t){return 0===o(e,t)},n.lo=function(e,t){e|=0,t|=0;for(var n=0;e>1;){var r=a(e);if(t>r)n+=r+1,e-=r+1,t-=r+1;else{if(t===r)break;e=r}}return n},n.hi=function(e,t){e|=0,t|=0;for(var n=0;e>1;){var r=a(e);if(t>r)n+=r+1,e-=r+1,t-=r+1;else{if(t===r){n+=e-1;break}e=r}}return n}},{"bit-twiddle":12}],12:[function(e,t,n){arguments[4][2][0].apply(n,arguments)},{dup:2}],13:[function(e,t,n){"use strict";t.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},{}],14:[function(e,t,n){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(e){return null!=e&&(r(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}(e)||!!e._isBuffer)}},{}],15:[function(e,t,n){"use strict";var r=e("cwise-compiler"),a={body:"",args:[],thisVars:[],localVars:[]};function o(e){if(!e)return a;for(var t=0;t<e.args.length;++t){var n=e.args[t];e.args[t]=0===t?{name:n,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:n,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function i(e){for(var t=[],n=0;n<e.args.length;++n)t.push("a"+n);return new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""))(function(e){return r({args:e.args,pre:o(e.pre),body:o(e.body),post:o(e.proc),funcName:e.funcName})}(e))}var s={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in s){var t=s[e];n[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),n[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:e+"eq"}),n[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),n[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:e+"seq"})}}();var l={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in l){var t=l[e];n[e]=i({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e}),n[e+"eq"]=i({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var u={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in u){var t=u[e];n[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),n[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),n[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:e+"eq"}),n[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var c=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<c.length;++e){var t=c[e];n[t]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t}),n[t+"eq"]=i({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"})}}();var d=["max","min","atan2","pow"];!function(){for(var e=0;e<d.length;++e){var t=d[e];n[t]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t}),n[t+"s"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"}),n[t+"eq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"}),n[t+"seq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"seq"})}}();var f=["atan2","pow"];!function(){for(var e=0;e<f.length;++e){var t=f[e];n[t+"op"]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"}),n[t+"ops"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"}),n[t+"opeq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opeq"}),n[t+"opseq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opseq"})}}(),n.any=r({args:["array"],pre:a,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),n.all=r({args:["array"],pre:a,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),n.sum=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),n.prod=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),n.norm2squared=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),n.norm2=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),n.norminf=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),n.norm1=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),n.sup=r({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),n.inf=r({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),n.argmin=r({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),n.argmax=r({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),n.random=i({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),n.assign=i({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),n.assigns=i({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),n.equals=r({args:["array","array"],pre:a,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":4}],16:[function(e,t,n){"use strict";var r=e("ndarray"),a=e("./doConvert.js");t.exports=function(e,t){for(var n=[],o=e,i=1;Array.isArray(o);)n.push(o.length),i*=o.length,o=o[0];return 0===n.length?r():(t||(t=r(new Float64Array(i),n)),a(t,e),t)}},{"./doConvert.js":17,ndarray:20}],17:[function(e,t,n){t.exports=e("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":4}],18:[function(e,t,n){"use strict";var r=e("ndarray"),a=e("ndarray-ops"),o=e("typedarray-pool");n.clone=function(e){var t=e.dtype;"generic"!==t&&"array"!==t||(t="double");var n=o.malloc(e.size,t),i=r(n,e.shape);return a.assign(i,e),i},n.malloc=function(e,t){t||(t="double");for(var n=1,a=new Array(e.length),i=e.length-1;i>=0;--i)a[i]=n,n*=e[i];return r(o.malloc(n,t),e,a,0)},n.free=function(e){"generic"!==e.dtype&&"array"!==e.dtype&&o.free(e.data)},n.zeros=function(e,t){t||(t="double");for(var n=1,a=new Array(e.length),i=e.length-1;i>=0;--i)a[i]=n,n*=e[i];var s=o.malloc(n,t);for(i=0;i<n;++i)s[i]=0;return r(s,e,a,0)},n.ones=function(e,t){t||(t="double");for(var n=1,a=new Array(e.length),i=e.length-1;i>=0;--i)a[i]=n,n*=e[i];var s=o.malloc(n,t);for(i=0;i<n;++i)s[i]=1;return r(s,e,a,0)},n.eye=function(e,t){var n,a;t||(t="double");var i=1,s=new Array(e.length);for(n=e.length-1;n>=0;--n)s[n]=i,i*=e[n];var l=o.malloc(i,t);for(n=0;n<i;++n)l[n]=0;var u=1/0,c=0;for(n=e.length-1;n>=0;n--)c+=s[n],u=Math.min(u,e[n]);for(n=0,a=0;n<u;n++,a+=c)l[a]=1;return r(l,e,s,0)}},{ndarray:20,"ndarray-ops":15,"typedarray-pool":25}],19:[function(e,t,n){"use strict";t.exports=function(e,t,n){if(t|=0,0===e.dimension||e.shape[0]<=t||t<0)return null;var r=!!n,a=p(e.order,r,e.dtype);return r?a(e,t,n):a(e,t)},t.exports.compile=p;var r="L",a="H";function o(e){return"s"+e}function i(e){return"t"+e}function s(e){return"u"+e}function l(e){return"v"+e}function u(e){return"i"+e}function c(e){return"p"+e}function d(e){return"x"+e}var f={};function p(e,t,n){var p=e.join()+t+n,h=f[p];return h||(f[p]=function(e,t,n){var f=(e=function(e){var t=e.slice();return t.splice(e.indexOf(0),1),t.unshift(0),t}(e)).length,p="generic"===n,h="ndSelect"+n+e.join("_")+"_"+(t?"cmp":"lex"),v=[],g=["a","K"];t&&g.push("C");for(var m=["d=a.data","o=a.offset|0","R=Math.random","T"],y=0;y<2;++y)m.push(d(y)+"=0");for(y=0;y<f;++y)m.push(o(y)+"=a.shape["+y+"]|0",i(y)+"=a.stride["+y+"]|0",u(y)+"=0");for(y=1;y<f;++y)y>1?m.push(l(y)+"=("+i(y)+"-"+o(y-1)+"*"+i(y-1)+")|0",s(e[y])+"=("+i(e[y])+"-"+o(e[y-1])+"*"+i(e[y-1])+")|0"):m.push(l(y)+"="+i(y),s(e[y])+"="+i(e[y]));if(t)for(y=0;y<2;++y)m.push(c(y)+"=a.pick(0)");function x(t,n){v.push(d(0),"=","o","+",i(e[0]),"*(",t,");",d(1),"=","o","+",i(e[0]),"*(",n,");");for(var r=f-1;r>0;--r)v.push("for(",u(e[r]),"=0;",u(e[r]),"<",o(e[r]),";",u(e[r]),"++){");p?v.push("T","=","d",".get(",d(0),");","d",".set(",d(0),",","d",".get(",d(1),"));","d",".set(",d(1),",","T",");"):v.push("T","=","d","[",d(0),"];","d","[",d(0),"]=","d","[",d(1),"];","d","[",d(1),"]=","T",";");for(r=1;r<f;++r)v.push(d(0),"+=",s(e[r]),";",d(1),"+=",s(e[r]),"}")}m.push("X=0","L=0","H="+o(e[0])+"-1"),v.push("while(",r,"<",a,"){","X","=(","R","()*(",a,"-",r,"+1)+",r,")|0;"),x("X",a),v.push("X","=",r,";","for(",u(0),"=",r,";",u(0),"<",a,";",u(0),"++){"),function(n,r,a){if(t)v.push(c(0),".offset=","o","+",i(e[0]),"*(",r,");",c(1),".offset=","o","+",i(e[0]),"*(",a,");",n,"=","C","(",c(0),",",c(1),");");else{v.push(d(0),"=","o","+",i(0),"*(",r,");",d(1),"=","o","+",i(0),"*(",a,");"),f>1&&v.push("_cmp:");for(var s=f-1;s>0;--s)v.push("for(",u(s),"=0;",u(s),"<",o(s),";",u(s),"++){");p?v.push(n,"=","d",".get(",d(0),")-","d",".get(",d(1),");"):v.push(n,"=","d","[",d(0),"]-","d","[",d(1),"];"),f>1&&v.push("if(",n,")break _cmp;");for(s=1;s<f;++s)v.push(d(0),"+=",l(s),";",d(1),"+=",l(s),"}")}}("T",u(0),a),v.push("if(","T","<0){"),x("X",u(0)),v.push("X","++;"),v.push("}}"),x("X",a),v.push("if(","X","===","K","){",r,"=","X",";","break;","}else if(","K","<","X","){",a,"=","X","-1;","}else{",r,"=","X","+1;","}","}"),t?v.push(c(0),".offset=","o","+",r,"*",i(0),";","return ",c(0),";"):v.push("return ","a",".pick(",r,");");var b=["'use strict';function ",h,"(",g,"){","var ",m.join(),";",v.join(""),"};return ",h].join("");return new Function(b)()}(e,t,n))}},{}],20:[function(e,t,n){var r=e("iota-array"),a=e("is-buffer"),o="undefined"!=typeof Float64Array;function i(e,t){return e[0]-t[0]}function s(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(i);var r=new Array(n.length);for(e=0;e<r.length;++e)r[e]=n[e][1];return r}function l(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var a="generic"===e;if(-1===t){var o="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(o)()}if(0===t){o="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(a?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(a?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",o)(u[e][0])}o=["'use strict'"];var i=r(t),l=i.map((function(e){return"i"+e})),c="this.offset+"+i.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),d=i.map((function(e){return"b"+e})).join(","),f=i.map((function(e){return"c"+e})).join(",");o.push("function "+n+"(a,"+d+","+f+",d){this.data=a","this.shape=["+d+"]","this.stride=["+f+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+i.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),t<4?(o.push("function "+n+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+n+"_set("+l.join(",")+",v){"),a?o.push("return this.data.set("+c+",v)}"):o.push("return this.data["+c+"]=v}"),o.push("proto.get=function "+n+"_get("+l.join(",")+"){"),a?o.push("return this.data.get("+c+")}"):o.push("return this.data["+c+"]}"),o.push("proto.index=function "+n+"_index(",l.join(),"){return "+c+"}"),o.push("proto.hi=function "+n+"_hi("+l.join(",")+"){return new "+n+"(this.data,"+i.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+i.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var p=i.map((function(e){return"a"+e+"=this.shape["+e+"]"})),h=i.map((function(e){return"c"+e+"=this.stride["+e+"]"}));o.push("proto.lo=function "+n+"_lo("+l.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+h.join(","));for(var v=0;v<t;++v)o.push("if(typeof i"+v+"==='number'&&i"+v+">=0){d=i"+v+"|0;b+=c"+v+"*d;a"+v+"-=d}");o.push("return new "+n+"(this.data,"+i.map((function(e){return"a"+e})).join(",")+","+i.map((function(e){return"c"+e})).join(",")+",b)}"),o.push("proto.step=function "+n+"_step("+l.join(",")+"){var "+i.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+i.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(v=0;v<t;++v)o.push("if(typeof i"+v+"==='number'){d=i"+v+"|0;if(d<0){c+=b"+v+"*(a"+v+"-1);a"+v+"=ceil(-a"+v+"/d)}else{a"+v+"=ceil(a"+v+"/d)}b"+v+"*=d}");o.push("return new "+n+"(this.data,"+i.map((function(e){return"a"+e})).join(",")+","+i.map((function(e){return"b"+e})).join(",")+",c)}");var g=new Array(t),m=new Array(t);for(v=0;v<t;++v)g[v]="a[i"+v+"]",m[v]="b[i"+v+"]";o.push("proto.transpose=function "+n+"_transpose("+l+"){"+l.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+g.join(",")+","+m.join(",")+",this.offset)}"),o.push("proto.pick=function "+n+"_pick("+l+"){var a=[],b=[],c=this.offset");for(v=0;v<t;++v)o.push("if(typeof i"+v+"==='number'&&i"+v+">=0){c=(c+this.stride["+v+"]*i"+v+")|0}else{a.push(this.shape["+v+"]);b.push(this.stride["+v+"])}");return o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+i.map((function(e){return"shape["+e+"]"})).join(",")+","+i.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",o.join("\n"))(u[e],s)}var u={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};t.exports=function(e,t,n,r){if(void 0===e)return(0,u.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var i=t.length;if(void 0===n){n=new Array(i);for(var s=i-1,c=1;s>=0;--s)n[s]=c,c*=t[s]}if(void 0===r){r=0;for(s=0;s<i;++s)n[s]<0&&(r-=(t[s]-1)*n[s])}for(var d=function(e){if(a(e))return"buffer";if(o)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(e)?"array":"generic"}(e),f=u[d];f.length<=i+1;)f.push(l(d,f.length-1));return(0,f[i+1])(e,t,n,r)}},{"iota-array":13,"is-buffer":14}],21:[function(require,module,exports){(function(global){"use strict";var numeric=void 0===exports?function(){}:exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var n,r,a;for(void 0===t&&(t=15),r=.5,n=new Date;;){for(a=r*=2;a>3;a-=4)e(),e(),e(),e();for(;a>0;)e(),a--;if(new Date-n>t)break}for(a=r;a>3;a-=4)e(),e(),e(),e();for(;a>0;)e(),a--;return 1e3*(3*r-1)/(new Date-n)},numeric._myIndexOf=function(e){var t,n=this.length;for(t=0;t<n;++t)if(this[t]===e)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){var t=[];return function e(n){var r;if(void 0===n)return t.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof n)return t.push('"'+n+'"'),!1;if("boolean"==typeof n)return t.push(n.toString()),!1;if("number"==typeof n){var a=function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var n=Math.floor(Math.log(t)/Math.log(10)),r=t/Math.pow(10,n),a=r.toPrecision(numeric.precision);return 10===parseFloat(a)&&(n++,a=(r=1).toPrecision(numeric.precision)),parseFloat(a).toString()+"e"+n.toString()}return"Infinity"}(n),o=n.toPrecision(numeric.precision),i=parseFloat(n.toString()).toString(),s=[a,o,i,parseFloat(o).toString(),parseFloat(i).toString()];for(r=1;r<s.length;r++)s[r].length<a.length&&(a=s[r]);return t.push(Array(numeric.precision+8-a.length).join(" ")+a),!1}if(null===n)return t.push("null"),!1;if("function"==typeof n){t.push(n.toString());var l=!1;for(r in n)n.hasOwnProperty(r)&&(l?t.push(",\n"):t.push("\n{"),l=!0,t.push(r),t.push(": \n"),e(n[r]));return l&&t.push("}\n"),!0}if(n instanceof Array){if(n.length>numeric.largeArray)return t.push("...Large Array..."),!0;l=!1;for(t.push("["),r=0;r<n.length;r++)r>0&&(t.push(","),l&&t.push("\n ")),l=e(n[r]);return t.push("]"),!0}for(r in t.push("{"),l=!1,n)n.hasOwnProperty(r)&&(l&&t.push(",\n"),l=!0,t.push(r),t.push(": \n"),e(n[r]));return t.push("}"),!0}(e),t.join("")},numeric.parseDate=function(e){return function e(t){if("string"==typeof t)return Date.parse(t.replace(/-/g,"/"));if(!(t instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,r=[];for(n=0;n<t.length;n++)r[n]=e(t[n]);return r}(e)},numeric.parseFloat=function(e){return function e(t){if("string"==typeof t)return parseFloat(t);if(!(t instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,r=[];for(n=0;n<t.length;n++)r[n]=e(t[n]);return r}(e)},numeric.parseCSV=function(e){var t,n,r,a=e.split("\n"),o=[],i=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,l=0;for(n=0;n<a.length;n++){var u,c=(a[n]+",").match(i);if(c.length>0){for(o[l]=[],t=0;t<c.length;t++)u=(r=c[t]).substr(0,r.length-1),s.test(u)?o[l][t]=parseFloat(u):o[l][t]=u;l++}}return o},numeric.toCSV=function(e){var t,n,r,a,o,i=numeric.dim(e);for(r=i[0],i[1],o=[],t=0;t<r;t++){for(a=[],n=0;n<r;n++)a[n]=e[t][n].toString();o[t]=a.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.length);var r,a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1;e.length;for(r=t;r<n;r++)o=o>>>8^a[255&(o^e[r])];return-1^o}var n,r,a,o,i,s,l,u,c,d,f=e[0].length,p=e[0][0].length,h=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,p>>24&255,p>>16&255,p>>8&255,255&p,f>>24&255,f>>16&255,f>>8&255,255&f,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(d=t(h,12,29),h[29]=d>>24&255,h[30]=d>>16&255,h[31]=d>>8&255,h[32]=255&d,n=1,r=0,l=0;l<f;l++){for(l<f-1?h.push(0):h.push(1),i=3*p+1+(0===l)&255,s=3*p+1+(0===l)>>8&255,h.push(i),h.push(s),h.push(255&~i),h.push(255&~s),0===l&&h.push(0),u=0;u<p;u++)for(a=0;a<3;a++)r=(r+(n=(n+(i=(i=e[a][l][u])>255?255:i<0?0:Math.round(i)))%65521))%65521,h.push(i);h.push(0)}return c=(r<<16)+n,h.push(c>>24&255),h.push(c>>16&255),h.push(c>>8&255),h.push(255&c),o=h.length-41,h[33]=o>>24&255,h[34]=o>>16&255,h[35]=o>>8&255,h[36]=255&o,d=t(h,37),h.push(d>>24&255),h.push(d>>16&255),h.push(d>>8&255),h.push(255&d),h.push(0),h.push(0),h.push(0),h.push(0),h.push(73),h.push(69),h.push(78),h.push(68),h.push(174),h.push(66),h.push(96),h.push(130),"data:image/png;base64,"+function(e){var t,n,r,a,o,i,s,l=e.length,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(t=0;t<l;t+=3)o=((3&(n=e[t]))<<4)+((r=e[t+1])>>4),i=((15&r)<<2)+((a=e[t+2])>>6),s=63&a,t+1>=l?i=s=64:t+2>=l&&(s=64),c+=u.charAt(n>>2)+u.charAt(o)+u.charAt(i)+u.charAt(s);return c}(h)},numeric._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t;return"object"==typeof e?"object"==typeof(t=e[0])?"object"==typeof t[0]?numeric._dim(e):[e.length,t.length]:[e.length]:[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(t,n){var r,a;if(!(t instanceof Array&&n instanceof Array))return!1;if((a=t.length)!==n.length)return!1;for(r=0;r<a;r++)if(t[r]!==n[r]){if("object"!=typeof t[r])return!1;if(!e(t[r],n[r]))return!1}return!0},numeric.rep=function(e,t,n){void 0===n&&(n=0);var r,a=e[n],o=Array(a);if(n===e.length-1){for(r=a-2;r>=0;r-=2)o[r+1]=t,o[r]=t;return-1===r&&(o[0]=t),o}for(r=a-1;r>=0;r--)o[r]=numeric.rep(e,t,n+1);return o},numeric.dotMMsmall=function(e,t){var n,r,a,o,i,s,l,u,c,d,f;for(o=e.length,i=t.length,s=t[0].length,l=Array(o),n=o-1;n>=0;n--){for(u=Array(s),c=e[n],a=s-1;a>=0;a--){for(d=c[i-1]*t[i-1][a],r=i-2;r>=1;r-=2)f=r-1,d+=c[r]*t[r][a]+c[f]*t[f][a];0===r&&(d+=c[0]*t[0][a]),u[a]=d}l[n]=u}return l},numeric._getCol=function(e,t,n){var r;for(r=e.length-1;r>0;--r)n[r]=e[r][t],n[--r]=e[r][t];0===r&&(n[0]=e[0][t])},numeric.dotMMbig=function(e,t){var n,r,a,o=numeric._getCol,i=t.length,s=Array(i),l=e.length,u=t[0].length,c=new Array(l),d=numeric.dotVV;for(--i,r=--l;-1!==r;--r)c[r]=Array(u);for(r=--u;-1!==r;--r)for(o(t,r,s),a=l;-1!==a;--a)0,n=e[a],c[a][r]=d(n,s);return c},numeric.dotMV=function(e,t){var n,r=e.length,a=(t.length,Array(r)),o=numeric.dotVV;for(n=r-1;n>=0;n--)a[n]=o(e[n],t);return a},numeric.dotVM=function(e,t){var n,r,a,o,i,s,l;for(a=e.length,o=t[0].length,i=Array(o),r=o-1;r>=0;r--){for(s=e[a-1]*t[a-1][r],n=a-2;n>=1;n-=2)l=n-1,s+=e[n]*t[n][r]+e[l]*t[l][r];0===n&&(s+=e[0]*t[0][r]),i[r]=s}return i},numeric.dotVV=function(e,t){var n,r,a=e.length,o=e[a-1]*t[a-1];for(n=a-2;n>=1;n-=2)r=n-1,o+=e[n]*t[n]+e[r]*t[r];return 0===n&&(o+=e[0]*t[0]),o},numeric.dot=function(e,t){var n=numeric.dim;switch(1e3*n(e).length+n(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,n,r,a,o=e.length,i=Array(o);for(t=o-1;t>=0;t--){for(a=Array(o),n=t+2,r=o-1;r>=n;r-=2)a[r]=0,a[r-1]=0;for(r>t&&(a[r]=0),a[t]=e[t],r=t-1;r>=1;r-=2)a[r]=0,a[r-1]=0;0===r&&(a[0]=0),i[t]=a}return i},numeric.getDiag=function(e){var t,n=Math.min(e.length,e[0].length),r=Array(n);for(t=n-1;t>=1;--t)r[t]=e[t][t],r[--t]=e[t][t];return 0===t&&(r[0]=e[0][0]),r},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,n){void 0===n&&(n="");var r,a,o=[],i=/\[i\]$/,s="",l=!1;for(r=0;r<e.length;r++)i.test(e[r])?s=a=e[r].substring(0,e[r].length-3):a=e[r],"ret"===a&&(l=!0),o.push(a);return o[e.length]="_s",o[e.length+1]="_k",o[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(l?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(e,t,n){void 0===n&&(n="");var r,a,o=[],i=/\[i\]$/,s="",l=!1;for(r=0;r<e.length;r++)i.test(e[r])?s=a=e[r].substring(0,e[r].length-3):a=e[r],"ret"===a&&(l=!0),o.push(a);return o[e.length]="var _n = "+s+".length;\nvar i"+(l?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function e(t,n,r,a,o){var i;if(a!==r.length-1)for(i=r[a]-1;i>=0;i--)e("object"==typeof t?t[i]:t,"object"==typeof n?n[i]:n,r,a+1,o);else o(t,n)},numeric._biforeach2=function e(t,n,r,a,o){if(a===r.length-1)return o(t,n);var i,s=r[a],l=Array(s);for(i=s-1;i>=0;--i)l[i]=e("object"==typeof t?t[i]:t,"object"==typeof n?n[i]:n,r,a+1,o);return l},numeric._foreach=function e(t,n,r,a){var o;if(r!==n.length-1)for(o=n[r]-1;o>=0;o--)e(t[o],n,r+1,a);else a(t)},numeric._foreach2=function e(t,n,r,a){if(r===n.length-1)return a(t);var o,i=n[r],s=Array(i);for(o=i-1;o>=0;o--)s[o]=e(t[o],n,r+1,a);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,t;for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],numeric.ops2[t]=t;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){t=numeric.ops2[e];var n,r,a="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,e)?(a="var "+t+" = Math."+t+";\n",n=function(e,n,r){return e+" = "+t+"("+n+","+r+")"},r=function(e,n){return e+" = "+t+"("+e+","+n+")"}):(n=function(e,n,r){return e+" = "+n+" "+t+" "+r},r=numeric.opseq.hasOwnProperty(e+"eq")?function(e,n){return e+" "+t+"= "+n}:function(e,n){return e+" = "+e+" "+t+" "+n}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),a),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),a),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),a),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+r("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),a),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),a),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],delete numeric.ops2[t];for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],numeric.ops1[t]=t;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(a="",t=numeric.ops1[e],-1!==numeric.myIndexOf.call(numeric.mathfuns,e)&&Math.hasOwnProperty(t)&&(a="var "+t+" = Math."+t+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",a),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",a),numeric[e]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],delete numeric.ops1[t];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(t=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[e]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return"object"==typeof e?"object"==typeof t?numeric.truncVV(e,t):numeric.truncVS(e,t):"object"==typeof t?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t,n,r,a,o,i,s,l=numeric.dim(e),u=Math.abs,c=l[0],d=l[1],f=numeric.clone(e),p=numeric.identity(c);for(i=0;i<d;++i){var h=-1,v=-1;for(o=i;o!==c;++o)(s=u(f[o][i]))>v&&(h=o,v=s);for(n=f[h],f[h]=f[i],f[i]=n,a=p[h],p[h]=p[i],p[i]=a,e=n[i],s=i;s!==d;++s)n[s]/=e;for(s=d-1;-1!==s;--s)a[s]/=e;for(o=c-1;-1!==o;--o)if(o!==i){for(t=f[o],r=p[o],e=t[i],s=i+1;s!==d;++s)t[s]-=n[s]*e;for(s=d-1;s>0;--s)r[s]-=a[s]*e,r[--s]-=a[s]*e;0===s&&(r[0]-=a[0]*e)}}return p},numeric.det=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var n,r,a,o,i,s,l,u,c=t[0],d=1,f=numeric.clone(e);for(r=0;r<c-1;r++){for(a=r,n=r+1;n<c;n++)Math.abs(f[n][r])>Math.abs(f[a][r])&&(a=n);for(a!==r&&(l=f[a],f[a]=f[r],f[r]=l,d*=-1),o=f[r],n=r+1;n<c;n++){for(s=(i=f[n])[r]/o[r],a=r+1;a<c-1;a+=2)u=a+1,i[a]-=o[a]*s,i[u]-=o[u]*s;a!==c&&(i[a]-=o[a]*s)}if(0===o[r])return 0;d*=o[r]}return d*f[r][r]},numeric.transpose=function(e){var t,n,r,a,o,i=e.length,s=e[0].length,l=Array(s);for(n=0;n<s;n++)l[n]=Array(i);for(t=i-1;t>=1;t-=2){for(a=e[t],r=e[t-1],n=s-1;n>=1;--n)(o=l[n])[t]=a[n],o[t-1]=r[n],(o=l[--n])[t]=a[n],o[t-1]=r[n];0===n&&((o=l[0])[t]=a[0],o[t-1]=r[0])}if(0===t){for(r=e[0],n=s-1;n>=1;--n)l[n][0]=r[n],l[--n][0]=r[n];0===n&&(l[0][0]=r[0])}return l},numeric.negtranspose=function(e){var t,n,r,a,o,i=e.length,s=e[0].length,l=Array(s);for(n=0;n<s;n++)l[n]=Array(i);for(t=i-1;t>=1;t-=2){for(a=e[t],r=e[t-1],n=s-1;n>=1;--n)(o=l[n])[t]=-a[n],o[t-1]=-r[n],(o=l[--n])[t]=-a[n],o[t-1]=-r[n];0===n&&((o=l[0])[t]=-a[0],o[t-1]=-r[0])}if(0===t){for(r=e[0],n=s-1;n>=1;--n)l[n][0]=-r[n],l[--n][0]=-r[n];0===n&&(l[0][0]=-r[0])}return l},numeric._random=function e(t,n){var r,a,o=t[n],i=Array(o);if(n===t.length-1){for(a=Math.random,r=o-1;r>=1;r-=2)i[r]=a(),i[r-1]=a();return 0===r&&(i[0]=a()),i}for(r=o-1;r>=0;r--)i[r]=e(t,n+1);return i},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,n){if(void 0===n&&(n=Math.max(Math.round(t-e)+1,1)),n<2)return 1===n?[e]:[];var r,a=Array(n);for(r=--n;r>=0;r--)a[r]=(r*t+(n-r)*e)/n;return a},numeric.getBlock=function(e,t,n){var r=numeric.dim(e);return function e(a,o){var i,s=t[o],l=n[o]-s,u=Array(l);if(o===r.length-1){for(i=l;i>=0;i--)u[i]=a[i+s];return u}for(i=l;i>=0;i--)u[i]=e(a[i+s],o+1);return u}(e,0)},numeric.setBlock=function(e,t,n,r){var a=numeric.dim(e);return function e(r,o,i){var s,l=t[i],u=n[i]-l;if(i===a.length-1)for(s=u;s>=0;s--)r[s+l]=o[s];for(s=u;s>=0;s--)e(r[s+l],o[s],i+1)}(e,r,0),e},numeric.getRange=function(e,t,n){var r,a,o,i,s=t.length,l=n.length,u=Array(s);for(r=s-1;-1!==r;--r)for(u[r]=Array(l),o=u[r],i=e[t[r]],a=l-1;-1!==a;--a)o[a]=i[n[a]];return u},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var n,r,a,o,i,s=t[0],l=t[1];for(n=0,r=0,a=0;a<s;++a)n+=e[a][0].length;for(o=0;o<l;++o)r+=e[0][o][0].length;var u=Array(n);for(a=0;a<n;++a)u[a]=Array(r);var c,d,f,p,h,v=0;for(a=0;a<s;++a){for(c=r,o=l-1;-1!==o;--o)for(c-=(i=e[a][o])[0].length,f=i.length-1;-1!==f;--f)for(h=i[f],d=u[v+f],p=h.length-1;-1!==p;--p)d[c+p]=h[p];v+=e[a][0].length}return u},numeric.tensor=function(e,t){if("number"==typeof e||"number"==typeof t)return numeric.mul(e,t);var n=numeric.dim(e),r=numeric.dim(t);if(1!==n.length||1!==r.length)throw new Error("numeric: tensor product is only defined for vectors");var a,o,i,s,l=n[0],u=r[0],c=Array(l);for(o=l-1;o>=0;o--){for(a=Array(u),s=e[o],i=u-1;i>=3;--i)a[i]=s*t[i],a[--i]=s*t[i],a[--i]=s*t[i],a[--i]=s*t[i];for(;i>=0;)a[i]=s*t[i],--i;c[o]=a}return c},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,n,r,a){var o;numeric.indexOf;if("string"!=typeof a)for(o in a="",numeric)numeric.hasOwnProperty(o)&&(e.indexOf(o)>=0||t.indexOf(o)>=0||n.indexOf(o)>=0||r.indexOf(o)>=0)&&o.length>1&&(a+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+a+"\nif(x.y) {  if(y.y) {    return new numeric.T("+r+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var n=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,n),t(numeric.neg(this.y),n))}return new T(t(1,this.x))},numeric.T.prototype.div=function(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,e.x),t(this.y,e.x)):new numeric.T(t(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),e(n)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),numeric.negtranspose(n)):new numeric.T(e(t))},numeric.Tunop=function(e,t,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+t+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if(void 0===e.y)return new numeric.T(numeric.inv(e.x));var t,n,r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x=e.x.length,b=numeric.identity(x),j=numeric.rep([x,x],0),w=numeric.clone(e.x),_=numeric.clone(e.y);for(u=0;u<x;u++){for(f=(h=w[u][u])*h+(v=_[u][u])*v,d=u,c=u+1;c<x;c++)(p=(h=w[c][u])*h+(v=_[c][u])*v)>f&&(d=c,f=p);for(d!==u&&(y=w[u],w[u]=w[d],w[d]=y,y=_[u],_[u]=_[d],_[d]=y,y=b[u],b[u]=b[d],b[d]=y,y=j[u],j[u]=j[d],j[d]=y),t=w[u],n=_[u],o=b[u],i=j[u],h=t[u],v=n[u],c=u+1;c<x;c++)g=t[c],m=n[c],t[c]=(g*h+m*v)/f,n[c]=(m*h-g*v)/f;for(c=0;c<x;c++)g=o[c],m=i[c],o[c]=(g*h+m*v)/f,i[c]=(m*h-g*v)/f;for(c=u+1;c<x;c++){for(r=w[c],a=_[c],s=b[c],l=j[c],h=r[u],v=a[u],d=u+1;d<x;d++)g=t[d],m=n[d],r[d]-=g*h-m*v,a[d]-=m*h+g*v;for(d=0;d<x;d++)g=o[d],m=i[d],s[d]-=g*h-m*v,l[d]-=m*h+g*v}}for(u=x-1;u>0;u--)for(o=b[u],i=j[u],c=u-1;c>=0;c--)for(s=b[c],l=j[c],h=w[c][u],v=_[c][u],d=x-1;d>=0;d--)g=o[d],m=i[d],s[d]-=h*g-v*m,l[d]-=h*m+v*g;return new numeric.T(b,j)},numeric.T.prototype.get=function(e){var t,n=this.x,r=this.y,a=0,o=e.length;if(r){for(;a<o;)n=n[t=e[a]],r=r[t],a++;return new numeric.T(n,r)}for(;a<o;)n=n[t=e[a]],a++;return new numeric.T(n)},numeric.T.prototype.set=function(e,t){var n,r=this.x,a=this.y,o=0,i=e.length,s=t.x,l=t.y;if(0===i)return l?this.y=l:a&&(this.y=void 0),this.x=r,this;if(l){for(a||(a=numeric.rep(numeric.dim(r),0),this.y=a);o<i-1;)r=r[n=e[o]],a=a[n],o++;return r[n=e[o]]=s,a[n]=l,this}if(a){for(;o<i-1;)r=r[n=e[o]],a=a[n],o++;return r[n=e[o]]=s,a[n]=s instanceof Array?numeric.rep(numeric.dim(s),0):0,this}for(;o<i-1;)r=r[n=e[o]],o++;return r[n=e[o]]=s,this},numeric.T.prototype.getRows=function(e,t){var n,r,a=t-e+1,o=Array(a),i=this.x,s=this.y;for(n=e;n<=t;n++)o[n-e]=i[n];if(s){for(r=Array(a),n=e;n<=t;n++)r[n-e]=s[n];return new numeric.T(o,r)}return new numeric.T(o)},numeric.T.prototype.setRows=function(e,t,n){var r,a=this.x,o=this.y,i=n.x,s=n.y;for(r=e;r<=t;r++)a[r]=i[r-e];if(s)for(o||(o=numeric.rep(numeric.dim(a),0),this.y=o),r=e;r<=t;r++)o[r]=s[r-e];else if(o)for(r=e;r<=t;r++)o[r]=numeric.rep([i[r-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,n=this.y;return n?new numeric.T(t[e],n[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var n=this.x,r=this.y,a=t.x,o=t.y;return n[e]=a,o?(r||(r=numeric.rep(numeric.dim(n),0),this.y=r),r[e]=o):r&&(r=numeric.rep([a.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var n=this.x,r=this.y,a=numeric.getBlock;return r?new numeric.T(a(n,e,t),a(r,e,t)):new numeric.T(a(n,e,t))},numeric.T.prototype.setBlock=function(e,t,n){n instanceof numeric.T||(n=new numeric.T(n));var r=this.x,a=this.y,o=numeric.setBlock,i=n.x,s=n.y;if(s)return a||(this.y=numeric.rep(numeric.dim(this),0),a=this.y),o(r,e,t,i),o(a,e,t,s),this;o(r,e,t,i),a&&o(a,e,t,numeric.rep(numeric.dim(i),0))},numeric.T.rep=function(e,t){var n=numeric.T;t instanceof n||(t=new n(t));var r=t.x,a=t.y,o=numeric.rep;return a?new n(o(e,r),o(e,a)):new n(o(e,r))},numeric.T.diag=function(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,n=e.y,r=numeric.diag;return n?new numeric.T(r(t),r(n)):new numeric.T(r(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,n=this.y;return n?new e.T(e.getDiag(t),e.getDiag(n)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),n=(e[0]>=0?1:-1)*numeric.norm2(e);t[0]+=n;var r=numeric.norm2(t);if(0===r)throw new Error("eig: internal error");return numeric.div(t,r)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,r,a,o,i,s,l,u,c,d,f=t[0],p=numeric.clone(e),h=numeric.identity(f);for(r=0;r<f-2;r++){for(o=Array(f-r-1),n=r+1;n<f;n++)o[n-r-1]=p[n][r];if(numeric.norm2(o)>0){for(i=numeric.house(o),s=numeric.getBlock(p,[r+1,r],[f-1,f-1]),l=numeric.tensor(i,numeric.dot(i,s)),n=r+1;n<f;n++)for(u=p[n],c=l[n-r-1],a=r;a<f;a++)u[a]-=2*c[a-r];for(s=numeric.getBlock(p,[0,r+1],[f-1,f-1]),l=numeric.tensor(numeric.dot(s,i),i),n=0;n<f;n++)for(u=p[n],c=l[n],a=r+1;a<f;a++)u[a]-=2*c[a-r-1];for(s=Array(f-r-1),n=r+1;n<f;n++)s[n-r-1]=h[n];for(l=numeric.tensor(i,numeric.dot(i,s)),n=r+1;n<f;n++)for(d=h[n],c=l[n-r-1],a=0;a<f;a++)d[a]-=2*c[a]}}return{H:p,Q:h}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(e,t){void 0===t&&(t=1e4),e=numeric.clone(e);numeric.clone(e);var n,r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b=numeric.dim(e)[0],j=numeric.identity(b);if(b<3)return{Q:j,B:[[0,b-1]]};var w=numeric.epsilon;for(x=0;x<t;x++){for(m=0;m<b-1;m++)if(Math.abs(e[m+1][m])<w*(Math.abs(e[m][m])+Math.abs(e[m+1][m+1]))){var _=numeric.QRFrancis(numeric.getBlock(e,[0,0],[m,m]),t),k=numeric.QRFrancis(numeric.getBlock(e,[m+1,m+1],[b-1,b-1]),t);for(p=Array(m+1),g=0;g<=m;g++)p[g]=j[g];for(h=numeric.dot(_.Q,p),g=0;g<=m;g++)j[g]=h[g];for(p=Array(b-m-1),g=m+1;g<b;g++)p[g-m-1]=j[g];for(h=numeric.dot(k.Q,p),g=m+1;g<b;g++)j[g]=h[g-m-1];return{Q:j,B:_.B.concat(numeric.add(k.B,m+1))}}var z,A,M;if(a=e[b-2][b-2],o=e[b-2][b-1],i=e[b-1][b-2],u=a+(s=e[b-1][b-1]),l=a*s-o*i,c=numeric.getBlock(e,[0,0],[2,2]),u*u>=4*l)z=.5*(u+Math.sqrt(u*u-4*l)),A=.5*(u-Math.sqrt(u*u-4*l)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,z+A)),numeric.diag(numeric.rep([3],z*A)));else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,u)),numeric.diag(numeric.rep([3],l)));for(n=[c[0][0],c[1][0],c[2][0]],r=numeric.house(n),p=[e[0],e[1],e[2]],h=numeric.tensor(r,numeric.dot(r,p)),g=0;g<3;g++)for(f=e[g],v=h[g],y=0;y<b;y++)f[y]-=2*v[y];for(p=numeric.getBlock(e,[0,0],[b-1,2]),h=numeric.tensor(numeric.dot(p,r),r),g=0;g<b;g++)for(f=e[g],v=h[g],y=0;y<3;y++)f[y]-=2*v[y];for(p=[j[0],j[1],j[2]],h=numeric.tensor(r,numeric.dot(r,p)),g=0;g<3;g++)for(d=j[g],v=h[g],y=0;y<b;y++)d[y]-=2*v[y];for(m=0;m<b-2;m++){for(y=m;y<=m+1;y++)if(Math.abs(e[y+1][y])<w*(Math.abs(e[y][y])+Math.abs(e[y+1][y+1]))){_=numeric.QRFrancis(numeric.getBlock(e,[0,0],[y,y]),t),k=numeric.QRFrancis(numeric.getBlock(e,[y+1,y+1],[b-1,b-1]),t);for(p=Array(y+1),g=0;g<=y;g++)p[g]=j[g];for(h=numeric.dot(_.Q,p),g=0;g<=y;g++)j[g]=h[g];for(p=Array(b-y-1),g=y+1;g<b;g++)p[g-y-1]=j[g];for(h=numeric.dot(k.Q,p),g=y+1;g<b;g++)j[g]=h[g-y-1];return{Q:j,B:_.B.concat(numeric.add(k.B,y+1))}}for(M=Math.min(b-1,m+3),n=Array(M-m),g=m+1;g<=M;g++)n[g-m-1]=e[g][m];for(r=numeric.house(n),p=numeric.getBlock(e,[m+1,m],[M,b-1]),h=numeric.tensor(r,numeric.dot(r,p)),g=m+1;g<=M;g++)for(f=e[g],v=h[g-m-1],y=m;y<b;y++)f[y]-=2*v[y-m];for(p=numeric.getBlock(e,[0,m+1],[b-1,M]),h=numeric.tensor(numeric.dot(p,r),r),g=0;g<b;g++)for(f=e[g],v=h[g],y=m+1;y<=M;y++)f[y]-=2*v[y-m-1];for(p=Array(M-m),g=m+1;g<=M;g++)p[g-m-1]=j[g];for(h=numeric.tensor(r,numeric.dot(r,p)),g=m+1;g<=M;g++)for(d=j[g],v=h[g-m-1],y=0;y<b;y++)d[y]-=2*v[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var n,r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y=numeric.toUpperHessenberg(e),x=numeric.QRFrancis(y.H,t),b=numeric.T,j=e.length,w=x.B,_=numeric.dot(x.Q,numeric.dot(y.H,numeric.transpose(x.Q))),k=new b(numeric.dot(x.Q,y.Q)),z=w.length,A=Math.sqrt;for(r=0;r<z;r++)if((n=w[r][0])===w[r][1]);else{if(o=n+1,i=_[n][n],s=_[n][o],l=_[o][n],u=_[o][o],0===s&&0===l)continue;(d=(c=-i-u)*c-4*(i*u-s*l))>=0?((g=(i-(f=c<0?-.5*(c-A(d)):-.5*(c+A(d))))*(i-f)+s*s)>(m=l*l+(u-f)*(u-f))?(h=(i-f)/(g=A(g)),v=s/g):(h=l/(m=A(m)),v=(u-f)/m),a=new b([[v,-h],[h,v]]),k.setRows(n,o,a.dot(k.getRows(n,o)))):(f=-.5*c,p=.5*A(-d),(g=(i-f)*(i-f)+s*s)>(m=l*l+(u-f)*(u-f))?(h=(i-f)/(g=A(g+p*p)),v=s/g,f=0,p/=g):(h=l/(m=A(m+p*p)),v=(u-f)/m,f=p/m,p=0),a=new b([[v,-h],[h,v]],[[f,p],[p,-f]]),k.setRows(n,o,a.dot(k.getRows(n,o))))}var M=k.dot(e).dot(k.transjugate()),O=(j=e.length,numeric.T.identity(j));for(o=0;o<j;o++)if(o>0)for(r=o-1;r>=0;r--){var F=M.get([r,r]),E=M.get([o,o]);numeric.neq(F.x,E.x)||numeric.neq(F.y,E.y)?(f=M.getRow(r).getBlock([r],[o-1]),p=O.getRow(o).getBlock([r],[o-1]),O.set([o,r],M.get([r,o]).neg().sub(f.dot(p)).div(F.sub(E)))):O.setRow(o,O.getRow(r))}for(o=0;o<j;o++)f=O.getRow(o),O.setRow(o,f.div(f.norm2()));return O=O.transpose(),O=k.transjugate().dot(O),{lambda:M.getDiag(),E:O}},numeric.ccsSparse=function(e){var t,n,r,a=e.length,o=[];for(n=a-1;-1!==n;--n)for(r in t=e[n]){for(r=parseInt(r);r>=o.length;)o[o.length]=0;0!==t[r]&&o[r]++}var i=o.length,s=Array(i+1);for(s[0]=0,n=0;n<i;++n)s[n+1]=s[n]+o[n];var l=Array(s[i]),u=Array(s[i]);for(n=a-1;-1!==n;--n)for(r in t=e[n])0!==t[r]&&(o[r]--,l[s[r]+o[r]]=n,u[s[r]+o[r]]=t[r]);return[s,l,u]},numeric.ccsFull=function(e){var t,n,r,a,o=e[0],i=e[1],s=e[2],l=numeric.ccsDim(e),u=l[0],c=l[1],d=numeric.rep([u,c],0);for(t=0;t<c;t++)for(r=o[t],a=o[t+1],n=r;n<a;++n)d[i[n]][t]=s[n];return d},numeric.ccsTSolve=function(e,t,n,r,a){var o,i,s,l,u,c,d,f=e[0],p=e[1],h=e[2],v=f.length-1,g=Math.max,m=0;function y(e){var t;if(0===n[e]){for(n[e]=1,t=f[e];t<f[e+1];++t)y(p[t]);a[m]=e,++m}}for(void 0===r&&(n=numeric.rep([v],0)),void 0===r&&(r=numeric.linspace(0,n.length-1)),void 0===a&&(a=[]),o=r.length-1;-1!==o;--o)y(r[o]);for(a.length=m,o=a.length-1;-1!==o;--o)n[a[o]]=0;for(o=r.length-1;-1!==o;--o)i=r[o],n[i]=t[i];for(o=a.length-1;-1!==o;--o){for(i=a[o],s=f[i],l=g(f[i+1],s),u=s;u!==l;++u)if(p[u]===i){n[i]/=h[u];break}for(d=n[i],u=s;u!==l;++u)(c=p[u])!==i&&(n[c]-=d*h[u])}return n},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,n,r,a,o){var i,s,l,u=0,c=a.length,d=this.k,f=this.k1,p=this.j;if(0===r[e])for(r[e]=1,p[0]=e,d[0]=s=t[e],f[0]=l=t[e+1];;)if(s>=l){if(a[c]=p[u],0===u)return;++c,s=d[--u],l=f[u]}else 0===r[i=o[n[s]]]?(r[i]=1,d[u]=s,p[++u]=i,s=t[i],f[u]=l=t[i+1]):++s},numeric.ccsLPSolve=function(e,t,n,r,a,o,i){var s,l,u,c,d,f,p,h,v,g=e[0],m=e[1],y=e[2],x=(g.length,t[0]),b=t[1],j=t[2];for(l=x[a],u=x[a+1],r.length=0,s=l;s<u;++s)i.dfs(o[b[s]],g,m,n,r,o);for(s=r.length-1;-1!==s;--s)n[r[s]]=0;for(s=l;s!==u;++s)n[c=o[b[s]]]=j[s];for(s=r.length-1;-1!==s;--s){for(d=g[c=r[s]],f=g[c+1],p=d;p<f;++p)if(o[m[p]]===c){n[c]/=y[p];break}for(v=n[c],p=d;p<f;++p)(h=o[m[p]])!==c&&(n[h]-=v*y[p])}return n},numeric.ccsLUP1=function(e,t){var n,r,a,o,i,s,l,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],d=[numeric.rep([u+1],0),[],[]],f=c[0],p=c[1],h=c[2],v=d[0],g=d[1],m=d[2],y=numeric.rep([u],0),x=numeric.rep([u],0),b=numeric.ccsLPSolve,j=(Math.max,Math.abs),w=numeric.linspace(0,u-1),_=numeric.linspace(0,u-1),k=new numeric.ccsDFS(u);for(void 0===t&&(t=1),n=0;n<u;++n){for(b(c,e,y,x,n,_,k),o=-1,i=-1,r=x.length-1;-1!==r;--r)(a=x[r])<=n||(s=j(y[a]))>o&&(i=a,o=s);for(j(y[n])<t*o&&(r=w[n],o=w[i],w[n]=o,_[o]=n,w[i]=r,_[r]=i,o=y[n],y[n]=y[i],y[i]=o),o=f[n],i=v[n],l=y[n],p[o]=w[n],h[o]=1,++o,r=x.length-1;-1!==r;--r)s=y[a=x[r]],x[r]=0,y[a]=0,a<=n?(g[i]=a,m[i]=s,++i):(p[o]=w[a],h[o]=s/l,++o);f[n+1]=o,v[n+1]=i}for(r=p.length-1;-1!==r;--r)p[r]=_[p[r]];return{L:c,U:d,P:w,Pinv:_}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,n,r,a,o,i){var s,l,u,c=0,d=a.length,f=this.k,p=this.k1,h=this.j;if(0===r[e])for(r[e]=1,h[0]=e,f[0]=l=t[o[e]],p[0]=u=t[o[e]+1];;){if(isNaN(l))throw new Error("Ow!");if(l>=u){if(a[d]=o[h[c]],0===c)return;++d,l=f[--c],u=p[c]}else 0===r[s=n[l]]?(r[s]=1,f[c]=l,h[++c]=s,l=t[s=o[s]],p[c]=u=t[s+1]):++l}},numeric.ccsLPSolve0=function(e,t,n,r,a,o,i,s){var l,u,c,d,f,p,h,v,g,m=e[0],y=e[1],x=e[2],b=(m.length,t[0]),j=t[1],w=t[2];for(u=b[a],c=b[a+1],r.length=0,l=u;l<c;++l)s.dfs(j[l],m,y,n,r,o,i);for(l=r.length-1;-1!==l;--l)n[i[d=r[l]]]=0;for(l=u;l!==c;++l)n[d=j[l]]=w[l];for(l=r.length-1;-1!==l;--l){for(v=i[d=r[l]],f=m[d],p=m[d+1],h=f;h<p;++h)if(y[h]===v){n[v]/=x[h];break}for(g=n[v],h=f;h<p;++h)n[y[h]]-=g*x[h];n[v]=g}},numeric.ccsLUP0=function(e,t){var n,r,a,o,i,s,l,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],d=[numeric.rep([u+1],0),[],[]],f=c[0],p=c[1],h=c[2],v=d[0],g=d[1],m=d[2],y=numeric.rep([u],0),x=numeric.rep([u],0),b=numeric.ccsLPSolve0,j=(Math.max,Math.abs),w=numeric.linspace(0,u-1),_=numeric.linspace(0,u-1),k=new numeric.ccsDFS0(u);for(void 0===t&&(t=1),n=0;n<u;++n){for(b(c,e,y,x,n,_,w,k),o=-1,i=-1,r=x.length-1;-1!==r;--r)(a=x[r])<=n||(s=j(y[w[a]]))>o&&(i=a,o=s);for(j(y[w[n]])<t*o&&(r=w[n],o=w[i],w[n]=o,_[o]=n,w[i]=r,_[r]=i),o=f[n],i=v[n],l=y[w[n]],p[o]=w[n],h[o]=1,++o,r=x.length-1;-1!==r;--r)s=y[w[a=x[r]]],x[r]=0,y[w[a]]=0,a<=n?(g[i]=a,m[i]=s,++i):(p[o]=w[a],h[o]=s/l,++o);f[n+1]=o,v[n+1]=i}for(r=p.length-1;-1!==r;--r)p[r]=_[p[r]];return{L:c,U:d,P:w,Pinv:_}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,n){var r=numeric.ccsDim(e),a=r[0],o=r[1];void 0===t?t=numeric.linspace(0,a-1):"number"==typeof t&&(t=[t]),void 0===n?n=numeric.linspace(0,o-1):"number"==typeof n&&(n=[n]);var i,s,l,u,c=t.length,d=n.length,f=numeric.rep([o],0),p=[],h=[],v=[f,p,h],g=e[0],m=e[1],y=e[2],x=numeric.rep([a],0),b=0,j=numeric.rep([a],0);for(s=0;s<d;++s){var w=g[u=n[s]],_=g[u+1];for(i=w;i<_;++i)j[l=m[i]]=1,x[l]=y[i];for(i=0;i<c;++i)j[t[i]]&&(p[b]=i,h[b]=x[t[i]],++b);for(i=w;i<_;++i)j[l=m[i]]=0;f[s+1]=b}return v},numeric.ccsDot=function(e,t){var n,r,a,o,i,s,l,u,c,d,f,p=e[0],h=e[1],v=e[2],g=t[0],m=t[1],y=t[2],x=numeric.ccsDim(e),b=numeric.ccsDim(t),j=x[0],w=(x[1],b[1]),_=numeric.rep([j],0),k=numeric.rep([j],0),z=Array(j),A=numeric.rep([w],0),M=[],O=[],F=[A,M,O];for(a=0;a!==w;++a){for(o=g[a],i=g[a+1],c=0,r=o;r<i;++r)for(d=m[r],f=y[r],s=p[d],l=p[d+1],n=s;n<l;++n)0===k[u=h[n]]&&(z[c]=u,k[u]=1,c+=1),_[u]=_[u]+v[n]*f;for(i=(o=A[a])+c,A[a+1]=i,r=c-1;-1!==r;--r)f=o+r,n=z[r],M[f]=n,O[f]=_[n],k[n]=0,_[n]=0;A[a+1]=A[a]+c}return F},numeric.ccsLUPSolve=function(e,t){var n=e.L,r=e.U,a=(e.P,t[0]),o=!1;"object"!=typeof a&&(a=(t=[[0,t.length],numeric.linspace(0,t.length-1),t])[0],o=!0);var i,s,l,u,c,d,f=t[1],p=t[2],h=n[0].length-1,v=a.length-1,g=numeric.rep([h],0),m=Array(h),y=numeric.rep([h],0),x=Array(h),b=numeric.rep([v+1],0),j=[],w=[],_=numeric.ccsTSolve,k=0;for(i=0;i<v;++i){for(c=0,l=a[i],u=a[i+1],s=l;s<u;++s)d=e.Pinv[f[s]],x[c]=d,y[d]=p[s],++c;for(x.length=c,_(n,y,g,x,m),s=x.length-1;-1!==s;--s)y[x[s]]=0;if(_(r,g,y,m,x),o)return y;for(s=m.length-1;-1!==s;--s)g[m[s]]=0;for(s=x.length-1;-1!==s;--s)d=x[s],j[k]=d,w[k]=y[d],y[d]=0,++k;b[i+1]=k}return[b,j,w]},numeric.ccsbinop=function(e,t){return void 0===t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var t,n=e[0],r=e[1],a=e[2],o=numeric.sup(r)+1,i=n.length,s=numeric.rep([o],0),l=Array(i),u=Array(i),c=numeric.rep([o],0);for(t=0;t<i;++t)c[r[t]]++;for(t=0;t<o;++t)s[t+1]=s[t]+c[t];var d,f,p=s.slice(0);for(t=0;t<i;++t)l[d=p[f=r[t]]]=n[t],u[d]=a[t],p[f]=p[f]+1;return[s,l,u]},numeric.ccsGather=function(e){var t,n,r,a,o,i=e[0],s=e[1],l=e[2],u=i.length-1,c=s.length,d=Array(c),f=Array(c),p=Array(c);for(o=0,t=0;t<u;++t)for(r=i[t],a=i[t+1],n=r;n!==a;++n)f[o]=t,d[o]=s[n],p[o]=l[n],++o;return[d,f,p]},numeric.sdim=function e(t,n,r){if(void 0===n&&(n=[]),"object"!=typeof t)return n;var a;for(a in void 0===r&&(r=0),r in n||(n[r]=0),t.length>n[r]&&(n[r]=t.length),t)t.hasOwnProperty(a)&&e(t[a],n,r+1);return n},numeric.sclone=function e(t,n,r){void 0===n&&(n=0),void 0===r&&(r=numeric.sdim(t).length);var a,o=Array(t.length);if(n===r-1){for(a in t)t.hasOwnProperty(a)&&(o[a]=t[a]);return o}for(a in t)t.hasOwnProperty(a)&&(o[a]=e(t[a],n+1,r));return o},numeric.sdiag=function(e){var t,n,r=e.length,a=Array(r);for(t=r-1;t>=1;t-=2)n=t-1,a[t]=[],a[t][t]=e[t],a[n]=[],a[n][n]=e[n];return 0===t&&(a[0]=[],a[0][0]=e[t]),a},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t,n,r,a=[];e.length;for(t in e)if(e.hasOwnProperty(t))for(n in r=e[t])r.hasOwnProperty(n)&&("object"!=typeof a[n]&&(a[n]=[]),a[n][t]=r[n]);return a},numeric.sLUP=function(e,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var n,r,a,o,i,s,l,u=e.length,c=(t.length,numeric.stranspose(t)),d=c.length,f=Array(u);for(a=u-1;a>=0;a--){for(l=[],n=e[a],i=d-1;i>=0;i--){for(o in s=0,r=c[i],n)n.hasOwnProperty(o)&&o in r&&(s+=n[o]*r[o]);s&&(l[i]=s)}f[a]=l}return f},numeric.sdotMV=function(e,t){var n,r,a,o,i=e.length,s=Array(i);for(r=i-1;r>=0;r--){for(a in o=0,n=e[r])n.hasOwnProperty(a)&&t[a]&&(o+=n[a]*t[a]);o&&(s[r]=o)}return s},numeric.sdotVM=function(e,t){var n,r,a,o,i=[];for(n in e)if(e.hasOwnProperty(n))for(r in a=t[n],o=e[n],a)a.hasOwnProperty(r)&&(i[r]||(i[r]=0),i[r]+=o*a[r]);return i},numeric.sdotVV=function(e,t){var n,r=0;for(n in e)e[n]&&t[n]&&(r+=e[n]*t[n]);return r},numeric.sdot=function(e,t){var n=numeric.sdim(e).length,r=numeric.sdim(t).length;switch(1e3*n+r){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+r)}},numeric.sscatter=function(e){var t,n,r,a,o=e[0].length,i=e.length,s=[];for(n=o-1;n>=0;--n)if(e[i-1][n]){for(a=s,r=0;r<i-2;r++)a[t=e[r][n]]||(a[t]=[]),a=a[t];a[e[r][n]]=e[r+1][n]}return s},numeric.sgather=function e(t,n,r){var a,o,i;for(o in void 0===n&&(n=[]),void 0===r&&(r=[]),a=r.length,t)if(t.hasOwnProperty(o))if(r[a]=parseInt(o),"number"==typeof(i=t[o])){if(i){if(0===n.length)for(o=a+1;o>=0;--o)n[o]=[];for(o=a;o>=0;--o)n[o].push(r[o]);n[a+1].push(i)}}else e(i,n,r);return r.length>a&&r.pop(),n},numeric.cLU=function(e){var t,n,r,a,o,i,s=e[0],l=e[1],u=e[2],c=s.length,d=0;for(t=0;t<c;t++)s[t]>d&&(d=s[t]);d++;var f,p=Array(d),h=Array(d),v=numeric.rep([d],1/0),g=numeric.rep([d],-1/0);for(r=0;r<c;r++)t=s[r],(n=l[r])<v[t]&&(v[t]=n),n>g[t]&&(g[t]=n);for(t=0;t<d-1;t++)g[t]>g[t+1]&&(g[t+1]=g[t]);for(t=d-1;t>=1;t--)v[t]<v[t-1]&&(v[t-1]=v[t]);for(t=0;t<d;t++)h[t]=numeric.rep([g[t]-v[t]+1],0),p[t]=numeric.rep([t-v[t]],0),t-v[t]+1,g[t]-t+1;for(r=0;r<c;r++)h[t=s[r]][l[r]-v[t]]=u[r];for(t=0;t<d-1;t++)for(a=t-v[t],x=h[t],n=t+1;v[n]<=t&&n<d;n++)if(o=t-v[n],i=g[t]-t,f=(b=h[n])[o]/x[a]){for(r=1;r<=i;r++)b[r+o]-=f*x[r+a];p[n][t-v[n]]=f}var m,y,x=[],b=[],j=[],w=[],_=[],k=[];for(c=0,m=0,t=0;t<d;t++){for(a=v[t],o=g[t],y=h[t],n=t;n<=o;n++)y[n-a]&&(x[c]=t,b[c]=n,j[c]=y[n-a],c++);for(y=p[t],n=a;n<t;n++)y[n-a]&&(w[m]=t,_[m]=n,k[m]=y[n-a],m++);w[m]=t,_[m]=t,k[m]=1,m++}return{U:[x,b,j],L:[w,_,k]}},numeric.cLUsolve=function(e,t){var n,r,a=e.L,o=e.U,i=numeric.clone(t),s=a[0],l=a[1],u=a[2],c=o[0],d=o[1],f=o[2],p=c.length,h=(s.length,i.length);for(r=0,n=0;n<h;n++){for(;l[r]<n;)i[n]-=u[r]*i[l[r]],r++;r++}for(r=p-1,n=h-1;n>=0;n--){for(;d[r]>n;)i[n]-=f[r]*i[d[r]],r--;i[n]/=f[r],r--}return i},numeric.cgrid=function(e,t){"number"==typeof e&&(e=[e,e]);var n,r,a,o=numeric.rep(e,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,n){return t>=e[0]/2||n<e[1]/2};break;default:t=function(e,t){return!0}}for(a=0,n=1;n<e[0]-1;n++)for(r=1;r<e[1]-1;r++)t(n,r)&&(o[n][r]=a,a++);return o},numeric.cdelsq=function(e){var t,n,r,a,o,i=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(e),l=s[0],u=s[1],c=[],d=[],f=[];for(t=1;t<l-1;t++)for(n=1;n<u-1;n++)if(!(e[t][n]<0)){for(r=0;r<4;r++)a=t+i[r][0],o=n+i[r][1],e[a][o]<0||(c.push(e[t][n]),d.push(e[a][o]),f.push(-1));c.push(e[t][n]),d.push(e[t][n]),f.push(4)}return[c,d,f]},numeric.cdotMV=function(e,t){var n,r,a,o=e[0],i=e[1],s=e[2],l=o.length;for(a=0,r=0;r<l;r++)o[r]>a&&(a=o[r]);for(a++,n=numeric.rep([a],0),r=0;r<l;r++)n[o[r]]+=s[r]*t[i[r]];return n},numeric.Spline=function(e,t,n,r,a){this.x=e,this.yl=t,this.yr=n,this.kl=r,this.kr=a},numeric.Spline.prototype._at=function(e,t){var n,r,a,o=this.x,i=this.yl,s=this.yr,l=this.kl,u=this.kr,c=numeric.add,d=numeric.sub,f=numeric.mul;n=d(f(l[t],o[t+1]-o[t]),d(s[t+1],i[t])),r=c(f(u[t+1],o[t]-o[t+1]),d(s[t+1],i[t]));var p=(a=(e-o[t])/(o[t+1]-o[t]))*(1-a);return c(c(c(f(1-a,i[t]),f(a,s[t+1])),f(n,p*(1-a))),f(r,p*a))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var t,n,r,a=this.x,o=a.length,i=Math.floor;for(t=0,n=o-1;n-t>1;)a[r=i((t+n)/2)]<=e?t=r:n=r;return this._at(e,t)}o=e.length;var s,l=Array(o);for(s=o-1;-1!==s;--s)l[s]=this.at(e[s]);return l},numeric.Spline.prototype.diff=function(){var e,t,n,r=this.x,a=this.yl,o=this.yr,i=this.kl,s=this.kr,l=a.length,u=i,c=s,d=Array(l),f=Array(l),p=numeric.add,h=numeric.mul,v=numeric.div,g=numeric.sub;for(e=l-1;-1!==e;--e)t=r[e+1]-r[e],n=g(o[e+1],a[e]),d[e]=v(p(h(n,6),h(i[e],-4*t),h(s[e+1],-2*t)),t*t),f[e+1]=v(p(h(n,-6),h(i[e],2*t),h(s[e+1],4*t)),t*t);return new numeric.Spline(r,u,c,d,f)},numeric.Spline.prototype.roots=function(){function e(e){return e*e}var t=[],n=this.x,r=this.yl,a=this.yr,o=this.kl,i=this.kr;"number"==typeof r[0]&&(r=[r],a=[a],o=[o],i=[i]);var s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E=r.length,S=n.length-1,B=(t=Array(E),Math.sqrt);for(s=0;s!==E;++s){for(c=r[s],d=a[s],f=o[s],p=i[s],h=[],l=0;l!==S;l++){for(l>0&&d[l]*c[l]<0&&h.push(n[l]),w=n[l+1]-n[l],n[l],m=c[l],y=d[l+1],v=f[l]/w,x=(g=p[l+1]/w)+3*m+2*v-3*y,b=3*(g+v+2*(m-y)),(j=e(v-g+3*(m-y))+12*g*m)<=0?_=(k=x/b)>n[l]&&k<n[l+1]?[n[l],k,n[l+1]]:[n[l],n[l+1]]:(k=(x-B(j))/b,z=(x+B(j))/b,_=[n[l]],k>n[l]&&k<n[l+1]&&_.push(k),z>n[l]&&z<n[l+1]&&_.push(z),_.push(n[l+1])),M=_[0],k=this._at(M,l),u=0;u<_.length-1;u++)if(O=_[u+1],z=this._at(O,l),0!==k)if(0===z||k*z>0)M=O,k=z;else{for(var T=0;!((F=(k*O-z*M)/(k-z))<=M||F>=O);)if((A=this._at(F,l))*z>0)O=F,z=A,-1===T&&(k*=.5),T=-1;else{if(!(A*k>0))break;M=F,k=A,1===T&&(z*=.5),T=1}h.push(F),M=_[u+1],k=this._at(M,l)}else h.push(M),M=O,k=z;0===z&&h.push(O)}t[s]=h}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(e,t,n,r){var a,o=e.length,i=[],s=[],l=[],u=numeric.sub,c=numeric.mul,d=numeric.add;for(a=o-2;a>=0;a--)s[a]=e[a+1]-e[a],l[a]=u(t[a+1],t[a]);"string"!=typeof n&&"string"!=typeof r||(n=r="periodic");var f=[[],[],[]];switch(typeof n){case"undefined":i[0]=c(3/(s[0]*s[0]),l[0]),f[0].push(0,0),f[1].push(0,1),f[2].push(2/s[0],1/s[0]);break;case"string":i[0]=d(c(3/(s[o-2]*s[o-2]),l[o-2]),c(3/(s[0]*s[0]),l[0])),f[0].push(0,0,0),f[1].push(o-2,0,1),f[2].push(1/s[o-2],2/s[o-2]+2/s[0],1/s[0]);break;default:i[0]=n,f[0].push(0),f[1].push(0),f[2].push(1)}for(a=1;a<o-1;a++)i[a]=d(c(3/(s[a-1]*s[a-1]),l[a-1]),c(3/(s[a]*s[a]),l[a])),f[0].push(a,a,a),f[1].push(a-1,a,a+1),f[2].push(1/s[a-1],2/s[a-1]+2/s[a],1/s[a]);switch(typeof r){case"undefined":i[o-1]=c(3/(s[o-2]*s[o-2]),l[o-2]),f[0].push(o-1,o-1),f[1].push(o-2,o-1),f[2].push(1/s[o-2],2/s[o-2]);break;case"string":f[1][f[1].length-1]=0;break;default:i[o-1]=r,f[0].push(o-1),f[1].push(o-1),f[2].push(1)}i="number"!=typeof i[0]?numeric.transpose(i):[i];var p=Array(i.length);if("string"==typeof n)for(a=p.length-1;-1!==a;--a)p[a]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(f)),i[a]),p[a][o-1]=p[a][0];else for(a=p.length-1;-1!==a;--a)p[a]=numeric.cLUsolve(numeric.cLU(f),i[a]);return p="number"==typeof t[0]?p[0]:numeric.transpose(p),new numeric.Spline(e,t,t,p,p)},numeric.fftpow2=function e(t,n){var r=t.length;if(1!==r){var a,o,i=Math.cos,s=Math.sin,l=Array(r/2),u=Array(r/2),c=Array(r/2),d=Array(r/2);for(o=r/2,a=r-1;-1!==a;--a)c[--o]=t[a],d[o]=n[a],--a,l[o]=t[a],u[o]=n[a];e(l,u),e(c,d),o=r/2;var f,p,h,v=-6.283185307179586/r;for(a=r-1;-1!==a;--a)-1===--o&&(o=r/2-1),p=i(f=v*a),h=s(f),t[a]=l[o]+p*c[o]-h*d[o],n[a]=u[o]+p*d[o]+h*c[o]}},numeric._ifftpow2=function e(t,n){var r=t.length;if(1!==r){var a,o,i=Math.cos,s=Math.sin,l=Array(r/2),u=Array(r/2),c=Array(r/2),d=Array(r/2);for(o=r/2,a=r-1;-1!==a;--a)c[--o]=t[a],d[o]=n[a],--a,l[o]=t[a],u[o]=n[a];e(l,u),e(c,d),o=r/2;var f,p,h,v=6.283185307179586/r;for(a=r-1;-1!==a;--a)-1===--o&&(o=r/2-1),p=i(f=v*a),h=s(f),t[a]=l[o]+p*c[o]-h*d[o],n[a]=u[o]+p*d[o]+h*c[o]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,n,r){var a,o,i,s,l;for(numeric.fftpow2(e,t),numeric.fftpow2(n,r),a=e.length-1;-1!==a;--a)o=e[a],s=t[a],i=n[a],l=r[a],e[a]=o*i-s*l,t[a]=o*l+s*i;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){var e,t,n=this.x,r=this.y,a=n.length,o=Math.log,i=o(2),s=Math.ceil(o(2*a-1)/i),l=Math.pow(2,s),u=numeric.rep([l],0),c=numeric.rep([l],0),d=Math.cos,f=Math.sin,p=-3.141592653589793/a,h=numeric.rep([l],0),v=numeric.rep([l],0);Math.floor(a/2);for(e=0;e<a;e++)h[e]=n[e];if(void 0!==r)for(e=0;e<a;e++)v[e]=r[e];for(u[0]=1,e=1;e<=l/2;e++)t=p*e*e,u[e]=d(t),c[e]=f(t),u[l-e]=d(t),c[l-e]=f(t);var g=new numeric.T(h,v),m=new numeric.T(u,c);return g=g.mul(m),numeric.convpow2(g.x,g.y,numeric.clone(m.x),numeric.neg(m.y)),(g=g.mul(m)).x.length=a,g.y.length=a,g},numeric.T.prototype.ifft=function(){var e,t,n=this.x,r=this.y,a=n.length,o=Math.log,i=o(2),s=Math.ceil(o(2*a-1)/i),l=Math.pow(2,s),u=numeric.rep([l],0),c=numeric.rep([l],0),d=Math.cos,f=Math.sin,p=3.141592653589793/a,h=numeric.rep([l],0),v=numeric.rep([l],0);Math.floor(a/2);for(e=0;e<a;e++)h[e]=n[e];if(void 0!==r)for(e=0;e<a;e++)v[e]=r[e];for(u[0]=1,e=1;e<=l/2;e++)t=p*e*e,u[e]=d(t),c[e]=f(t),u[l-e]=d(t),c[l-e]=f(t);var g=new numeric.T(h,v),m=new numeric.T(u,c);return g=g.mul(m),numeric.convpow2(g.x,g.y,numeric.clone(m.x),numeric.neg(m.y)),(g=g.mul(m)).x.length=a,g.y.length=a,g.div(a)},numeric.gradient=function(e,t){var n=t.length,r=e(t);if(isNaN(r))throw new Error("gradient: f(x) is a NaN!");var a,o,i,s,l,u,c,d,f,p=Math.max,h=numeric.clone(t),v=Array(n),g=(numeric.div,numeric.sub,p=Math.max,Math.abs),m=Math.min,y=0;for(a=0;a<n;a++)for(var x=p(1e-6*r,1e-8);;){if(++y>20)throw new Error("Numerical gradient fails");if(h[a]=t[a]+x,o=e(h),h[a]=t[a]-x,i=e(h),h[a]=t[a],isNaN(o)||isNaN(i))x/=16;else{if(v[a]=(o-i)/(2*x),s=t[a]-x,l=t[a],u=t[a]+x,c=(o-r)/x,d=(r-i)/x,f=p(g(v[a]),g(r),g(o),g(i),g(s),g(l),g(u),1e-8),!(m(p(g(c-v[a]),g(d-v[a]),g(c-d))/f,x/f)>.001))break;x/=16}}return v},numeric.uncmin=function(e,t,n,r,a,o,i){var s=numeric.gradient;void 0===i&&(i={}),void 0===n&&(n=1e-8),void 0===r&&(r=function(t){return s(e,t)}),void 0===a&&(a=1e3);var l,u,c=(t=numeric.clone(t)).length,d=e(t);if(isNaN(d))throw new Error("uncmin: f(x0) is a NaN!");var f=Math.max,p=numeric.norm2;n=f(n,numeric.epsilon);var h,v,g,m,y,x,b,j,w,_,k=i.Hinv||numeric.identity(c),z=numeric.dot,A=(numeric.inv,numeric.sub),M=numeric.add,O=numeric.tensor,F=numeric.div,E=numeric.mul,S=numeric.all,B=numeric.isFinite,T=numeric.neg,N=0,I="";for(v=r(t);N<a;){if("function"==typeof o&&o(N,t,d,v,k)){I="Callback returned true";break}if(!S(B(v))){I="Gradient has Infinity or NaN";break}if(!S(B(h=T(z(k,v))))){I="Search direction has Infinity or NaN";break}if((_=p(h))<n){I="Newton step smaller than tol";break}for(w=1,u=z(v,h),y=t;N<a&&!(w*_<n)&&(y=M(t,m=E(h,w)),(l=e(y))-d>=.1*w*u||isNaN(l));)w*=.5,++N;if(w*_<n){I="Line search step size smaller than tol";break}if(N===a){I="maxit reached during line search";break}j=z(x=A(g=r(y),v),m),b=z(k,x),k=A(M(k,E((j+z(x,b))/(j*j),O(m,m))),F(M(O(b,m),O(m,b)),j)),t=y,d=l,v=g,++N}return{solution:t,f:d,gradient:v,invHessian:k,iterations:N,message:I}},numeric.Dopri=function(e,t,n,r,a,o,i){this.x=e,this.y=t,this.f=n,this.ymid=r,this.iterations=a,this.events=i,this.message=o},numeric.Dopri.prototype._at=function(e,t){function n(e){return e*e}var r,a,o,i,s,l,u,c,d,f=this.x,p=this.y,h=this.f,v=this.ymid,g=(f.length,Math.floor,numeric.add),m=numeric.mul,y=numeric.sub;return r=f[t],a=f[t+1],i=p[t],s=p[t+1],o=r+.5*(a-r),l=v[t],u=y(h[t],m(i,1/(r-o)+2/(r-a))),c=y(h[t+1],m(s,1/(a-o)+2/(a-r))),g(g(g(g(m(i,(d=[n(e-a)*(e-o)/n(r-a)/(r-o),n(e-r)*n(e-a)/n(r-o)/n(a-o),n(e-r)*(e-o)/n(a-r)/(a-o),(e-r)*n(e-a)*(e-o)/n(r-a)/(r-o),(e-a)*n(e-r)*(e-o)/n(r-a)/(a-o)])[0]),m(l,d[1])),m(s,d[2])),m(u,d[3])),m(c,d[4]))},numeric.Dopri.prototype.at=function(e){var t,n,r,a=Math.floor;if("number"!=typeof e){var o=e.length,i=Array(o);for(t=o-1;-1!==t;--t)i[t]=this.at(e[t]);return i}var s=this.x;for(t=0,n=s.length-1;n-t>1;)s[r=a(.5*(t+n))]<=e?t=r:n=r;return this._at(e,t)},numeric.dopri=function(e,t,n,r,a,o,i){void 0===a&&(a=1e-6),void 0===o&&(o=1e3);var s,l,u,c,d,f,p,h,v,g,m,y,x,b=[e],j=[n],w=[r(e,n)],_=[],k=[3/40,9/40],z=[44/45,-56/15,32/9],A=[19372/6561,-25360/2187,64448/6561,-212/729],M=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],O=[35/384,0,500/1113,125/192,-2187/6784,11/84],F=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],E=[.2,.3,.8,8/9,1,1],S=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],B=0,T=(t-e)/10,N=0,I=numeric.add,C=numeric.mul,q=(Math.max,Math.min),V=Math.abs,D=numeric.norminf,U=Math.pow,P=numeric.any,L=numeric.lt,R=numeric.and,H=(numeric.sub,new numeric.Dopri(b,j,w,_,-1,""));for("function"==typeof i&&(m=i(e,n));e<t&&N<o;)if(++N,e+T>t&&(T=t-e),s=r(e+E[0]*T,I(n,C(.2*T,w[B]))),l=r(e+E[1]*T,I(I(n,C(k[0]*T,w[B])),C(k[1]*T,s))),u=r(e+E[2]*T,I(I(I(n,C(z[0]*T,w[B])),C(z[1]*T,s)),C(z[2]*T,l))),c=r(e+E[3]*T,I(I(I(I(n,C(A[0]*T,w[B])),C(A[1]*T,s)),C(A[2]*T,l)),C(A[3]*T,u))),d=r(e+E[4]*T,I(I(I(I(I(n,C(M[0]*T,w[B])),C(M[1]*T,s)),C(M[2]*T,l)),C(M[3]*T,u)),C(M[4]*T,c))),f=r(e+T,v=I(I(I(I(I(n,C(w[B],T*O[0])),C(l,T*O[2])),C(u,T*O[3])),C(c,T*O[4])),C(d,T*O[5]))),(g="number"==typeof(p=I(I(I(I(I(C(w[B],T*S[0]),C(l,T*S[2])),C(u,T*S[3])),C(c,T*S[4])),C(d,T*S[5])),C(f,T*S[6])))?V(p):D(p))>a){if(e+(T=.2*T*U(a/g,.25))===e){H.msg="Step size became too small";break}}else{if(_[B]=I(I(I(I(I(I(n,C(w[B],T*F[0])),C(l,T*F[2])),C(u,T*F[3])),C(c,T*F[4])),C(d,T*F[5])),C(f,T*F[6])),b[++B]=e+T,j[B]=v,w[B]=f,"function"==typeof i){var Y,X,G=e,W=e+.5*T;if(y=i(W,_[B-1]),P(x=R(L(m,0),L(0,y)))||(G=W,m=y,y=i(W=e+T,v),x=R(L(m,0),L(0,y))),P(x)){for(var Q,Z,K=0,J=1,$=1;;){if("number"==typeof m)X=($*y*G-J*m*W)/($*y-J*m);else for(X=W,h=m.length-1;-1!==h;--h)m[h]<0&&y[h]>0&&(X=q(X,($*y[h]*G-J*m[h]*W)/($*y[h]-J*m[h])));if(X<=G||X>=W)break;Z=i(X,Y=H._at(X,B-1)),P(Q=R(L(m,0),L(0,Z)))?(W=X,y=Z,x=Q,$=1,-1===K?J*=.5:J=1,K=-1):(G=X,m=Z,J=1,1===K?$*=.5:$=1,K=1)}return v=H._at(.5*(e+X),B-1),H.f[B]=r(X,Y),H.x[B]=X,H.y[B]=Y,H.ymid[B-1]=v,H.events=x,H.iterations=N,H}}e+=T,n=v,m=y,T=q(.8*T*U(a/g,.25),4*T)}return H.iterations=N,H},numeric.LU=function(e,t){t=t||!1;var n,r,a,o,i,s,l,u,c,d=Math.abs,f=e.length,p=f-1,h=new Array(f);for(t||(e=numeric.clone(e)),a=0;a<f;++a){for(l=a,c=d((s=e[a])[a]),r=a+1;r<f;++r)c<(o=d(e[r][a]))&&(c=o,l=r);for(h[a]=l,l!=a&&(e[a]=e[l],e[l]=s,s=e[a]),i=s[a],n=a+1;n<f;++n)e[n][a]/=i;for(n=a+1;n<f;++n){for(u=e[n],r=a+1;r<p;++r)u[r]-=u[a]*s[r],u[++r]-=u[a]*s[r];r===p&&(u[r]-=u[a]*s[r])}}return{LU:e,P:h}},numeric.LUsolve=function(e,t){var n,r,a,o,i,s=e.LU,l=s.length,u=numeric.clone(t),c=e.P;for(n=l-1;-1!==n;--n)u[n]=t[n];for(n=0;n<l;++n)for(a=c[n],c[n]!==n&&(i=u[n],u[n]=u[a],u[a]=i),o=s[n],r=0;r<n;++r)u[n]-=u[r]*o[r];for(n=l-1;n>=0;--n){for(o=s[n],r=n+1;r<l;++r)u[n]-=u[r]*o[r];u[n]/=o[n]}return u},numeric.solve=function(e,t,n){return numeric.LUsolve(numeric.LU(e,n),t)},numeric.echelonize=function(e){var t,n,r,a,o,i,s,l,u=numeric.dim(e),c=u[0],d=u[1],f=numeric.identity(c),p=Array(c),h=Math.abs,v=numeric.diveq;for(e=numeric.clone(e),t=0;t<c;++t){for(r=0,o=e[t],i=f[t],n=1;n<d;++n)h(o[r])<h(o[n])&&(r=n);for(p[t]=r,v(i,o[r]),v(o,o[r]),n=0;n<c;++n)if(n!==t){for(l=(s=e[n])[r],a=d-1;-1!==a;--a)s[a]-=o[a]*l;for(s=f[n],a=c-1;-1!==a;--a)s[a]-=i[a]*l}}return{I:f,A:e,P:p}},numeric.__solveLP=function(e,t,n,r,a,o,i){var s,l,u,c,d=numeric.sum,f=(numeric.log,numeric.mul),p=numeric.sub,h=numeric.dot,v=numeric.div,g=numeric.add,m=e.length,y=n.length,x=!1,b=1,j=(numeric.transpose(t),numeric.svd,numeric.transpose),w=(numeric.leq,Math.sqrt),_=Math.abs,k=(numeric.muleq,numeric.norminf,numeric.any,Math.min),z=numeric.all,A=numeric.gt,M=Array(m),O=Array(y),F=(numeric.rep([y],1),numeric.solve),E=p(n,h(t,o)),S=h(e,e);for(u=0;u<a;++u){var B,T;for(B=y-1;-1!==B;--B)O[B]=v(t[B],E[B]);var N=j(O);for(B=m-1;-1!==B;--B)M[B]=d(N[B]);b=.25*_(S/h(e,M));var I=100*w(S/h(M,M));for((!isFinite(b)||b>I)&&(b=I),c=g(e,f(b,M)),l=h(N,O),B=m-1;-1!==B;--B)l[B][B]+=1;T=F(l,v(c,b),!0);var C=v(E,h(t,T)),q=1;for(B=y-1;-1!==B;--B)C[B]<0&&(q=k(q,-.999*C[B]));if(s=p(o,f(T,q)),!z(A(E=p(n,h(t,s)),0)))return{solution:o,message:"",iterations:u};if(o=s,b<r)return{solution:s,message:"",iterations:u};if(i){var V=h(e,c),D=h(t,c);for(x=!0,B=y-1;-1!==B;--B)if(V*D[B]<0){x=!1;break}}else x=!(o[m-1]>=0);if(x)return{solution:s,message:"Unbounded",iterations:u}}return{solution:o,message:"maximum iteration count exceeded",iterations:u}},numeric._solveLP=function(e,t,n,r,a){var o=e.length,i=n.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),l=numeric.dot,u=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),c=numeric.rep([i,1],-1),d=numeric.blockMatrix([[t,c]]),f=n,p=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),h=numeric.__solveLP(u,d,f,r,a,p,!1),v=numeric.clone(h.solution);if(v.length=o,numeric.inf(s(n,l(t,v)))<0)return{solution:NaN,message:"Infeasible",iterations:h.iterations};var g=numeric.__solveLP(e,t,n,r,a-h.iterations,v,!0);return g.iterations+=h.iterations,g},numeric.solveLP=function(e,t,n,r,a,o,i){if(void 0===i&&(i=1e3),void 0===o&&(o=numeric.epsilon),void 0===r)return numeric._solveLP(e,t,n,o,i);var s,l=r.length,u=r[0].length,c=t.length,d=numeric.echelonize(r),f=numeric.rep([u],0),p=d.P,h=[];for(s=p.length-1;-1!==s;--s)f[p[s]]=1;for(s=u-1;-1!==s;--s)0===f[s]&&h.push(s);var v=numeric.getRange,g=numeric.linspace(0,l-1),m=numeric.linspace(0,c-1),y=v(r,g,h),x=v(t,m,p),b=v(t,m,h),j=numeric.dot,w=numeric.sub,_=j(x,d.I),k=w(b,j(_,y)),z=w(n,j(_,a)),A=Array(p.length),M=Array(h.length);for(s=p.length-1;-1!==s;--s)A[s]=e[p[s]];for(s=h.length-1;-1!==s;--s)M[s]=e[h[s]];var O=w(M,j(A,j(d.I,y))),F=numeric._solveLP(O,k,z,o,i),E=F.solution;if(E!=E)return F;var S=j(d.I,w(a,j(y,E))),B=Array(e.length);for(s=p.length-1;-1!==s;--s)B[p[s]]=S[s];for(s=h.length-1;-1!==s;--s)B[h[s]]=E[s];return{solution:B,message:F.message,iterations:F.iterations}},numeric.MPStoLP=function(e){e instanceof String&&e.split("\n");var t,n,r,a,o=0,i=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=e.length,l=0,u={},c=[],d=0,f={},p=0,h=[],v=[],g=[];function m(n){throw new Error("MPStoLP: "+n+"\nLine "+t+": "+e[t]+"\nCurrent state: "+i[o]+"\n")}for(t=0;t<s;++t){var y=(r=e[t]).match(/\S*/g),x=[];for(n=0;n<y.length;++n)""!==y[n]&&x.push(y[n]);if(0!==x.length){for(n=0;n<i.length&&r.substr(0,i[n].length)!==i[n];++n);if(n<i.length){if(o=n,1===n&&(a=x[1]),6===n)return{name:a,c:h,A:numeric.transpose(v),b:g,rows:u,vars:f}}else switch(o){case 0:case 1:m("Unexpected line");case 2:switch(x[0]){case"N":0===l?l=x[1]:m("Two or more N rows");break;case"L":u[x[1]]=d,c[d]=1,g[d]=0,++d;break;case"G":u[x[1]]=d,c[d]=-1,g[d]=0,++d;break;case"E":u[x[1]]=d,c[d]=0,g[d]=0,++d;break;default:m("Parse error "+numeric.prettyPrint(x))}break;case 3:f.hasOwnProperty(x[0])||(f[x[0]]=p,h[p]=0,v[p]=numeric.rep([d],0),++p);var b=f[x[0]];for(n=1;n<x.length;n+=2)if(x[n]!==l){var j=u[x[n]];v[b][j]=(c[j]<0?-1:1)*parseFloat(x[n+1])}else h[b]=parseFloat(x[n+1]);break;case 4:for(n=1;n<x.length;n+=2)g[u[x[n]]]=(c[u[x[n]]]<0?-1:1)*parseFloat(x[n+1]);break;case 5:break;case 6:m("Internal error")}}}m("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,t,n,r,a,o,i){function s(e){var t,n,r=this,a=e.length,o=0,i=r.i=r.j=r.m=0;for(r.S=[],r.c=[],a||(e=[a++]);o<256;)r.S[o]=o++;for(o=0;o<256;o++)i=c(i+(t=r.S[o])+e[o%a]),n=r.S[i],r.S[o]=n,r.S[i]=t;r.g=function(e){var t=r.S,n=c(r.i+1),a=t[n],o=c(r.j+a),i=t[o];t[n]=i,t[o]=a;for(var s=t[c(a+i)];--e;)n=c(n+1),i=t[o=c(o+(a=t[n]))],t[n]=i,t[o]=a,s=256*s+t[c(a+i)];return r.i=n,r.j=o,s},r.g(256)}function l(e,t,n,r,a){if(n=[],a=typeof e,t&&"object"==a)for(r in e)if(r.indexOf("S")<5)try{n.push(l(e[r],t-1))}catch(e){}return n.length?n:e+("string"!=a?"\0":"")}function u(e,t,n,r){for(e+="",n=0,r=0;r<e.length;r++)t[c(r)]=c((n^=19*t[c(r)])+e.charCodeAt(r));for(r in e="",t)e+=String.fromCharCode(t[r]);return e}function c(e){return 255&e}t.seedrandom=function(n,r){var c,d=[];return n=u(l(r?[n,e]:arguments.length?n:[(new Date).getTime(),e,window],3),d),u((c=new s(d)).S,e),t.random=function(){for(var e=c.g(6),t=i,n=0;e<a;)e=256*(e+n),t*=256,n=c.g(1);for(;e>=o;)e/=2,t/=2,n>>>=1;return(e+n)/t},n},i=t.pow(256,6),a=t.pow(2,a),o=2*a,u(t.random(),e)}([],numeric.seedrandom,0,0,52),function(e){function t(e){if("object"!=typeof e)return e;var n,r=[],a=e.length;for(n=0;n<a;n++)r[n+1]=t(e[n]);return r}function n(e){if("object"!=typeof e)return e;var t,r=[],a=e.length;for(t=1;t<a;t++)r[t-1]=n(e[t]);return r}function r(e,t,n,r,a,o,i,s,l,u,c,d,f,p,h,v){var g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B,T,N,I,C,q,V,D,U,P,L;O=Math.min(r,u),y=2*r+O*(O+5)/2+2*u+1,D=1e-60;do{U=1+.1*(D+=D),P=1+.2*D}while(U<=1||P<=1);for(g=1;g<=r;g+=1)h[g]=t[g];for(g=r+1;g<=y;g+=1)h[g]=0;for(g=1;g<=u;g+=1)d[g]=0;if(b=[],0===v[1]){if(function(e,t,n,r){var a,o,i,s,l,u;for(o=1;o<=n;o+=1){if(r[1]=o,u=0,(i=o-1)<1){if((u=e[o][o]-u)<=0)break;e[o][o]=Math.sqrt(u)}else{for(s=1;s<=i;s+=1){for(l=e[s][o],a=1;a<s;a+=1)l-=e[a][o]*e[a][s];l/=e[s][s],e[s][o]=l,u+=l*l}if((u=e[o][o]-u)<=0)break;e[o][o]=Math.sqrt(u)}r[1]=0}}(e,0,r,b),0!==b[1])return void(v[1]=2);!function(e,t,n,r){var a,o,i,s;for(o=1;o<=n;o+=1){for(s=0,a=1;a<o;a+=1)s+=e[a][o]*r[a];r[o]=(r[o]-s)/e[o][o]}for(i=1;i<=n;i+=1)for(r[o=n+1-i]=r[o]/e[o][o],s=-r[o],a=1;a<o;a+=1)r[a]=r[a]+s*e[a][o]}(e,0,r,t),function(e,t,n){var r,a,o,i,s;for(o=1;o<=n;o+=1){for(e[o][o]=1/e[o][o],s=-e[o][o],r=1;r<o;r+=1)e[r][o]=s*e[r][o];if(n<(i=o+1))break;for(a=i;a<=n;a+=1)for(s=e[o][a],e[o][a]=0,r=1;r<=o;r+=1)e[r][a]=e[r][a]+s*e[r][o]}}(e,0,r)}else{for(m=1;m<=r;m+=1)for(a[m]=0,g=1;g<=m;g+=1)a[m]=a[m]+e[g][m]*t[g];for(m=1;m<=r;m+=1)for(t[m]=0,g=m;g<=r;g+=1)t[m]=t[m]+e[m][g]*a[g]}for(o[1]=0,m=1;m<=r;m+=1)for(a[m]=t[m],o[1]=o[1]+h[m]*a[m],h[m]=0,g=m+1;g<=r;g+=1)e[g][m]=0;for(o[1]=-o[1]/2,v[1]=0,F=(z=(k=(A=(_=(w=r)+r)+O)+O+1)+O*(O+1)/2)+u,g=1;g<=u;g+=1){for(S=0,m=1;m<=r;m+=1)S+=i[m][g]*i[m][g];h[F+g]=Math.sqrt(S)}function R(){for(p[1]=p[1]+1,y=z,g=1;g<=u;g+=1){for(y+=1,S=-s[g],m=1;m<=r;m+=1)S+=i[m][g]*a[m];if(Math.abs(S)<D&&(S=0),g>c)h[y]=S;else if(h[y]=-Math.abs(S),S>0){for(m=1;m<=r;m+=1)i[m][g]=-i[m][g];s[g]=-s[g]}}for(g=1;g<=f;g+=1)h[z+d[g]]=0;for(M=0,E=0,g=1;g<=u;g+=1)h[z+g]<E*h[F+g]&&(M=g,E=h[z+g]/h[F+g]);return 0===M?999:0}function H(){for(g=1;g<=r;g+=1){for(S=0,m=1;m<=r;m+=1)S+=e[m][g]*i[m][M];h[g]=S}for(x=w,g=1;g<=r;g+=1)h[x+g]=0;for(m=f+1;m<=r;m+=1)for(g=1;g<=r;g+=1)h[x+g]=h[x+g]+e[g][m]*h[m];for(q=!0,g=f;g>=1;g-=1){for(S=h[g],x=(y=k+g*(g+3)/2)-g,m=g+1;m<=f;m+=1)S-=h[y]*h[_+m],y+=m;if(S/=h[x],h[_+g]=S,d[g]<c)break;if(S<0)break;q=!1,j=g}if(!q)for(B=h[A+j]/h[_+j],g=1;g<=f&&!(d[g]<c)&&!(h[_+g]<0);g+=1)(E=h[A+g]/h[_+g])<B&&(B=E,j=g);for(S=0,g=w+1;g<=w+r;g+=1)S+=h[g]*h[g];if(Math.abs(S)<=D){if(q)return v[1]=1,999;for(g=1;g<=f;g+=1)h[A+g]=h[A+g]-B*h[_+g];return h[A+f+1]=h[A+f+1]+B,700}for(S=0,g=1;g<=r;g+=1)S+=h[w+g]*i[g][M];for(T=-h[z+M]/S,V=!0,q||B<T&&(T=B,V=!1),g=1;g<=r;g+=1)a[g]=a[g]+T*h[w+g],Math.abs(a[g])<D&&(a[g]=0);for(o[1]=o[1]+T*S*(T/2+h[A+f+1]),g=1;g<=f;g+=1)h[A+g]=h[A+g]-T*h[_+g];if(h[A+f+1]=h[A+f+1]+T,!V){for(S=-s[M],m=1;m<=r;m+=1)S+=a[m]*i[m][M];if(M>c)h[z+M]=S;else if(h[z+M]=-Math.abs(S),S>0){for(m=1;m<=r;m+=1)i[m][M]=-i[m][M];s[M]=-s[M]}return 700}for(d[f+=1]=M,y=k+(f-1)*f/2+1,g=1;g<=f-1;g+=1)h[y]=h[g],y+=1;if(f===r)h[y]=h[r];else{for(g=r;g>=f+1&&0!==h[g]&&(N=Math.max(Math.abs(h[g-1]),Math.abs(h[g])),I=Math.min(Math.abs(h[g-1]),Math.abs(h[g])),E=h[g-1]>=0?Math.abs(N*Math.sqrt(1+I*I/(N*N))):-Math.abs(N*Math.sqrt(1+I*I/(N*N))),N=h[g-1]/E,I=h[g]/E,1!==N);g-=1)if(0===N)for(h[g-1]=I*E,m=1;m<=r;m+=1)E=e[m][g-1],e[m][g-1]=e[m][g],e[m][g]=E;else for(h[g-1]=E,C=I/(1+N),m=1;m<=r;m+=1)E=N*e[m][g-1]+I*e[m][g],e[m][g]=C*(e[m][g-1]+E)-e[m][g],e[m][g-1]=E;h[y]=h[f]}return 0}function Y(){if(0===h[x=(y=k+j*(j+1)/2+1)+j])return 798;if(N=Math.max(Math.abs(h[x-1]),Math.abs(h[x])),I=Math.min(Math.abs(h[x-1]),Math.abs(h[x])),E=h[x-1]>=0?Math.abs(N*Math.sqrt(1+I*I/(N*N))):-Math.abs(N*Math.sqrt(1+I*I/(N*N))),N=h[x-1]/E,I=h[x]/E,1===N)return 798;if(0===N){for(g=j+1;g<=f;g+=1)E=h[x-1],h[x-1]=h[x],h[x]=E,x+=g;for(g=1;g<=r;g+=1)E=e[g][j],e[g][j]=e[g][j+1],e[g][j+1]=E}else{for(C=I/(1+N),g=j+1;g<=f;g+=1)E=N*h[x-1]+I*h[x],h[x]=C*(h[x-1]+E)-h[x],h[x-1]=E,x+=g;for(g=1;g<=r;g+=1)E=N*e[g][j]+I*e[g][j+1],e[g][j+1]=C*(e[g][j]+E)-e[g][j+1],e[g][j]=E}return 0}function X(){for(x=y-j,g=1;g<=j;g+=1)h[x]=h[y],y+=1,x+=1;return h[A+j]=h[A+j+1],d[j]=d[j+1],(j+=1)<f?797:0}function G(){return h[A+f]=h[A+f+1],h[A+f+1]=0,d[f]=0,f-=1,p[2]=p[2]+1,0}for(f=0,p[1]=0,p[2]=0,L=0;;){if(999===(L=R()))return;for(;0!==(L=H());){if(999===L)return;if(700===L)if(j===f)G();else{for(;Y(),797===(L=X()););G()}}}}e.solveQP=function(e,a,o,i,s,l){e=t(e),a=t(a),o=t(o);var u,c,d,f,p,h=[],v=[],g=[],m=[],y=[];if(s=s||0,l=l?t(l):[void 0,0],i=i?t(i):[],c=e.length-1,d=o[1].length-1,!i)for(u=1;u<=d;u+=1)i[u]=0;for(u=1;u<=d;u+=1)v[u]=0;for(0,f=Math.min(c,d),u=1;u<=c;u+=1)g[u]=0;for(h[1]=0,u=1;u<=2*c+f*(f+5)/2+2*d+1;u+=1)m[u]=0;for(u=1;u<=2;u+=1)y[u]=0;return r(e,a,0,c,g,h,o,i,0,d,s,v,0,y,m,l),p="",1===l[1]&&(p="constraints are inconsistent, no solution!"),2===l[1]&&(p="matrix D in quadratic function is not positive definite!"),{solution:n(g),value:n(h),unconstrained_solution:n(a),iterations:n(y),iact:n(v),message:p}}}(numeric),numeric.svd=function(e){var t,n=numeric.epsilon,r=1e-64/n,a=0,o=0,i=0,s=0,l=0,u=numeric.clone(e),c=u.length,d=u[0].length;if(c<d)throw"Need more rows than columns";var f=new Array(d),p=new Array(d);for(o=0;o<d;o++)f[o]=p[o]=0;var h=numeric.rep([d,d],0);function v(e,t){return(e=Math.abs(e))>(t=Math.abs(t))?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var g=0,m=0,y=0,x=0,b=0,j=0,w=0;for(o=0;o<d;o++){for(f[o]=m,w=0,l=o+1,i=o;i<c;i++)w+=u[i][o]*u[i][o];if(w<=r)m=0;else for(g=u[o][o],m=Math.sqrt(w),g>=0&&(m=-m),y=g*m-w,u[o][o]=g-m,i=l;i<d;i++){for(w=0,s=o;s<c;s++)w+=u[s][o]*u[s][i];for(g=w/y,s=o;s<c;s++)u[s][i]+=g*u[s][o]}for(p[o]=m,w=0,i=l;i<d;i++)w+=u[o][i]*u[o][i];if(w<=r)m=0;else{for(g=u[o][o+1],m=Math.sqrt(w),g>=0&&(m=-m),y=g*m-w,u[o][o+1]=g-m,i=l;i<d;i++)f[i]=u[o][i]/y;for(i=l;i<c;i++){for(w=0,s=l;s<d;s++)w+=u[i][s]*u[o][s];for(s=l;s<d;s++)u[i][s]+=w*f[s]}}(b=Math.abs(p[o])+Math.abs(f[o]))>x&&(x=b)}for(o=d-1;-1!=o;o+=-1){if(0!=m){for(y=m*u[o][o+1],i=l;i<d;i++)h[i][o]=u[o][i]/y;for(i=l;i<d;i++){for(w=0,s=l;s<d;s++)w+=u[o][s]*h[s][i];for(s=l;s<d;s++)h[s][i]+=w*h[s][o]}}for(i=l;i<d;i++)h[o][i]=0,h[i][o]=0;h[o][o]=1,m=f[o],l=o}for(o=d-1;-1!=o;o+=-1){for(l=o+1,m=p[o],i=l;i<d;i++)u[o][i]=0;if(0!=m){for(y=u[o][o]*m,i=l;i<d;i++){for(w=0,s=l;s<c;s++)w+=u[s][o]*u[s][i];for(g=w/y,s=o;s<c;s++)u[s][i]+=g*u[s][o]}for(i=o;i<c;i++)u[i][o]=u[i][o]/m}else for(i=o;i<c;i++)u[i][o]=0;u[o][o]+=1}for(n*=x,s=d-1;-1!=s;s+=-1)for(var _=0;_<50;_++){var k=!1;for(l=s;-1!=l;l+=-1){if(Math.abs(f[l])<=n){k=!0;break}if(Math.abs(p[l-1])<=n)break}if(!k){a=0,w=1;var z=l-1;for(o=l;o<s+1&&(g=w*f[o],f[o]=a*f[o],!(Math.abs(g)<=n));o++)for(y=v(g,m=p[o]),p[o]=y,a=m/y,w=-g/y,i=0;i<c;i++)b=u[i][z],j=u[i][o],u[i][z]=b*a+j*w,u[i][o]=-b*w+j*a}if(j=p[s],l==s){if(j<0)for(p[s]=-j,i=0;i<d;i++)h[i][s]=-h[i][s];break}if(_>=49)throw"Error: no convergence.";for(x=p[l],m=v(g=(((b=p[s-1])-j)*(b+j)+((m=f[s-1])-(y=f[s]))*(m+y))/(2*y*b),1),g=g<0?((x-j)*(x+j)+y*(b/(g-m)-y))/x:((x-j)*(x+j)+y*(b/(g+m)-y))/x,a=1,w=1,o=l+1;o<s+1;o++){for(m=f[o],b=p[o],y=w*m,m*=a,j=v(g,y),f[o-1]=j,g=x*(a=g/j)+m*(w=y/j),m=-x*w+m*a,y=b*w,b*=a,i=0;i<d;i++)x=h[i][o-1],j=h[i][o],h[i][o-1]=x*a+j*w,h[i][o]=-x*w+j*a;for(j=v(g,y),p[o-1]=j,g=(a=g/j)*m+(w=y/j)*b,x=-w*m+a*b,i=0;i<c;i++)b=u[i][o-1],j=u[i][o],u[i][o-1]=b*a+j*w,u[i][o]=-b*w+j*a}f[l]=0,f[s]=g,p[s]=x}for(o=0;o<p.length;o++)p[o]<n&&(p[o]=0);for(o=0;o<d;o++)for(i=o-1;i>=0;i--)if(p[i]<p[o]){for(a=p[i],p[i]=p[o],p[o]=a,s=0;s<u.length;s++)t=u[s][o],u[s][o]=u[s][i],u[s][i]=t;for(s=0;s<h.length;s++)t=h[s][o],h[s][o]=h[s][i],h[s][i]=t;o=i}return{U:u,S:p,V:h}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],22:[function(e,t,n){!function(){"use strict";function e(e,t,n){var r=t.x,a=t.y,o=n.x-r,i=n.y-a;if(0!==o||0!==i){var s=((e.x-r)*o+(e.y-a)*i)/(o*o+i*i);s>1?(r=n.x,a=n.y):s>0&&(r+=o*s,a+=i*s)}return(o=e.x-r)*o+(i=e.y-a)*i}function n(t,n){var r=t.length-1,a=[t[0]];return function t(n,r,a,o,i){for(var s,l=o,u=r+1;u<a;u++){var c=e(n[u],n[r],n[a]);c>l&&(s=u,l=c)}l>o&&(s-r>1&&t(n,r,s,o,i),i.push(n[s]),a-s>1&&t(n,s,a,o,i))}(t,0,r,n,a),a.push(t[r]),a}function r(e,t,r){if(e.length<=2)return e;var a=void 0!==t?t*t:1;return e=n(e=r?e:function(e,t){for(var n,r,a,o,i,s=e[0],l=[s],u=1,c=e.length;u<c;u++)n=e[u],a=s,o=void 0,i=void 0,o=(r=n).x-a.x,i=r.y-a.y,o*o+i*i>t&&(l.push(n),s=n);return s!==n&&l.push(n),l}(e,a),a)}"function"==typeof define&&define.amd?define((function(){return r})):void 0!==t?(t.exports=r,t.exports.default=r):"undefined"!=typeof self?self.simplify=r:window.simplify=r}()},{}],23:[function(e,t,n){"use strict";t.exports=function(e){var t,n,d;if(Array.isArray(e)){if(0===(t=e.length))return new f(null,null,0,0);n=e[0].length,d=r(l.mallocDouble(t*(n+1)),[t,n+1]),o(e,d.hi(t,n))}else{t=e.shape[0],n=e.shape[1];var p=e.dtype;p="int8"===p||"int16"===p||"int32"===p?"int32":"uint8"===p||"uint8_clamped"===p||"buffer"===p||"uint16"===p||"uint32"===p?"uint32":"float32"===p?"float32":"float64",d=r(l.malloc(t*(n+1),p),[t,n+1]),i.assign(d.hi(t,n),e)}for(var v=0;v<t;++v)d.set(v,n,v);var g=s.malloc([t,n],e.dtype),m=l.mallocInt32(t),y=0,x=g.data,b=d.data,j=(c.log2(c.nextPow2(t)),a.compile(d.order,!0,d.dtype)),w=new h;w.push(d);for(;y<t;){var _=w.pop(),k=0|_.shape[0];if(k>1){var z,A=c.log2(y+1)%n,M=u.root(k);z=j(_,M,(function(e,t){return e.get(A)-t.get(A)}));var O=g.index(y,0),F=z.offset;for(v=0;v<n;++v)x[O++]=b[F++];m[y]=b[F],y+=1,w.push(_.hi(M)),k>2&&w.push(_.lo(M+1))}else{for(F=_.offset,O=g.index(y,0),v=0;v<n;++v)x[O+v]=b[F++];m[y]=b[F],y+=1}}return l.free(d.data),new f(g,m,t,n)},t.exports.deserialize=function(e){var t=e.p,n=e.i;if(t){for(var a=t.length,o=l.mallocFloat64(a),i=0;i<a;++i)o[i]=t[i];var s=n.length,u=l.mallocInt32(s);for(i=0;i<s;++i)u[i]=n[i];var c=a/s|0;return new f(r(o,[s,c]),u,s,c)}return new f(null,null,0,e.d)};var r=e("ndarray"),a=e("ndarray-select"),o=e("ndarray-pack"),i=e("ndarray-ops"),s=e("ndarray-scratch"),l=e("typedarray-pool"),u=e("inorder-tree-layout"),c=e("bit-twiddle"),d=e("./lib/heap.js");function f(e,t,n,r){this.points=e,this.ids=t,this.dimension=r,this.length=n}var p=f.prototype;function h(){this.data=[],this.offset=0}p.serialize=function(){return this.length>0?{p:Array.prototype.slice.call(this.points.data,0,this.length*this.dimension),i:Array.prototype.slice.call(this.ids,0,this.length)}:{d:this.dimension}},p.range=function(e,t,n){var r=this.length;if(!(r<1)){for(var a=this.dimension,i=0;i<a;++i)if(t[i]<e[i])return;var u,d=this.points,f=this.ids,p=s.malloc([r,2,a]),h=l.mallocInt32(r),v=p.data,g=d.data,m=1,y=0;for(h[0]=0,o(e,p.pick(0,0)),o(t,p.pick(0,1));y<m;){var x=h[y],b=c.log2(x+1)%a,j=p.index(y,0,0),w=p.index(y,1,0),_=d.index(x,0),k=!0;for(i=0;i<a;++i){var z=g[_+i];if(z<v[j+i]||v[w+i]<z){k=!1;break}}if(k&&void 0!==(u=n(f[x])))break;var A=g[_+b],M=v[w+b],O=v[j+b];if(O<=A){var F=2*x+1;if(F<r){h[m]=F;var E=p.index(m,0,0);for(i=0;i<a;++i)v[E+i]=v[j+i];var S=p.index(m,1,0);for(i=0;i<a;++i)v[S+i]=v[w+i];v[S+b]=Math.min(M,A),m+=1}}if(A<=M){var B=2*(x+1);if(B<r){h[m]=B;for(E=p.index(m,0,0),i=0;i<a;++i)v[E+i]=v[j+i];for(S=p.index(m,1,0),i=0;i<a;++i)v[S+i]=v[w+i];v[E+b]=Math.max(O,A),m+=1}}y+=1}return s.free(p),l.free(h),u}},p.rnn=function(e,t,n){if(!(t<0)){var r=this.length;if(!(r<1)){var a,o=this.dimension,i=this.points,u=this.ids,d=s.malloc([r,o]),f=l.mallocInt32(r),p=d.data,h=i.data,v=1,g=0,m=t*t;f[0]=0;for(var y=0;y<o;++y)d.set(0,y,0);for(;g<v;){var x=f[g],b=i.index(x,0),j=0;for(y=0;y<o;++y)j+=Math.pow(e[y]-h[b+y],2);if(j<=m&&void 0!==(a=n(u[x])))break;var w=c.log2(x+1)%o,_=0,k=d.index(g,0);for(y=0;y<o;++y)y!==w&&(_+=p[k+y]);var z=e[w],A=h[b+w],M=p[k+w],O=M,F=M;z<A?F=Math.max(M,Math.pow(A-z,2)):O=Math.max(M,Math.pow(A-z,2));var E=F+_;if(O+_<=m){var S=2*x+1;if(S<r){f[v]=S;var B=d.index(v,0);for(y=0;y<o;++y)p[B+y]=p[k+y];p[B+w]=O,v+=1}}if(E<=m){var T=2*(x+1);if(T<r){f[v]=T;for(B=d.index(v,0),y=0;y<o;++y)p[B+y]=p[k+y];p[B+w]=F,v+=1}}g+=1}return s.free(d),l.free(f),a}}},p.nn=function(e,t){var n=this.length;if(n<1)return-1;if("number"==typeof t){if(t<0)return-1}else t=1/0;var r=this.dimension,a=this.points,o=a.data,i=l.mallocFloat64(r),s=new d(n,r+1),u=s.index,f=s.data;u[0]=0;for(var p=0;p<=r;++p)f[p]=0;s.count+=1;for(var h=-1,v=t;s.count>0&&!(f[0]>=v);){var g=u[0],m=a.index(g,0),y=0;for(p=0;p<r;++p)y+=Math.pow(e[p]-o[m+p],2);y<v&&(v=y,h=g);var x=c.log2(g+1)%r,b=0;for(p=0;p<r;++p){var j=f[p+1];p!==x&&(b+=j),i[p]=j}var w=e[x],_=o[m+x],k=i[x],z=k,A=k;w<_?A=Math.max(k,Math.pow(_-w,2)):z=Math.max(k,Math.pow(_-w,2));var M=z+b,O=A+b;if(s.pop(),M<v){var F=2*g+1;if(F<n){u[S=s.count]=F,f[B=S*(r+1)]=M;for(p=1;p<=r;++p)f[B+p]=i[p-1];f[B+x+1]=z,s.push()}}if(O<v){var E=2*(g+1);if(E<n){var S,B;u[S=s.count]=E,f[B=S*(r+1)]=O;for(p=1;p<=r;++p)f[B+p]=i[p-1];f[B+x+1]=A,s.push()}}}return l.freeFloat64(i),s.dispose(),h<0?-1:this.ids[h]},p.knn=function(e,t,n){if("number"==typeof n){if(n<0)return[]}else n=1/0;var r=this.length;if(r<1)return[];if("number"==typeof t){if(t<=0)return[];t=0|Math.min(t,r)}else t=r;var a=this.ids,o=this.dimension,i=this.points,s=i.data,u=l.mallocFloat64(o),f=new d(t,1),p=f.index,h=f.data,v=new d(r,o+1),g=v.index,m=v.data;g[0]=0;for(var y=0;y<=o;++y)m[y]=0;v.count+=1;for(var x=n;v.count>0&&!(m[0]>=x);){var b=g[0],j=i.index(b,0),w=0;for(y=0;y<o;++y)w+=Math.pow(e[y]-s[j+y],2);if(w<x){f.count>=t&&f.pop();var _=f.count;p[_]=b,h[_]=-w,f.push(),f.count>=t&&(x=-h[0])}var k=c.log2(b+1)%o,z=0;for(y=0;y<o;++y){var A=m[y+1];y!==k&&(z+=A),u[y]=A}var M=e[k],O=s[j+k],F=u[k],E=F,S=F;M<O?S=Math.max(F,Math.pow(O-M,2)):E=Math.max(F,Math.pow(O-M,2));var B=E+z,T=S+z;if(v.pop(),B<x){var N=2*b+1;if(N<r){g[C=v.count]=N,m[q=C*(o+1)]=B;for(y=1;y<=o;++y)m[q+y]=u[y-1];m[q+k+1]=E,v.push()}}if(T<x){var I=2*(b+1);if(I<r){var C,q;g[C=v.count]=I,m[q=C*(o+1)]=T;for(y=1;y<=o;++y)m[q+y]=u[y-1];m[q+k+1]=S,v.push()}}}l.freeFloat64(u),v.dispose();var V=new Array(f.count);for(a=this.ids,y=f.count-1;y>=0;--y)V[y]=a[p[0]],f.pop();return f.dispose(),V},p.dispose=function(){l.free(this.points.data),l.freeInt32(this.ids),this.points=null,this.ids=null,this.length=0},h.prototype.size=function(){return this.data.length-this.offset},h.prototype.push=function(e){return this.data.push(e)},h.prototype.pop=function(){if(0!==this.size()){var e=this.data[this.offset];return this.offset++,this.data.length>1024&&2*this.offset>this.data.length&&(this.data=this.data.slice(this.offset),this.offset=0),e}}},{"./lib/heap.js":24,"bit-twiddle":2,"inorder-tree-layout":11,ndarray:20,"ndarray-ops":15,"ndarray-pack":16,"ndarray-scratch":18,"ndarray-select":19,"typedarray-pool":25}],24:[function(e,t,n){"use strict";t.exports=o;var r=e("typedarray-pool");function a(e){return 1&e?e-1>>1:(e>>1)-1}function o(e,t){this.count=0,this.dataSize=t,this.index=r.mallocInt32(e),this.data=r.mallocFloat64(e*t)}var i=o.prototype;i.heapSwap=function(e,t){var n=this.data,r=this.index,a=this.dataSize,o=r[e];r[e]=r[t],r[t]=o;for(var i=a*e,s=a*t,l=0;l<a;++l){var u=n[i];n[i]=n[s],n[s]=u,i+=1,s+=1}},i.heapUp=function(e){for(var t=this.dataSize,n=(this.index,this.data),r=n[t*e];e>0;){var o=a(e);if(o>=0)if(r<n[t*o]){this.heapSwap(e,o),e=o;continue}break}},i.heapDown=function(e){for(var t=this.dataSize,n=(this.index,this.data),r=this.count,a=n[t*e];;){var o=a,i=2*e+1,s=2*(e+1),l=e;if(i<r){var u=n[t*i];u<o&&(l=i,o=u)}if(s<r)n[t*s]<o&&(l=s);if(l===e)break;this.heapSwap(e,l),e=l}},i.pop=function(){this.count-=1,this.heapSwap(0,this.count),this.heapDown(0)},i.push=function(){this.heapUp(this.count),this.count+=1},i.dispose=function(){r.freeInt32(this.index),r.freeFloat64(this.data)}},{"typedarray-pool":25}],25:[function(e,t,n){(function(t){"use strict";var r=e("bit-twiddle"),a=e("dup"),o=e("buffer").Buffer;t.__TYPEDARRAY_POOL||(t.__TYPEDARRAY_POOL={UINT8:a([32,0]),UINT16:a([32,0]),UINT32:a([32,0]),BIGUINT64:a([32,0]),INT8:a([32,0]),INT16:a([32,0]),INT32:a([32,0]),BIGINT64:a([32,0]),FLOAT:a([32,0]),DOUBLE:a([32,0]),DATA:a([32,0]),UINT8C:a([32,0]),BUFFER:a([32,0])});var i="undefined"!=typeof Uint8ClampedArray,s="undefined"!=typeof BigUint64Array,l="undefined"!=typeof BigInt64Array,u=t.__TYPEDARRAY_POOL;u.UINT8C||(u.UINT8C=a([32,0])),u.BIGUINT64||(u.BIGUINT64=a([32,0])),u.BIGINT64||(u.BIGINT64=a([32,0])),u.BUFFER||(u.BUFFER=a([32,0]));var c=u.DATA,d=u.BUFFER;function f(e){if(e){var t=e.length||e.byteLength,n=r.log2(t);c[n].push(e)}}function p(e){e=r.nextPow2(e);var t=r.log2(e),n=c[t];return n.length>0?n.pop():new ArrayBuffer(e)}function h(e){return new Uint8Array(p(e),0,e)}function v(e){return new Uint16Array(p(2*e),0,e)}function g(e){return new Uint32Array(p(4*e),0,e)}function m(e){return new Int8Array(p(e),0,e)}function y(e){return new Int16Array(p(2*e),0,e)}function x(e){return new Int32Array(p(4*e),0,e)}function b(e){return new Float32Array(p(4*e),0,e)}function j(e){return new Float64Array(p(8*e),0,e)}function w(e){return i?new Uint8ClampedArray(p(e),0,e):h(e)}function _(e){return s?new BigUint64Array(p(8*e),0,e):null}function k(e){return l?new BigInt64Array(p(8*e),0,e):null}function z(e){return new DataView(p(e),0,e)}function A(e){e=r.nextPow2(e);var t=r.log2(e),n=d[t];return n.length>0?n.pop():new o(e)}n.free=function(e){if(o.isBuffer(e))d[r.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=0|r.log2(t);c[n].push(e)}},n.freeUint8=n.freeUint16=n.freeUint32=n.freeBigUint64=n.freeInt8=n.freeInt16=n.freeInt32=n.freeBigInt64=n.freeFloat32=n.freeFloat=n.freeFloat64=n.freeDouble=n.freeUint8Clamped=n.freeDataView=function(e){f(e.buffer)},n.freeArrayBuffer=f,n.freeBuffer=function(e){d[r.log2(e.length)].push(e)},n.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return p(e);switch(t){case"uint8":return h(e);case"uint16":return v(e);case"uint32":return g(e);case"int8":return m(e);case"int16":return y(e);case"int32":return x(e);case"float":case"float32":return b(e);case"double":case"float64":return j(e);case"uint8_clamped":return w(e);case"bigint64":return k(e);case"biguint64":return _(e);case"buffer":return A(e);case"data":case"dataview":return z(e);default:return null}return null},n.mallocArrayBuffer=p,n.mallocUint8=h,n.mallocUint16=v,n.mallocUint32=g,n.mallocInt8=m,n.mallocInt16=y,n.mallocInt32=x,n.mallocFloat32=n.mallocFloat=b,n.mallocFloat64=n.mallocDouble=j,n.mallocUint8Clamped=w,n.mallocBigUint64=_,n.mallocBigInt64=k,n.mallocDataView=z,n.mallocBuffer=A,n.clearCache=function(){for(var e=0;e<32;++e)u.UINT8[e].length=0,u.UINT16[e].length=0,u.UINT32[e].length=0,u.INT8[e].length=0,u.INT16[e].length=0,u.INT32[e].length=0,u.FLOAT[e].length=0,u.DOUBLE[e].length=0,u.BIGUINT64[e].length=0,u.BIGINT64[e].length=0,u.UINT8C[e].length=0,c[e].length=0,d[e].length=0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"bit-twiddle":2,buffer:3,dup:7}],26:[function(e,t,n){"use strict";t.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,r=e.length,a=e[0],o=e[0],i=1;i<r;++i)if(o=a,t(a=e[i],o)){if(i===n){n++;continue}e[n++]=a}return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,r=e[0],a=e[0],o=1;o<n;++o,a=r)if(a=r,(r=e[o])!==a){if(o===t){t++;continue}e[t++]=r}return e.length=t,e}(e))}},{}],27:[function(e,t,n){(function(){var n;n=e("../color/sort.js"),t.exports=function(e,t,r,a,o,i,s){var l,u,c;for(a||(a="asc"),o instanceof Array||(o=[o]),r instanceof Array||(r=[r]),i&&void 0!==s&&"number"!=typeof s&&(s=i.id.nesting.indexOf(s)),c=0,l=0;l<r.length&&(u=r[l],e=i&&e.d3po&&e.d3po.sortKeys?e.d3po.sortKeys[u]:e[u],t=i&&t.d3po&&t.d3po.sortKeys?t.d3po.sortKeys[u]:t[u],0===(c=i&&o.indexOf(u)>=0?n(e,t):e<t?-1:1)&&l!==r.length-1);)l++;return"asc"===a?c:-c}}).call(this)},{"../color/sort.js":44}],28:[function(e,t,n){(function(){t.exports=function(e,t){var n;return e instanceof Array&&(n=null==t?t:t.constructor,e.indexOf(t)>=0||e.indexOf(n)>=0)}}).call(this)},{}],29:[function(e,t,n){(function(){var n,r;n=e("./comparator.js"),r=e("../core/fetch/sort.js"),t.exports=function(e,t,a,o,i,s){var l,u,c,d;if(!e||e.length<=1)return e||[];if(i)for(t||(t=i.order.value||i.size.value||i.id.value),a||(a=i.order.sort.value),o||(o=i.color.value||[]),c=0,d=e.length;c<d;c++)(l=e[c]).d3po||(l.d3po={}),u="d3po"in l&&"d3po"in l.d3po?l.d3po:l,l.d3po.sortKeys=r(i,u,t,o,s);return e.sort((function(e,r){return n(e,r,t,a,o,i,s)}))}}).call(this)},{"../core/fetch/sort.js":59,"./comparator.js":27}],30:[function(e,t,n){(function(){t.exports=function(e,t){return void 0===t?e:!1===t?[]:t instanceof Array?t:(e instanceof Array||(e=[]),e.indexOf(t)>=0?e.splice(e.indexOf(t),1):e.push(t),e)}}).call(this)},{}],31:[function(e,t,n){(function(){var e;(e=function(t){var n,r,a,o;if(t in(o=e.tested))return o[t];for(r=0,a=!1;r<document.styleSheets.length;){if((n=document.styleSheets[r]).href&&n.href.indexOf(t)>=0){a=!0;break}r++}return a}).tested={},t.exports=e}).call(this)},{}],32:[function(e,t,n){t.exports=/(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent)},{}],33:[function(e,t,n){(function(){var n,r;n=e("./ie.js"),r=e("./touch.js"),t.exports=r?{click:"touchend",down:"touchstart",up:"touchend",over:n?"mouseenter":"mouseover",out:n?"mouseleave":"mouseout",move:"mousemove"}:{click:"click",down:"mousedown",up:"mouseup",over:n?"mouseenter":"mouseover",out:n?"mouseleave":"mouseout",move:"mousemove"}}).call(this)},{"./ie.js":32,"./touch.js":38}],34:[function(e,t,n){(function(){var e;e=function(){var t;return t="-webkit-transform"in document.body.style?"-webkit-":"-moz-transform"in document.body.style?"-moz-":"-ms-transform"in document.body.style?"-ms-":"-o-transform"in document.body.style?"-o-":"",e=function(){return t},t},t.exports=e}).call(this)},{}],35:[function(e,t,n){(function(){t.exports="rtl"===d3.select("html").attr("dir")}).call(this)},{}],36:[function(e,t,n){t.exports={y:function(){return void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop},x:function(){return void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}}},{}],37:[function(e,t,n){(function(){var e;e=function(){var t,n,r,a,o;return(t=document.createElement("p")).style.width="100%",t.style.height="200px",(n=document.createElement("div")).style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.visibility="hidden",n.style.width="200px",n.style.height="150px",n.style.overflow="hidden",n.appendChild(t),document.body.appendChild(n),a=t.offsetWidth,n.style.overflow="scroll",a===(o=t.offsetWidth)&&(o=n.clientWidth),document.body.removeChild(n),e=function(){return r},r=a-o},t.exports=e}).call(this)},{}],38:[function(e,t,n){(function(){t.exports=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}).call(this)},{}],39:[function(e,t,n){(function(){t.exports=function(e){var t;return(t=d3.hsl(e)).l>.45&&(t.s>.8&&(t.s=.8),t.l=.45),t.toString()}}).call(this)},{}],40:[function(e,t,n){(function(){t.exports=function(e,t){var n;return void 0===t&&(t=.5),t=(1-(n=d3.hsl(e)).l)*t,n.l+=t,n.s-=t,n.toString()}}).call(this)},{}],41:[function(e,t,n){(function(){t.exports=function(e,t,n,r){var a,o,i;return n||(n=1),r||(r=1),e=d3.rgb(e),t=d3.rgb(t),i=(n*e.r+r*t.r-n*r*t.r)/(n+r-n*r),o=(n*e.g+r*t.g-n*r*t.g)/(n+r-n*r),a=(n*e.b+r*t.b-n*r*t.b)/(n+r-n*r),d3.rgb(i,o,a).toString()}}).call(this)},{}],42:[function(e,t,n){(function(){var n;n=e("./scale.js"),t.exports=function(e,t){var r;return r=e||Math.floor(20*Math.random()),(t=t||n)(r)}}).call(this)},{"./scale.js":43}],43:[function(e,t,n){(function(){t.exports=d3.scale.ordinal().range(["#bf3251","#5c57d9","#d6c650","#406662","#872a41","#1c26b3","#d05555","#549e95","#993f7b","#dc8e7a","#ede788","#7485aa","#4d6fd0","#635b56","#7454a6","#a8c380","#8abdb6","#74c0e2","#bcd8af","#a1aafb","#a17cb0","#d1a1bc"])}).call(this)},{}],44:[function(e,t,n){(function(){t.exports=function(e,t){var n,r;return n=d3.hsl(e),r=d3.hsl(t),(e=0===n.s?361:n.h)===(t=0===r.s?361:r.h)?n.l-r.l:e-t}}).call(this)},{}],45:[function(e,t,n){(function(){t.exports=function(e){var t;return(299*(t=d3.rgb(e)).r+587*t.g+114*t.b)/1e3>=128?"#444444":"#f7f7f7"}}).call(this)},{}],46:[function(e,t,n){(function(){t.exports=function(e){var t,n;return 0===(e=(e+="").replace(RegExp(" ","g"),"")).indexOf("rgb")&&(e=e.split("(")[1].split(")")[0].split(",").slice(0,3).join(",")),0===e.indexOf("hsl")&&(e=e.split(",")[2].split(")")[0]),t=d3.rgb(e).toString(),n=["black","#000","#000000","0%","0,0,0"].indexOf(e)>=0,"#000000"!==t||n}}).call(this)},{}],47:[function(e,t,n){(function(){var n,r;n=e("../../client/ie.js"),(r=function(e,t,r){r=r||"",n||"undefined"!=typeof InstallTrigger?console.log("[ d3po ] "+t):0===e.indexOf("group")?console[e]("%c[ d3po ]%c "+t,"font-weight: 800;color: #b35c1e;margin-left: 0px;","font-weight: 400;"+r):console[e]("%c"+t,r+"font-weight: 400;")}).comment=function(e){this("log",e,"color:#aaa;")},r.error=function(e,t){this("groupCollapsed","ERROR: "+e,"font-weight:800;color:#D74B03;"),this.stack(),this.groupEnd()},r.group=function(e){this("group",e,"color:#888;")},r.groupCollapsed=function(e){this("groupCollapsed",e,"color:#888;")},r.groupEnd=function(){n||console.groupEnd()},r.log=function(e){this("log",e,"color:#444444;")},r.stack=function(){var e,t,r,a,o;n||(e=new Error).stack&&(a=(a=e.stack.split("\n")).filter((function(e){return 0!==e.indexOf("Error")&&e.indexOf("d3po.js:")<0&&e.indexOf("d3po.min.js:")<0}))).length&&a[0].length&&(r=window.chrome?"at ":"@",(o=a[0]).indexOf(r)>=0&&(o=o.split(r)[1]),3===(a=o.split(":")).length&&a.pop(),this("log","line "+a.pop()+" of "+(t=(t=a.join(":").split("/"))[t.length-1])+": "+o,"color:#D74B03;"))},r.time=function(e){n||console.time(e)},r.timeEnd=function(e){n||console.timeEnd(e)},r.warning=function(e,t){this("groupCollapsed",e,"color:#888;"),this.stack(),this.groupEnd()},t.exports=r}).call(this)},{"../../client/ie.js":32}],48:[function(e,t,n){var r=e("../../util/buckets.js"),a=e("../fetch/value.js"),o=e("../console/print.js");t.exports=function(e){if(e.dev.value&&o.time("getting color data range"),e.color.domain.value)var t=e.color.domain.value;else{t=[];e.data.pool.forEach((function(n){var r=parseFloat(a(e,n,e.color.value));"number"==typeof r&&!isNaN(r)&&t.indexOf(r)<0&&t.push(r)}))}if(e.dev.value&&o.timeEnd("getting color data range"),t.length>1){if(e.dev.value&&o.time("calculating color scale"),(t=d3.extent(t))[0]<0&&t[1]>0)3==(n=e.color.range).length&&(t.push(t[1]),t[1]=0);else if(t[1]>0&&t[0]>=0){var n=e.color.heatmap;t=r(t,n.length)}else{n=e.color.range.slice(0);t[0]<0?n.pop():n.shift()}e.color.valueScale=d3.scale.sqrt().domain(t).range(n).interpolate(d3.interpolateRgb),e.dev.value&&o.timeEnd("calculating color scale")}else e.color.valueScale=null}},{"../../util/buckets.js":190,"../console/print.js":47,"../fetch/value.js":61}],49:[function(e,t,n){var r=e("../fetch/value.js"),a=e("../console/print.js"),o=e("../../object/validate.js");t.exports=function(e,t){e.dev.value&&a.time("filtering data");var n=d3.keys(e.data.keys||{});"attrs"in e&&(n=n.concat(d3.keys(e.attrs.keys||{}))),t=t.filter((function(t){return null!==r(e,t,e.id.value)}));var i=e.types[e.type.value].requirements||[];e.data.filters.forEach((function(a){n.indexOf(e[a].value)>=0&&i.indexOf(a)>=0&&(t=t.filter((function(t){var n=r(e,t,e[a].value);return"y"===a&&e.y2.value&&null===n?n=r(e,t,e.y2.value):"x"===a&&e.x2.value&&null===n&&(n=r(e,t,e.x2.value)),"size"===a?"number"==typeof n:null!==n})))}));var s=e.data.solo.length?"solo":"mute";return e.data[s].length?e.data[s].forEach((function(n){function i(t){var r=e[n][s].value,a=!1;return r.forEach((function(e){"function"==typeof e?a=e(t):e===t&&(a=!0)})),"solo"===s?a:!a}function l(t,a){if(!a&&e[n].nesting){var s=e[n].nesting;o(s)&&(s=d3.values(s));for(var l=0;l<s.length;l++){var u=t.filter((function(t){return i(r(e,t,s[l]))}));u.length&&(t=u)}}else t=t.filter((function(t){return i(r(e,t,e[n].value))}));return t}t=l(t),"id"===n&&("nodes"in e&&e.nodes.value&&(e.dev.value&&a.time("filtering nodes"),e.nodes.restricted=l(e.nodes.value),e.dev.value&&a.timeEnd("filtering nodes")),"edges"in e&&e.edges.value&&(e.dev.value&&a.time("filtering edges"),e.edges.restricted=e.edges.value.filter((function(t){return 2===l([t[e.edges.source],t[e.edges.target]]).length})),e.dev.value&&a.timeEnd("filtering edges")))})):"nodes"in e&&(e.nodes.restricted=void 0,e.edges.restricted=void 0),e.dev.value&&a.timeEnd("filtering data"),t}},{"../../object/validate.js":158,"../console/print.js":47,"../fetch/value.js":61}],50:[function(e,t,n){var r=e("./nest.js"),a=e("../fetch/value.js"),o=e("../console/print.js"),i=e("../../util/uniques.js");t.exports=function(e){var t;if(e.data.time={values:[]},e.time&&e.time.value){e.dev.value&&(t="analyzing time periods",o.time(t)),e.data.time.values=i(e.data.value,e.time.value,a,e),e.data.time.values.sort((function(e,t){return e-t}));var n=[];e.data.time.values.forEach((function(t,r){if(0!==r){var a=e.data.time.values[r-1];n.push(t-a),r===e.data.time.values.length-1&&(e.data.time.total=t-e.data.time.values[0])}})),n=d3.min(n),e.data.time.step=n;var s=["Milliseconds","Seconds","Minutes","Hours","Date","Month","FullYear"],l=[1e3,60,60,24,30,12,1];e.data.time.periods=s;var u=function(t,n,r){return e.data.time.stepDivider||(arr=l.slice(0,r),arr.length?e.data.time.stepDivider=arr.reduce((function(e,t){return e*t})):e.data.time.stepDivider=1),Math.round(Math.floor(n-t)/e.data.time.stepDivider)},c=e.data.time.total;s.forEach((function(t,r){var a="Date"===t?28:l[r];if(!e.data.time.stepType&&(r===s.length-1||Math.round(n)<a)){e.data.time.stepType=t;var o=e.data.time.values[0],i=e.data.time.values[e.data.time.values.length-1];e.data.time.stepIntervals=u(o,i,r)}!e.data.time.totalType&&(r===s.length-1||Math.round(c)<a)&&(e.data.time.totalType=t),n/=a,c/=a})),e.data.time.values.forEach((function(t,n){if(0!==n){var r=e.data.time.values[0];e.data.time.dataSteps.push(u(r,t,s.indexOf(e.data.time.stepType)))}else e.data.time.dataSteps=[0]}));var d=e.time.format.value,f=e.format.locale.value,p=[function(e){return e.getMilliseconds()},function(e){return e.getSeconds()},function(e){return e.getMinutes()},function(e){return e.getHours()},function(e){return 1!=e.getDate()},function(e){return e.getMonth()},function(e){return!0}];e.data.time.functions=p;var h=function(e,t,n){return e===t?n&&f.timeFormat[e+"Small"]?f.timeFormat[e+"Small"]:f.timeFormat[e]:s.indexOf(e)>=4||s.indexOf(t)<=3?f.timeFormat[t+"-"+e]:(r="Date"===t?f.timeFormat[t]:f.timeFormat[t+"-Date"],"Hours"===e?r+" "+f.timeFormat[e]:r+" "+f.timeFormat["Hours-"+e]);var r};if(e.data.time.getFormat=h,d)"string"==typeof d?e.data.time.format=d3.locale(f.format).timeFormat(d):"function"==typeof d?e.data.time.format=d:d instanceof Array&&(e.data.time.format=d3.locale(f.format).timeFormat.multi(d)),e.data.time.multiFormat=e.data.time.format;else{for(var v=e.data.time.stepType,g=e.data.time.totalType,m=[],y=s.indexOf(v);y<=s.indexOf(g);y++){var x=y-1<s.indexOf(v)?s[y]:s[y-1],b=s[y]===x&&v!==g,j=h(x,s[y],b);m.push([j,p[y]])}e.data.time.format=d3.locale(f.format).timeFormat(h(v,g)),m.length>1?(m[m.length-1][1]=function(e){return!0},e.data.time.multiFormat=d3.locale(f.format).timeFormat.multi(m)):e.data.time.multiFormat=e.data.time.format}e.data.time.ticks=[];for(var w=d3.min(e.data.time.values),_=d3.max(e.data.time.values),k=0;k<=e.data.time.stepIntervals;k++){var z=new Date(w);z["set"+e.data.time.stepType](z["get"+e.data.time.stepType]()+k),z<=_&&e.data.time.ticks.push(z)}e.dev.value&&o.timeEnd(t)}if(e.dev.value&&(t="nesting data by time and depths",o.time(t)),e.data.nested={},0===e.data.time.values.length)e.data.nested.all={},e.id.nesting.forEach((function(t,n){var a=e.id.nesting.slice(0,n+1);e.data.nested.all[t]=r(e,e.data.value,a)}));else{var A=e.data.value.reduce((function(t,n){var r=a(e,n,e.time.value).getTime();return r in t||(t[r]=[]),t[r].push(n),t}),{});e.data.time.values.forEach((function(t){var n=t.getTime();e.data.nested[n]={},e.id.nesting.forEach((function(t,a){var o=e.id.nesting.slice(0,a+1);e.data.nested[n][t]=r(e,A[n],o)}))}))}e.dev.value&&o.timeEnd(t)}},{"../../util/uniques.js":196,"../console/print.js":47,"../fetch/value.js":61,"./nest.js":54}],51:[function(e,t,n){(function(){var n;n=e("../fetch/value.js"),t.exports=function(e,t,r){var a,o,i,s,l,u,c,d,f,p;if(o=d3.nest(),e.id.grouping.value)for(void 0===r&&(r=e.id.nesting),i=s=0,u=r.length;s<u;i=++s)d=r[i],i<e.depth.value&&function(t){o.key((function(r){return n(e,r.d3po,t)}))}(d);for(f=[],l=0,c=t.length;l<c;l++)a=t[l],(p=e.size.value?n(e,a,e.size.value):1)&&"number"==typeof p&&p>0&&(delete a.d3po.r,delete a.d3po.x,delete a.d3po.y,f.push({d3po:a,id:a[e.id.value],value:p}));return o.entries(f)}}).call(this)},{"../fetch/value.js":61}],52:[function(e,t,n){(function(){var n,r,a=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};n=e("../console/print.js"),r=e("../../object/validate.js"),t.exports=function(e,t){var o,i,s,l,u,c,d,f,p;if(d=t+" key analysis",e.dev.value&&n.time(d),e[t].keys={},o=function(n){var i,s,l,u,c,d,f;if(n instanceof Array){for(c=[],s=0,u=n.length;s<u;s++)i=n[s],c.push(o(i));return c}if(r(n)){for(l in d=[],n)f=n[l],0===l.indexOf("d3po")||a.call(e[t].keys,l)>=0||null===f?d.push(void 0):d.push(e[t].keys[l]=typeof f);return d}},r(e[t].value))for(i in l=d3.keys(e[t].value).length===e.id.nesting.length,u=e[t].value)if(f=u[i],l&&e.id.nesting.indexOf(i)>=0&&r(f))for(s in f)p=f[s],o(p);else o(f);else for(i in c=e[t].value)f=c[i],o(f);if(e.dev.value)return n.time(d)}}).call(this)},{"../../object/validate.js":158,"../console/print.js":47}],53:[function(e,t,n){(function(){var n,r;n=e("../console/print.js"),r=e("../../object/validate.js"),t.exports=function(e,t,a){var o,i,s;return(o=e.dev.value)&&n.time("loading "+t),s=e[t].url,e[t].filetype.value?i=e[t].filetype.value:(i=(i=s.slice(s.length-5).split(".")).length>1&&i[1])?("txt"===i&&(i="text"),e[t].filetype.accepted.indexOf(i)<0&&(i="json")):i="json",("dsv"===i?d3.dsv(e[t].delimiter.value,"text/plain"):d3[i])(s,(function(l,u){var c,d;if(!l&&u){if("function"==typeof e[t].callback){if(d=e[t].callback(u))if(r(d)&&t in d)for(c in d)c in e&&(e[c].value=d[c]);else e[t].value=d}else e[t].value=u;["json"].indexOf(i)<0&&e[t].value.forEach((function(e){var t;for(c in t=[],e)isNaN(e[c])?"false"===e[c].toLowerCase()?t.push(e[c]=!1):"true"===e[c].toLowerCase()?t.push(e[c]=!0):"null"===e[c].toLowerCase()?t.push(e[c]=null):"undefined"===e[c].toLowerCase()?t.push(e[c]=void 0):t.push(void 0):t.push(e[c]=parseFloat(e[c]));return t})),e[t].changed=!0,e[t].loaded=!0}else e.error.internal='Could not load data from: "'+s+'"';return o&&n.timeEnd("loading "+t),a()}))}}).call(this)},{"../../object/validate.js":158,"../console/print.js":47}],54:[function(e,t,n){var r=e("../fetch/value.js"),a=e("../../object/validate.js"),o=e("../../util/uniques.js"),i=function(e,t){var n=[];return function e(r){r instanceof Array?r.forEach(e):a(r)&&t in r&&(r[t]instanceof Array?r[t].forEach(e):n.push(r))}(e),n},s=function(e){var t=[];return function e(n){for(var r=0;r<n.length;r++){var a=n[r];a&&(a.constructor===Array?e(a):t.push(a))}}(e),o(t)},l=function(e){return e.values&&e.values.length?(e.children=e.values.map((function(e){return l(e)})),delete e.values,e):e.values?e.values:e};t.exports=function(e,t,n,a){void 0===a&&(a=!0);var u=d3.nest(),c=[],d="temp"in e?["active","temp","total"]:[];n.length?n.forEach((function(t,n){u.key((function(n){return r(e,n,t)}))})):u.key((function(e){return!0})),a&&e.axes&&e.axes.discrete&&(!e.time||e[e.axes.discrete].value!==e.time.value)&&u.key((function(t){return r(e,t,e[e.axes.discrete].value)}));var f=n.length&&e.id.nesting.indexOf(n[n.length-1])>=0,p=n.length&&f?n.length-1:0;f?e.id.nesting[p]:e.depth.value;u.rollup((function(t){if(1===t.length&&"d3po"in t[0])return c.push(t[0]),t[0];t=t.reduce((function(e,t){return t.values instanceof Array?e.concat(t.values):(e.push(t),e)}),[]);var a={d3po:{data:{},depth:p}};if(d3.sum(t,(function(e){return"d3po"in e&&e.d3po.merged?1:0}))===t.length)for(var l=0;l<t.length;l++){var u=t[l];a.d3po.merged||(a.d3po.merged=[]),a.d3po.merged=a.d3po.merged.concat(u.d3po.merged),u.d3po.text&&(a.d3po.text=u.d3po.text)}for(var f=0;f<d.length;f++){var h=d[f],v=e.aggs&&e.aggs.value[g]?e.aggs.value[g]:"sum";"d3po"in t[0]&&h in t[0].d3po?a.d3po[h]=d3.sum(t,(function(e){return e.d3po[h]})):a.d3po[h]="function"==typeof v?v(t):d3[v](t,(function(t){var n="total"===h?1:0;return e[h].value&&"number"!=typeof(n=r(e,t,e[h].value))&&(n=n?1:0),n}))}for(var g in e.data.keys){if(g in a.d3po.data)a[g]=a.d3po[g];else{var m=e.aggs&&e.aggs.value[g]?e.aggs.value[g]:"sum",y=typeof m,x=e.data.keys[g],b=e.id.nesting.indexOf(g)>=0,j="time"in e&&g===e.time.value;if(g in a.d3po.data)a[g]=a.d3po[g];else if("function"===y)a[g]=e.aggs.value[g](t);else if(j)a[g]=s(o(t,g));else if(e.axes&&e.axes.discrete&&e[e.axes.discrete].value===g)a[g]=o(t,g);else if("number"!==x||"string"!==y||b){var w=i(t,g),_=1===w.length?w[0][g]:o(w,g);if(1===w.length)a[g]=_;else if(_&&_.length)_ instanceof Array||(_=[_]),b&&e.id.nesting.indexOf(g)>p?a[g]=w:a[g]=_;else if(b){e.id.nesting.indexOf(g)-1>=p&&(!("endPoint"in a.d3po)||a.d3po.endPoint>p)&&(a.d3po.endPoint=p)}}else{var k=t.map((function(e){return e[g]}));(k=k.filter((function(e){return typeof e===x}))).length&&(a[g]=d3[m](k))}}g in a&&a[g]instanceof Array&&1===a[g].length&&(a[g]=a[g][0])}for(var z=0;z<n.length;z++){var A=n[z];A in a||(a[A]=r(e,t[0],A))}return c.push(a),a}));var h=function(t,r,a){if(t.children){for(var o in"number"==e.data.keys[n[r]]&&(t.key=parseFloat(t.key)),a[n[r]]=t.key,delete t.key,a)t[o]=a[o];r++,t.children.forEach((function(e){h(e,r,a)}))}};return u=u.entries(t).map(l).map((function(e){return h(e,0,{}),e})),c}},{"../../object/validate.js":158,"../../util/uniques.js":196,"../fetch/value.js":61}],55:[function(e,t,n){var r=e("../../array/sort.js"),a=e("./nest.js"),o=e("../fetch/value.js"),i=(e("../fetch/color.js"),e("../fetch/text.js"));t.exports=function(e,t,n){var s;if("number"==typeof(s=!1===e.size.threshold.value?0:"number"==typeof e.size.threshold.value?e.size.threshold.value:"function"==typeof e.size.threshold.value?e.size.threshold.value(e):"number"==typeof e.types[e.type.value].threshold?e.types[e.type.value].threshold:"function"==typeof e.types[e.type.value].threshold?e.types[e.type.value].threshold(e):.02)&&s>0){var l=[],u=0===e.depth.value?0:{},c=[],d=[],f=[],p={},h=d3.nest();n&&h.key((function(t){return o(e,t,n)})),h.rollup((function(t){var r=t.length;e.aggs.value[e.size.value]?"function"==typeof e.aggs.value[e.size.value]?r=e.aggs.value[e.size.value](t):"string"==typeof e.aggs.value[e.size.value]&&(r=d3[e.aggs.value[e.size.value]](t,(function(t){return o(e,t,e.size.value)}))):r=d3.sum(t,(function(t){return o(e,t,e.size.value)}));var a=n?o(e,t[0],n):"all";return p[a]=r,r})).entries(t),t.forEach((function(t){var r=o(e,t,e.id.value),a=o(e,t,e.size.value),i=n?o(e,t,n):"all";if(a/p[i]>=s&&l.indexOf(r)<0&&(l.push(r),e.depth.value)){var u=o(e,t,e.id.nesting[e.depth.value-1]);d.indexOf(u)<0&&d.push(u)}}));var v=t.filter((function(t){var n=o(e,t,e.id.value),r=l.indexOf(n)>=0,a=e.depth.value?o(e,t,e.id.nesting[e.depth.value-1]):null;if(null!==a&&d.indexOf(a)<0&&f.indexOf(a)<0&&f.push(a),!r){var i=o(e,t,e.size.value);i>0&&(0===e.depth.value?i>u&&(u=i):(a in u||(u[a]=0),i>u[a]&&(u[a]=i)),c.push(t))}return r}));if(c.length>1){c=r(c,e.size.value,"desc",[],e);var g=e.id.nesting.slice(0,e.depth.value);e.types[e.type.value].requirements.indexOf(e.axes.discrete)>=0&&g.push(e[e.axes.discrete].value);var m=a(e,c,g);m.forEach((function(t){var n,r=e.id.nesting[e.depth.value-1],a=o(e,t,r);(children=r?c.filter((function(t){return o(e,t,r)===a})):c,children.length>1)&&(e.id.nesting.forEach((function(n,r){if(e.depth.value==r){var a=t[n];t[n]="string"==typeof a?"d3po_other_"+a:"d3po_other"}else r>e.depth.value&&delete t[n]})),e.color.value&&"string"===e.color.type&&(0===e.depth.value?t[e.color.value]=e.color.missing:t[e.color.value]=o(e,a,e.color.value,r)),e.icon.value&&(t[e.icon.value]=o(e,a,e.icon.value,r)),a&&(t.d3po.depth=e.depth.value),0===e.depth.value?(n=e.format.value(e.format.locale.value.ui.values,{key:"threshold",vars:e}),n+=" < "+e.format.value(u,{key:e.size.value,vars:e})):(n=(n=i(e,t,e.depth.value-1)).length?n[0].split(" < ")[0]:e.format.value(e.format.locale.value.ui.values,{key:"threshold",vars:e}),f.indexOf(a)<0&&(n+=" < "+e.format.value(u[a],{key:e.size.value,vars:e}))),f.indexOf(a)<0&&(n+=" ("+e.format.value(100*s,{key:"share",vars:e})+")"),t.d3po.threshold=u,t.d3po.merged=children,e.text.value&&(t[e.text.value]=n),t.d3po.text=n)}))}else m=c;return v.concat(m)}return t}},{"../../array/sort.js":29,"../fetch/color.js":57,"../fetch/text.js":60,"../fetch/value.js":61,"./nest.js":54}],56:[function(e,t,n){(function(){var n;n=e("../../font/sizes.js"),t.exports=function(e,t){var r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b;if(b=t.values||e.data.time.ticks,g=t.style||{},s=t.limit||e.width.value,m={},c=e.data.time.periods,v=e.data.time.stepType,y=e.data.time.totalType,o=e.data.time.functions,i=e.data.time.getFormat,l=e.format.locale.value.format,e.time.format.value)m.format=e.data.time.format,m.values=b,m.sizes=n(b.map((function(e){return m.format(e)})),g);else for(u=c.indexOf(v);u<=c.indexOf(y);){if(x=b.filter((function(e){var t,n;if(u===c.indexOf(v))return!0;if(t=!0,n=u-1,u<0)return!0;for(;n>=c.indexOf(v)&&t;)t=!o[n](e),n--;return t})),c[u]===y)a=d3.locale(l).timeFormat(i(c[u],y));else{for(d=u,a=[];d<=c.indexOf(y);)f=d-1<c.indexOf(v)?d:d-1,f=c[f],h=c[d]===f&&v!==y,r=i(f,c[d],h),a.push([r,o[d]]),d++;a[a.length-1][1]=function(){return!0},a=d3.locale(l).timeFormat.multi(a)}if(p=n(x.map((function(e){return a(e)})),g),d3.sum(p,(function(e){return e.width}))<s||u===c.indexOf(y)){m.format=a,m.values=x,m.sizes=p;break}u++}return m}}).call(this)},{"../../font/sizes.js":88}],57:[function(e,t,n){(function(){var n,r,a,o,i,s,l;n=e("./value.js"),o=e("../../color/random.js"),s=e("../../color/validate.js"),l=e("../../object/validate.js"),i=e("../../util/uniques.js"),t.exports=function(e,t,o){var s,u,c,d,f;if(l(t)&&"d3po"in t&&"color"in t.d3po)return t.d3po.color;if(void 0===o&&(o=e.id.value),"number"==typeof o&&(o=e.id.nesting[o]),e.color.value){for(c=[],d=e.id.nesting.indexOf(o);d>=0;){if(u=e.id.nesting[d],1===(f=i(t,e.color.value,n,e,u)).length&&(f=f[0]),!(f instanceof Array)&&null!=f){s=r(e,t,f,o),c.indexOf(s)<0&&c.push(s);break}d--}return 1===c.length?c[0]:e.color.missing}return a(e,t,o)},r=function(e,t,n,r){return n?e.color.valueScale?e.color.valueScale(n):s(n)?n:a(e,n,r):e.color.value&&"function"==typeof e.color.valueScale?e.color.valueScale(0):a(e,t,r)},a=function(e,t,r){return l(t)&&(t=n(e,t,r)),t instanceof Array&&(t=t[0]),o(t,e.color.scale.value)}}).call(this)},{"../../color/random.js":42,"../../color/validate.js":46,"../../object/validate.js":158,"../../util/uniques.js":196,"./value.js":61}],58:[function(e,t,n){var r=e("../data/filter.js"),a=e("../data/nest.js"),o=e("../console/print.js"),i=e("../../string/format.js"),s=e("../../string/list.js");t.exports=function(e,t,n){if(!e.data.value)return[];void 0===n&&(n=e.depth.value);var l=e.id.nesting[n];if(!t||t instanceof Array||(t=[t]),!t&&"time"in e){t=[];var u=e.time.solo.value.length?"solo":"mute",c=e.time[u].value;if(c.length){t=[];for(var d=0;d<c.length;d++){var f=c[d];if("function"==typeof f)for(var p=0;p<e.data.time.values.length;p++){var h=e.data.time.values[p].getTime();f(h)&&t.push(h)}else if(f.constructor===Date)t.push(new Date(f).getTime());else{4===(f+="").length&&parseInt(f)+""===f&&(f+="/01/01");var v=new Date(f);"Invalid Date"!==v&&t.push(v.getTime())}}"mute"===u&&(t=e.data.time.values.filter((function(e){return t.indexOf(e.getTime())<0})))}else t.push("all")}else t=["all"];if(t.indexOf("all")>=0&&e.data.time.values.length){t=e.data.time.values.slice(0);for(var g=0;g<t.length;g++)t[g]=t[g].getTime()}var m=[e.type.value,l,n].concat(e.data.filters).concat(t),y=e.data.solo.length?"solo":"mute",x=d3.keys(e.data.cache),b=e.types[e.type.value].filter||void 0;if(e.data[y].length)for(var j=0;j<e.data[y].length;j++){var w=e.data[y][j],_=e[w][y].value.slice(0);_.unshift(w),_.unshift(y),m=m.concat(_)}e.axes&&e.axes.discrete&&m.push(e.axes.discrete),m=m.join("_"),e.data.cacheID=m;for(var k,z=0;z<x.length;z++){if(x[z].split("_").slice(1).join("_")===m){m=(new Date).getTime()+"_"+m,e.data.cache[m]=e.data.cache[x[z]],delete e.data.cache[x[z]];break}}if(e.data.cache[m])return e.dev.value&&o.comment("data already cached"),k=e.data.cache[m].data,"nodes"in e&&(e.nodes.restricted=e.data.cache[m].nodes,e.edges.restricted=e.data.cache[m].edges),"function"==typeof b&&(k=b(e,k)),k;var A=[];if(k=[],e.data.value&&e.data.value.length)for(var M=0;M<t.length;M++){var O=t[M];e.data.nested[O]?k=k.concat(e.data.nested[O][l]):A.push(O)}if(0===k.length&&A.length&&!e.error.internal){A.length>1&&(A=d3.extent(A)),A=(A=A.map((function(t){return e.data.time.format(new Date(t))}))).join(" - ");var F=e.format.locale.value.error.dataYear,E=e.format.locale.value.ui.and;A=s(A,E),e.error.internal=i(F,A),e.time.missing=!0}else{if(e.time&&(e.time.missing=!1),t.length>1){var S=!1;if(["x","y","x2","y2"].forEach((function(t){e[t].value===e.time.value&&"discrete"===e[t].scale.value&&(S=!0)})),!S){var B=e.id.nesting.slice(0,n+1);k=a(e,k,B)}}k=k?r(e,k):[],20===x.length&&(x.sort(),delete e.data.cache[x[0]]),m=(new Date).getTime()+"_"+m,e.data.cache[m]={data:k},"nodes"in e&&(e.data.cache[m].nodes=e.nodes.restricted,e.data.cache[m].edges=e.edges.restricted),"function"==typeof b&&(k=b(e,k)),e.dev.value&&o.comment("storing data in cache")}return k}},{"../../string/format.js":159,"../../string/list.js":160,"../console/print.js":47,"../data/filter.js":49,"../data/nest.js":54}],59:[function(e,t,n){(function(){var n,r,a;a=e("./value.js"),n=e("./color.js"),r=e("./text.js"),t.exports=function(e,t,o,i,s){var l,u,c,d,f,p;for(o instanceof Array||(o=[o]),i instanceof Array||(i=[i]),e&&(void 0===s?s=e.id.value:"number"!=typeof s&&(s=e.id.nesting.indexOf(s))),f={},u=0,d=o.length;u<d;u++)c=o[u],p=e?i.indexOf(c)>=0?n(e,t,s):c===e.text.value?r(e,t,s):3===d3.keys(t).length&&t.d3po&&t.key&&t.values?a(e,t.values.map((function(e){return e.d3po})),c,s):a(e,t,c,s):t[c],[e.data.keys[c],e.attrs.keys[c]].indexOf("number")>=0?((l=e.order.agg.value||e.aggs.value[c]||"sum").constructor===String&&(l=d3[l]),p instanceof Array||(p=[p]),p=l(p)):(p instanceof Array&&(p=p[0]),p="string"==typeof p?p.toLowerCase():p),f[c]=p;return f}}).call(this)},{"./color.js":57,"./text.js":60,"./value.js":61}],60:[function(e,t,n){var r=e("./value.js"),a=e("../../object/validate.js"),o=e("../../util/uniques.js");t.exports=function(e,t,n){"number"!=typeof n&&(n=e.depth.value);var i,s=e.id.nesting[n];e.text.nesting&&a(e.text.nesting)?i=e.text.nesting[s]?e.text.nesting[s]:e.text.value:(i=[],e.text.value&&n===e.depth.value&&i.push(e.text.value),i.push(s)),i instanceof Array||(i=[i]);var l=[];if(a(t)&&"d3po"in t&&t.d3po.text)l.push(t.d3po.text.toString()),l.push(e.format.value(t.d3po.text.toString(),{vars:e,data:t}));else{var u=a(t)?t:void 0;u&&t[e.id.value]instanceof Array?t=t[e.id.value]:t instanceof Array||(t=[t]),i.forEach((function(n){var a=o(t,n,r,e,s);a.length&&(a.length>1&&(a=a.filter((function(e){return e instanceof Array||"string"==typeof e&&e.indexOf(" < ")<0}))),1===(a=a.map((function(t){return t instanceof Array?(t=t.filter((function(e){return e}))).map((function(t){return e.format.value(t.toString(),{vars:e,data:u,key:n})})):t?e.format.value(t.toString(),{vars:e,data:u,key:n}):void 0}))).length&&(a=a[0]),l.push(a))}))}return l}},{"../../object/validate.js":158,"../../util/uniques.js":196,"./value.js":61}],61:[function(e,t,n){(function(){var n,r,a,o,i,s,l,u,c,d;c=e("../../object/validate.js"),u=e("../../util/uniques.js"),l=function(e,t,o,i){var s,l,d,f;if(l=c(t),"function"==typeof o&&l)return o(t,e);if(l){if(o in t)return t[o];if(s=e.data.cacheID+"_"+i,n(t,s,e),o in t.d3po.data[s])return t.d3po.data[s][o];if(i in t)t=t[i];else{if(!(e.id.value in t))return null;if(t=t[e.id.value],i!==o&&(d=a(e,t,i,e.id.value)),null==d&&(d=r(e,t,i,e.id.value)),null==d)return null;if(i===o)return d;t=d}}return t instanceof Array&&!c(t[0])&&(t=u(t)),t instanceof Array&&c(t[0])&&(f=u(t,o)).length||(f=a(e,t,o,i))?f:f=r(e,t,o,i)},a=function(e,t,n,r){var a;return e.data.viz instanceof Array&&n in e.data.keys&&(a=u(s(e.data.viz,t,r),n)),a&&a.length?a:null},r=function(e,t,n,r){var a,o,i,l;if("attrs"in e&&e.attrs.value&&n in e.attrs.keys)if((a=c(e.attrs.value)&&r in e.attrs.value?e.attrs.value[r]:e.attrs.value)instanceof Array){if((i=u(s(a,t,r),n)).length)return i}else if(t instanceof Array){if((a=[function(){var e,n,r;if(o in a){for(r=[],e=0,n=t.length;e<n;e++)o=t[e],r.push(a[o]);return r}}()]).length&&(l=u(a,n)).length)return l}else if(t in a)return a[t][n];return null},s=function(e,t,n){return t instanceof Array?e.filter((function(e){return t.indexOf(e[n])>=0})):e.filter((function(e){return e[n]===t}))},n=function(e,t,n){return"d3po"in e||(e.d3po={}),"data"in e.d3po||(e.d3po.data={}),(n.data.changed||n.attrs&&n.attrs.changed||!(t in e.d3po.data))&&(e.d3po.data[t]={}),e},d=function(e,t,n,r,a){var o,i,s,l,u,d,f;if(null===a)return a;d="time"in e&&e.time.value===r,a instanceof Array||(a=[a]);for(s=l=0,u=a.length;l<u;s=++l)f=a[s],d&&null!==f&&f.constructor!==Date&&(4===(f+="").length&&parseInt(f)+""===f&&(f+="/01/01"),"Invalid Date"!==(i=new Date(f))&&(a[s]=i));return 1===a.length&&(a=a[0]),null!==a&&c(t)&&"string"==typeof r&&!(r in t)&&(o=e.data.cacheID+"_"+n,t.d3po.data[o][r]=a),a},i=function(e,t,n,r){var a,o,i,s,f;for(f=[],o=0,i=t.length;o<i;o++)a=t[o],c(a)?(s=l(e,a,n,r),f.push(d(e,a,r,n,s))):f.push(a);return"number"!=typeof f[0]&&(f=u(f)),1===f.length?f[0]:f},o=function(e,t,n,r){var a,o;return n?"number"==typeof n?n:(a=c(t),r||(r=e.id.value),a&&t.values instanceof Array?o=i(e,t.values,n,r):a&&t[n]instanceof Array?o=i(e,t[n],n,r):t instanceof Array?o=i(e,t,n,r):(o=l(e,t,n,r),o=d(e,t,r,n,o)),o):null},t.exports=o}).call(this)},{"../../object/validate.js":158,"../../util/uniques.js":196}],62:[function(e,t,n){(function(){t.exports=function(e){var t,n,r;return["div","svg"].indexOf(e)<0&&(e="div"),n={position:"absolute",left:"-9999px",top:"-9999px",visibility:"hidden",display:"block"},t="div"===e?{}:{position:"absolute"},(r=d3.select("body").selectAll(e+".d3po_tester").data([0])).enter().append(e).attr("class","d3po_tester").style(n).attr(t),r}}).call(this)},{}],63:[function(e,t,n){(function(){t.exports={dev:{accepted:"{0} is not an accepted value for {1}, please use one of the following: {2}.",noChange:"{0} was not updated because it did not change.",noContainer:"cannot find a container on the page matching {0}.",of:"of",oldStyle:"style properties for {0} have now been embedded directly into .{1}().",sameEdge:"edges cannot link to themselves. automatically removing self-referencing edge {0}.",set:"{0} has been set.",setLong:"{0} has been set to {1}.",setContainer:"please define a container div using .container()"},error:{accepted:"{0} is not an accepted {1} for {2} visualizations, please use one of the following: {3}.",connections:"no connections available for {0}.",data:"no data available",dataYear:"no data available for {0}.",lib:"{0} visualizations require loading the {1} library.",libs:"{0} visualizations require loading the following libraries: {1}.",method:"{0} visualizations require setting the {1} method.",methods:"{0} visualizations require setting the following methods: {1}."},format:{decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%A, %B %-d, %Y %X",date:"%-m/%-d/%Y",time:"%I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},lowercase:["a","an","and","as","at","but","by","for","from","if","in","into","near","nor","of","on","onto","or","per","that","the","to","with","via","vs","vs."],message:{data:"analyzing data",draw:"drawing visualization",initializing:"initializing {0}",loading:"loading data",tooltipReset:"resetting tooltips",ui:"updating ui"},method:{active:"active segments",color:"color",depth:"depth",dev:"verbose",focus:"focus",icon:"icon",id:"id",height:"height",labels:"labels",legend:"legend",margin:"margin",messages:"status messages",mode:"mode",mute:"hide",order:"order",search:"search",shape:"shape",size:"size",solo:"isolate",style:"style",temp:"temporary segments",text:"text",time:"time",total:"total segments",type:"type",width:"width",x:"x axis",y:"y axis",zoom:"zoom"},time:["date","day","month","time","year"],timeFormat:{FullYear:"%Y",Month:"%B",MonthSmall:"%b",Date:"%A %-d",DateSmall:"%-d",Hours:"%I %p",Minutes:"%I:%M",Seconds:"%Ss",Milliseconds:"%Lms","FullYear-Month":"%b %Y","FullYear-Date":"%-m/%-d/%Y","Month-Date":"%b %-d","Hours-Minutes":"%I:%M %p","Hours-Seconds":"%I:%M:%S %p","Hours-Milliseconds":"%H:%M:%S.%L","Minutes-Seconds":"%I:%M:%S %p","Minutes-Milliseconds":"%H:%M:%S.%L","Seconds-Milliseconds":"%H:%M:%S.%L"},ui:{and:"and",back:"back",collapse:"click to collapse",error:"error",expand:"click to expand",including:"including",iqr:"interquartile range for {0}",loading:"loading...",max:"maximum",median:"median",min:"minimum",more:"{0} more",moreInfo:"click for more info",or:"or",noResults:"no results matching {0}.",percentile:"{0} percentile",primary:"primary connections",quartile_first:"first quartile",quartile_third:"third quartile",share:"share",total:"total",tukey_bottom:"bottom tukey",tukey_top:"top tukey",values:"values"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","ER","GDP","HVAC","ID","IT","PCP","R&D","TV","UI"],visualization:{bar:"Bar Chart",box:"Box Plot",bubbles:"Bubbles",chart:"Chart",geomap:"Geo Map",line:"Line Plot",network:"Network",paths:"Paths",pie:"Pie Chart",rings:"Rings",scatter:"Scatter Plot",stacked:"Stacked Area",table:"Table",treemap:"Tree Map"}}}).call(this)},{}],64:[function(e,t,n){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," "],dateTime:"%A, %e de %B de %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],shortDays:["dom","lun","mar","mi","jue","vie","sb"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},dev:{accepted:"{0} no es un valor aceptado para {1}, por favor utilice uno de los siguientes: {2}.",noChange:"{0} no se actualiza porque no cambi.",noContainer:"no se puede encontrar un contenedor en la pgina correspondiente a {0}.",of:"de",oldStyle:"propiedades de estilo para {0} ahora se han incorporado directamente en. {1} ().",sameEdge:"los vnculos no se pueden enlazar con si mismos. eliminando automticamente el vnculo {0} que se autorreferencia.",set:"{0} se ha establecido.",setLong:"{0} ha sido establecido a {1}.",setContainer:"defina un div contenedor utilizando .container ()"},error:{accepted:"{0} no es un {1} aceptado para visualizaciones de {2}, por favor utilice uno de los siguientes: {3}.",connections:"no hay conexiones disponibles para {0}.",data:"No hay datos disponibles",dataYear:"no hay datos disponibles para {0}.",lib:"{0} visualizaciones requieren cargar las siguientes libreras: {1}.",libs:"{0} visualizaciones requieren cargar las siguientes libreras: {1}.",method:"{0} visualizaciones requieren establecer el mtodo {1}.",methods:"{0} visualizaciones requieren establecer los siguientes mtodos: {1}."},lowercase:["una","y","en","pero","en","de","o","el","la","los","las","para","a","con"],method:{active:"segmentos activos",color:"color",depth:"profundidad",dev:"detallado",focus:"foco",icon:"cono",id:"id",height:"alto",labels:"rtulo",legend:"leyenda",margin:"margen",messages:"mensajes de estado",order:"orden",search:"bsqueda",shape:"forma",size:"tamao",style:"estilo",temp:"segmentos temporales",text:"texto",time:"tiempo",total:"segmentos totales",type:"tipo",width:"anchura",x:"eje x",y:"eje Y",zoom:"zoom",mode:"modo",mute:"ocultar",solo:"aislar"},time:["fecha","da","mes","hora","ao"],visualization:{bubbles:"Burbujas",chart:"Grfico",geomap:"Mapa",line:"Grfico de linea",network:"Red",rings:"Anillos",scatter:"Grfico De Dispersin",stacked:"rea Apilada",treemap:"Tree Map",bar:"Grfico De Barras",box:"Diagrama de Cajas",paths:"Caminos",pie:"Grfico de Pastel",table:"Tabla"},ui:{and:"y",back:"atrs",collapse:"click para cerrar",error:"error",expand:"haga clic para ampliar",loading:"Cargando ...",more:"{0} ms",moreInfo:"clic para ms informacin",noResults:"no se encontraron resultados para {0}.",primary:"relaciones principales",share:"participacin",total:"total",values:"valores",including:"Incluyendo",or:"o",iqr:"rango intercuartil para {0}",max:"mximo",min:"mnimo",percentile:"{0} percentil",tukey_bottom:"Tukey inferior",tukey_top:"la parte superior de Tukey",quartile_first:"primer cuartil",quartile_third:"tercer cuartil",median:"mediana"},message:{data:"analizando los datos",draw:"visualizando",initializing:"inicializando {0}",loading:"cargando datos",tooltipReset:"restableciendo las descripciones emergentes",ui:"actualizando la interfaz de usuario"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","I&D","TV","UI"]}},{}],65:[function(e,t,n){(function(){t.exports={en_US:e("./languages/en_US.js"),es_ES:e("./languages/es_ES.js")}}).call(this)},{"./languages/en_US.js":63,"./languages/es_ES.js":64}],66:[function(e,t,n){(function(){var n,r,a,o,i,s,l,u,c;r=e("../../util/copy.js"),i=e("../console/print.js"),s=e("./process/detect.js"),l=e("./set.js"),u=e("../../string/format.js"),c=e("../../object/validate.js"),t.exports=function(e,t){var n,i,s;for(n in s=[],t)i=t[n],e[n]=r(i),e[n].initialized=o(e,e[n],n),s.push(e.self[n]=a(e,n));return s},o=function(e,t,n,r){var a;for(a in t.previous=!1,t.changed=!1,t.initialized=!1,t.callback=!1,"init"in t&&!("value"in t)&&(t.value=t.init(e),delete t.init),"process"in t&&(t.value=s(e,t,t.value)),t)"global"===a?n in e||(e[n]=[]):"value"!==a&&c(t[a])&&o(e,t[a],a,n);return!0},a=function(e,t){return function(r,a){var o,s,l,d,f,p,h,v;if("function"==typeof(o="accepted"in e[t]?e[t].accepted:null)&&(o=o(e)),o instanceof Array||(o=[o]),r===Object)return e[t];if(!arguments.length&&o.indexOf(void 0)<0)return"value"in e[t]?e[t].value:e[t];if("style"===t&&"object"==typeof r)for(p in v=e.format.locale.value.dev.oldStyle,r)i.warning(u(v,'"'+p+'"',p),p),e.self[p](r[p]);if("font"===t)for(d in"string"==typeof r&&(r={family:r}),h=!0,l=function(e,t,n,r){c(e[n])&&t in e[n]&&(c(e[n][t])?e[n][t].process?e[n][t].value=e[n][t].process(r):e[n][t].value=r:e[n][t]=r)},s=function(e,t,n){var r;if(c(e)){if(h)for(r in e)l(e,t,r,n);else"font"in e&&l(e,t,"font",n);for(r in h=!1,e)s(e[r],t,n)}},r)f=r[d],"secondary"!==d&&(c(f)&&(f=f.value),f&&s(e,d,f));return n(e,t,e,t,r),"function"==typeof a&&(e[t].callback=a),!1===e[t].chainable?e[t].value:e.self}},n=function(e,t,r,a,o){var i,s,u,d;if(["accepted","changed","initialized","previous","process"].indexOf(a)<0)if(d=c(o),u=c(r[a])&&"objectAccess"in r[a]&&!1===r[a].objectAccess,i=d&&(u||!("value"in o)&&(!c(r[a])||!(d3.keys(o)[0]in r[a]))),null===o||!d||i)l(e,t,r,a,o);else if(d)for(s in o)n(e,t,r[a],s,o[s])}}).call(this)},{"../../object/validate.js":158,"../../string/format.js":159,"../../util/copy.js":193,"../console/print.js":47,"./process/detect.js":74,"./set.js":80}],67:[function(e,t,n){(function(){t.exports=function(e){return e||(e=!1),{accepted:[!1,Array,Function,Number,Object,String],callback:{accepted:[!1,Function],value:!1},global:e,process:Array,value:[]}}}).call(this)},{}],68:[function(e,t,n){(function(){var n;n=e("../../../client/rtl.js"),t.exports=function(e){var t;return t=["left","center","right"],!1===e&&t.unshift(!1),t.indexOf(e)<0&&(e="left"),{accepted:t,process:function(e){return n?"left"===e?"right":"right"===e?"left":e:e},value:e}}}).call(this)},{"../../../client/rtl.js":35}],69:[function(e,t,n){(function(){t.exports=function(e){var t;return t=["line-through","none","overline","underline"],!1===e&&t.unshift(!1),t.indexOf(e)<0&&(e="none"),{accepted:t,value:e}}}).call(this)},{}],70:[function(e,t,n){(function(){var n,r;r=e("../../../font/validate.js"),n=["Fira Sans","sans-serif"],t.exports=function(e){return void 0===e&&(e=n),{process:r,value:e}}}).call(this)},{"../../../font/validate.js":89}],71:[function(e,t,n){(function(){t.exports=function(e){var t;return t=["top","middle","bottom"],!1===e&&t.unshift(!1),t.indexOf(e)<0&&(e="bottom"),{accepted:t,mapping:{top:"0ex",middle:"0.5ex",bottom:"1ex"},process:function(e){return this.text=e,this.mapping[e]},value:e}}}).call(this)},{}],72:[function(e,t,n){(function(){t.exports=function(e){var t;return t=["capitalize","lowercase","none","uppercase"],!1===e&&t.unshift(!1),t.indexOf(e)<0&&(e="none"),{accepted:t,value:e}}}).call(this)},{}],73:[function(e,t,n){(function(){t.exports=function(e,t,n){var r;return t.history&&t.history.reset(),e.constructor===String?e.indexOf("/")>=0?(n.url=e,[]):(r=d3.selectAll(e)).size()?r:(e.indexOf(".")>=0&&(n.url=e),[]):e}}).call(this)},{}],74:[function(e,t,n){(function(){var n,r;n=e("../../../util/copy.js"),r=e("../../../array/update.js"),t.exports=function(e,t,a){return t.process===Array?r(n(t.value),a):"object"==typeof t.process&&"string"==typeof a?t.process[a]:"function"==typeof t.process?t.process(a,e,t):a}}).call(this)},{"../../../array/update.js":30,"../../../util/copy.js":193}],75:[function(e,t,n){(function(){var n;n=e("../../../client/css.js"),t.exports=function(e,t,r){return!1===e||e.indexOf("fa-")<0||0===e.indexOf("fa-")&&n("font-awesome")?e:r.fallback}}).call(this)},{"../../../client/css.js":31}],76:[function(e,t,n){(function(){t.exports=function(e,t){var n,r,a,o,i,s,l,u,c,d,f,p,h;if("string"==typeof e){for(n=r=0,i=(e=e.split(" ")).length;r<i;n=++r)h=e[n],e[n]=parseFloat(h,10);e=1===e.length?e[0]:2===e.length?{top:e[0],right:e[1],bottom:e[0],left:e[1]}:3===e.length?{top:e[0],right:e[1],bottom:e[2],left:e[1]}:4===e.length?{top:e[0],right:e[1],bottom:e[2],left:e[3]}:0}if(p=["top","right","bottom","left"],"number"==typeof e)for(a=0,s=p.length;a<s;a++)t[f=p[a]]=e;else for(o=0,l=p.length;o<l;o++)t[f=p[o]]=e[f];for(t.css="",d=[],n=c=0,u=p.length;c<u;n=++c)f=p[n],n&&(t.css+=" "),d.push(t.css+=t[f]+"px");return d}}).call(this)},{}],77:[function(e,t,n){(function(){var n,r,a,o;n=e("../../array/contains.js"),r=e("../../string/format.js"),a=e("../../string/list.js"),o=e("../console/print.js"),t.exports=function(e,t,i,s,l){var u,c,d,f,p,h,v,g;if("function"==typeof t&&(t=t(e)),t instanceof Array||(t=[t]),!1===(c=n(t,i))&&void 0!==i){for(h=[],g=JSON.stringify(i),"string"!=typeof i&&(g='"'+g+'"'),f=0,p=t.length;f<p;f++)"string"==typeof(u=t[f])?h.push('"'+u+'"'):"function"==typeof u?h.push(u.toString().split("()")[0].substring(9)):void 0===u?h.push("undefined"):h.push(JSON.stringify(u));h=a(h,e.format.locale.value.ui.or),e.type&&["mode","shape"].indexOf(s)>=0?(v=e.format.locale.value.error.accepted,d=e.format.locale.value.visualization[e.type.value]||e.type.value,o.warning(r(v,g,s,d,h),s)):(v=e.format.locale.value.dev.accepted,o.warning(r(v,g,l,h),s))}return!c}}).call(this)},{"../../array/contains.js":28,"../../string/format.js":159,"../../string/list.js":160,"../console/print.js":47}],78:[function(e,t,n){(function(){t.exports=function(e){var t;return(t=["auto","optimizeSpeed","crispEdges","geometricPrecision"]).indexOf(e)>=0||(e="crispEdges"),{accepted:t,value:e}}}).call(this)},{}],79:[function(e,t,n){(function(){var n,r;r=e("../../object/validate.js"),n=function(e,t){var a;for(a in e.changed&&(e.changed=!1),"draw"===t&&(e.frozen=!1,e.update=!0,e.first=!1),e)a.indexOf("d3po")<0&&r(e[a])&&n(e[a],a)},t.exports=n}).call(this)},{"../../object/validate.js":158}],80:[function(e,t,n){(function(){var n,r,a,o,i,s,l,u,c;n=e("../../util/copy.js"),r=e("../../util/d3selection.js"),c=e("../../object/validate.js"),a=e("../../object/merge.js"),o=e("../console/print.js"),i=e("./process/detect.js"),s=e("./rejected.js"),l=e("../../string/format.js"),u=e("../../array/update.js"),t.exports=function(e,t,d,f,p){var h,v,g,m,y,x,b,j,w,_,k,z,A,M;if(z="value"!==f&&f&&f!==t?'"'+f+'" '+e.format.locale.value.dev.of+" ."+t+"()":"."+t+"()",h="value"===f&&"accepted"in d?d.accepted:c(d[f])&&"accepted"in d[f]?d[f].accepted:[p],!s(e,h,p,t,z)){if(c(d[f])&&"value"in d[f]&&(_=f,d=d[f],f="value"),"value"===f&&"process"in d&&(p=i(e,d,p)),d[f]instanceof Array||d[f]!==p||void 0===p){if(d.changed=!0,d.loaded&&(d.loaded=!1),"history"in e&&"draw"!==t&&((v=n(d)).method=t,e.history.chain.push(v)),d.previous=d[f],"id"in e&&"value"===f&&"nesting"in d)if("id"!==t){if("object"!=typeof d.nesting&&(d.nesting={}),c(p)){for(x in p)"string"==typeof p[x]&&(p[x]=[p[x]]);d.nesting=a(d.nesting,p),e.id.value in d.nesting||(d.nesting[e.id.value]=p[d3.keys(p)[0]])}else d.nesting[e.id.value]=p instanceof Array?p:[p];d[f]=d.nesting[e.id.value][0]}else p instanceof Array?(d.nesting=p,"depth"in e&&e.depth.value<p.length?d[f]=p[e.depth.value]:(d[f]=p[0],"depth"in e&&(e.depth.value=0))):(d[f]=p,d.nesting=[p],"depth"in e&&(e.depth.value=0));else"depth"===t?(p>=e.id.nesting.length?e.depth.value=e.id.nesting.length-1:e.depth.value=p<0?0:p,e.id.value=e.id.nesting[e.depth.value],"object"==typeof e.text.nesting&&(w=e.text.nesting[e.id.value])&&(e.text.nesting[e.id.value]="string"==typeof w?[w]:w,e.text.value=w instanceof Array?w[0]:w)):c(d[f])&&c(p)?d[f]=a(d[f],p):d[f]=p;"value"===f&&d.global&&(y=d[f].length>0,(b=_||f)in e&&(y&&e.data[b].indexOf(t)<0||!y&&e.data[b].indexOf(t)>=0)&&(e.data[b]=u(e.data[b],t))),"value"===f&&d.dataFilter&&e.data&&e.data.filters.indexOf(t)<0&&e.data.filters.push(t),e.dev.value&&d.changed&&void 0!==d[f]&&(j=d[f]instanceof Array&&d[f].length>10,m=r(d[f]),A="function"==typeof d[f],null!==(M=j||m||A?null:"string"==typeof d[f]?d[f]:JSON.stringify(d[f]))&&M.length<260?(k=e.format.locale.value.dev.setLong,o.log(l(k,z,'"'+M+'"'))):(k=e.format.locale.value.dev.set,o.log(l(k,z))))}else k=e.format.locale.value.dev.noChange,e.dev.value&&o.comment(l(k,z));"value"===f&&d.callback&&!d.url&&(g="function"==typeof d.callback?d.callback:d.callback.value)&&g(p,e.self)}}}).call(this)},{"../../array/update.js":30,"../../object/merge.js":157,"../../object/validate.js":158,"../../string/format.js":159,"../../util/copy.js":193,"../../util/d3selection.js":194,"../console/print.js":47,"./process/detect.js":74,"./rejected.js":77}],81:[function(e,t,n){var r=e("../console/print.js"),a=e("../../string/format.js");t.exports=function(e){if(e.dev.value){var t="analyzing edges list";r.time(t)}var n=e.types[e.type.value].requirements;n instanceof Array||(n=[n]);var o=n.indexOf("nodes")>=0&&!e.nodes.value;if(o){e.nodes.value=[];var i=[];e.nodes.changed=!0}e.edges.value.forEach((function(t){["source","target"].forEach((function(n){var r=typeof t[e.edges[n]];if("object"!==r)if("number"!==r||o||"number"===e.data.keys[e.id.value])if(o&&i.indexOf(t[e.edges[n]])>=0)t[e.edges[n]]=e.nodes.value.filter((function(r){return r[e.id.value]===t[e.edges[n]]}))[0];else{var a={};a[e.id.value]=t[e.edges[n]],t[e.edges[n]]=a}else t[e.edges[n]]=e.nodes.value[t[e.edges[n]]];var s=t[e.edges[n]];o&&i.indexOf(s[e.id.value])<0&&(i.push(s[e.id.value]),e.nodes.value.push(s))})),"keys"in e.data||(e.data.keys={}),e.id.value in e.data.keys||(e.data.keys[e.id.value]=typeof t[e.edges.source][e.id.value])})),e.edges.value=e.edges.value.filter((function(t){var n=t[e.edges.source][e.id.value];if(n===t[e.edges.target][e.id.value]){var o=e.format.locale.value.dev.sameEdge;return r.warning(a(o,'"'+n+'"'),"edges"),!1}return!0})),e.edges.linked=!0,e.dev.value&&r.timeEnd(t)}},{"../../string/format.js":159,"../console/print.js":47}],82:[function(e,t,n){var r=e("./hideelement.js");t.exports=function(e){var t=[e.color.value,e.icon.value,e.keywords.value,e.alt.value,"style"];function n(e,n){[].forEach.call(n.attributes,(function(t){if(/^data-/.test(t.name)){var n=t.name.substr(5).replace(/-(.)/g,(function(e,t){return t.toUpperCase()}));e[n]=t.value}})),t.forEach((function(t){null!==n.getAttribute(t)&&(e[t]=n.getAttribute(t))}))}e.text.value||e.self.text("text"),t=t.concat(e.id.nesting),e.self.data({element:e.data.value});var a=e.data.element.value.node().tagName.toLowerCase(),o=e.data.element.value.attr("type"),i=[];if("select"===a){var s=e.data.element.value.node().id;s&&e.self.container({id:s}),e.data.element.value.selectAll("option").each((function(t,r){var a={};if(a.text=d3.select(this).text(),n(a,this),i.push(a),this.selected)for(r=e.id.nesting.length-1;r>=0;r--){var o=e.id.nesting[r];if(o in a){e.self.focus(a[o]);break}}}))}else if("input"===a&&"radio"===o){var l=e.data.element.value.node().getAttribute("name");l&&e.self.container({id:l}),e.data.element.value.each((function(t,a){var o={};n(o,this);var s=o[e.id.value]||this.id||!1;if(s&&isNaN(parseFloat(s))){var l=d3.select("label[for="+s+"]");l.empty()||(o.text=l.html(),l.call(r))}i.push(o),this.checked&&e.self.focus(o[e.id.value])}))}!e.focus.value.length&&i.length&&(e.data.element.value.node().selectedIndex=0,e.self.focus(i[0][e.id.value]));var u=d3.select("legend[for="+e.container.id+"]");u.empty()||(e.self.title(u.html()),u.call(r));var c=!!e.container.value&&e.container.value.node().tagName.toLowerCase();return!1!==e.container.value&&"body"!==c||(e.container.value=d3.select(e.data.element.value.node().parentNode)),e.data.element.value.call(r),i}},{"./hideelement.js":83}],83:[function(e,t,n){t.exports=function(e){e.style("position","absolute","important").style("clip","rect(1px 1px 1px 1px)","important").style("clip","rect(1px, 1px, 1px, 1px)","important").style("width","1px","important").style("height","1px","important").style("margin","-1px","important").style("padding","0","important").style("border","0","important").style("overflow","hidden","important")}},{}],84:[function(e,t,n){var r=e("../console/print.js");t.exports=function(e){if("network"===e.type.value){if(e.dev.value){var t="analyzing node positions";r.time(t)}if(e.nodes.value.filter((function(e){return"number"==typeof e.x&&"number"==typeof e.y})).length===e.nodes.value.length)e.nodes.positions=!0;else{var n=d3.layout.force().size([e.width.viz,e.height.viz]).nodes(e.nodes.value).links(e.edges.value),a=e.edges.strength.value;a&&("string"==typeof a?n.linkStrength((function(e){return e[a]})):n.linkStrength(a));n.start();for(var o=50;o>0&&(n.tick(),!(n.alpha()<.01));--o);n.stop(),e.nodes.positions=!0}e.dev.value&&r.timeEnd(t)}}},{"../console/print.js":47}],85:[function(e,t,n){(function(){var n;n=e("numeric"),t.exports=function(e,t){var r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z;for(null==t&&(t={}),null==t.maxDegree&&(t.maxDegree=5),r=e.length,y=Number.MAX_VALUE,s=null,o=function(){var n,r,a;for(a=[],c=n=1,r=t.maxDegree+1;1<=r?n<r:n>r;c=1<=r?++n:--n)a.push(function(){var t,n,r;for(r=[],n=0,t=e.length;n<t;n++)m=e[n],r.push(Math.pow(m[0],c));return r}());return a}(),k=function(){var t,n,r;for(r=[],t=0,n=e.length;t<n;t++)m=e[t],r.push(m[1]);return r}(),f=v=0,x=1<<t.maxDegree;0<=x?v<x:v>x;f=0<=x?++v:--v){for(i=[function(){var e,t,n;for(n=[],e=0,t=r;0<=t?e<t:e>t;0<=t?++e:--e)n.push(1);return n}()],d=[0],p=g=0,b=t.maxDegree;0<=b?g<b:g>b;p=0<=b?++g:--g)(f&1<<p)>0&&(i.push(o[p]),d.push(p+1));a=n.transpose(i),h=d.length,l=n.dot(n.dot(n.inv(n.dot(i,a)),i),k),z=n.dot(a,l),j=n.sub(k,z),w=(_=n.dot(j,j))/(r-h),(u=-2*(-.5*r*Math.log(2*Math.PI)-.5*r*Math.log(w)-_/(2*w))+h*(Math.log(r)-Math.log(2*Math.PI)))<y&&(y=u,s=[d,l,z])}return s}}).call(this)},{numeric:21}],86:[function(e,t,n){(function(){var n;n=e("static-kdtree"),t.exports=function(e,t){var r,a,o,i,s,l,u,c,d,f,p;return null==t&&(t=10),p=n(e),u=function(){var n,r,a;for(a=[],n=0,r=e.length;n<r;n++)c=e[n],a.push(p.knn(c,t+1).slice(1));return a}(),f=function(t,n){var r,a,o,i,s,l;for(r=e[t],a=e[n],i=0,t=s=0,l=r.length;0<=l?s<l:s>l;t=0<=l?++s:--s)i+=(o=r[t]-a[t])*o;return i},i=function(){var n,r,o;for(o=[],a=n=0,r=e.length;0<=r?n<r:n>r;a=0<=r?++n:--n)o.push(f(a,u[a][t-1]));return o}(),d=function(e,t){return Math.max(f(e,t),i[t])},s=function(e){var n,r,a,o,i;for(o=0,r=0,a=(i=u[e]).length;r<a;r++)n=i[r],o+=d(e,n);return t/o},l=function(){var t,n,r;for(r=[],a=t=0,n=e.length;0<=n?t<n:t>n;a=0<=n?++t:--t)r.push(s(a));return r}(),function(){var n,i,s,c,d,f;for(f=[],a=n=0,c=e.length;0<=c?n<c:n>c;a=0<=c?++n:--n){for(r=0,i=0,s=(d=u[a]).length;i<s;i++)o=d[i],r+=l[o];r/=t,f.push([a,r/l[a]])}return f}().sort((function(e,t){return t[1]-e[1]}))}}).call(this)},{"static-kdtree":23}],87:[function(e,t,n){(function(){t.exports=function(e){var t,n;return n=d3.median(e),t=d3.median(e.map((function(e){return Math.abs(e-n)}))),e.map((function(e,r){return[r,Math.abs(e-n)/t]})).sort((function(e,t){return t[1]-e[1]}))}}).call(this)},{}],88:[function(e,t,n){(function(){var n;n=e("../core/font/tester.js"),t.exports=function(e,t,r){var a,o,i,s,l,u,c;return r||(r={}),t=t||{},u=r.parent||n("svg").append("text"),s=[],e instanceof Array||(e=[e]),c=u.selectAll("tspan").data(e),a={left:"0px",position:"absolute",top:"0px",x:0,y:0},l=0,"letter-spacing"in t&&(l=parseFloat(t["letter-spacing"]),delete t["letter-spacing"]),i=function(e){var t;return t=0,l&&(t=(d3.select(e).text().length-1)*l),e.getComputedTextLength()+t},o=function(e){return e.parentNode.getBBox().height||e.getBoundingClientRect().height},c.enter().append("tspan").text(String).style(t).attr(a).each((function(e){if("function"==typeof r.mod)return r.mod(this)})).each((function(e){var t,n,r;return(t=d3.select(this).selectAll("tspan")).size()?(r=[],t.each((function(){return r.push(i(this))})),r=d3.max(r)):r=i(this),n=o(this),s.push({height:n,text:e,width:r})})),c.remove(),r.parent||u.remove(),s}}).call(this)},{"../core/font/tester.js":62}],89:[function(e,t,n){(function(){var n,r;n=e("../core/font/tester.js"),(r=function(e){var t,a,o,i,s,l,u,c,d,f,p,h,v;for(e instanceof Array||(e=e.split(",")),i=0,l=e.length;i<l;i++)e[i].trim();if((o=e.join(", "))in(t=r.complete))return t[o];for(f=function(e){return h.append("span").style("font-family",e).style("font-size","32px").style("padding","0px").style("margin","0px").text("abcdefghiABCDEFGHI_!@#$%^&*()_+1234567890")},p=function(e,t){var n,r,a;return r=(n=f(e)).node().offsetWidth,a=t.node().offsetWidth,n.remove(),r!==a},h=n("div"),c=f("monospace"),d=f("sans-serif"),s=0,u=e.length;s<u;s++)if((v=p((a=e[s])+",monospace",c))||(v=p(a+",sans-serif",d)),v){v=a;break}return v||(v="sans-serif"),c.remove(),d.remove(),t[o]=v,v}).complete={},t.exports=r}).call(this)},{"../core/font/tester.js":62}],90:[function(e,t,n){var r=e("../array/sort.js"),a=e("../core/methods/attach.js"),o=e("../core/data/format.js"),i=e("../core/data/keys.js"),s=e("../core/data/load.js"),l=e("../core/fetch/data.js"),u=e("../client/ie.js"),c=e("../core/methods/reset.js"),d=e("../core/console/print.js");t.exports=function(){var t={types:{auto:e("./types/auto.js"),button:e("./types/button/button.js"),drop:e("./types/drop/drop.js"),toggle:e("./types/toggle.js")},self:function(e){var n=t.data.value instanceof Array&&t.data.value.length>t.data.large;if(t.draw.timing=t.draw.first||n||u?0:t.timing.ui,t.data.value instanceof Array){if(t.dev.value&&d.group('drawing "'+t.type.value+'"'),t.data.changed&&(t.data.cache={},i(t,"data"),o(t)),t.data.viz=l(t),t.data.sort.value&&(t.data.changed||t.order.changed||t.order.sort.changed)&&r(t.data.viz,t.order.value||t.text.value,t.order.sort.value,t.color.value,t),!1===t.focus.value&&["auto","button"].indexOf(t.type.value)<0){var a=t.data.element.value;if(a&&"select"===a.node().tagName.toLowerCase()){var f=a.property("selectedIndex");f=f<0?0:f;var p=a.selectAll("option")[0][f],h=p.getAttribute("data-"+t.id.value)||p.getAttribute(t.id.value);h&&(t.focus.value=h)}!1===t.focus.value&&t.data.viz.length&&(t.focus.value=t.data.viz[0][t.id.value]),t.dev.value&&!1!==t.focus.value&&d.log('"value" set to "'+t.focus.value+'"')}var v=function(e,n){n="number"!=typeof n?1===t.id.nesting.length?0:t.id.nesting.length-1:n;var r=t.id.nesting[n];return n>0&&(!(r in e)||e[r]instanceof Array)?v(e,n-1):r};if(t.data.changed){"auto"===t.search.value?t.data.viz.length>10?(t.search.enabled=!0,t.dev.value&&d.log("Search enabled.")):(t.search.enabled=!1,t.dev.value&&d.log("Search disabled.")):t.search.enabled=t.search.value;var g=t.data.element.value?t.data.element.value.node().tagName.toLowerCase():"";if(t.data.element.value&&"select"===g){var m=[];for(var y in t.data.nested.all)m=m.concat(t.data.nested.all[y]);options=t.data.element.value.selectAll("option").data(m,(function(e){var t=!!e&&v(e);return!(!e||!(t in e))&&e[t]})),options.exit().remove(),options.enter().append("option"),options.each((function(e){var n=v(e),r=n===t.id.value?t.text.value||t.id.value:!0!==t.text.nesting&&n in t.text.nesting?t.text.nesting[n]:n;for(var a in e)"object"!=typeof e[a]&&(a===r&&d3.select(this).html(e[a]),["alt","value"].indexOf(a)>=0?d3.select(this).attr(a,e[a]):d3.select(this).attr("data-"+a,e[a]));e[n]===t.focus.value?this.selected=!0:this.selected=!1}))}}else if(t.focus.changed&&t.data.element.value){if("select"===t.data.element.value.node().tagName.toLowerCase())t.data.element.value.selectAll("option").each((function(e){e[v(e)]===t.focus.value?this.selected=!0:this.selected=!1}));else"radio"===t.data.element.value.attr("type").toLowerCase()&&t.data.element.value.each((function(e){this.value===t.focus.value?this.checked=!0:this.checked=!1}))}if("auto"!==t.type.value){if(!t.container.ui){t.container.ui=t.container.value.selectAll("div#d3po_"+t.type.value+"_"+t.container.id).data(["container"]);var x=t.data.element.value?t.data.element.value[0][0]:null;if(x)if(x.id)x="#"+x.id;else{var b=x.getAttribute(t.id.value)?t.id.value:"data-"+t.id.value;x=x.getAttribute(b)?"["+b+"="+x.getAttribute(b)+"]":null}t.container.ui.enter().insert("div",x).attr("id","d3po_"+t.type.value+"_"+t.container.id).style("position","relative").style("overflow","visible").style("vertical-align","top")}t.container.ui.style("display",t.ui.display.value),t.container.ui.transition().duration(t.draw.timing).style("margin",t.ui.margin.css);var j=t.container.ui.selectAll("div.d3po_title").data(t.title.value?[t.title.value]:[]);j.enter().insert("div","#d3po_"+t.type.value+"_"+t.container.id).attr("class","d3po_title").style("display","inline-block"),j.style("color",t.font.color).style("font-family",t.font.family.value).style("font-size",t.font.size+"px").style("font-weight",t.font.weight).style("padding",t.ui.padding.css).style("border-color","transparent").style("border-style","solid").style("border-width",t.ui.border+"px").text(String).each((function(e){t.margin.left=this.offsetWidth}))}if(t.data.value.length){var w=t.format.locale.value.visualization[t.type.value];t.dev.value&&d.time("drawing "+w),t.types[t.type.value](t),t.dev.value&&d.timeEnd("drawing "+w)}else!t.data.url||t.data.loaded&&!t.data.stream||s(t,"data",t.self.draw);t.dev.value&&d.timeEnd("total draw time"),c(t)}}};return a(t,{active:e("./methods/active.js"),alt:e("./methods/alt.js"),color:e("./methods/color.js"),config:e("./methods/config.js"),container:e("./methods/container.js"),data:e("./methods/data.js"),depth:e("./methods/depth.js"),dev:e("./methods/dev.js"),draw:e("./methods/draw.js"),focus:e("./methods/focus.js"),font:e("./methods/font.js"),format:e("./methods/format.js"),height:e("./methods/height.js"),history:e("./methods/history.js"),hover:e("./methods/hover.js"),icon:e("./methods/icon.js"),id:e("./methods/id.js"),keywords:e("./methods/keywords.js"),margin:e("./methods/margin.js"),open:e("./methods/open.js"),order:e("./methods/order.js"),remove:e("./methods/remove.js"),search:e("./methods/search.js"),select:e("./methods/select.js"),selectAll:e("./methods/selectall.js"),text:e("./methods/text.js"),timing:e("./methods/timing.js"),title:e("./methods/title.js"),type:e("./methods/type.js"),ui:e("./methods/ui.js"),width:e("./methods/width.js")}),t.self}},{"../array/sort.js":29,"../client/ie.js":32,"../core/console/print.js":47,"../core/data/format.js":50,"../core/data/keys.js":52,"../core/data/load.js":53,"../core/fetch/data.js":58,"../core/methods/attach.js":66,"../core/methods/reset.js":79,"./methods/active.js":91,"./methods/alt.js":92,"./methods/color.js":93,"./methods/config.js":94,"./methods/container.js":95,"./methods/data.js":96,"./methods/depth.js":97,"./methods/dev.js":98,"./methods/draw.js":99,"./methods/focus.js":100,"./methods/font.js":101,"./methods/format.js":102,"./methods/height.js":103,"./methods/history.js":104,"./methods/hover.js":105,"./methods/icon.js":106,"./methods/id.js":107,"./methods/keywords.js":108,"./methods/margin.js":109,"./methods/open.js":110,"./methods/order.js":111,"./methods/remove.js":112,"./methods/search.js":113,"./methods/select.js":114,"./methods/selectall.js":115,"./methods/text.js":116,"./methods/timing.js":117,"./methods/title.js":118,"./methods/type.js":119,"./methods/ui.js":120,"./methods/width.js":121,"./types/auto.js":122,"./types/button/button.js":123,"./types/drop/drop.js":128,"./types/toggle.js":145}],91:[function(e,t,n){(function(){e("../../core/methods/filter.js"),t.exports={accepted:[!1,Array,Function,Number,String],value:!1}}).call(this)},{"../../core/methods/filter.js":67}],92:[function(e,t,n){(function(){var n;n=e("../../core/methods/filter.js"),t.exports={accepted:[!1,Array,Function,Object,String],mute:n(!0),solo:n(!0),value:"alt"}}).call(this)},{"../../core/methods/filter.js":67}],93:[function(e,t,n){(function(){t.exports={accepted:[String],value:"color"}}).call(this)},{}],94:[function(e,t,n){(function(){t.exports={accepted:[Object],objectAccess:!1,process:function(e,t){var n,r;for(n in e)r=e[n],n in t.self&&t.self[n](r);return e},value:{}}}).call(this)},{}],95:[function(e,t,n){(function(){var n;n=e("../../util/d3selection.js"),t.exports={accepted:[!1,Array,Object,String],element:!1,id:"default",process:function(e){return!1===e?d3.select("body"):n(e)?e:e instanceof Array?d3.select(e[0][0]):(this.selector=e,d3.select(e))},value:d3.select("body")}}).call(this)},{"../../util/d3selection.js":194}],96:[function(e,t,n){var r=e("../../util/d3selection.js"),a=e("../../core/methods/process/data.js");t.exports={accepted:[!1,Array,Function,String],delimiter:{accepted:[String],value:"|"},element:{process:function(e,t){var n=!1;return r(e)?n=e:"string"!=typeof e||d3.select(e).empty()||(n=d3.select(e)),n&&t.self.container(d3.select(n.node().parentNode)),n},value:!1},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},filters:[],large:400,mute:[],process:function(e,t){return"default"===t.container.id&&e.length&&t.self.container({id:"default"+e.length}),a(e,t,this)},solo:[],sort:{accepted:[Boolean],value:!1},value:!1}},{"../../core/methods/process/data.js":73,"../../util/d3selection.js":194}],97:[function(e,t,n){(function(){t.exports={accepted:[Number],value:0}}).call(this)},{}],98:[function(e,t,n){(function(){t.exports={accepted:[Boolean],value:!1}}).call(this)},{}],99:[function(e,t,n){var r=e("../../util/d3selection.js"),a=e("../../core/parse/hideelement.js"),o=e("../../core/parse/element.js"),i=e("../../core/console/print.js"),s=e("../../string/format.js");t.exports={accepted:[void 0,Function],first:!0,frozen:!1,process:function(e,t){if(!1===this.initialized)return this.initialized=!0,e;if(!t.data.value||t.data.value instanceof Array&&!r(t.data.value)?t.data.element.value&&t.data.element.value.call(a):t.data.value=o(t),void 0===e&&"function"==typeof this.value&&(e=this.value),!1===t.container.value){var n=t.format.locale.value.dev.setContainer;i.warning(n,"container")}else if(t.container.value.empty()){n=t.format.locale.value.dev.noContainer;var l=t.container.selector||"";i.warning(s(n,'"'+l+'"'),"container")}else t.dev.value&&i.time("total draw time"),t.container.value.call(t.self);if("function"==typeof e&&t.history.chain.length){var u={};t.history.chain.forEach((function(e){var t=e.method;delete e.method,u[t]=e})),e(u),t.history.chain=[]}return e},update:!0,value:void 0}},{"../../core/console/print.js":47,"../../core/parse/element.js":82,"../../core/parse/hideelement.js":83,"../../string/format.js":159,"../../util/d3selection.js":194}],100:[function(e,t,n){(function(){t.exports={accepted:[!1,Number,String],process:function(e,t){var n,r,a,o,i,s,l,u,c,d;if((r=t.data.element.value)&&["string","number"].indexOf(typeof e)>=0)if(a=r.node().tagName.toLowerCase(),o=r.attr("type"),"select"===a)for(i=s=0,u=(d=r.selectAll("option")).length;s<u;i=++s)(n=d[i])&&n[t.id.value]===e&&(r.node().selectedIndex=i);else if("input"===a&&"radio"===o)for(l=0,c=r.length;l<c;l++)n=r[l],this.checked=n&&n[t.id.value]===e;return e},value:!1}}).call(this)},{}],101:[function(e,t,n){(function(){var n,r,a,o;a=e("../../core/methods/font/family.js"),n=e("../../core/methods/font/align.js"),r=e("../../core/methods/font/decoration.js"),o=e("../../core/methods/font/transform.js"),t.exports={align:n(),color:"#444444",decoration:r(),family:a(),secondary:{align:n(),color:"#444444",decoration:r(),family:a(),size:12,spacing:0,transform:o(),weight:200},size:12,spacing:0,transform:o(),weight:200}}).call(this)},{"../../core/methods/font/align.js":68,"../../core/methods/font/decoration.js":69,"../../core/methods/font/family.js":70,"../../core/methods/font/transform.js":72}],102:[function(e,t,n){(function(){var n,r,a,o;n=e("../../number/format.js"),r=e("../../core/locale/locale.js"),a=e("../../object/merge.js"),o=e("../../string/title.js"),t.exports={accepted:[Function,String],affixes:{accepted:[Object],objectAccess:!1,value:{}},locale:{accepted:function(){return d3.keys(r)},process:function(e){var t;return"en_US",t=r.en_US,"en_US"!==e&&(t=a(t,r[e])),this.language=e,t},value:"en_US"},number:{accepted:[!1,Function],value:!1},process:function(e,t){if("string"==typeof e)t.self.format({locale:e});else if("function"==typeof e)return e;return this.value},text:{accepted:[!1,Function],value:!1},value:function(e,t){var r,a;return t||(t={}),(a=t.vars||{}).time&&a.time.value&&t.key===a.time.value?(r=e.constructor===Date?e:new Date(e),a.data.time.format(r)):"number"==typeof e?(this.number.value||n)(e,t):"string"==typeof e?(this.text.value||o)(e,t):JSON.stringify(e)}}}).call(this)},{"../../core/locale/locale.js":65,"../../number/format.js":156,"../../object/merge.js":157,"../../string/title.js":162}],103:[function(e,t,n){(function(){t.exports={accepted:[!1,Number],max:600,secondary:!1,value:!1}}).call(this)},{}],104:[function(e,t,n){(function(){t.exports={back:function(){if(this.states.length)return this.states.pop()()},chain:[],reset:function(){var e;for(e=[];this.states.length;)e.push(this.states.pop()());return e},states:[]}}).call(this)},{}],105:[function(e,t,n){(function(){t.exports={accepted:[Boolean,Number,String],value:!1}}).call(this)},{}],106:[function(e,t,n){(function(){var n;n=e("../../core/methods/process/icon.js"),t.exports={accepted:[!1,Array,Function,Object,String],back:{accepted:[!1,String],fallback:"&#x276e;",opacity:1,process:n,rotate:0,value:"fa-angle-left"},button:{accepted:[!1,String],fallback:!1,opacity:1,process:n,rotate:0,value:!1},drop:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:n,rotate:0,value:"fa-angle-down"},next:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:n,rotate:0,value:"fa-angle-right"},select:{accepted:[!1,String],fallback:"&#x2713;",opacity:1,process:n,rotate:0,value:"fa-check"},style:{accepted:[Object,String],value:"default"},value:"icon"}}).call(this)},{"../../core/methods/process/icon.js":75}],107:[function(e,t,n){(function(){var n;n=e("../../core/methods/filter.js"),t.exports={accepted:[Array,String],dataFilter:!0,mute:n(!0),nesting:["value"],solo:n(!0),value:"value"}}).call(this)},{"../../core/methods/filter.js":67}],108:[function(e,t,n){(function(){var n;n=e("../../core/methods/filter.js"),t.exports={accepted:[!1,Array,Function,Object,String],mute:n(!0),solo:n(!0),value:"keywords"}}).call(this)},{"../../core/methods/filter.js":67}],109:[function(e,t,n){(function(){var n;n=e("../../core/methods/process/margin.js"),t.exports={accepted:[Number,Object,String],process:function(e){var t;return void 0===e&&(e=this.value),t=e,n(e,this),t},value:0}}).call(this)},{"../../core/methods/process/margin.js":76}],110:[function(e,t,n){(function(){t.exports={accepted:[Boolean],flipped:{accepted:[Boolean],value:!1},value:!1}}).call(this)},{}],111:[function(e,t,n){(function(){t.exports={accepted:[!1,Function,String],sort:{accepted:["asc","desc"],value:"asc"},value:!1}}).call(this)},{}],112:[function(e,t,n){(function(){t.exports={accepted:[void 0,Function],process:function(e,t){this.initialized&&t.container.ui.remove(),delete t.container.ui},value:void 0}}).call(this)},{}],113:[function(e,t,n){(function(){t.exports={accepted:["auto",Boolean],process:function(e){return"Boolean"==typeof e&&(this.enabled=e),e},term:"",value:"auto"}}).call(this)},{}],114:[function(e,t,n){(function(){t.exports={accepted:[String],chainable:!1,process:function(e,t){var n;return(n=t.container.value)&&e?n.select(e):e},value:void 0}}).call(this)},{}],115:[function(e,t,n){(function(){t.exports={accepted:[String],chainable:!1,process:function(e,t){var n;return(n=t.container.value)&&e?n.selectAll(e):e},value:void 0}}).call(this)},{}],116:[function(e,t,n){(function(){var n;n=e("../../core/methods/filter.js"),t.exports={accepted:[!1,String],nesting:!0,mute:n(!0),solo:n(!0),secondary:{accepted:[!1,String],nesting:!0,value:!1},value:!1}}).call(this)},{"../../core/methods/filter.js":67}],117:[function(e,t,n){(function(){t.exports={mouseevents:60,ui:200}}).call(this)},{}],118:[function(e,t,n){(function(){var n,r,a,o;n=e("../../core/methods/font/decoration.js"),r=e("../../core/methods/font/family.js"),o=e("../../core/methods/font/transform.js"),a=e("../../string/strip.js"),t.exports={accepted:[!1,Function,String],font:{align:"center",color:"#444444",decoration:n(),family:r(),size:16,transform:o(),weight:400},link:!1,process:function(e,t){var n;return 0===t.container.id.indexOf("default")&&e&&(n=a(e).toLowerCase(),t.self.container({id:n})),e},value:!1}}).call(this)},{"../../core/methods/font/decoration.js":69,"../../core/methods/font/family.js":70,"../../core/methods/font/transform.js":72,"../../string/strip.js":161}],119:[function(e,t,n){(function(){t.exports={accepted:function(e){return d3.keys(e.types)},value:"auto"}}).call(this)},{}],120:[function(e,t,n){(function(){var n,r,a,o,i;a=e("../../core/methods/font/family.js"),n=e("../../core/methods/font/align.js"),r=e("../../core/methods/font/decoration.js"),o=e("../../core/methods/process/margin.js"),i=e("../../core/methods/font/transform.js"),t.exports={align:n("center"),border:1,color:{primary:{process:function(e,t){var n;return n=this.value,t.ui.color.secondary.value||(t.ui.color.secondary.value=d3.rgb(n).darker(.75).toString()),e},value:"#ffffff"},secondary:{value:!1}},display:{acceped:["block","inline-block"],value:"inline-block"},font:{align:n("center"),color:"#444",decoration:r(),family:a(),size:11,transform:i(),weight:200},margin:{process:function(e){var t;return void 0===e&&(e=this.value),t=e,o(e,this),t},value:5},padding:{process:function(e){var t;return void 0===e&&(e=this.value),t=e,o(e,this),t},value:5}}}).call(this)},{"../../core/methods/font/align.js":68,"../../core/methods/font/decoration.js":69,"../../core/methods/font/family.js":70,"../../core/methods/font/transform.js":72,"../../core/methods/process/margin.js":76}],121:[function(e,t,n){(function(){t.exports={accepted:[!1,Number],secondary:!1,value:!1}}).call(this)},{}],122:[function(e,t,n){t.exports=function(e){var t=e.data.value.length;1===t?e.self.type("button").draw():t<5?e.self.type("toggle").draw():e.self.type("drop").draw()}},{}],123:[function(e,t,n){(function(){t.exports=function(t){var n,r,a,o,i,s,l,u;return s=e("../../../core/console/print.js"),a=e("./functions/color.js"),o=e("./functions/icons.js"),i=e("./functions/mouseevents.js"),l=e("./functions/style.js"),n=t.container.ui.selectAll("div.d3po_node").data(t.data.viz,(function(e){return e[t.id.value]})),t.dev.value&&s.time("enter"),n.enter().append("div").attr("class","d3po_node").call(a,t).call(l,t).call(o,t).call(i,t),t.dev.value&&s.timeEnd("enter"),t.draw.update||t.draw.timing?(t.dev.value&&s.time("ordering"),n.order(),t.dev.value&&s.timeEnd("ordering"),u=n):(r=[t.focus.previous,t.focus.value,t.hover.previous,t.hover.value].filter((function(e){return e})),u=n.filter((function(e){return r.indexOf(e[t.id.value])>=0}))),t.dev.value&&s.time("update"),u.classed("d3po_button_active",(function(e){return t.focus.value===e[t.id.value]})),t.draw.timing?u.transition().duration(t.draw.timing).call(a,t).call(l,t):u.call(a,t).call(l,t),u.call(o,t).call(i,t),t.dev.value&&s.timeEnd("update"),n.exit().remove()}}).call(this)},{"../../../core/console/print.js":47,"./functions/color.js":124,"./functions/icons.js":125,"./functions/mouseevents.js":126,"./functions/style.js":127}],124:[function(e,t,n){(function(){t.exports=function(t,n){var r,a;return r=e("../../../../color/legible.js"),e("../../../../color/lighter.js"),a=e("../../../../color/text.js"),t.style("background-color",(function(e){var t;return t=n.focus.value===e[n.id.value]?n.ui.color.secondary.value:n.ui.color.primary.value,n.hover.value===e[n.id.value]&&(t=d3.rgb(t).darker(.15).toString()),t})).style("color",(function(e){var t,o,i;return i=n.focus.value===e[n.id.value]?.75:1,!(e[n.icon.value]&&n.data.viz.length<n.data.large)&&e[n.color.value]?o=r(e[n.color.value]):(t=n.focus.value===e[n.id.value]?n.ui.color.secondary.value:n.ui.color.primary.value,n.hover.value===e[n.id.value]&&(t=d3.rgb(t).darker(.15).toString()),o=a(t)),"rgba("+(o=d3.rgb(o)).r+","+o.g+","+o.b+","+i+")"})).style("border-color",n.ui.color.secondary.value)}}).call(this)},{"../../../../color/legible.js":39,"../../../../color/lighter.js":40,"../../../../color/text.js":45}],125:[function(e,t,n){var r=e("../../../../client/prefix.js"),a=e("../../../../client/rtl.js");t.exports=function(e,t){var n="right"===t.font.align.value&&!a||a&&"right"===t.font.align.value;e.each((function(e,o){var i=["label"];e[t.icon.value]&&t.data.viz.length<=t.data.large&&i.push("icon");var s=t.icon.button.value;e[t.id.value]===t.focus.value&&t.icon.select.value?(s=t.icon.select.value,i.push("selected")):s&&!1!==e.d3po.icon&&i.push("selected");var l=0,u=d3.select(this).selectAll("div.d3po_button_element").data(i,(function(e){return e}));u.enter().append("div").style("display",(function(e){return"label"===e?"block":"absolute"})),u.order().attr("class",(function(e){var t="";return"selected"===e&&0===s.indexOf("fa-")&&(t=" fa "+s),"d3po_button_element d3po_button_"+e+t})).html((function(n){if("label"===n){var r=!t.text.value||!(t.text.value in e)||e[t.text.value]instanceof Array?t.id.value:t.text.value;return t.format.value(e[r])}return"selected"===n&&s.indexOf("fa-")<0?s:""})).style("background-image",(function(n){return"icon"===n?"url('"+e[t.icon.value]+"')":"none"})).style("background-color",(function(n){return"icon"===n&&"knockout"===e.style?e[t.color.value]||t.ui.color.primary.value:"transparent"})).style("background-size","100%").style("text-align",(function(e){return"label"===e?t.font.align.value:"center"})).style("position",(function(e){return"label"==e?"static":"absolute"})).style("width",(function(e){return"label"===e?"auto":(l=t.height.value?t.height.value-(t.ui.padding.top+t.ui.padding.bottom)-2*t.ui.border:t.font.size+t.ui.border)+"px"})).style("height",(function(e){return"icon"===e?l+"px":"auto"})).style("margin-top",(function(e){if("label"===e)return"0px";if(this.offsetHeight||this.getBoundingClientRect().height)var n=this.offsetHeight||this.getBoundingClientRect().height;else if("selected"===e)n=t.font.size;else n=l;return-n/2+"px"})).style("top",(function(e){return"label"===e?"auto":"50%"})).style("left",(function(e){return"icon"===e&&!n||"selected"===e&&n?t.ui.padding.left+"px":"auto"})).style("right",(function(e){return"icon"===e&&n||"selected"===e&&!n?t.ui.padding.right+"px":"auto"})).style(r()+"transition",(function(e){return"selected"===e?t.draw.timing/1e3+"s":"none"})).style(r()+"transform",(function(e){var n="selected"===e?t.icon.select.rotate:"none";return"string"==typeof n?n:"rotate("+n+"deg)"})).style("opacity",(function(e){return"selected"===e?t.icon.select.opacity:1})),u.exit().remove();var c=d3.select(this).selectAll(".d3po_button_label");if(l>0){var d=t.ui.padding;d=3===i.length?d.top+"px "+(2*d.right+l)+"px "+d.bottom+"px "+(2*d.left+l)+"px":i.indexOf("icon")>=0&&!a||i.indexOf("selected")>=0&&a?d.top+"px "+d.right+"px "+d.bottom+"px "+(2*d.left+l)+"px":d.top+"px "+(2*d.right+l)+"px "+d.bottom+"px "+d.left+"px",c.style("padding",d)}else c.style("padding",t.ui.padding.css);if("number"==typeof t.width.value){var f=t.width.value;f-=parseFloat(c.style("padding-left"),10),f-=parseFloat(c.style("padding-right"),10),f-=2*t.ui.border,f+="px"}else f="auto";c.style("width",f)}))}},{"../../../../client/prefix.js":34,"../../../../client/rtl.js":35}],126:[function(e,t,n){(function(){t.exports=function(t,n,r){var a,o;return r=e("./color.js"),a=e("../../../../client/pointer.js"),o=e("../../../../client/ie.js"),t.on(a.over,(function(e,t){return n.self.hover(e[n.id.value]),o||!n.draw.timing?d3.select(this).style("cursor","pointer").call(r,n):d3.select(this).style("cursor","pointer").transition().duration(n.timing.mouseevents).call(r,n)})).on(a.out,(function(e){return n.self.hover(!1),o||!n.draw.timing?d3.select(this).style("cursor","auto").call(r,n):d3.select(this).style("cursor","auto").transition().duration(n.timing.mouseevents).call(r,n)})).on(a.click,(function(e){return!1!==n.focus.value?n.self.focus(e[n.id.value]).draw():n.focus.callback?n.focus.callback(e,n.self):void 0}))}}).call(this)},{"../../../../client/ie.js":32,"../../../../client/pointer.js":33,"./color.js":124}],127:[function(e,t,n){t.exports=function(e,t){e.style("position","relative").style("margin",t.ui.margin.css).style("display",t.ui.display.value).style("border-style","solid").style("border-width",t.ui.border+"px").style("font-family",t.font.family.value).style("font-size",t.font.size+"px").style("font-weight",t.font.weight).style("letter-spacing",t.font.spacing+"px")}},{}],128:[function(e,t,n){(function(){t.exports=function(t){var n,r,a,o,i,s,l,u,c,d,f;return a=e("./functions/element.js"),o=e("./functions/keyboard.js"),f=e("./functions/window.js"),d=e("./functions/width.js"),n=e("./functions/button.js"),l=e("./functions/selector.js"),u=e("./functions/title.js"),s=e("./functions/search.js"),i=e("./functions/list.js"),r=e("./functions/data.js"),c=e("./functions/update.js"),t.margin.top=0,t.margin.title=0,a(t),o(t),f(t),d(t),n(t),l(t),u(t),s(t),i(t),r(t),c(t)}}).call(this)},{"./functions/button.js":131,"./functions/data.js":132,"./functions/element.js":133,"./functions/keyboard.js":136,"./functions/list.js":137,"./functions/search.js":139,"./functions/selector.js":140,"./functions/title.js":141,"./functions/update.js":142,"./functions/width.js":143,"./functions/window.js":144}],129:[function(e,t,n){t.exports=function(e,t,n){var r=[];if((n=n||e.active.value)instanceof Array)for(var a=0;a<n.length;a++)r.push(this(e,t,n[a]));else{var o=typeof n;"number"===o?r.push(e.depth.value===n):"function"===o?r.push(n(t)):r.push(t===n)}return r.indexOf(!0)>=0}},{}],130:[function(e,t,n){var r=e("../../../../core/console/print.js");t.exports=function(e){e.dev.value&&r.time("rotating arrow");var t="&#x276f;"===e.icon.drop.value?90:0;if(e.open.value!=e.open.flipped.value)var n=180+t;else n=t;e.container.button.icon({select:{opacity:e.open.value?.5:1,rotate:n}}).draw(),e.dev.value&&r.timeEnd("rotating arrow")}},{"../../../../core/console/print.js":47}],131:[function(e,t,n){var r=e("../../../../util/copy.js"),a=e("../../../../client/pointer.js"),o=e("../../../form.js"),i=e("../../../../core/console/print.js");t.exports=function(e){if("button"in e.container||(e.dev.value&&i.time("creating main button"),e.container.button=o().container(e.container.ui).type("button").ui({margin:0}),e.dev.value&&i.timeEnd("creating main button")),e.focus.changed||e.data.changed||e.depth.changed){var t=e.depth.value,n=r(e.data.value.filter((function(n){for(var r=!1,a=0;a<e.id.nesting.length;a++){var o=e.id.nesting[a];if(r=o in n&&n[o]===e.focus.value){t=a;break}}return r}))[0]);n||(n=e.container.button.data()[0]||e.data.viz[0]),e.container.button.data([n]).id(e.id.nesting).depth(t)}var s=!0===e.hover.value&&e.focus.value;e.container.button.draw({update:e.draw.update}).focus("").font(e.font).format(e.format).hover(s).icon({button:e.icon.drop.value,select:e.icon.drop.value,value:e.icon.value}).text(e.text.value).timing({ui:e.draw.timing}).ui({border:e.ui.border,color:e.ui.color,padding:e.ui.padding.css}).width(e.width.value).draw();var l=e.container.button.container(Object).ui;e.margin.top+=l.node().offsetHeight||l.node().getBoundingClientRect().height,l.on(a.click,(function(){e.self.open(!e.open.value).draw()}))}},{"../../../../client/pointer.js":33,"../../../../core/console/print.js":47,"../../../../util/copy.js":193,"../../../form.js":90}],132:[function(e,t,n){var r=e("../../../../string/format.js"),a=e("../../../../string/strip.js");t.exports=function(e){if(e.data.url&&!e.data.loaded){var t={};t[e.text.value||e.id.value]=e.format.value(e.format.locale.value.ui.loading),e.data.filtered=[t],e.data.changed="loading"!==e.data.lastFilter,e.data.lastFilter="loading"}else if(e.open.value)if(e.search.term){var n=a(e.search.term).split("_"),o=[e.id.value,e.text.value,e.alt.value,e.keywords.value];o=o.filter((function(e){return e})),n=n.filter((function(e){return""!==e}));var i=[],s=[],l=[],u=[];if(e.id.nesting.forEach((function(t){u=u.concat(e.data.nested.all[t])})),u.forEach((function(t){var r=!1;o.forEach((function(o){if(!r&&o in t&&"string"==typeof t[o]){var u=t[o].toLowerCase();if([e.text.value,e.id.value].indexOf(o)>=0&&0===u.indexOf(e.search.term))i.push(t),r=!0;else if(u.indexOf(e.search.term)>=0)s.push(t),r=!0;else{var c=a(u).split("_");for(var d in c){if(r)break;for(var f in n)if(0===c[d].indexOf(n[f])){l.push(t),r=!0;break}}}}}))})),e.data.filtered=d3.merge([i,s,l]),e.data.filtered.forEach((function(e,t){e.d3po_order=t})),e.data.changed=!0,e.data.lastFilter="search",0===e.data.filtered.length){var c={},d=e.format.value(e.format.locale.value.ui.noResults);c[e.text.value||e.id.value]=r(d,'"'+e.search.term+'"'),e.data.filtered=[c]}}else e.data.filtered=e.data.viz,e.data.changed="viz"!==e.data.lastFilter,e.data.lastFilter="viz",e.id.nesting.length>1&&e.depth.value<e.id.nesting.length-1&&(e.data.filtered=e.data.filtered.filter((function(t){return"endPoint"in t.d3po&&t.d3po.endPoint===e.depth.value&&(t.d3po.icon=!1),!0})),e.data.changed="depth"!==e.data.lastFilter,e.data.lastFilter="depth");else e.data.filtered=[]}},{"../../../../string/format.js":159,"../../../../string/strip.js":161}],133:[function(e,t,n){(function(){t.exports=function(e){if(e.data.element.value)return e.data.element.value.on("focus."+e.container.id,(function(){return e.self.hover(!0).draw()})),e.data.element.value.on("blur."+e.container.id,(function(){if(!e.search.enabled||d3.event.relatedTarget!==e.container.value.select("input").node())return e.self.open(!1).hover(!1).draw()})),e.data.element.value.on("change."+e.container.id,(function(){return e.self.focus(this.value).draw()})),e.data.element.value.on("keydown.cancel_"+e.container.id,(function(){if(9!==d3.event.keyCode)return d3.event.preventDefault()}))}}).call(this)},{}],134:[function(e,t,n){t.exports=function(e){var t=e.height.secondary,n=e.container.button.container().node().getBoundingClientRect(),r=window.innerHeight-n.bottom-2*e.ui.border-e.ui.margin.top-e.ui.margin.bottom-e.ui.padding.top-e.ui.padding.bottom;r<3*n.height&&(r=n.top-10,e.self.open({flipped:!0})),"number"!=typeof t&&(t=r),t>e.height.max&&(t=e.height.max),e.self.height({secondary:t})}},{}],135:[function(e,t,n){(function(){var n,r,a,o;n=e("./active.js"),r=e("../../../../util/copy.js"),a=e("../../../form.js"),o=e("../../../../core/console/print.js"),t.exports=function(e){var t,i,s;e.open.value&&(e.dev.value&&o.time("updating list items"),"items"in e.container||(e.container.items=a().container(e.container.list).type("button").ui({border:0,display:"block",margin:0}).width(!1)),i=e.draw.timing?e.data.large:1,(s=r(e.order)).value=e.search.term.length?"d3po_order":e.order.value,t=e.depth.value===e.id.nesting.length-1,(e.focus.changed||!1===e.container.items.focus())&&e.container.items.focus(e.focus.value,(function(t){var r,a,o,i;a=e.data.filtered.filter((function(n){return n[e.id.value]===t}))[0],e.depth.value<e.id.nesting.length-1&&e.id.nesting[e.depth.value+1]in a?(o=e.depth.value,i=e.id.solo.value,e.history.states.push((function(){return e.self.depth(o).id({solo:i}).draw()})),e.self.depth(e.depth.value+1).id({solo:[t]}).draw()):(e.depth.changed||e.self.open(!1),(r=t!==e.focus.value)&&e.active.value&&(r=n(e,t)),r&&e.self.focus(t).draw())})),e.container.items.active(e.active.value).data({large:i,sort:e.data.sort.value,value:e.data.filtered}).draw({update:e.draw.update}).font(e.font.secondary).format(e.format).hover(e.hover.value).id(e.id.value).icon({button:!t&&e.icon.next,select:!!t&&e.icon.select,value:e.icon.value}).order(s).text(e.text.secondary.value||e.text.value).timing({ui:e.draw.timing}).ui({color:{primary:1===e.id.nesting.length?e.ui.color.primary.value:e.ui.color.secondary.value,secondary:e.ui.color.secondary.value},padding:e.ui.padding.css}).draw(),e.dev.value&&o.timeEnd("updating list items"))}}).call(this)},{"../../../../core/console/print.js":47,"../../../../util/copy.js":193,"../../../form.js":90,"./active.js":129}],136:[function(e,t,n){(function(){t.exports=function(e){return d3.select(window).on("keydown."+e.container.id,(function(){var t,n,r,a,o,i,s,l,u,c,d,f;if(l=d3.event.keyCode,e.open.value||!0===e.hover.value){for(c=!0===e.hover.value?"focus":"hover",i=!1,o=s=0,u=(d=e.data.filtered).length;s<u;o=++s)if(d[o][e.id.value]===e[c].value){i=o;break}if(9===l&&e.open.value&&(!e.search.enabled||e.search.enabled&&!d3.event.shiftKey))return e.self.open(!1).hover(!1).draw();if([38,40].indexOf(l)>=0)return!1===i?i=0:38===l?e.open.value&&(i<=0?i=e.data.filtered.length-1:i-=1):40===l&&e.open.value&&(i>=e.data.filtered.length-1?i=0:i+=1),a="boolean"!=typeof e.hover.value?e.data.filtered[i][e.id.value]:e.focus.value,e.self.hover(a).open(!0).draw();if(13===l)return"boolean"!=typeof e.hover.value?(t=e.data.filtered.filter((function(t){return t[e.id.value]===e.hover.value}))[0],(n=e.depth.value)<e.id.nesting.length-1&&e.id.nesting[n+1]in t?(f=e.id.solo.value,r=function(){return e.self.depth(n).id({solo:f}).draw()},e.history.states.push(r),e.self.depth(e.depth.value+1).id({solo:[e.hover.value]}).draw()):e.self.focus(e.hover.value).hover(!0).draw()):e.self.hover(e.focus.value).open(!0).draw();if(27===l){if(e.open.value)return e.self.open(!1).hover(!0).draw();if(!0===e.hover.value)return e.self.hover(!1).draw()}}}))}}).call(this)},{}],137:[function(e,t,n){var r=e("../../../../core/console/print.js");t.exports=function(e){e.dev.value&&r.time("populating list"),e.container.list=e.container.selector.selectAll("div.d3po_drop_list").data(["list"]),e.container.list.enter().append("div").attr("class","d3po_drop_list").attr("id","d3po_drop_list_"+e.container.id).style("overflow-y","auto").style("overflow-x","hidden"),e.dev.value&&r.timeEnd("populating list")}},{"../../../../core/console/print.js":47}],138:[function(e,t,n){var r=e("../../../../core/console/print.js");t.exports=function(e){if(e.open.value){e.dev.value&&r.time("calculating height");var t=!1;if("none"==e.container.selector.style("display"))t=!0;t&&e.container.selector.style("display","block");var n=e.container.selector.style("height"),a=e.container.selector.property("scrollTop"),o=e.container.list.style("max-height"),i=e.container.list.property("scrollTop");e.container.selector.style("height","auto"),e.container.list.style("max-height","200000px"),e.container.listHeight=parseFloat(e.container.selector.style("height"),10),e.container.list.style("max-height",o).property("scrollTop",i),e.container.selector.style("height",n).property("scrollTop",a);var s=!1;if(e.container.listHeight>e.height.secondary&&(e.container.listHeight=e.height.secondary,s=!0),t&&e.container.selector.style("display","none"),e.dev.value&&r.timeEnd("calculating height"),s){e.dev.value&&r.time("calculating scroll position");var l=e.container.list.select("div").selectAll("div.d3po_node"),u=l[0][0],c="boolean"!=typeof e.hover.value?e.hover.value:e.focus.value;l.each((function(t,n){t[e.id.value]===c&&(u=this)}));t=!1;"none"===e.container.selector.style("display")&&(t=!0,e.container.selector.style("display","block"));var d=u.offsetTop,f=u.offsetHeight||u.getBoundingClientRect().height,p=e.container.list.property("scrollTop");t&&e.container.selector.style("display","none"),t||e.data.changed||e.depth.changed?e.container.listScroll=d:(e.container.listScroll=p,d<p?e.container.listScroll=d:d+f>p+e.height.secondary-e.search.height&&(e.container.listScroll=d-(e.height.secondary-f-e.search.height))),e.dev.value&&r.timeEnd("calculating scroll position")}else e.container.listScroll=0}else e.container.listScroll=e.container.list.property("scrollTop"),e.container.listHeight=0}},{"../../../../core/console/print.js":47}],139:[function(e,t,n){var r=e("../../../../client/prefix.js"),a=e("../../../../core/console/print.js");t.exports=function(t){t.dev.value&&a.time("creating search");var n=e("./data.js"),o=e("./items.js"),i=e("./update.js");function s(e){e.style("padding",t.ui.padding.css).style("display","block").style("background-color",d3.rgb(t.ui.color.primary.value).darker(.15).toString())}function l(e){var n=t.width.secondary-2*t.ui.padding.left-2*t.ui.padding.right+2*t.ui.border;e.style("padding",t.ui.padding.left/2+t.ui.padding.right/2+"px").style("width",n+"px").style("border-width","0px").style("font-family",t.font.secondary.family.value).style("font-size",t.font.secondary.size+"px").style("font-weight",t.font.secondary.weight).style("text-align",t.font.secondary.align).style("outline","none").style(r()+"border-radius","0").attr("placeholder",t.format.value(t.format.locale.value.method.search))}t.container.search=t.container.selector.selectAll("div.d3po_drop_search").data(t.search.enabled?["search"]:[]),t.draw.timing?(t.container.search.transition().duration(t.draw.timing).call(s),t.container.search.select("input").transition().duration(t.draw.timing).call(l)):(t.container.search.call(s),t.container.search.select("input").call(l)),t.container.search.enter().insert("div","#d3po_drop_list_"+t.container.id).attr("class","d3po_drop_search").attr("id","d3po_drop_search_"+t.container.id).call(s).append("input").attr("id","d3po_drop_input_"+t.container.id).style("-webkit-appearance","none").call(l),t.container.search.select("input").on("keyup."+t.container.id,(function(e){var r=this.value;t.search.term!==r&&(t.search.term=r,n(t),o(t),i(t))})),t.container.search.exit().remove();var u=t.container.selector.style("display");t.container.selector.style("display","block"),t.search.height=t.search.enabled?t.container.search.node().offsetHeight||t.container.search.node().getBoundingClientRect().height:0,t.container.selector.style("display",u),t.search.enabled&&(t.margin.title+=t.search.height),t.dev.value&&a.timeEnd("creating search")}},{"../../../../client/prefix.js":34,"../../../../core/console/print.js":47,"./data.js":132,"./items.js":135,"./update.js":142}],140:[function(e,t,n){t.exports=function(e){e.container.selector=e.container.ui.selectAll("div.d3po_drop_selector").data(["selector"]),e.container.selector.enter().append("div").attr("class","d3po_drop_selector").style("position","absolute").style("top","0px").style("z-index","-1").style("overflow","hidden"),e.container.selector.style("padding",e.ui.border+"px")}},{}],141:[function(e,t,n){var r=e("../../../../client/pointer.js"),a=e("../../../../color/lighter.js"),o=e("../../../../core/console/print.js"),i=e("../../../../color/text.js");t.exports=function(e){if(e.open.value){e.dev.value&&o.time("creating title and back button");var t=1===e.id.solo.value.length&&e.depth.value>0,n=t,s=e.container.button.data(Object).viz[0];n=!0;for(var l=0;l<e.id.nesting.length;l++){var u=e.id.nesting[l];if(u in s&&s[u]===e.focus.value){n=!1;break}}function c(t){t.style("padding",e.ui.padding.css).style("display","block").style("background-color",e.ui.color.secondary.value).style("font-family",e.font.secondary.family.value).style("font-size",e.font.secondary.size+"px").style("font-weight",e.font.secondary.weight).style("text-align",e.font.secondary.align).style("color",i(e.ui.color.secondary.value))}function d(t){if(!t.empty()){var n=0===e.icon.back.value.indexOf("fa-")?" fa "+e.icon.back.value:"";n="d3po_drop_back"+n;var r=0===e.icon.back.value.indexOf("fa-")?"":e.icon.back.value;t.style("position","absolute").attr("class",n).style("top",e.ui.padding.top+e.font.secondary.size/2/2.5+"px").html(r)}}function f(t){var r=n?e.focus.value:e.format.locale.value.ui.back;t.text(e.format.value(r)).style("padding","0px "+(e.ui.padding.left+e.ui.padding.right)+"px")}e.container.title=e.container.selector.selectAll("div.d3po_drop_title").data(t?["title"]:[]),e.draw.timing?(e.container.title.transition().duration(e.draw.timing).call(c),e.container.title.select("div.d3po_drop_title_text").transition().duration(e.draw.timing).call(f)):(e.container.title.call(c),e.container.title.select("div.d3po_drop_title_text").call(f)),e.container.title.select("span.d3po_drop_back").call(d);var p=e.container.title.enter().insert("div","#d3po_drop_list_"+e.container.id).attr("class","d3po_drop_title").attr("id","d3po_drop_title_"+e.container.id).call(c);p.append("span").attr("id","d3po_drop_back_"+e.container.id).attr("class","d3po_drop_back").call(d),p.append("div").attr("id","d3po_drop_title_text_"+e.container.id).attr("class","d3po_drop_title_text").call(f),e.container.title.on(r.over,(function(t,n){var r=a(e.ui.color.secondary.value);d3.select(this).style("cursor","pointer").transition().duration(e.timing.mouseevents).style("background-color",r).style("color",i(r))})).on(r.out,(function(t){var n=e.ui.color.secondary.value;d3.select(this).style("cursor","auto").transition().duration(e.timing.mouseevents).style("background-color",n).style("color",i(n))})).on(r.click,(function(t){e.history.back()})),e.container.title.exit().remove(),t&&(e.margin.title+=e.container.title.node().offsetHeight||e.container.title.node().getBoundingClientRect().height),e.dev.value&&o.timeEnd("creating title and back button")}}},{"../../../../client/pointer.js":33,"../../../../color/lighter.js":40,"../../../../color/text.js":45,"../../../../core/console/print.js":47}],142:[function(e,t,n){var r=e("./items.js"),a=e("./height.js"),o=e("../../../../core/console/print.js"),i=e("./scroll.js"),s=e("./arrow.js");t.exports=function(e){function t(t){var n=e.open.flipped.value;t.style("top",(function(){return n?"auto":e.margin.top-e.ui.border+"px"})).style("bottom",(function(){return n?e.margin.top+e.ui.border+"px":"auto"}))}function n(n){n.style("left",(function(){return"left"===e.font.align.value?e.margin.left+"px":"center"===e.font.align.value?e.margin.left-(e.width.secondary-e.width.value)/2+"px":"auto"})).style("right",(function(){return"right"===e.font.align.value?"0px":"auto"})).style("height",e.container.listHeight+"px").style("padding",e.ui.border+"px").style("background-color",e.ui.color.secondary.value).style("z-index",(function(){return e.open.value?"9999":"-1"})).style("width",e.width.secondary-2*e.ui.border+"px").style("opacity",e.open.value?1:0).call(t)}function l(n){n.style("display",e.open.value?null:"none").call(t),e.search.enabled&&e.open.value&&e.container.selector.select("div.d3po_drop_search input").node().focus()}e.draw.timing?e.container.ui.transition().duration(e.draw.timing).each("start",(function(){e.open.value&&d3.select(this).style("z-index",9999)})).style("margin",e.ui.margin.css).each("end",(function(){e.open.value||d3.select(this).style("z-index","auto")})):e.container.ui.style("margin",e.ui.margin.css).style("z-index",(function(){return e.open.value?9999:"auto"})),r(e),a(e),i(e),s(e),e.dev.value&&o.time("drawing list");var u,c=e.open.value?e.height.secondary-e.margin.title:0;if(e.draw.timing){e.container.selector.transition().duration(e.draw.timing).each("start",(function(){d3.select(this).style("display",e.open.value?"block":null)})).call(n).each("end",(function(){d3.select(this).transition().duration(e.draw.timing).call(l)})),e.container.list.transition().duration(e.draw.timing).style("width",e.width.secondary-2*e.ui.border+"px").style("max-height",c+"px").tween("scroll",(u=e.container.listScroll,function(){var e=d3.interpolateNumber(this.scrollTop,u);return function(t){this.scrollTop=e(t)}}))}else e.container.selector.call(n).call(l),e.container.list.style("width",e.width.secondary-2*e.ui.border+"px").style("max-height",c+"px").property("scrollTop",e.container.listScroll);e.dev.value&&o.timeEnd("drawing list")}},{"../../../../core/console/print.js":47,"./arrow.js":130,"./height.js":134,"./items.js":135,"./scroll.js":138}],143:[function(e,t,n){var r=e("../../../../util/copy.js"),a=e("../../../../core/font/tester.js"),o=e("../../../form.js"),i=e("../../../../core/console/print.js"),s=e("../../../../object/validate.js");t.exports=function(e){var t=[];for(var n in e.data.nested.all){var l=e.data.nested.all[n],u=s(e.text.nesting)&&n in e.text.nesting?e.text.nesting[n][0]:n;[e.id.value,e.text.value].indexOf(u)<0&&(l=r(l)).forEach((function(t){t[e.text.value||e.id.value]=t[u]})),t=t.concat(l)}function c(n){var r="primary"===n?"value":n,s="value"===r?e.icon.drop.value:e.icon.select.value||e.icon.drop.value,l="value"===r?e.text.value:e.text.secondary.value||e.text.value,u="value"===r?e.font:e.font.secondary;e.dev.value&&i.time("calculating "+n+" width");var c=o().container(a()).data({large:9999,value:t}).draw({update:!1}).font(u).format(e.format).icon({button:s,value:e.icon.value}).id(e.id.value).timing({ui:0}).text(l||e.id.value).type("button").ui({border:"primary"===n?e.ui.border:0,display:"inline-block",margin:0,padding:e.ui.padding.css}).width(!1).draw(),d=[];c.selectAll("div.d3po_node").each((function(e){d.push(this.offsetWidth+1)})).remove();var f={};f[r]=d3.max(d),e.self.width(f),e.dev.value&&i.timeEnd("calculating "+n+" width")}"number"!=typeof e.width.value&&c("primary"),"number"!=typeof e.width.secondary&&(e.text.secondary.value&&e.text.value!==e.text.secondary.value?c("secondary"):e.self.width({secondary:e.width.value}))}},{"../../../../core/console/print.js":47,"../../../../core/font/tester.js":62,"../../../../object/validate.js":158,"../../../../util/copy.js":193,"../../../form.js":90}],144:[function(e,t,n){var r=e("../../../../util/child.js"),a=function(e,t){if(void 0===t)t=window;d3.select(t).on("click."+e.container.id,(function(){var t=d3.event.target||d3.event.toElement,n=t.parentNode;n&&["d3po_node","d3po_drop_title"].indexOf(n.className)>=0&&(t=n.parentNode),t&&n&&!r(e.container.ui,t)&&(e.open.value||e.hover.value)&&e.self.open(!1).hover(!1).draw()}));try{var n=window.parent.location.host===window.location.host}catch(e){n=!1}n&&t.self!==window.top&&a(e,t.parent)};t.exports=a},{"../../../../util/child.js":191}],145:[function(e,t,n){var r=e("../form.js");t.exports=function(e){"buttons"in e.container||(e.container.buttons=r().container(e.container.ui).type("button"));var t=e.data.viz.length,n=!!e.width.value&&e.width.value/t,a=e.container.ui.selectAll("div.d3po_toggle").data(e.data.viz,(function(t){return t[e.id.value]}));a.exit().remove(),a.enter().append("div").attr("class","d3po_toggle").style("display","inline-block").style("vertical-align","top"),a.order().each((function(t){"form"in t.d3po||(t.d3po.form=r().container(d3.select(this)));var a=e.id.nesting.length>e.depth.value?e.id.nesting[e.depth.value+1]:e.id.value;t[a]instanceof Array?t.d3po.form.container({id:e.container.id+"_"+t[e.id.value]}).data(t[a]).id(e.id.nesting.slice(1)).type("drop"):t.d3po.form.data([t]).id(e.id.value).type("button"),t.d3po.form.color(e.color).focus(e.focus.value,(function(t){t!==e.focus.value&&e.self.focus(t).draw()})).hover(e.hover.value).icon({select:!1,value:e.icon.value}).font(e.font).format(e.format).order(e.order).text(e.text.value).ui({border:e.ui.border,color:e.ui.color,display:"inline-block",margin:0,padding:e.ui.padding.css}).width(n).draw()})),e.data.element.value&&e.data.element.value.on("focus."+e.container.id,(function(){e.self.focus(this.value).hover(this.value).draw()})).on("blur."+e.container.id,(function(){e.self.hover(!1).draw()}))}},{"../form.js":90}],146:[function(e,t,n){(function(){var n,r,a,o,i,s,l,u,c,d,f;d=e("simplify-js"),t.exports=function(e,t){var r,o,s,l,c,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B,T,N,I,C,q,V,D,U,P,L,R,H,Y,X,G,W,Q,Z,K,J,$,ee,te,ne,re,ae,oe,ie,se,le,ue,ce,de,fe,pe,he,ve,ge,me;if(e.length<3)return null;if(y=[],.5,5,null==t&&(t={}),null==t.maxAspectRatio&&(t.maxAspectRatio=15),null==t.minWidth&&(t.minWidth=0),null==t.minHeight&&(t.minHeight=0),null==t.tolerance&&(t.tolerance=.02),null==t.nTries&&(t.nTries=20),null!=t.angle&&(t.angle instanceof Array?c=t.angle:"number"==typeof t.angle?c=[t.angle]:"string"!=typeof t.angle||isNaN(t.angle)||(c=[Number(t.angle)])),null==c&&(c=d3.range(-90,95,5)),null!=t.aspectRatio&&(t.aspectRatio instanceof Array?h=t.aspectRatio:"number"==typeof t.aspectRatio?h=[t.aspectRatio]:"string"!=typeof t.aspectRatio||isNaN(t.aspectRatio)||(h=[Number(t.aspectRatio)])),null!=t.origin&&t.origin instanceof Array&&(X=t.origin[0]instanceof Array?t.origin:[t.origin]),0===(p=Math.abs(d3.geom.polygon(e).area())))return null;if(P=($=d3.extent(e,(function(e){return e[0]})))[0],C=$[1],L=(ee=d3.extent(e,(function(e){return e[1]})))[0],q=ee[1],pe=Math.min(C-P,q-L)*t.tolerance,fe=function(){var t,n,r;for(r=[],t=0,n=e.length;t<n;t++)G=e[t],r.push({x:G[0],y:G[1]});return r}(),pe>0&&(fe=d(fe,pe),e=function(){var e,t,n;for(n=[],e=0,t=fe.length;e<t;e++)G=fe[e],n.push([G.x,G.y]);return n}()),t.vdebug&&y.push({type:"simplify",poly:e}),P=(te=d3.extent(e,(function(e){return e[0]})))[0],C=te[1],[[P,L=(ne=d3.extent(e,(function(e){return e[1]})))[0]],[C,L],[C,q=ne[1]],[P,q]],g=(re=[C-P,q-L])[0],v=re[1],ve=Math.min(g,v)/50,null==X)for(X=[],m=d3.geom.polygon(e).centroid(),a(m,e)&&X.push(m);X.length<t.nTries;)ce=Math.random()*g+P,de=Math.random()*v+L,a(ue=[ce,de],e)&&X.push(ue);for(t.vdebug&&y.push({type:"origins",points:X}),S=0,N=null,w=0,A=c.length;w<A;w++)for(l=-(s=c[w])*Math.PI/180,t.vdebug&&y.push({type:"angle",angle:s}),b=_=0,M=X.length;_<M;b=++_)for(H=X[b],Q=(ae=n(e,H,l))[0],K=ae[1],W=(oe=n(e,H,l+Math.PI/2))[0],Z=oe[1],R=[],null!=Q&&null!=K&&R.push([(Q[0]+K[0])/2,(Q[1]+K[1])/2]),null!=W&&null!=Z&&R.push([(W[0]+Z[0])/2,(W[1]+Z[1])/2]),t.vdebug&&y.push({type:"modifOrigin",idx:b,p1W:Q,p2W:K,p1H:W,p2H:Z,modifOrigins:R}),k=0,O=R.length;k<O;k++)if(Y=R[k],t.vdebug&&y.push({type:"origin",cx:Y[0],cy:Y[1]}),Q=(ie=n(e,Y,l))[0],K=ie[1],null!==Q&&null!==K&&(U=Math.min(f(Y,Q),f(Y,K)),I=2*Math.sqrt(U),W=(se=n(e,Y,l+Math.PI/2))[0],Z=se[1],null!==W&&null!==Z&&(D=Math.min(f(Y,W),f(Y,Z)),!(I*(T=2*Math.sqrt(D))<S))))for(null!=h?o=h:(V=Math.max(1,t.minWidth/T,S/(T*T)),B=Math.min(t.maxAspectRatio,I/t.minHeight,I*I/S),o=d3.range(V,B+.5,.5)),E=0,F=o.length;E<F;E++)if(r=o[E],z=Math.max(t.minWidth,Math.sqrt(S*r)),!((le=Math.min(I,T*r))*T<S))for(le-z>=ve&&t.vdebug&&y.push({type:"aRatio",aRatio:r});le-z>=ve;)x=(he=(z+le)/2)/r,ge=Y[0],me=Y[1],J=u(J=[[ge-he/2,me-x/2],[ge+he/2,me-x/2],[ge+he/2,me+x/2],[ge-he/2,me+x/2]],l,Y),i(J,e)?(j=!0,S=he*x,N={cx:ge,cy:me,width:he,height:x,angle:s},z=he):(j=!1,le=he),t.vdebug&&y.push({type:"rectangle",cx:ge,cy:me,width:he,height:x,areaFraction:he*x/p,angle:s,insidePoly:j});return[N,S,y]},f=function(e,t){var n,r;return(n=t[0]-e[0])*n+(r=t[1]-e[1])*r},s=function(e,t,n){var r,a,o,i;return r=(i=t[1]<n[1]?[t,n]:[n,t])[0],a=i[1],e[1]!==a[1]&&e[1]!==r[1]||(e[1]+=Number.MIN_VALUE),!(e[1]>a[1]||e[1]<r[1])&&(!(e[0]>r[0]&&e[0]>a[0])&&(e[0]<r[0]&&e[0]<a[0]||(o=(a[1]-r[1])/(a[0]-r[0]),(e[1]-r[1])/(e[0]-r[0])>o)))},a=function(e,t){var n,r,a,o,i;for(o=-1,r=t[(i=t.length)-1],a=0;++o<i;)n=r,r=t[o],s(e,n,r)&&a++;return a%2!=0},o=function(e,t,n){var r,a;return 1e-9,r=e[0],a=e[1],!(r<Math.min(t[0],n[0])-1e-9||r>Math.max(t[0],n[0])+1e-9||a<Math.min(t[1],n[1])-1e-9||a>Math.max(t[1],n[1])+1e-9)},r=function(e,t,n,r){var a,o,i,s,l,u,c;return 1e-9,s=e[0]-t[0],u=e[1]-t[1],l=n[0]-r[0],i=s*(c=n[1]-r[1])-u*l,Math.abs(i)<1e-9?null:[((a=e[0]*t[1]-e[1]*t[0])*l-(o=n[0]*r[1]-n[1]*r[0])*s)/i,(a*c-o*u)/i]},c=function(e,t,n,a){var i;return null!=(i=r(e,t,n,a))&&(o(i,e,t)&&o(i,n,a))},i=function(e,t){var n,r,o,i,s,l,u,d;for(s=-1,u=e.length,d=t.length,o=e[u-1];++s<u;)for(n=o,o=e[s],l=-1,i=t[d-1];++l<d;)if(r=i,i=t[l],c(n,o,r,i))return!1;return a(e[0],t)},l=function(e,t,n){var r,a,o,i;return null==n&&(n=[0,0]),o=e[0]-n[0],i=e[1]-n[1],[(r=Math.cos(t))*o-(a=Math.sin(t))*i+n[0],a*o+r*i+n[1]]},u=function(e,t,n){var r,a,o,i;for(i=[],r=0,a=e.length;r<a;r++)o=e[r],i.push(l(o,t,n));return i},n=function(e,t,n){var a,i,s,l,u,c,d,p,h,v,g,m,y,x;for(1e-9,y=(t=[t[0]+1e-9*Math.cos(n),t[1]+1e-9*Math.sin(n)])[0],x=t[1],g=[y+Math.cos(n),x+Math.sin(n)],c=0,Math.abs(g[0]-y)<1e-9&&(c=1),u=-1,i=e[(h=e.length)-1],d=Number.MAX_VALUE,p=Number.MAX_VALUE,s=null,l=null;++u<h;)a=i,i=e[u],null!=(v=r(t,g,a,i))&&o(v,a,i)&&(m=f(t,v),v[c]<t[c]?m<d&&(d=m,s=v):v[c]>t[c]&&m<p&&(p=m,l=v));return[s,l]}}).call(this)},{"simplify-js":22}],147:[function(e,t,n){(function(){t.exports=function(e,t,n){var r,a,o,i;return a={x:0,y:0},e<0&&(e=2*Math.PI+e),"square"===n?(o=Math.PI/180*45,e<=Math.PI?e<Math.PI/2?e<o?(a.x+=t,i=Math.tan(e)*t,a.y+=i):(a.y+=t,r=t/Math.tan(e),a.x+=r):e<Math.PI-o?(a.y+=t,r=t/Math.tan(Math.PI-e),a.x-=r):(a.x-=t,i=Math.tan(Math.PI-e)*t,a.y+=i):e<3*Math.PI/2?e<o+Math.PI?(a.x-=t,i=Math.tan(e-Math.PI)*t,a.y-=i):(a.y-=t,r=t/Math.tan(e-Math.PI),a.x-=r):e<2*Math.PI-o?(a.y-=t,r=t/Math.tan(2*Math.PI-e),a.x+=r):(a.x+=t,i=Math.tan(2*Math.PI-e)*t,a.y-=i)):(a.x+=t*Math.cos(e),a.y+=t*Math.sin(e)),a}}).call(this)},{}],148:[function(e,t,n){(function(){var n;n=e("../geom/offset.js"),t.exports=function(e){var t,r,a,o,i,s,l,u,c,d,f,p,h,v;if(!e)return[];for(u=[],a=0,i=(e=e.slice(1).slice(0,-1).split(/L|A/)).length;a<i;a++)if(1===(l=(l=e[a]).split(" ")).length)u.push(l[0].split(",").map((function(e){return parseFloat(e)})));else{for(c=u[u.length-1],o=l.pop().split(",").map((function(e){return parseFloat(e)})),d=parseFloat(l.shift().split(",")[0]),v=Math.sqrt(Math.pow(o[0]-c[0],2)+Math.pow(o[1]-c[1],2)),t=Math.acos((d*d+d*d-v*v)/(2*d*d)),"1"===l[1].split(",")[0]&&(t=2*Math.PI-t),f=t/(2*Math.PI)*(d*Math.PI*2)/5,p=Math.atan2(-c[1],-c[0])-Math.PI,r=h=t/f;r<t;)s=n(p+r,d),u.push([s.x,s.y]),r+=h;u.push(o)}return u}}).call(this)},{"../geom/offset.js":147}],149:[function(e,t,n){(function(){var n;(n={}).version="0.1.0",n.array={comparator:e("./array/comparator.js"),contains:e("./array/contains.js"),sort:e("./array/sort.js"),update:e("./array/update.js")},n.client={css:e("./client/css.js"),ie:e("./client/ie.js"),pointer:e("./client/pointer.js"),prefix:e("./client/prefix.js"),rtl:e("./client/rtl.js"),scroll:e("./client/scroll.js"),scrollbar:e("./client/scrollbar.js"),touch:e("./client/touch.js")},n.color={legible:e("./color/legible.js"),lighter:e("./color/lighter.js"),mix:e("./color/mix.js"),random:e("./color/random.js"),scale:e("./color/scale.js"),sort:e("./color/sort.js"),text:e("./color/text.js"),validate:e("./color/validate.js")},n.data={bestRegress:e("./data/bestregression.js"),lof:e("./data/lof.js"),mad:e("./data/mad.js")},n.font={sizes:e("./font/sizes.js"),validate:e("./font/validate.js")},n.form=e("./form/form.js"),n.geom={largestRect:e("./geom/largestrectangle.js"),offset:e("./geom/offset.js"),path2poly:e("./geom/path2poly.js")},n.network={cluster:e("./network/cluster.js"),distance:e("./network/distance.js"),normalize:e("./network/normalize.js"),shortestPath:e("./network/shortestpath.js"),smallestGap:e("./network/smallestgap.js"),subgraph:e("./network/subgraph.js")},n.number={format:e("./number/format.js")},n.object={merge:e("./object/merge.js"),validate:e("./object/validate.js")},n.string={format:e("./string/format.js"),list:e("./string/list.js"),strip:e("./string/strip.js"),title:e("./string/title.js")},n.textwrap=e("./textwrap/textwrap.js"),n.tooltip={create:e("./tooltip/create.js"),move:e("./tooltip/move.js"),remove:e("./tooltip/remove.js")},n.util={buckets:e("./util/buckets.js"),child:e("./util/child.js"),closest:e("./util/closest.js"),copy:e("./util/copy.js"),d3selection:e("./util/d3selection.js"),dataurl:e("./util/dataurl.js"),uniques:e("./util/uniques.js")},n.viz=e("./viz/viz.js"),e("./client/css.js"),e("./core/console/print.js"),"undefined"!=typeof window&&(window.d3po=n),t.exports=n}).call(this)},{"./array/comparator.js":27,"./array/contains.js":28,"./array/sort.js":29,"./array/update.js":30,"./client/css.js":31,"./client/ie.js":32,"./client/pointer.js":33,"./client/prefix.js":34,"./client/rtl.js":35,"./client/scroll.js":36,"./client/scrollbar.js":37,"./client/touch.js":38,"./color/legible.js":39,"./color/lighter.js":40,"./color/mix.js":41,"./color/random.js":42,"./color/scale.js":43,"./color/sort.js":44,"./color/text.js":45,"./color/validate.js":46,"./core/console/print.js":47,"./data/bestregression.js":85,"./data/lof.js":86,"./data/mad.js":87,"./font/sizes.js":88,"./font/validate.js":89,"./form/form.js":90,"./geom/largestrectangle.js":146,"./geom/offset.js":147,"./geom/path2poly.js":148,"./network/cluster.js":150,"./network/distance.js":151,"./network/normalize.js":152,"./network/shortestpath.js":153,"./network/smallestgap.js":154,"./network/subgraph.js":155,"./number/format.js":156,"./object/merge.js":157,"./object/validate.js":158,"./string/format.js":159,"./string/list.js":160,"./string/strip.js":161,"./string/title.js":162,"./textwrap/textwrap.js":186,"./tooltip/create.js":187,"./tooltip/move.js":188,"./tooltip/remove.js":189,"./util/buckets.js":190,"./util/child.js":191,"./util/closest.js":192,"./util/copy.js":193,"./util/d3selection.js":194,"./util/dataurl.js":195,"./util/uniques.js":196,"./viz/viz.js":305}],150:[function(e,t,n){(function(){var n;n=e("./normalize.js"),t.exports=function(e,t){var r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S;if(p=[],null==t&&(t={}),(null==t.nodes||"object"!=typeof t.nodes)&&(e=(F=n(e,t))[0],null===(t=F[1])))return null;for(v in t.distance,A=t.nodeid,S=t.startpoint,f=t.endpoint,O={},M=t.nodes)O[v]={node:M[v].node,degree:0};for(w=0,j={},h=0,x=e.length;h<x;h++)r=A(S(d=e[h])),a=A(f(d)),r in j||(j[r]={}),a in j||(j[a]={}),a in j[r]||(j[r][a]=0,j[a][r]=0,w++,O[r].degree+=1,O[a].degree+=1);for(v in l={},0,O)z=O[v],l[v]={score:z.degree/(2*w),nodes:[v]};for(r in j)for(a in j[r])j[r][a]=1/(2*w)-O[r].degree*O[a].degree/(4*w*w);for(g=0;g<1e3;){for(r in c=-1,_=void 0,k=void 0,j)for(a in j[r])j[r][a]>c&&(c=j[r][a],_=r,k=a);if(c<0)break;for(y in j[_])y!==k&&(y in j[k]?j[k][y]+=j[_][y]:j[k][y]=j[_][y]-2*l[k].score*l[y].score,j[y][k]=j[k][y]),delete j[y][_];for(y in j[k])y in j[_]||y===k||(j[k][y]-=2*l[_].score*l[y].score,j[y][k]=j[k][y]);for(m=0,b=(E=l[_].nodes).length;m<b;m++)z=E[m],l[k].nodes.push(z);l[k].score+=l[_].score,t.vdebug&&p.push({type:"merge",father:k,child:_,nodes:l[k].nodes}),delete l[_],delete j[_],c,g++}return(s=function(){var e;for(o in e=[],l)u=l[o],e.push([o,u.nodes.length]);return e}()).sort((function(e,t){return t[1]-e[1]})),[function(){var e,t,n;for(n=[],e=0,t=s.length;e<t;e++)i=s[e],n.push(l[i[0]].nodes);return n}(),p]}}).call(this)},{"./normalize.js":152}],151:[function(e,t,n){(function(){t.exports=function(e,t){var n,r;return e instanceof Array||(e=[e.x,e.y]),t instanceof Array||(t=[t.x,t.y]),n=Math.abs(e[0]-t[0]),r=Math.abs(e[1]-t[1]),Math.sqrt(n*n+r*r)}}).call(this)},{}],152:[function(e,t,n){(function(){var n;n=e("../core/console/print.js"),t.exports=function(e,t){var r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B,T;if(E=t.source,B=t.target,i=t.directed,s=t.distance,A=t.nodeid,S=t.startpoint,c=t.endpoint,r=t.K,T=t.vdebug,i||(i=!1),null==r&&(r=1),null==A?A=function(e){return e}:"string"==typeof A&&(A=function(e){return function(t){return t[e]}}(A)),null!=E&&"object"==typeof E&&(E=A(E)),null!=B&&"object"==typeof B&&(B=A(B)),null==S?S=function(e){return e.source}:"string"==typeof S&&(S=function(e){return function(t){return t[e]}}(S)),null==c?c=function(e){return e.target}:"string"==typeof c&&(c=function(e){return function(t){return t[e]}}(c)),null==s)s=function(e){return 1};else if("number"==typeof s)s=function(e){return function(t){return e}}(s);else if("string"==typeof s)s=function(e){return function(t){return t[e]}}(s);else if(s instanceof Array){for(u={},f=m=0,b=e.length;m<b;f=++m)l=e[f],a=A(S(l)),o=A(c(l)),u[a+"_"+o]=s[f];s=function(e){return a=A(S(e)),o=A(c(e)),u[a+"_"+o]}}for(M={},y=0,j=e.length;y<j;y++){for(l=e[y],k=S(l),z=c(l),v=A(k),g=A(z),x=0,w=(O=[k,z]).length;x<w;x++)(p=A(_=O[x]))in M||(M[p]={node:_,outedges:[]});M[v].outedges.push(l),i||M[g].outedges.push(l)}return d=null,0===e.length?d="The length of edges is 0":r<0?d="K can not have negative value":null==s(e[0])?d="Check the distance function/attribute":null==S(e[0])?d="Check the startpoint function/attribute":null==c(e[0])?d="Check the endpoint function/attribute":null==(h=A(S(e[0])))||"string"!=(F=typeof h)&&"number"!==F?d="Check the nodeid function/attribute":null==E||E in M?null==B||B in M||(d="The target is not in the graph"):d="The source is not in the graph",null!=d?(n.error(d),null):[e,{source:E,target:B,directed:i,distance:s,nodeid:A,startpoint:S,endpoint:c,K:r,nodes:M,vdebug:T}]}}).call(this)},{"../core/console/print.js":47}],153:[function(e,t,n){(function(){var n,r;n=e("heap"),r=e("./normalize.js"),t.exports=function(e,t,a){var o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B;if(null==a&&(a={}),a.source=t,(null==a.nodes||"object"!=typeof a.nodes)&&(k=r(e,a),e=k[0],null===(a=k[1])))return null;for(g in t=a.source,E=a.target,u=a.directed,c=a.distance,j=a.nodeid,F=a.startpoint,f=a.endpoint,o=a.K,w=a.nodes)w[g].count=0;for(h=new n((function(e,t){return e.distance-t.distance})),B={},null==E&&(B[t]=!0),h.push({edge:null,target:t,distance:0}),b=0,O=[];!h.empty()&&(b=Math.max(b,h.size()),w[S=(_=h.pop()).target].count++,(null==E||S===E)&&O.push(_),O.length!==o);)if(w[S].count<=o)for(v=0,y=(z=w[S].outedges).length;v<y;v++){if(i=j(F(d=z[v])),l=j(f(d)),u||l!==S||(i=(A=[l,i])[0],l=A[1]),null==E){if(B[l])continue;B[l]=!0}s=_.distance+c(d),h.push({edge:d,previous:_,target:l,distance:s})}for(p=function(t){for(e=[];null!=t.edge;)e.push(t.edge),t=t.previous;return e.reverse()},m=0,x=O.length;m<x;m++)M=O[m],null!=E&&(delete M.target,M.edges=p(M)),delete M.edge,delete M.previous;return O}}).call(this)},{"./normalize.js":152,heap:8}],154:[function(e,t,n){(function(){var n;n=e("./distance.js"),t.exports=function(e,t){var r;return t||(t={}),r=[],d3.geom.quadtree().x((function(e){return t.accessor?t.accessor(e)[0]:e[0]})).y((function(e){return t.accessor?t.accessor(e)[1]:e[1]}))(e).visit((function(e){var a,o,i,s,l,u,c,d;if(!e.leaf)for(a=0,i=(c=e.nodes).length;a<i;a++)if((l=c[a])&&l.point)if(t.origin)r.push(n(l,t));else for(o=0,s=(d=e.nodes).length;o<s;o++)(u=d[o])&&u.point&&u.point!==l.point&&r.push(n(l,u));return!1})),t.all?r.sort((function(e,t){return e-t})):d3.min(r)}}).call(this)},{"./distance.js":151}],155:[function(e,t,n){(function(){var n;n=e("./normalize.js"),t.exports=function(e,t,r){var a,o,i,s,l,u,c,d,f,p,h,v;return null==r&&(r={}),r.source=t,null!=r.nodes&&"object"==typeof r.nodes||(p=n(e,r),e=p[0],null!==(r=p[1]))?(t=r.source,i=r.directed,s=r.distance,d=r.nodeid,h=r.startpoint,u=r.endpoint,a=r.K,f=r.nodes,(v={})[t]=!0,(o=function(e,t){var n,r,l,c,p,g,m,y,x;for(x=[],c=0,p=(m=f[e].outedges).length;c<p;c++)l=m[c],n=d(h(l)),r=d(u(l)),i||r!==e||(n=(y=[r,n])[0],r=y[1]),r in v?x.push(void 0):(g=t+s(l))<=a?(v[r]=!0,x.push(o(r,g))):x.push(void 0);return x})(t,0),{nodes:function(){var e;for(c in e=[],v)e.push(f[c].node);return e}(),edges:function(){var t,n,r;for(r=[],t=0,n=e.length;t<n;t++)l=e[t],d(h(l))in v&&d(u(l))in v&&r.push(l);return r}()}):null}}).call(this)},{"./normalize.js":152}],156:[function(e,t,n){(function(){var n;n=e("../core/locale/languages/en_US.js"),t.exports=function(e,t){var r,a,o,i,s,l,u,c,d,f,p;return null==e||!1===e?"":(t||(t={}),f=(l="locale"in t?t.locale:n).time.slice(),a=d3.locale(l.format),t||(t={}),p=t.vars||{},o=t.key,i=!("labels"in t)||t.labels,s=e.toString().split(".")[0].length,p.time&&p.time.value&&f.push(p.time.value),"string"==typeof o&&f.indexOf(o.toLowerCase())>=0?u=e:"share"===o?(u=0===e?0:e>=100?a.numberFormat(",f")(e):e>99?a.numberFormat(".3g")(e):a.numberFormat(".2g")(e),u+="%"):e<10&&e>-10?(c=1,(s=e.toString().split(".")).length>1&&(c=d3.min([parseFloat(s[1]).toString().length,2]),-1<e&&e<1||(c+=1+(s[1].length-parseFloat(s[1]).toString().length))),u=a.numberFormat("."+c+"g")(e)):s>3?(d=(d=d3.formatPrefix(e).symbol).replace("G","B"),e=d3.formatPrefix(e).scale(e),e=(e=a.numberFormat(".3g")(e)).replace(l.format.decimal,"."),u=(e=(e=parseFloat(e)+"").replace(".",l.format.decimal))+d):u=3===s?a.numberFormat(",f")(e):0===e?0:e===parseInt(e,10)?a.numberFormat(".2")(e):a.numberFormat(".3g")(e),u.length>2&&""+u.indexOf(".0")===u.length-2&&(u=u.slice(0,u.length-2)),i&&o&&"format"in p&&o in p.format.affixes.value?(r=p.format.affixes.value[o])[0]+u+r[1]:u)}}).call(this)},{"../core/locale/languages/en_US.js":63}],157:[function(e,t,n){(function(){var n,r;n=e("../util/d3selection.js"),r=e("./validate.js"),t.exports=function(e,t){var a,o;return a=function(e,t,o){var i,s,l;for(i in s=[],e)void 0!==(l=e[i])?!o&&r(l)?("object"!=typeof t[i]&&(t[i]={}),s.push(a(l,t[i],0===i.indexOf("d3po")))):!n(l)&&l instanceof Array?s.push(t[i]=l.slice(0)):s.push(t[i]=l):s.push(void 0);return s},o={},e&&a(e,o),t&&a(t,o),o}}).call(this)},{"../util/d3selection.js":194,"./validate.js":158}],158:[function(e,t,n){(function(){t.exports=function(e){return e&&e.constructor===Object}}).call(this)},{}],159:[function(e,t,n){t.exports=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return t.unkeyed_index=0,t.replace(/\{(\w*)\}/g,function(n,r){if(""===r&&(r=t.unkeyed_index,t.unkeyed_index++),r==+r)return"undefined"!==e[r]?e[r]:n;for(var a=0;a<e.length;a++)if("object"==typeof e[a]&&void 0!==e[a][r])return e[a][r];return n}.bind(t))}},{}],160:[function(e,t,n){(function(){var n,r;n=e("./format.js"),r=e("../core/locale/languages/en_US.js").ui,t.exports=function(e,t,a,o){var i;return e instanceof Array?(e=e.slice(0),t||(t=r.and),o||(o=r.moreText),2===e.length?e.join(" "+t+" "):(a&&e.length>a&&(i=e.length-a+1,(e=e.slice(0,a-1))[a-1]=n(o,i)),e.length>1&&(e[e.length-1]=t+" "+e[e.length-1]),e.join(", "))):e}}).call(this)},{"../core/locale/languages/en_US.js":63,"./format.js":159}],161:[function(e,t,n){t.exports=function(e){var t=[[/[\300-\305]/g,"A"],[/[\340-\345]/g,"a"],[/[\306]/g,"AE"],[/[\346]/g,"ae"],[/[\337]/g,"B"],[/[\307]/g,"C"],[/[\347]/g,"c"],[/[\320\336\376]/g,"D"],[/[\360]/g,"d"],[/[\310-\313]/g,"E"],[/[\350-\353]/g,"e"],[/[\314-\317]/g,"I"],[/[\354-\357]/g,"i"],[/[\321]/g,"N"],[/[\361]/g,"n"],[/[\322-\326\330]/g,"O"],[/[\362-\366\370]/g,"o"],[/[\331-\334]/g,"U"],[/[\371-\374]/g,"u"],[/[\327]/g,"x"],[/[\335]/g,"Y"],[/[\375\377]/g,"y"]];return""+e.toString().replace(/[^A-Za-z0-9\-_]/g,(function(e){if(" "===e)return"-";for(var n=!1,r=0;r<t.length;r++)if(new RegExp(t[r][0]).test(e)){n=t[r][1];break}return n||""}))}},{}],162:[function(e,t,n){(function(){var n;n=e("../core/locale/languages/en_US.js"),t.exports=function(e,t){var r,a,o,i;return e?(t||(t={}),t.key,"."===e.charAt(e.length-1)?e.charAt(0).toUpperCase()+e.substr(1):(o="locale"in this?this.locale.value:n,i=o.lowercase.map((function(e){return e.toLowerCase()})),a=(a=o.uppercase).concat(a.map((function(e){return e+"s"}))),r=a.map((function(e){return e.toLowerCase()})),e.replace(/[^\s!-#%&(-\x2A,-:;\x3F@\x5B-\x5D_\x7B}\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]*/g,(function(t,n){var o;return t?(o=r.indexOf(t.toLowerCase()))>=0?a[o]:i.indexOf(t.toLowerCase())>=0&&0!==n&&n!==e.length-1?t.toLowerCase():t.charAt(0).toUpperCase()+t.substr(1).toLowerCase():""})))):""}}).call(this)},{"../core/locale/languages/en_US.js":63}],163:[function(e,t,n){(function(){var n,r;n=e("./foreign.js"),r=e("./tspan.js"),t.exports=function(e){e.text.html.value?n(e):r(e)}}).call(this)},{"./foreign.js":164,"./tspan.js":167}],164:[function(e,t,n){(function(){t.exports=function(e){var t,n,r,a,o;r=(o=e.container.value).attr("font-family")||o.style("font-family"),t=e.align.value||o.attr("text-anchor")||o.style("text-anchor"),n=o.attr("fill")||o.style("fill"),a=o.attr("opacity")||o.style("opacity"),t="end"===t?"right":"middle"===t?"center":"left",d3.select(o.node().parentNode).append("foreignObject").attr("width",e.width.value+"px").attr("height",e.height.value+"px").attr("x","0px").attr("y","0px").append("xhtml:div").style("font-family",r).style("font-size",e.size.value[1]+"px").style("color",n).style("text-align",t).style("opacity",a).text(e.text.current)}}).call(this)},{}],165:[function(e,t,n){(function(){t.exports=function(e){var t,n,r,a,o,i,s,l,u,c;if(i=(a=(n=e.container.value).node().previousElementSibling)?a.tagName.toLowerCase():"",a&&(a=d3.select(a)),e.container.x=e.x.value||parseFloat(n.attr("x"),10),e.container.y=e.y.value||parseFloat(n.attr("y"),10),a&&(e.shape.accepted.indexOf(i)>=0&&e.self.shape(i),"rect"===i?(u=parseFloat(a.attr("x"),10)||0,c=parseFloat(a.attr("y"),10)||0,!1===e.padding.value&&(t=Math.abs(u-e.container.x))&&e.self.padding(t),e.container.x||(e.container.x=u+e.padding.value),e.container.y||(e.container.y=c+e.padding.value),e.width.value||(l=parseFloat(a.attr("width")),e.self.width(l)),e.height.value||(r=parseFloat(a.attr("height")),e.self.height(r))):"circle"===i?(o=parseFloat(a.attr("r"),10),u=parseFloat(a.attr("cx"),10)||0,u-=o,c=parseFloat(a.attr("cy"),10)||0,c-=o,!1===e.padding.value&&(t=Math.abs(u-e.container.x))&&e.self.padding(t),e.container.x||(e.container.x=u+e.padding.value),e.container.y||(e.container.y=c+e.padding.value),e.width.value||e.self.width(2*o,10),e.height.value||e.self.height(2*o,10)):(e.width.value||e.self.width(500),e.height.value||e.self.height(500))),e.container.x||(e.container.x=0),e.container.y||(e.container.y=0),e.width.inner=e.width.value-2*e.padding.value,e.height.inner=e.height.value-2*e.padding.value,s=n.attr("font-size")||n.style("font-size"),s=parseFloat(s,10),e.container.fontSize=s,e.container.dy=parseFloat(n.attr("dy"),10),!e.size.value)return e.resize.value?e.self.size([4,80]):e.self.size([s/2,s])}}).call(this)},{}],166:[function(e,t,n){(function(){t.exports=function(e){var t;if(e.text.value||(t=e.container.value.text())&&(t.indexOf("tspan")>=0&&(t.replace(/\<\/tspan\>\<tspan\>/g," "),t.replace(/\<\/tspan\>/g,""),t.replace(/\<tspan\>/g,"")),t=(t=t.replace(/(\r\n|\n|\r)/gm,"")).replace(/^\s+|\s+$/g,""),e.self.text(t)),e.text.value instanceof Array?e.text.phrases=e.text.value.filter((function(e){return["string","number"].indexOf(typeof e)>=0})):e.text.phrases=[e.text.value+""],!e.align.value)return e.container.align=e.container.value.style("text-anchor")||e.container.value.attr("text-anchor")}}).call(this)},{}],167:[function(e,t,n){(function(){var n;n=e("../../client/rtl.js"),t.exports=function(e){var t,r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B;return f=function(t){return(!v||t?e.container.value.append("tspan"):e.container.value.insert("tspan","tspan")).attr("x",F+"px").attr("dy",r+"px").style("baseline-shift","0%").attr("dominant-baseline","alphabetic")},d=-90===e.rotate.value||90===e.rotate.value,A=d?e.height.inner:e.width.inner,s=d?e.width.inner:e.height.inner,E="end"===(t="circle"===e.shape.value?"middle":e.align.value||e.container.align||"start")||"start"===t&&n?A:"middle"===t?A/2:0,z=e.valign.value||"top",F=e.container.x+E,o=e.resize.value?e.size.value[1]:e.container.fontSize||e.size.value[0],r=e.container.dy||1.1*o,w=null,h=null,M=null,v=!1,B=0,"circle"===e.shape.value&&("middle"===z?B=s/r%1*r/2:"end"===z&&(B=s/r%1*r)),e.container.value.attr("text-anchor",t).attr("font-size",o+"px").style("font-size",o+"px").attr("x",e.container.x).attr("y",e.container.y),k=function(){if(w.remove(),v?(l++,w=e.container.value.select("tspan")):(l--,w=d3.select(e.container.value.node().lastChild)),!w.empty())return M=w.text().match(/[^\s-]+-?/g),a()},u=function(){var t;return"circle"===e.shape.value?((t=(l-1)*r+B)>s/2&&(t+=r),2*Math.sqrt(t*(A/2*2-t))):A},a=function(){var t,n;return M&&M.length?(t=(n=M.pop()).charAt(n.length-1),1===n.length&&e.text.split.value.indexOf(n)>=0?a():(e.text.split.value.indexOf(t)>=0&&(n=n.substr(0,n.length-1)),w.text(M.join(" ")+" "+n+"..."),w.node().getComputedTextLength()>u()?a():void 0)):k()},p=function(t){var n,r,a,o;if(n=w.text(),o="",v){if(" "===(o=e.text.current.charAt(e.text.current.length-h.length-1)))for(a="",r=2;" "===o;)a+=" ",o=e.text.current.charAt(e.text.current.length-h.length-r),r++;else a="";h=t+a+h,w.text(t+a+n)}else{if(" "===(o=e.text.current.charAt(h.length)))for(a="",r=1;" "===o;)a+=" ",o=e.text.current.charAt(h.length+r),r++;else a="";h+=a+t,w.text(n+a+t)}if(Math.floor(w.node().getComputedTextLength())>u()||"\n"===o)return w.text(n),n.length&&(w=f()),w.text(t),v?l--:l++},j=1,l=null,c=null,(O=function(){var t,n,a,o,i,u;for(e.container.value.text("").html(""),M=e.text.words.slice(),v&&M.reverse(),h="",w=f(!0),l=j,n=0,a=M.length;n<a;n++){if(u=M[n],l*r>s){k();break}for(p(u),i=!0;i;){for(o=e.text.current.charAt(h.length),t=1;" "===o;)o=e.text.current.charAt(h.length+t),t++;(i=e.text.split.value.indexOf(o)>=0)&&p(o)}}return l*r>s&&k(),c=Math.abs(l-j)+1})(),c=0,e.container.value.selectAll("tspan").each((function(){if(d3.select(this).text().length)return c++})),"circle"===e.shape.value&&(b=s-c*r)>r&&("middle"===z?(j=1+(b/r/2>>0),O()):"bottom"===z&&(v=!0,j=s/r>>0,O())),c=0,e.container.value.selectAll("tspan").each((function(){if(d3.select(this).text().length)return c++})),"top"===z?S=0:(i=c*r,S="middle"===z?s/2-i/2:s-i),_="translate(0,"+(S-=.2*r)+")",180===e.rotate.value||-180===e.rotate.value?(y=e.container.x+A/2,x=e.container.y+s/2):(g=e.rotate.value<0?A:s,y=e.container.x+g/2,x=e.container.y+g/2),m="rotate("+e.rotate.value+", "+y+", "+x+")",e.container.value.attr("transform",m+_)}}).call(this)},{"../../client/rtl.js":35}],168:[function(e,t,n){(function(){var n,r,a,o;n=e("./flow.js"),r=e("../../font/sizes.js"),o=function(e){var t;e.text.phrases.length&&(e.text.current=e.text.phrases.shift()+"",e.text.words=e.text.current.match(e.text.split.break),(t=e.text.current.charAt(0))!==e.text.words[0].charAt(0)&&(e.text.words[0]=t+e.text.words[0]),e.container.value.html(""),e.resize.value?a(e):n(e))},t.exports=o,a=function(e){var t,a,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b;for(b=[],c=0;c<e.text.words.length;)t=c===e.text.words.length-1?"":" ",b.push(e.text.words[c]+t),c++;y=(p=-90===e.rotate.value||90===e.rotate.value)?e.height.inner:e.width.inner,l=p?e.width.inner:e.height.inner,h=Math.floor(e.size.value[1]),d="circle"===e.shape.value?.75*y:y,g=r(b,{"font-size":h+"px"},{parent:e.container.value}),f=d3.max(g,(function(e){return e.width})),a=1.165+y/l*.11,m=d3.sum(g,(function(t){var n;return n=e.container.dy||1.2*h,t.width*n}))*a,s="circle"===e.shape.value?Math.PI*Math.pow(y/2,2):d*l,(f>d||m>s)&&(i=Math.sqrt(s/m),x=d/f,v=d3.min([i,x]),h=d3.max([e.size.value[0],Math.floor(h*v)])),u=Math.floor(.8*l),h>u&&(h=u),f*(h/e.size.value[1])<=d?(h!==e.size.value[1]&&e.self.size([e.size.value[0],h]),n(e)):o(e)}}).call(this)},{"../../font/sizes.js":88,"./flow.js":163}],169:[function(e,t,n){(function(){t.exports={accepted:[!1,"start","middle","end","left","center","right"],process:function(e){var t;return(t=["left","center","right"].indexOf(e))>=0&&(e=this.accepted[t+1]),e},value:!1}}).call(this)},{}],170:[function(e,t,n){arguments[4][94][0].apply(n,arguments)},{dup:94}],171:[function(e,t,n){(function(){var n;n=e("../../util/d3selection.js"),t.exports={accepted:[!1,Array,Object,String],element:!1,id:"default",process:function(e){return!1!==e&&(n(e)?e:e instanceof Array?d3.select(e[0][0]):(this.selector=e,d3.select(e)))},value:!1}}).call(this)},{"../../util/d3selection.js":194}],172:[function(e,t,n){arguments[4][98][0].apply(n,arguments)},{dup:98}],173:[function(e,t,n){(function(){var n,r;n=e("../../core/console/print.js"),r=e("../../string/format.js"),t.exports={accepted:[void 0],process:function(e,t){var a,o;return!1===this.initialized||(!1===t.container.value?(o=t.format.locale.value.dev.setContainer,n.warning(o,"container")):t.container.value.empty()?(o=t.format.locale.value.dev.noContainer,a=t.container.selector||"",n.warning(r(o,'"'+a+'"'),"container")):(t.dev.value&&n.time("total draw time"),t.container.value.call(t.self))),e},value:void 0}}).call(this)},{"../../core/console/print.js":47,"../../string/format.js":159}],174:[function(e,t,n){(function(){var n,r;n=e("../../core/locale/locale.js"),r=e("../../object/merge.js"),t.exports={accepted:[Function,String],locale:{accepted:function(){return d3.keys(n)},process:function(e){var t;return"en_US",t=n.en_US,"en_US"!==e&&(t=r(t,n[e])),this.language=e,t},value:"en_US"},process:function(e,t){if(this.initialized&&"string"==typeof e)t.self.format({locale:e});else if("function"==typeof e)return e;return this.value},value:"en_US"}}).call(this)},{"../../core/locale/locale.js":65,"../../object/merge.js":157}],175:[function(e,t,n){(function(){t.exports={accepted:[!1,Number],value:!1}}).call(this)},{}],176:[function(e,t,n){arguments[4][175][0].apply(n,arguments)},{dup:175}],177:[function(e,t,n){arguments[4][98][0].apply(n,arguments)},{dup:98}],178:[function(e,t,n){(function(){t.exports={accepted:[-180,-90,0,90,180],value:0}}).call(this)},{}],179:[function(e,t,n){(function(){t.exports={accepted:["circle","square"],value:!1}}).call(this)},{}],180:[function(e,t,n){(function(){t.exports={accepted:[Array,!1],value:!1}}).call(this)},{}],181:[function(e,t,n){(function(){t.exports={accepted:[!1,Array,Number,String],html:{accepted:[Boolean],value:!1},init:function(e){var t;return t=this.split.value,this.split.break=new RegExp("[^\\s\\"+t.join("\\")+"]+\\"+t.join("?\\")+"?","g"),!1},split:{accepted:[Array],process:function(e){return this.break=new RegExp("[^\\s\\"+e.join("\\")+"]+\\"+e.join("?\\")+"?","g"),e},value:["-","/",";",":","&"]}}}).call(this)},{}],182:[function(e,t,n){(function(){t.exports={accepted:[!1,"top","middle","bottom"],value:!1}}).call(this)},{}],183:[function(e,t,n){arguments[4][175][0].apply(n,arguments)},{dup:175}],184:[function(e,t,n){arguments[4][175][0].apply(n,arguments)},{dup:175}],185:[function(e,t,n){arguments[4][175][0].apply(n,arguments)},{dup:175}],186:[function(e,t,n){(function(){var n,r,a,o,i;n=e("../core/methods/attach.js"),a=e("./helpers/parsesize.js"),r=e("../core/console/print.js"),o=e("./helpers/parsetext.js"),i=e("./helpers/wrap.js"),t.exports=function(){var t;return n(t={self:function(e){return e.each((function(){a(t),t.size.value[0]<=t.height.inner?(o(t),i(t)):t.container.value.html(""),t.dev.value&&r.timeEnd("total draw time")})),t.self}},{align:e("./methods/align.js"),config:e("./methods/config.js"),container:e("./methods/container.js"),dev:e("./methods/dev.js"),draw:e("./methods/draw.js"),format:e("./methods/format.js"),height:e("./methods/height.js"),padding:e("./methods/padding.js"),resize:e("./methods/resize.js"),rotate:e("./methods/rotate.js"),text:e("./methods/text.js"),shape:e("./methods/shape.js"),size:e("./methods/size.js"),valign:e("./methods/valign.js"),width:e("./methods/width.js"),x:e("./methods/x.js"),y:e("./methods/y.js")}),t.self}}).call(this)},{"../core/console/print.js":47,"../core/methods/attach.js":66,"./helpers/parsesize.js":165,"./helpers/parsetext.js":166,"./helpers/wrap.js":168,"./methods/align.js":169,"./methods/config.js":170,"./methods/container.js":171,"./methods/dev.js":172,"./methods/draw.js":173,"./methods/format.js":174,"./methods/height.js":175,"./methods/padding.js":176,"./methods/resize.js":177,"./methods/rotate.js":178,"./methods/shape.js":179,"./methods/size.js":180,"./methods/text.js":181,"./methods/valign.js":182,"./methods/width.js":183,"./methods/x.js":184,"./methods/y.js":185}],187:[function(e,t,n){var r=e("../core/locale/languages/en_US.js"),a=e("../client/pointer.js"),o=e("../color/legible.js"),i=e("./move.js"),s=e("../client/prefix.js"),l=e("../client/rtl.js"),u=e("./remove.js"),c=e("../client/scroll.js"),d=e("../client/scrollbar.js"),f=e("../string/list.js"),p=e("../color/text.js");function h(){d3.selectAll("div.d3po_tooltip_data_desc").style("height","0px"),d3.selectAll("div.d3po_tooltip_data_help").style("background-color","#ccc")}t.exports=function(e){var t=e.fullscreen?250:200,n=s();e.width=e.width||t,e.max_width=e.max_width||386,e.id=e.id||"default",e.size=e.fullscreen||e.html?"large":"small",e.offset=e.offset||0,e.arrow_offset=e.arrow?8:0,e.x=e.x||0,e.y=e.y||0,e.parent=e.parent||d3.select("body"),e.curtain=e.curtain||"#fff",e.curtainopacity=e.curtainopacity||.8,e.background=e.background||"#fff",e.fontcolor=e.fontcolor||"#444",e.fontfamily=e.fontfamily||"sans-serif",e.fontweight=e.fontweight||"normal",e.fontsize=e.fontsize||"12px",e.style=e.style||"default",e.zindex="small"==e.size?2e3:500,e.locale=e.locale||r,e.stacked=e.stacked||!1;var v=e.parent?e.parent.node().offsetHeight||e.parent.node().getBoundingClientRect().height:0;if(e.iconsize||(e.iconsize="small"==e.size?22:50),e.parent.node()===document.body){e.limit=[window.innerWidth+c.x(),window.innerHeight+c.y()];var g=d();document.body.scrollHeight>window.innerHeight&&(e.limit[0]-=g)}else e.limit=[parseFloat(e.parent.style("width"),10),parseFloat(e.parent.style("height"),10)];if(e.title instanceof Array){var m=e.locale.ui.and,y=e.locale.ui.more;e.title=f(e.title,m,3,y)}if(u(e.id),e.anchor={},e.fullscreen)e.anchor.x="center",e.anchor.y="center",e.x=e.parent?e.parent.node().offsetWidth/2:window.innerWidth/2,e.y=e.parent?v/2:window.innerHeight/2;else if(e.align){var x=e.align.split(" ");e.anchor.y=x[0],x[1]?e.anchor.x=x[1]:e.anchor.x="center"}else e.anchor.x="center",e.anchor.y="top";var b=e.width-30;if(e.fullscreen)e.parent.append("div").attr("id","d3po_tooltip_curtain_"+e.id).attr("class","d3po_tooltip_curtain").style("background-color",e.curtain).style("opacity",e.curtainopacity).style("position","absolute").style("z-index",499).style("top","0px").style("right","0px").style("bottom","0px").style("left","0px").on(a.click,(function(){u(e.id)}));var j=e.parent.append("div").datum(e).attr("id","d3po_tooltip_id_"+e.id).attr("class","d3po_tooltip d3po_tooltip_"+e.size).style("color",e.fontcolor).style("font-family",e.fontfamily).style("font-weight",e.fontweight).style("font-size",e.fontsize+"px").style(n+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").on(a.out,h);e.max_height&&j.style("max-height",e.max_height+"px"),e.fixed?(j.style("z-index",500),e.mouseevents=!0):j.style("z-index",2e3);var w=j.append("div").datum(e).attr("class","d3po_tooltip_container").style("background-color",e.background).style("padding","6px");if(e.fullscreen&&e.html&&!e.stacked){k=e.parent?.75*e.parent.node().offsetWidth:.75*window.innerWidth,q=e.parent?.75*v:.75*window.innerHeight,w.style("width",k+"px").style("height",q+"px");var _=w.append("div").attr("class","d3po_tooltip_body").style("padding-right","6px").style("display","inline-block").style("z-index",1).style("width",e.width+"px")}else{if("auto"==e.width){var k="auto";w.style("max-width",e.max_width+"px")}else k=e.width-14+"px";_=w.style("width",k)}if(e.title||e.icon)var z=_.append("div").attr("class","d3po_tooltip_header").style("position","relative").style("z-index",1);if(e.fullscreen){j.append("div").attr("class","d3po_tooltip_close").style("background-color",e.color).style("color",p(e.color)).style("position","absolute").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)").style("font-size","20px").style("height","18px").style("line-height","14px").style("text-align","center").style("right","16px").style("top","-10px").style("width","18px").style("z-index",10).html("&times;").on(a.over,(function(){d3.select(this).style("cursor","pointer").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.5)")})).on(a.out,(function(){d3.select(this).style("cursor","auto").style(n+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)")})).on(a.click,(function(){u(e.id)}));d3.select("body").on("keydown.esc_"+e.id,(function(){27===d3.event.keyCode&&(u(e.id),d3.select("body").on("keydown.esc_"+e.id,null))}))}if(e.mouseevents){if(!0!==e.mouseevents){var A=d3.select(e.mouseevents).on(a.out),M=function(){var t=d3.event.toElement||d3.event.relatedTarget;if(t)var n=0==("string"==typeof t.className?t.className:t.className.baseVal).indexOf("d3po_tooltip");else n=!1;t&&(O(j.node(),t)||O(e.mouseevents,t)||n)||(A(d3.select(e.mouseevents).datum()),h(),d3.select(e.mouseevents).on(a.out,A))},O=function(e,t){for(var n=t.parentNode;null!==n;){if(n==e)return!0;n=n.parentNode}return!1};d3.select(e.mouseevents).on(a.out,M),j.on(a.out,M);var F=d3.select(e.mouseevents).on(a.move);F&&j.on(a.move,F)}}else j.style("pointer-events","none");if(e.arrow)j.append("div").attr("class","d3po_tooltip_arrow").style("background-color",e.background).style(n+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").style("bottom","-5px").style("height","10px").style("left","50%").style("margin-left","-5px").style("width","10px").style(n+"transform","rotate(45deg)").style("z-index",-1);if(e.icon){var E=z.append("div").attr("class","d3po_tooltip_icon").style("width",e.iconsize+"px").style("height",e.iconsize+"px").style("z-index",1).style("background-position","50%").style("background-size","100%").style("background-image","url("+e.icon+")").style("display","inline-block").style("margin","0px 3px 3px 0px");"knockout"==e.style&&E.style("background-color",e.color),b-=E.node().offsetWidth}if(e.title){var S=e.max_width-6;e.icon&&(S-=e.iconsize+6),S+="px";z.append("div").attr("class","d3po_tooltip_title").style("max-width",S).style("color",e.icon?e.fontcolor:o(e.color)).style("vertical-align","top").style("width",b+"px").style("display","inline-block").style("overflow","hidden").style("text-overflow","ellipsis").style("word-wrap","break-word").style("z-index",1).style("font-size","large"===e.size?"18px":"16px").style("line-height","large"===e.size?"20px":"17px").style("padding","large"===e.size?"3px 6px":"3px").text(e.title)}if(e.description)_.append("div").attr("class","d3po_tooltip_description").style("font-size","12px").style("padding","6px").text(e.description);if(e.data||e.html&&!e.fullscreen)var B=_.append("div").attr("class","d3po_tooltip_data_container").style("overflow-y","auto").style("z-index",-1);if(e.data){var T=0,N={},I=null;e.data.forEach((function(t,r){t.group&&I!=t.group&&(I=t.group,B.append("div").attr("class","d3po_tooltip_data_title").style("font-size","12px").style("font-weight","bold").style("padding","6px 3px 0px 3px").text(t.group));var i=B.append("div").attr("class","d3po_tooltip_data_block").style("font-size","12px").style("padding","3px 6px").style("position","relative").datum(t);!0===t.highlight?i.style("color",o(e.color)):(t.allColors||t.highlight!==e.color)&&i.style("color",o(t.highlight));var u=i.append("div").attr("class","d3po_tooltip_data_name").style("display","inline-block").html(t.name).on(a.out,(function(){d3.event.stopPropagation()}));if(t.link&&u.style("cursor","pointer").on(a.click,t.link),t.value instanceof Array){var c=e.locale.ui.and,d=e.locale.ui.more;t.value=list(t.value,c,3,d)}var f=i.append("div").attr("class","d3po_tooltip_data_value").style("display","block").style("position","absolute").style("text-align","right").style("top","3px").html(t.value).on(a.out,(function(){d3.event.stopPropagation()}));if(l?f.style("left","6px"):f.style("right","6px"),e.mouseevents&&t.desc){var p=i.append("div").attr("class","d3po_tooltip_data_desc").style("color","#888").style("overflow","hidden").style(n+"transition","height 0.5s").style("width","85%").text(t.desc).on(a.out,(function(){d3.event.stopPropagation()})),v=p.node().offsetHeight||p.node().getBoundingClientRect().height;p.style("height","0px");var g=u.append("div").attr("class","d3po_tooltip_data_help").style("background-color","#ccc").style(n+"border-radius","5px").style("color","#fff").style("cursor","pointer").style("display","inline-block").style("font-size","8px").style("font-weight","bold").style("height","10px").style("margin","3px 0px 0px 3px").style("padding-right","1px").style("text-align","center").style("width","10px").style("vertical-align","top").style(s+"transition","background-color 0.5s").text("?").on(a.over,(function(){var e=d3.select(this.parentNode.parentNode).style("color");d3.select(this).style("background-color",e),p.style("height",v+"px")})).on(a.out,(function(){d3.event.stopPropagation()}));u.style("cursor","pointer").on(a.over,(function(){h();var e=d3.select(this.parentNode).style("color");g.style("background-color",e),p.style("height",v+"px")})),i.on(a.out,(function(){d3.event.stopPropagation(),h()}))}var m=parseFloat(f.style("width"),10);m>e.width/2&&(m=e.width/2),m>T&&(T=m),r!=e.data.length-1&&(t.group&&t.group==e.data[r+1].group||!t.group&&!e.data[r+1].group)&&B.append("div").attr("class","d3po_tooltip_data_seperator").style("background-color","#ddd").style("display","block").style("height","1px").style("margin","0px 3px")})),B.selectAll(".d3po_tooltip_data_name").style("width",(function(){return parseFloat(d3.select(this.parentNode).style("width"),10)-T-30+"px"})),B.selectAll(".d3po_tooltip_data_value").style("width",T+"px").each((function(e){var t=parseFloat(d3.select(this).style("height"),10);N[e.name]=t})),B.selectAll(".d3po_tooltip_data_name").style("min-height",(function(e){return N[e.name]+"px"}))}!e.html||e.fullscreen&&!e.stacked||(B.append("div").html(e.html),e.js&&e.js(w));var C=_.append("div").attr("class","d3po_tooltip_footer").style("font-size","10px").style("position","relative").style("text-align","center");if(e.footer&&C.html(e.footer),e.height=j.node().offsetHeight||j.node().getBoundingClientRect().height,e.html&&e.fullscreen&&!e.stacked){var q=e.height-12;k=j.node().offsetWidth-e.width-44;w.append("div").attr("class","d3po_tooltip_html").style("width",k+"px").style("height",q+"px").style("display","inline-block").style("vertical-align","top").style("overflow-y","auto").style("padding","0px 12px").style("position","absolute").html(e.html),e.js&&e.js(w)}if(e.width=j.node().offsetWidth,"center"!=e.anchor.y?e.height+=e.arrow_offset:e.width+=e.arrow_offset,e.data||(!e.fullscreen||e.stacked)&&e.html){if(!e.fullscreen||e.stacked){var V=e.fixed?v-e.y-10:v-10;q=e.height<V?e.height:V}else q=e.height;q-=parseFloat(w.style("padding-top"),10),q-=parseFloat(w.style("padding-bottom"),10),z&&(q-=z.node().offsetHeight||z.node().getBoundingClientRect().height,q-=parseFloat(z.style("padding-top"),10),q-=parseFloat(z.style("padding-bottom"),10)),C&&(q-=C.node().offsetHeight||C.node().getBoundingClientRect().height,q-=parseFloat(C.style("padding-top"),10),q-=parseFloat(C.style("padding-bottom"),10)),B.style("max-height",q+"px")}e.height=j.node().offsetHeight||j.node().getBoundingClientRect().height,i(e.x,e.y,e.id)}},{"../client/pointer.js":33,"../client/prefix.js":34,"../client/rtl.js":35,"../client/scroll.js":36,"../client/scrollbar.js":37,"../color/legible.js":39,"../color/text.js":45,"../core/locale/languages/en_US.js":63,"../string/list.js":160,"./move.js":188,"./remove.js":189}],188:[function(e,t,n){(function(){var n,r;r=e("../client/scroll.js"),t.exports=function(e,t,a){var o,i,s;return a||(a="default"),(s=d3.select("div#d3po_tooltip_id_"+a)).node()&&((o=s.datum()).cx=e,o.cy=t,o.fixed||(i="body"===o.parent.node().tagName.toLowerCase()?[r.x(),r.y()]:[0,0],"center"!==o.anchor.y?("right"===o.anchor.x?o.x=o.cx-o.arrow_offset-4:"center"===o.anchor.x?o.x=o.cx-o.width/2:"left"===o.anchor.x&&(o.x=o.cx-o.width+o.arrow_offset+2),"bottom"===o.anchor.y?o.flip=o.cy+o.height+o.offset<=o.limit[1]:"top"===o.anchor.y&&(o.flip=o.cy-o.height-o.offset<i[1]),o.flip?o.y=o.cy+o.offset+o.arrow_offset:o.y=o.cy-o.height-o.offset-o.arrow_offset):(o.y=o.cy-o.height/2,"right"===o.anchor.x?o.flip=o.cx+o.width+o.offset<=o.limit[0]:"left"===o.anchor.x&&(o.flip=o.cx-o.width-o.offset<i[0]),"center"===o.anchor.x?(o.flip=!1,o.x=o.cx-o.width/2):o.flip?o.x=o.cx+o.offset+o.arrow_offset:o.x=o.cx-o.width-o.offset),o.x<i[0]?o.x=i[0]:o.x+o.width>o.limit[0]&&(o.x=o.limit[0]-o.width),o.y<i[1]?o.y=i[1]:o.y+o.height>o.limit[1]&&(o.y=o.limit[1]-o.height)),s.style("top",o.y+"px").style("left",o.x+"px"),o.arrow&&s.selectAll(".d3po_tooltip_arrow").call(n)),s},n=function(e){return e.style("bottom",(function(e){return"center"===e.anchor.y||e.flip?"auto":"-5px"})).style("right",(function(e){return"center"!==e.anchor.y||e.flip?"auto":"-5px"})).style("top",(function(e){return"center"!==e.anchor.y&&e.flip?"-5px":"center"===e.anchor.y?"50%":"auto"})).style("left",(function(e){return"center"===e.anchor.y&&e.flip?"-5px":"center"!==e.anchor.y?"50%":"auto"})).style("margin-left",(function(e){var t;return"center"===e.anchor.y?"auto":(t="right"===e.anchor.x?-e.width/2+e.arrow_offset/2:"left"===e.anchor.x?e.width/2-2*e.arrow_offset-5:-5,e.cx-e.width/2-5<t?(t=e.cx-e.width/2-5)<2-e.width/2&&(t=2-e.width/2):-(e.limit[0]-e.cx-e.width/2+5)>t&&(t=-(e.limit[0]-e.cx-e.width/2+5))>e.width/2-11&&(t=e.width/2-11),t+"px")})).style("margin-top",(function(e){var t;return"center"!==e.anchor.y?"auto":(t="bottom"===e.anchor.y?-e.height/2+e.arrow_offset/2-1:"top"===e.anchor.y?e.height/2-2*e.arrow_offset-2:-9,e.cy-e.height/2-e.arrow_offset<t?(t=e.cy-e.height/2-e.arrow_offset)<4-e.height/2&&(t=4-e.height/2):-(e.limit[1]-e.cy-e.height/2+e.arrow_offset)>t&&(t=-(e.limit[1]-e.cy-e.height/2+e.arrow_offset))>e.height/2-22&&(t=e.height/2-22),t+"px")}))}}).call(this)},{"../client/scroll.js":36}],189:[function(e,t,n){(function(){t.exports=function(e){return e?(d3.selectAll("div#d3po_tooltip_curtain_"+e).remove(),d3.selectAll("div#d3po_tooltip_id_"+e).remove()):(d3.selectAll("div.d3po_tooltip_curtain").remove(),d3.selectAll("div.d3po_tooltip").remove())}}).call(this)},{}],190:[function(e,t,n){(function(){t.exports=function(e,t){var n;return[],n=1/(t-1)*(e[1]-e[0]),d3.range(e[0],e[1]+n,n)}}).call(this)},{}],191:[function(e,t,n){(function(){var n;n=e("./d3selection.js"),t.exports=function(e,t){var r;if(!e||!t)return!1;for(n(e)&&(e=e.node()),n(e)&&(t=t.node()),r=t.parentNode;null!==r;){if(r===e)return!0;r=r.parentNode}return!1}}).call(this)},{"./d3selection.js":194}],192:[function(e,t,n){(function(){t.exports=function(e,t){var n,r;return t.constructor===String?(r=e.indexOf(t))>-1?e[r]:e[0]:(n=e[0],e.forEach((function(e){if(Math.abs(t-e)<Math.abs(t-n))return n=e})),n)}}).call(this)},{}],193:[function(e,t,n){(function(){var n,r,a;r=e("../object/merge.js"),a=e("../object/validate.js"),n=function(e){var t;return a(e)?r(e):e instanceof Array?(t=[],e.forEach((function(e){return t.push(n(e))})),t):e},t.exports=n}).call(this)},{"../object/merge.js":157,"../object/validate.js":158}],194:[function(e,t,n){(function(){var n;n=e("../client/ie.js"),t.exports=function(e){return n?"object"==typeof e&&e instanceof Array&&"size"in e&&"select"in e:e instanceof d3.selection}}).call(this)},{"../client/ie.js":32}],195:[function(e,t,n){(function(){t.exports=function(e,t){var n;(n=new Image).src=e,n.crossOrigin="Anonymous",n.onload=function(){var e;(e=document.createElement("canvas")).width=this.width,e.height=this.height,e.getContext("2d").drawImage(this,0,0),t.call(this,e.toDataURL("image/png")),e=null}}}).call(this)},{}],196:[function(e,t,n){(function(){var n,r;n=e("../object/validate.js"),r=function(e,t,a,o,i,s){var l,u,c,d,f,p,h,v,g,m,y,x,b;if(void 0===e)return[];if(o&&void 0===i&&(i=o.id.value),s=!0===s&&void 0===s,e instanceof Array||(e=[e]),m=[],void 0===t)return e.reduce((function(e,t){var n;return n=JSON.stringify(t),m.indexOf(n)<0&&(e.indexOf(t)<0&&e.push(t),m.push(n)),e}),[]);if(b=[],l=function(e){var t;if(null!=e&&(t=JSON.stringify(e),m.indexOf(t)<0))return b.push(e),m.push(t)},"function"==typeof a&&o)for(c=0,p=e.length;c<p;c++)for(u=e[c],d=0,h=(x=r(a(o,u,t,i))).length;d<h;d++)l(x[d]);else if("function"==typeof t)for(f=0,v=e.length;f<v;f++)l(x=t(u=e[f]));else for(y=0,g=e.length;y<g;y++)u=e[y],n(u)&&l(x=u[t]);return s?b.sort((function(e,t){return e-t})):b},t.exports=r}).call(this)},{"../object/validate.js":158}],197:[function(e,t,n){(function(){t.exports=function(e){var t,n,r,a,o;for(e.container.value.style("position",(function(){var e;return e=d3.select(this).style("position"),["absolute","fixed"].indexOf(e)>=0?e:"relative"})),e.container.changed&&e.container.value.html(""),n=0,r=(a=["width","height"]).length;n<r;n++)e[o=a[n]].value||((t=function(n){var r,a;return void 0===n.tagName||["BODY","HTML"].indexOf(n.tagName)>=0?(a=window["inner"+o.charAt(0).toUpperCase()+o.slice(1)],(r=document!==n&&d3.select(n))&&("width"===o?(a-=parseFloat(r.style("margin-left"),10),a-=parseFloat(r.style("margin-right"),10),a-=parseFloat(r.style("padding-left"),10),a-=parseFloat(r.style("padding-right"),10)):(a-=parseFloat(r.style("margin-top"),10),a-=parseFloat(r.style("margin-bottom"),10),a-=parseFloat(r.style("padding-top"),10),a-=parseFloat(r.style("padding-bottom"),10))),e[o].value=a<=20?e[o].small:a):"number"==typeof(a=parseFloat(d3.select(n).style(o),10))&&a>0?e[o].value=a:"BODY"!==n.tagName?t(n.parentNode):void 0})(e.container.value.node()),1===d3.selectAll("body > *:not(script)").size()&&d3.select("body").style("overflow","hidden"));e.container.value.style("width",e.width.value+"px").style("height",e.height.value+"px")}}).call(this)},{}],198:[function(e,t,n){var r=e("../../core/data/format.js"),a=e("../../core/data/color.js"),o=e("../../core/data/keys.js"),i=e("../../core/data/load.js"),s=e("./ui/drawer.js"),l=e("./ui/legend.js"),u=e("./ui/menu.js"),c=e("./errorCheck.js"),d=e("../../core/fetch/data.js"),f=e("./finish.js"),p=e("./focus/tooltip.js"),h=e("./ui/history.js"),v=e("../../core/parse/edges.js"),g=e("../../core/parse/nodes.js"),m=e("../../core/console/print.js"),y=e("../../tooltip/remove.js"),x=e("./types/run.js"),b=e("./shapes/draw.js"),j=e("../../string/format.js"),w=e("./svg/enter.js"),_=e("./svg/update.js"),k=e("./ui/titles.js"),z=e("../../object/validate.js");t.exports=function(e){var t=[],n=e.type.value,A=e.format.locale.value,M=A.message.ui,O=A.message.draw;if(["data","attrs","coords","nodes","edges"].forEach((function(n){e.error.value||e[n].loaded||!e[n].url||t.push({function:function(e,t){i(e,n,t)},message:A.message.loading,wait:!0})})),e.draw.update){var F=A.visualization[n]||n,E=e.types[n].setup||!1,S=e.types[n].requirements||[],B=j(A.message.initializing,F),T=A.message.data;S instanceof Array||(S=[S]),F=F.toLowerCase(),e.error.value||"function"!=typeof E||t.push({function:function(e){if(e.dev.value){var t="running "+F+" setup";m.time(t)}E(e),e.dev.value&&m.timeEnd(t)},message:B}),e.container.changed&&t.push({function:w,message:B}),n in e.g.apps||t.push({function:function(e){if(e.dev.value){var t="creating "+F+" group";m.time(t)}e.g.apps[n]=e.g.app.append("g").attr("id",n).attr("opacity",0),e.dev.value&&m.timeEnd(t)},message:B}),e.data.changed&&t.push({function:function(e){e.data.cache={},delete e.nodes.restricted,delete e.edges.restricted,o(e,"data")},message:T}),e.attrs.changed&&t.push({function:function(e){o(e,"attrs")},message:T}),t.push({function:function(e){if(!e.color.type||e.color.changed||e.data.changed||e.attrs.changed||e.id.changed||e.depth.changed||e.id.solo.changed||!e.time.fixed.value&&(e.time.solo.changed||e.time.mute.changed)){if(e.color.valueScale=!1,e.dev.value){var t="checking color type";m.time(t)}if(e.color.type=!1,e.color.value){var n=e.color.value;z(n)&&(n=n[e.id.value]?n[e.id.value]:n[d3.keys(n)[0]]),e.data.keys&&n in e.data.keys?e.color.type=e.data.keys[n]:e.attrs.keys&&n in e.attrs.keys&&(e.color.type=e.attrs.keys[n])}else e.data.keys&&(e.color.type=e.data.keys[e.id.value]);e.dev.value&&m.timeEnd(t)}},message:T}),(S.indexOf("edges")>=0&&e.edges.value&&(!e.edges.linked||e.edges.changed)||S.indexOf("nodes")>=0&&!e.nodes.value&&e.edges.value)&&t.push({function:v,message:T}),S.indexOf("nodes")>=0&&e.edges.value&&(!e.nodes.positions||e.nodes.changed||e.type.changed)&&t.push({function:g,message:T}),(e.data.changed||e.time.changed||e.time.format.changed||e.type.changed||e.id.changed||e.x.scale.changed&&[e.x.scale.value,e.x.scale.previous].indexOf("discrete")>=0||e.y.scale.changed&&[e.y.scale.value,e.y.scale.previous].indexOf("discrete")>=0)&&t.push({function:r,message:T}),e.error.value||t.push({function:function(e){var t=e.time.fixed.value?["all"]:null;if(e.dev.value){var n=t?"fetching pool data":"fetching data";m.time(n)}e.data.pool=d(e,t),e.dev.value&&m.timeEnd(n),t?(e.dev.value&&m.time("fetching data for current year"),e.data.viz=d(e),e.dev.value&&m.timeEnd("fetching data for current year")):e.data.viz=e.data.pool,e.draw.timing=e.data.viz.length<e.data.large?e.timing.transitions:0},message:T}),e.error.value||t.push({check:function(e){return e.color.value&&"number"===e.color.type&&!1===e.color.valueScale},function:a,message:T})}return t.push({function:function(e){if(e.dev.value){var t=e.format.locale.value.message.tooltipReset;m.time(t)}e.type.previous&&n!==e.type.previous&&y(e.type.previous),y(n),e.dev.value&&m.timeEnd(t)},message:M}),e.error.value||t.push({function:c,message:M}),t.push({function:function(e){if(e.margin.process(),k(e),!e.error.value)if(e.draw.update)s(e),l(e);else{e.dev.value&&m.time("calculating margins");var t=e.container.value.select("div#d3po_drawer").node().offsetHeight||e.container.value.select("div#d3po_drawer").node().getBoundingClientRect().height,n=e.g.legend.node().getBBox();n=e.legend.value?n.height+e.ui.padding:0,e.margin.bottom+=t+n,e.dev.value&&m.timeEnd("calculating margins")}h(e),e.height.viz-=e.margin.top+e.margin.bottom,e.width.viz-=e.margin.left+e.margin.right},message:M}),e.error.value||t.push({function:p,message:M}),t.push({function:function(e){u(e)},message:M}),e.error.value||t.push({function:p,message:M}),t.push({function:_,message:O}),!e.error.value&&e.draw.update&&t.push({function:[x,b],message:O}),t.push({function:f,message:O}),t}},{"../../core/console/print.js":47,"../../core/data/color.js":48,"../../core/data/format.js":50,"../../core/data/keys.js":52,"../../core/data/load.js":53,"../../core/fetch/data.js":58,"../../core/parse/edges.js":81,"../../core/parse/nodes.js":84,"../../object/validate.js":158,"../../string/format.js":159,"../../tooltip/remove.js":189,"./errorCheck.js":199,"./finish.js":200,"./focus/tooltip.js":201,"./shapes/draw.js":208,"./svg/enter.js":219,"./svg/update.js":220,"./types/run.js":223,"./ui/drawer.js":224,"./ui/history.js":225,"./ui/legend.js":226,"./ui/menu.js":227,"./ui/titles.js":229}],199:[function(e,t,n){var r=e("../../core/fetch/text.js"),a=e("../../core/console/print.js"),o=e("../../core/methods/rejected.js"),i=e("../../string/format.js"),s=e("../../string/list.js");t.exports=function(e){e.dev.value&&a.time("checking for errors");var t=["id"],n=e.types[e.type.value].requirements;n&&(n instanceof Array?t=t.concat(e.types[e.type.value].requirements):t.push(n));var l=[];if(t.forEach((function(t){if("string"==typeof t)e[t].value&&e[t].value.length||l.push('"'+t+'"');else if("function"==typeof t){var n=t(e);!n.status&&n.text&&l.push('"'+n.text+'"')}})),l.length>1){var u=e.format.locale.value.error.methods,c=e.format.locale.value.visualization[e.type.value]||e.type.value,d=e.format.locale.value.ui.and;l=s(l,d),e.error.internal=i(u,c,l)}else if(1===l.length){u=e.format.locale.value.error.method,c=e.format.locale.value.visualization[e.type.value]||e.type.value;e.error.internal=i(u,c,l[0])}if(!e.error.internal&&t.indexOf("edges")>=0&&t.indexOf("focus")>=0&&0==e.edges.connections(e.focus.value[0],e.id.value).length){var f=r(e,e.focus.value[0],e.depth.value);u=e.format.locale.value.error.connections;e.error.internal=i(u,'"'+f+'"')}t=["d3"];e.types[e.type.value].libs&&(t=t.concat(e.types[e.type.value].libs));l=[];if(t.forEach((function(e){window[e]||l.push('"'+e+'"')})),l.length>1){u=e.format.locale.value.error.libs,c=e.format.locale.value.visualization[e.type.value],d=e.format.locale.value.ui.and;l=s(l,d),e.error.internal=i(u,c,l)}else if(1===l.length){u=e.format.locale.value.error.lib,c=e.format.locale.value.visualization[e.type.value];e.error.internal=i(u,c,l[0])}var p=e.shape.accepted(e);p instanceof Array||(p=[p]);var h=e.shape.value;if(h&&!o(e,p,h,"shape")||e.self.shape(p[0]),"modes"in e.types[e.type.value]){var v=e.types[e.type.value].modes;v instanceof Array||(v=[v]);var g=e.type.mode.value;g&&!o(e,v,g,"mode")||e.self.type({mode:v[0]})}e.dev.value&&a.timeEnd("checking for errors")}},{"../../core/console/print.js":47,"../../core/fetch/text.js":60,"../../core/methods/rejected.js":77,"../../string/format.js":159,"../../string/list.js":160}],200:[function(e,t,n){var r=e("./shapes/edges.js"),a=e("./shapes/paths.js"),o=e("./ui/message.js"),i=e("./focus/viz.js"),s=e("../../core/methods/reset.js"),l=e("../../core/console/print.js"),u=e("./shapes/labels.js"),c=e("../../string/title.js"),d=e("./zoom/bounds.js"),f=e("./zoom/labels.js"),p=e("./zoom/mouse.js");t.exports=function(e){if(e.draw.first?setTimeout((function(){i(e)}),e.draw.timing):i(e),!e.error.value){var t=e.zoom.viewport||e.zoom.bounds;e.types[e.type.value].zoom&&e.zoom.value&&t?(e.dev.value&&l.time("calculating zoom"),e.draw.first||e.zoom.reset?d(e,t,0):(e.type.changed||e.focus.changed||e.height.changed||e.width.changed||e.nodes.changed||e.legend.changed||e.ui.changed)&&d(e,t),e.dev.value&&l.timeEnd("calculating zoom")):(e.zoom.bounds=[[0,0],[e.width.viz,e.height.viz]],e.zoom.scale=1,d(e))}var n=e.zoom.size?e.zoom.size.width:e.width.viz,h=e.zoom.size?e.zoom.size.height:e.height.viz,v=e.zoom.bounds?e.zoom.bounds[0][0]:0,g=e.zoom.bounds?e.zoom.bounds[0][1]:0;if(e.g.overlay.attr("width",n).attr("height",h).attr("x",v).attr("y",g),e.error.value||(e.draw.update?(e.edges.path?a(e):r(e),u(e,"data"),e.edges.label&&!e.edges.path&&setTimeout((function(){u(e,"edges")}),e.draw.timing+200)):(e.labels.value||e.labels.changed)&&e.types[e.type.value].zoom&&e.zoom.value&&e.draw.timing&&setTimeout((function(){f(e)}),e.draw.timing)),!e.error.value){var m=e.types[e.type.value].requirements||[];m instanceof Array||(m=[m]);var y=m.indexOf("data")>=0;e.error.internal||e.data.viz&&e.returned.nodes.length||!y||(e.error.internal=e.format.locale.value.error.data)}var x=e.type.previous;if(x&&e.type.value!=x&&e.g.apps[x]&&(e.dev.value&&l.time('hiding "'+x+'"'),e.draw.timing?e.g.apps[x].transition().duration(e.draw.timing).attr("opacity",0):e.g.apps[x].attr("opacity",0),e.dev.value&&l.timeEnd()),!e.error.value){var b=y&&0===e.data.viz.length||e.error.internal||e.error.value?0:e.focus.value.length&&e.types[e.type.value].zoom&&e.zoom.value?1-e.tooltip.curtain.opacity:1,j=e.draw.timing;e.group.transition().duration(j).attr("opacity",b),e.g.data.transition().duration(j).attr("opacity",b),e.g.edges.transition().duration(j).attr("opacity",b)}e.error.value?o(e,e.error.value):e.error.internal?(e.error.internal=c(e.error.internal),l.warning(e.error.internal),o(e,e.error.internal),e.error.internal=null):o(e),setTimeout((function(){s(e),e.types[e.type.value].zoom&&e.zoom.value?(e.g.zoom.datum(e).call(e.zoom.behavior.on("zoom",p)),e.zoom.scroll.value||e.g.zoom.on("mousewheel.zoom",null).on("MozMousePixelScroll.zoom",null).on("wheel.zoom",null),e.zoom.click.value||e.g.zoom.on("dblclick.zoom",null),e.zoom.pan.value||e.g.zoom.on("mousedown.zoom",null).on("mousemove.zoom",null)):e.g.zoom.call(e.zoom.behavior.on("zoom",null)).on("dblclick.zoom",null).on("mousedown.zoom",null).on("mousemove.zoom",null).on("mousewheel.zoom",null).on("MozMousePixelScroll.zoom",null).on("touchstart.zoom",null).on("wheel.zoom",null)}),e.draw.timing)}},{"../../core/console/print.js":47,"../../core/methods/reset.js":79,"../../string/title.js":162,"./focus/viz.js":202,"./shapes/edges.js":209,"./shapes/labels.js":211,"./shapes/paths.js":213,"./ui/message.js":228,"./zoom/bounds.js":230,"./zoom/labels.js":232,"./zoom/mouse.js":233}],201:[function(e,t,n){(function(){var n,r,a,o;n=e("../tooltip/create.js"),r=e("../../../core/fetch/value.js"),a=e("../../../core/console/print.js"),o=e("../../../tooltip/remove.js"),t.exports=function(e){var t,i,s;i=e.focus,!e.error.internal&&1===i.value.length&&i.value.length&&!e.small&&i.tooltip.value?(e.dev.value&&a.time("drawing focus tooltip"),(t=e.data.pool.filter((function(t){return r(e,t,e.id.value)===i.value[0]}))).length>=1?t=t[0]:(t={})[e.id.value]=i.value[0],s=e.labels.padding,n({anchor:"top left",arrow:!1,data:t,fullscreen:!1,id:"visualization_focus",length:"long",maxheight:e.height.viz-2*s,mouseevents:!0,offset:Math.max(30-e.margin.top,0),vars:e,width:e.tooltip.large,x:e.width.value-e.margin.right-s,y:e.margin.top+s}),e.width.viz-=2*s,e.dev.value&&a.timeEnd("drawing focus tooltip")):o("visualization_focus")}}).call(this)},{"../../../core/console/print.js":47,"../../../core/fetch/value.js":61,"../../../tooltip/remove.js":189,"../tooltip/create.js":221}],202:[function(t,n,r){var a=t("../../../client/pointer.js"),o=t("../../../client/ie.js"),i=t("../../../core/fetch/value.js"),s=t("../../../core/console/print.js"),l=t("../../../util/uniques.js");n.exports=function(t){if(t.g.edge_focus.selectAll("g").remove(),t.g.data_focus.selectAll("g").remove(),t.focus.value.length&&t.types[t.type.value].zoom&&t.zoom.value){t.dev.value&&s.time("drawing focus elements");var n=t.g.edges.selectAll("g");if(n.size()>0){n.each((function(e){var n=e[t.edges.source][t.id.value],r=e[t.edges.target][t.id.value];if(n==t.focus.value[0]||r==t.focus.value[0]){var a=t.g.edge_focus.node().appendChild(this.cloneNode(!0));d3.select(a).datum(e).attr("opacity",1).selectAll("line, path").datum(e)}}));var r=t.edges.arrows.value;t.g.edge_focus.selectAll("line, path").attr("vector-effect","non-scaling-stroke").style("stroke",t.color.focus).style("stroke-width",(function(){return o&&t.types[t.type.value].zoom?0:t.edges.size.value?d3.select(this).style("stroke-width"):2*t.data.stroke.width})).attr("marker-start",(function(e){var n=t.edges.arrows.direction.value;if("bucket"in e.d3po)var a="_"+e.d3po.bucket;else a="";return"source"==n&&r?"url(#d3po_edge_marker_focus"+a+")":"none"})).attr("marker-end",(function(e){var n=t.edges.arrows.direction.value;if("bucket"in e.d3po)var a="_"+e.d3po.bucket;else a="";return"target"==n&&r?"url(#d3po_edge_marker_focus"+a+")":"none"})),t.g.edge_focus.selectAll("text").style("fill",t.color.focus)}var u=l(t.edges.connections(t.focus.value[0],t.id.value,!0),t.id.value,i,t);u.push(t.focus.value[0]);var c=[],d=[],f=[0],p=[0];t.g.data.selectAll("g").each((function(n){if(u.indexOf(n[t.id.value])>=0){var r=t.g.data_focus.node().appendChild(this.cloneNode(!0));r=d3.select(r).datum(n).attr("opacity",1);for(e in"coordinates"==t.shape.value?t.zoom.viewport=t.path.bounds(t.zoom.coords[n.d3po.id]):"d3po"in n&&("x"in n.d3po&&c.push(n.d3po.x),"y"in n.d3po&&d.push(n.d3po.y),"r"in n.d3po?(f.push(n.d3po.r),p.push(n.d3po.r)):("width"in n.d3po&&f.push(n.d3po.width/2),"height"in n.d3po&&p.push(n.d3po.height/2))),a){var o=d3.select(this).on(a[e]);o&&r.on(a[e],o)}}}));if(c.length&&d.length){var h=d3.extent(c),v=d3.extent(d),g=d3.max(f),m=d3.max(p);t.zoom.viewport=[[h[0]-g,v[0]-m],[h[1]+g,v[1]+m]]}t.g.data_focus.selectAll("path").style("stroke-width",o&&t.types[t.type.value].zoom?0:2*t.data.stroke.width),t.dev.value&&s.timeEnd("drawing focus elements")}else t.zoom.viewport=!1}},{"../../../client/ie.js":32,"../../../client/pointer.js":33,"../../../core/console/print.js":47,"../../../core/fetch/value.js":61,"../../../util/uniques.js":196}],203:[function(e,t,n){(function(){var n,r,a,o;o=e("./style.js"),r=e("../../../geom/largestrectangle.js"),a=e("../../../geom/path2poly.js"),n={start:{},end:{}},t.exports=function(e,t,i,s){var l,u,c,d;l=d3.svg.arc().innerRadius((function(e){return e.d3po.r_inner})).outerRadius((function(e){return e.d3po.r_outer})).startAngle((function(e){return e.d3po.startAngle})).endAngle((function(e){return e.d3po.endAngle})),c=function(t){var n,o;return e.labels.value&&(t.d3po.label?t.d3po_label=t.d3po.label:t.d3po.endAngle-t.d3po.startAngle>=.1?(n=a(l(t)),(o=r(n,{angle:0}))[0]?t.d3po_label={w:o[0].width,h:o[0].height,x:o[0].cx,y:o[0].cy}:delete t.d3po_label):delete t.d3po_label),[t]},e.draw.timing?(d=d3.svg.arc().innerRadius((function(e){return e.d3po.r_inner})).outerRadius((function(e){return e.d3po.r_outer})).startAngle((function(e){return void 0===n.start[e.d3po.id]&&(n.start[e.d3po.id]=0),isNaN(n.start[e.d3po.id])&&(n.start[e.d3po.id]=e.d3po.startAngle),n.start[e.d3po.id]})).endAngle((function(e){return void 0===n.end[e.d3po.id]&&(n.end[e.d3po.id]=0),isNaN(n.end[e.d3po.id])&&(n.end[e.d3po.id]=e.d3po.endAngle),n.end[e.d3po.id]})),u=function(e,t){return e.attrTween("d",(function(e){var r,a,o,i;return void 0===t?(i=e.d3po.startAngle,r=e.d3po.endAngle):0===t&&(i=0,r=0),o=d3.interpolate(n.start[e.d3po.id],i),a=d3.interpolate(n.end[e.d3po.id],r),function(t){return n.start[e.d3po.id]=o(t),n.end[e.d3po.id]=a(t),d(e)}}))},i.append("path").attr("class","d3po_data").call(o,e).attr("d",d),t.selectAll("path.d3po_data").data(c).transition().duration(e.draw.timing).call(o,e).call(u),s.selectAll("path.d3po_data").transition().duration(e.draw.timing).call(u,0)):(i.append("path").attr("class","d3po_data"),t.selectAll("path.d3po_data").data(c).call(o,e).attr("d",l))}}).call(this)},{"../../../geom/largestrectangle.js":146,"../../../geom/path2poly.js":148,"./style.js":217}],204:[function(e,t,n){var r=e("../../../core/fetch/text.js"),a=e("../../../font/sizes.js"),o=e("../../../geom/largestrectangle.js"),i=e("./style.js");t.exports=function(e,t,n,s){var l=d3.svg.area().x((function(e){return e.d3po.x})).y0((function(e){return e.d3po.y0})).y1((function(e){return e.d3po.y})).interpolate(e.shape.interpolate.value),u=d3.svg.area().x((function(e){return e.d3po.x})).y0((function(e){return e.d3po.y0})).y1((function(e){return e.d3po.y0})).interpolate(e.shape.interpolate.value);n.append("path").attr("class","d3po_data").attr("d",(function(e){return u(e.values)})).call(i,e);var c={"font-weight":e.labels.font.weight,"font-family":e.labels.font.family.value};t.selectAll("path.d3po_data").data((function(t){if(e.labels.value&&t.values.length>1){var n=!1;if(d3.max(t.values,(function(e){return e.d3po.y0-e.d3po.y}))>e.labels.font.size){var i=[],s=[],l=r(e,t);t.values.forEach((function(e){i.push([e.d3po.x,e.d3po.y]),s.push([e.d3po.x,e.d3po.y0])})),i=i.concat(s.reverse());var u=null;if(l.length){var d=a(l[0],c);u=d[0].width/d[0].height}n=o(i,{angle:d3.range(-70,71,1),aspectRatio:u,tolerance:0})}if(n&&n[0]){var f={w:~~n[0].width,h:~~n[0].height,x:~~n[0].cx,y:~~n[0].cy,angle:-1*n[0].angle,padding:2,names:l};0!==n[0].angle?f.translate={x:f.x,y:f.y}:f.translate=!1,f.w>=10&&f.h>=10&&(t.d3po_label=f)}}return[t]})),e.draw.timing?t.selectAll("path.d3po_data").transition().duration(e.draw.timing).attr("d",(function(e){return l(e.values)})).call(i,e):t.selectAll("path.d3po_data").attr("d",(function(e){return l(e.values)})).call(i,e)}},{"../../../core/fetch/text.js":60,"../../../font/sizes.js":88,"../../../geom/largestrectangle.js":146,"./style.js":217}],205:[function(e,t,n){e("../../../core/fetch/text.js"),e("../../../geom/largestrectangle.js");var r=e("./style.js");t.exports=function(e,t,n,a){function o(e){e.attr("transform",(function(e){var t=Math.min(e.d3po.width,e.d3po.height);return"scale("+Math.floor(t/16)+")"}))}n.append("path").attr("class","d3po_data").attr("d","M5-6.844L3.594-5.407L-2,0.188l-1.594-1.594L-5-2.844L-7.844,0l1.438,1.406l3,3L-2,5.843l1.406-1.438l7-7L7.844-4L5-6.844z").call((function(e){e.attr("transform","scale(1)")})).call(r,e),t.selectAll("path.d3po_data").data((function(e){return[e]})),e.draw.timing?t.selectAll("path.d3po_data").transition().duration(e.draw.timing).call(o).call(r,e):t.selectAll("path.d3po_data").call(o).call(r,e)}},{"../../../core/fetch/text.js":60,"../../../geom/largestrectangle.js":146,"./style.js":217}],206:[function(e,t,n){(function(){var n,r,a;e("../../../core/fetch/value.js"),n=e("../../../core/fetch/color.js"),r=e("../../../color/lighter.js"),a=e("./segments.js"),t.exports=function(e,t,o){var i,s,l,u;return s=e.d3po.shape||t.shape.value,"line"===t.shape.value&&"circle"!==s?"none":"area"===t.shape.value||"active"===s||"line"===t.shape.value?n(t,e):"temp"===s?o?n(t,e):"url(#d3po_hatch_"+e.d3po.id+")":e.d3po.static?r(n(t,e),.75):(i=a(t,e,"active"),l=a(t,e,"temp"),u=a(t,e,"total"),!t.active.value&&!t.temp.value||!0===i||i&&u&&i>=u&&!l||i&&!u?n(t,e):t.active.spotlight.value?t.color.missing:r(n(t,e),.75))}}).call(this)},{"../../../color/lighter.js":40,"../../../core/fetch/color.js":57,"../../../core/fetch/value.js":61,"./segments.js":216}],207:[function(e,t,n){(function(){var n,r,a,o,i,s,l,u;n=e("../../../util/copy.js"),r=e("../../../network/distance.js"),a=e("../../../core/fetch/text.js"),o=e("../../../font/sizes.js"),s=e("../../../geom/largestrectangle.js"),l=e("../../../geom/path2poly.js"),u=e("./style.js"),i={},t.exports=function(e,t,c,d){var f,p;return(f=d3.geo[e.coords.projection.value]()).center&&f.center(e.coords.center),e.zoom.scale||(e.zoom.scale=1),e.zoom.area=1/e.zoom.scale/e.zoom.scale,e.path=d3.geo.path().projection(f),e.draw.timing?t.selectAll("path.d3po_data").attr("d",e.path).transition().duration(e.draw.timing).call(u,e):t.selectAll("path.d3po_data").attr("d",e.path).call(u,e),c.append("path").attr("id",(function(e){return e.id})).attr("class","d3po_data").attr("d",e.path).call(u,e),p=e.old_height!==e.height.viz||e.height.changed||e.old_width!==e.width.viz||e.width.changed,e.old_height=e.height.viz,e.old_width=e.width.viz,e.coords.changed||p||e.coords.mute.changed||e.coords.solo.changed||e.type.changed||e.text.changed||e.coords.projection.changed||e.labels.changed?(e.zoom.bounds=null,e.zoom.reset=!0,e.zoom.coords={},t.each((function(t){var u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F;if(e.coords.simplify.value&&t.geometry.coordinates.length>1){for(m=[],c=[],u=0,b=n(t),A=n(t),t.geometry.coordinates=t.geometry.coordinates.filter((function(t,n){var r;return A.geometry.coordinates=[t],(r=e.path.area(A))>0&&(c.push(r),r>u&&(b.geometry.coordinates=[t],u=r),!0)})),p=e.path.centroid(b),y=x=0,j=(M=t.geometry.coordinates).length;x<j;y=++x)f=M[y],A.geometry.coordinates=[f],m.push(r(e.path.centroid(A),p));g=m.reduce((function(e,t,n){return t&&e.push(c[n]/t),e}),[]),v=d3.quantile(g,e.coords.threshold.value),A.geometry.coordinates=t.geometry.coordinates.filter((function(e,t){var n,r;return r=m[t],n=c[t],0===r||n/r>=v})),(h=b.geometry.coordinates[0])&&"MultiPolygon"===b.geometry.type&&(h=h[0],b.geometry.coordinates[0]=h,b.geometry.type="Polygon")}else A=t,b=t,h=t.geometry.coordinates[0];return e.zoom.coords[t.d3po.id]=A,delete t.d3po_label,e.labels.value&&(w=a(e,t),h&&w.length&&(_=l(e.path(b)),F={"font-weight":e.labels.font.weight,"font-family":e.labels.font.family.value},k=null,1===w[0].split(" ").length&&(k=(O=o(w[0],F)[0]).width/O.height),(z=s(_,{angle:0,aspectRatio:k}))&&(z=z[0],t.d3po_label={anchor:"middle",valign:"center",h:z.height,w:z.width,x:z.cx,y:z.cy,names:w}))),i[t.id]=t.d3po_label,d=e.path.bounds(A),e.zoom.bounds?(e.zoom.bounds[0][0]>d[0][0]&&(e.zoom.bounds[0][0]=d[0][0]),e.zoom.bounds[0][1]>d[0][1]&&(e.zoom.bounds[0][1]=d[0][1]),e.zoom.bounds[1][0]<d[1][0]&&(e.zoom.bounds[1][0]=d[1][0]),e.zoom.bounds[1][1]<d[1][1]?e.zoom.bounds[1][1]=d[1][1]:void 0):e.zoom.bounds=d}))):e.focus.value.length?void 0:(e.zoom.viewport=!1,t.each((function(e){return e.d3po_label=i[e.id]})))}}).call(this)},{"../../../core/fetch/text.js":60,"../../../font/sizes.js":88,"../../../geom/largestrectangle.js":146,"../../../geom/path2poly.js":148,"../../../network/distance.js":151,"../../../util/copy.js":193,"./style.js":217}],208:[function(e,t,n){var r=e("../../../util/child.js"),a=e("../../../util/closest.js"),o=e("../tooltip/create.js"),i=e("../../../client/pointer.js"),s=e("../../../core/fetch/value.js"),l=e("../../../core/fetch/color.js"),u=e("../../../core/fetch/text.js"),c=e("../../../color/legible.js"),d=e("../../../core/console/print.js"),f=e("../../../tooltip/remove.js"),p=(e("./segments.js"),e("./fill.js")),h=e("../../../string/strip.js"),v=e("../../../client/touch.js"),g=e("../zoom/propagation.js"),m=e("../../../util/uniques.js"),y=e("../../../object/validate.js"),x=e("../zoom/direction.js"),b={arc:e("./arc.js"),area:e("./area.js"),check:e("./check.js"),coordinates:e("./coordinates.js"),line:e("./line.js"),radial:e("./radial.js"),rect:e("./rect.js"),whisker:e("./whisker.js")};t.exports=function(e){var t=e.returned.nodes||[],n=e.returned.edges||[];e.draw.timing=t.length<e.data.large&&n.length<e.edges.large?e.timing.transitions:0;var j={arc:"arc",area:"area",check:"check",circle:"rect",coordinates:"coordinates",donut:"donut",line:"line",radial:"radial",rect:"rect",square:"rect",whisker:"whisker"},w={};function _(t){if(!t.d3po.id){t.d3po.id="";for(var n=0;n<=e.depth.value;n++)t.d3po.id+=s(e,t,e.id.nesting[n])+"_";t.d3po.id+=O,["x","y","x2","y2"].forEach((function(n){if("discrete"==e[n].scale.value){var r=s(e,t,e[n].value);r.constructor===Date&&(r=r.getTime()),t.d3po.id+="_"+r}})),t.d3po.suffix&&(t.d3po.id+="_"+t.d3po.suffix),t.d3po.id=h(t.d3po.id)}return t}function k(t,n){var r=e.types[e.type.value].scale,a=1;r&&(y[r]&&e.shape.value in r?a=r[e.shape.value]:"function"==typeof r?a=r(e,e.shape.value):"number"==typeof r&&(a=r)),a=n?a:1,t.attr("transform",(function(e){return["line","area","coordinates"].indexOf(O)<0?"translate("+(e.d3po.x||0)+","+(e.d3po.y||0)+")scale("+a+")":"scale("+a+")"}))}function z(t){t.attr("id",(function(e){return"d3po_group_"+e.d3po.id})).attr("class",(function(t){var n=e.class.value?" "+s(e,t,e.class.value):"";return"d3po_"+O+n}))}for(var A in t.forEach((function(t){var n=t.d3po&&t.d3po.shape?t.d3po.shape:e.shape.value;n in j&&(t.d3po&&(t.d3po.shape=n),w[n=j[n]]||(w[n]=[]),w[n].push(t))})),j)if(!(j[A]in w)||0===d3.keys(w).length){var M=e.g.data.selectAll("g.d3po_"+j[A]);e.draw.timing?M.transition().duration(e.draw.timing).attr("opacity",0).remove():M.remove()}for(var O in w){var F=e.g.data.selectAll("g.d3po_"+O).data(w[O],(function(e){return e.d3po||(e.d3po={}),"coordinates"===O?(e.d3po.id=e.id,e.id):(e.d3po.id||(e.values?(e.values.forEach((function(e){(e=_(e)).d3po.shape="circle"})),e.d3po.id=e.key):e=_(e)),!!e.d3po&&e.d3po.id)}));if(e.draw.timing)var E=F.exit().transition().duration(e.draw.timing).attr("opacity",0).remove();else E=F.exit().remove();e.draw.timing?F.transition().duration(e.draw.timing).call(k).call(z):F.call(k).call(z);var S=e.draw.timing?0:1,B=F.enter().append("g").attr("opacity",S).call(k).call(z);e.draw.timing&&B.transition().duration(e.draw.timing).attr("opacity",1),F.order(),e.dev.value&&d.time('drawing "'+O+'" shapes'),b[O](e,F,B,E,k),e.dev.value&&d.timeEnd('drawing "'+O+'" shapes'),["rect"].indexOf(O)>=0&&e.types[e.type.value].fill&&(e.dev.value&&d.time('filling "'+O+'" shapes'),p(e,F,B,E,k),e.dev.value&&d.timeEnd('filling "'+O+'" shapes'))}function T(t){if(t&&e.g.edges.selectAll("g").size()>0){e.g.edge_hover.selectAll("*").remove(),e.g.edges.selectAll("g").each((function(n){var r=t[e.id.value],a=n[e.edges.source][e.id.value],o=n[e.edges.target][e.id.value];if(a==r||a=="left_"+r||a=="right_"+r||o==r||o=="left_"+r||o=="right_"+r){var i=e.g.edge_hover.node().appendChild(this.cloneNode(!0));d3.select(i).datum(n).attr("opacity",1).selectAll("line, path").datum(n)}}));var n=e.edges.arrows.value;e.g.edge_hover.attr("opacity",0).selectAll("line, path").style("stroke",e.color.primary).style("stroke-width",(function(t){return e.edges.path&&t.dy?Math.max(1,t.dy):e.edges.size.value?d3.select(this).style("stroke-width"):2*e.data.stroke.width})).attr("marker-start",(function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3po)var a="_"+t.d3po.bucket;else a="";return"source"==r&&n?"url(#d3po_edge_marker_highlight"+a+")":"none"})).attr("marker-end",(function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3po)var a="_"+t.d3po.bucket;else a="";return"target"==r&&n?"url(#d3po_edge_marker_highlight"+a+")":"none"})),e.g.edge_hover.selectAll("text").style("fill",e.color.primary),e.draw.timing?(e.g.edge_hover.transition().duration(e.timing.mouseevents).attr("opacity",1),e.g.edges.transition().duration(e.timing.mouseevents).attr("opacity",.5)):e.g.edge_hover.attr("opacity",1)}else e.draw.timing?(e.g.edge_hover.transition().duration(e.timing.mouseevents).attr("opacity",0).transition().selectAll("*").remove(),e.g.edges.transition().duration(e.timing.mouseevents).attr("opacity",1)):e.g.edge_hover.selectAll("*").remove()}if(T(),e.tooltip.value)e.g.data.selectAll("g").on(i.over,(function(t){if(v&&g(e,d3.event),d3.event.buttons||!e.mouse.value||!e.mouse.over.value||e.draw.frozen||t.d3po&&t.d3po.static)f(e.type.value);else{var n="function"!=typeof e.mouse.over.value;if("function"==typeof e.mouse.over.value&&(n=e.mouse.over.value(t,e.self)),n){var r=x(t.d3po_data||t,e),s="function"==typeof e.mouse.viz||"function"==typeof e.mouse.viz[i.click]||e.zoom.value&&(e.types[e.type.value].zoom||t.d3po.threshold&&t.d3po.merged||1===r||-1===r&&e.history.states.length&&!e.tooltip.value.long);if(d3.select(this).style("cursor",s?"pointer":"auto").transition().duration(e.timing.mouseevents).call(k,!0),d3.select(this).selectAll(".d3po_data").transition().duration(e.timing.mouseevents).attr("opacity",1),e.covered=!1,t.values&&e.axes.discrete){var l="x"===e.axes.discrete?0:1,u=d3.mouse(e.container.value.node())[l],c=m(t.values,(function(t){return t.d3po[e.axes.discrete]})),d=a(c,u);t.d3po_data=t.values[c.indexOf(d)],t.d3po=t.values[c.indexOf(d)].d3po}var p=t.d3po_data?t.d3po_data:t;o({vars:e,data:p}),"function"==typeof e.mouse.viz?e.mouse.viz(t.d3po_data||t,e):e.mouse.viz[i.over]&&e.mouse.viz[i.over](t.d3po_data||t,e),T(t)}}})).on(i.move,(function(t){if(v&&g(e,d3.event),d3.event.buttons||!e.mouse.value||!e.mouse.move.value||e.draw.frozen||t.d3po&&t.d3po.static)f(e.type.value);else{var n="function"!=typeof e.mouse.move.value;if("function"==typeof e.mouse.move.value&&(n=e.mouse.move.value(t,e.self)),n){var r=x(t.d3po_data||t,e),s="function"==typeof e.mouse.viz||"function"==typeof e.mouse.viz[i.click]||e.zoom.value&&(e.types[e.type.value].zoom||t.d3po.threshold&&t.d3po.merged||1===r||-1===r&&e.history.states.length&&!e.tooltip.value.long);d3.select(this).style("cursor",s?"pointer":"auto");e.types[e.type.value].tooltip;if(t.values&&e.axes.discrete){var l="x"===e.axes.discrete?0:1,u=d3.mouse(e.container.value.node())[l],c=m(t.values,(function(t){return t.d3po[e.axes.discrete]})),d=a(c,u);t.d3po_data=t.values[c.indexOf(d)],t.d3po=t.values[c.indexOf(d)].d3po}var p=t.d3po_data?t.d3po_data:t;o({vars:e,data:p}),"function"==typeof e.mouse.viz?e.mouse.viz(t.d3po_data||t,e):e.mouse.viz[i.move]&&e.mouse.viz[i.move](t.d3po_data||t,e)}}})).on(i.out,(function(t){if(v&&g(e,d3.event),!d3.event.buttons&&e.mouse.value&&e.mouse.out.value){var n="function"!=typeof e.mouse.out.value;if("function"==typeof e.mouse.out.value&&(n=e.mouse.out.value(t,e.self)),n)r(this,d3.event.toElement)||e.draw.frozen||t.d3po&&t.d3po.static||(d3.select(this).transition().duration(e.timing.mouseevents).call(k),d3.select(this).selectAll(".d3po_data").transition().duration(e.timing.mouseevents).attr("opacity",e.data.opacity),e.covered||f(e.type.value),"function"==typeof e.mouse.viz?e.mouse.viz(t.d3po_data||t,e):e.mouse.viz[i.out]&&e.mouse.viz[i.out](t.d3po_data||t,e),T())}else f(e.type.value)}));else{var N=function(){g(e,d3.event)};e.g.data.selectAll("g").on(i.over,N).on(i.move,N).on(i.out,N)}d3.select(window).on("scroll.d3po",(function(){f(e.type.value)})),e.g.data.selectAll("g").on(i.click,(function(t){if((!e.mouse.viz||!1!==e.mouse.viz.click)&&e.mouse.value&&e.mouse.click.value&&!d3.event.defaultPrevented&&!e.draw.frozen&&(!t.d3po||!t.d3po.static)){var n="function"!=typeof e.mouse.click.value;if("function"==typeof e.mouse.click.value&&(n=e.mouse.click.value(t,e.self)),n){if(t.values&&e.axes.discrete){var r="x"===e.axes.discrete?0:1,d=d3.mouse(e.container.value.node())[r],p=m(t.values,(function(t){return t.d3po[e.axes.discrete]})),h=a(p,d);t.d3po_data=t.values[p.indexOf(h)],t.d3po=t.values[p.indexOf(h)].d3po}"function"==typeof e.mouse.viz?e.mouse.viz(t.d3po_data||t,e):e.mouse.viz[i.out]?e.mouse.viz[i.out](t.d3po_data||t,e):e.mouse.viz[i.click]&&e.mouse.viz[i.click](t.d3po_data||t,e);var v=x(t.d3po_data||t,e),g=e.id.solo.value,y=u(e,t)[0],b=c(l(e,t)),j=e.title.sub.value||!1,w=e.title.sub.font.color,_=e.title.total.font.color;if(t.d3po.threshold&&t.d3po.merged&&e.zoom.value)e.history.states.push((function(){e.self.id({solo:g}).title({sub:{font:{color:w},value:j},total:{font:{color:_}}}).draw()})),e.self.id({solo:g.concat(m(t.d3po.merged,e.id.value,s,e))}).title({sub:{font:{color:b},value:y},total:{font:{color:b}}}).draw();else if(1===v&&e.zoom.value){var z=s(e,t.d3po_data||t,e.id.value);e.history.states.push((function(){e.self.depth(e.depth.value-1).id({solo:g}).title({sub:{font:{color:w},value:j},total:{font:{color:_}}}).draw()})),e.self.depth(e.depth.value+1).id({solo:g.concat(z)}).title({sub:{font:{color:b},value:y},total:{font:{color:b}}}).draw()}else if(-1===v&&e.zoom.value&&e.history.states.length&&!e.tooltip.value.long)e.history.back();else if(e.types[e.type.value].zoom&&e.zoom.value)T(),d3.select(this).transition().duration(e.timing.mouseevents).call(k),d3.select(this).selectAll(".d3po_data").transition().duration(e.timing.mouseevents).attr("opacity",e.data.opacity),f(e.type.value),e.draw.update=!1,t&&t[e.id.value]!=e.focus.value[0]?e.self.focus(t[e.id.value]).draw():e.self.focus(!1).draw();else if(e.types[e.type.value].requirements.indexOf("focus")<0){T();var A=t.d3po_data?t.d3po_data:t;o({vars:e,data:A})}}}}))}},{"../../../client/pointer.js":33,"../../../client/touch.js":38,"../../../color/legible.js":39,"../../../core/console/print.js":47,"../../../core/fetch/color.js":57,"../../../core/fetch/text.js":60,"../../../core/fetch/value.js":61,"../../../object/validate.js":158,"../../../string/strip.js":161,"../../../tooltip/remove.js":189,"../../../util/child.js":191,"../../../util/closest.js":192,"../../../util/uniques.js":196,"../tooltip/create.js":221,"../zoom/direction.js":231,"../zoom/propagation.js":234,"./arc.js":203,"./area.js":204,"./check.js":205,"./coordinates.js":207,"./fill.js":210,"./line.js":212,"./radial.js":214,"./rect.js":215,"./segments.js":216,"./whisker.js":218}],209:[function(e,t,n){var r=e("../../../util/buckets.js"),a=e("../../../geom/offset.js");t.exports=function(e){var t=e.returned.edges||[],n=e.zoom.behavior.scaleExtent()[0];if("string"==typeof e.edges.size.value){var o=d3.extent(t,(function(t){return t[e.edges.size.value]})),i=d3.min(e.returned.nodes||[],(function(e){return e.d3po.r}))*(2*e.edges.size.scale);e.edges.scale=d3.scale.sqrt().domain(o).range([e.edges.size.min,i*n])}else{var s="number"==typeof e.edges.size.value?e.edges.size.value:e.edges.size.min;e.edges.scale=function(){return s}}var l=e.edges.opacity.value,u=typeof l;function c(t){t.attr("opacity",0).style("stroke-width",0).style("stroke",e.background.value).style("fill","none")}function d(t){var n=e.edges.arrows.value;t.attr("opacity",(function(t){return"number"===u?l:"function"===u?l(t,e):e.edges.opacity.scale.value(t[l])})).style("stroke-width",(function(t){return e.edges.scale(t[e.edges.size.value])})).style("stroke",e.edges.color).attr("marker-start",(function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3po)var a="_"+t.d3po.bucket;else a="";return"source"==r&&n?"url(#d3po_edge_marker_default"+a+")":"none"})).attr("marker-end",(function(t){var r=e.edges.arrows.direction.value;if("bucket"in t.d3po)var a="_"+t.d3po.bucket;else a="";return"target"==r&&n?"url(#d3po_edge_marker_default"+a+")":"none"})).attr("vector-effect","non-scaling-stroke").attr("pointer-events","none")}function f(t){t.attr("x1",(function(t){return t[e.edges.source].d3po.edges[t[e.edges.target][e.id.value]].x})).attr("y1",(function(t){return t[e.edges.source].d3po.edges[t[e.edges.target][e.id.value]].y})).attr("x2",(function(t){return t[e.edges.target].d3po.edges[t[e.edges.source][e.id.value]].x})).attr("y2",(function(t){return t[e.edges.target].d3po.edges[t[e.edges.source][e.id.value]].y}))}e.edges.opacity.changed&&"string"===u&&e.edges.opacity.scale.value.domain(d3.extent(t,(function(e){return e[l]}))).range([e.edges.opacity.min.value,1]);var p=d3.svg.line().interpolate(e.edges.interpolate.value);function h(e){e.attr("d",(function(e){return p(e.d3po.spline)}))}function v(t){if(delete t.d3po_label,e.g.edges.selectAll("line, path").size()<e.edges.large&&e.edges.label&&t[e.edges.label]){if("spline"in t.d3po)var n=this.getTotalLength(),r=this.getPointAtLength(n/2),a=this.getPointAtLength(n/2-.1*n),o=this.getPointAtLength(n/2+.1*n),i=Math.atan2(o.y-a.y,o.x-a.x)*(180/Math.PI),s=(this.parentNode.getBBox(),.8*n),l=r.x,u=r.y;else{this.getBBox();var c=t[e.edges.source],d=t[e.edges.target],f={x:c.d3po.edges[d[e.id.value]].x,y:c.d3po.edges[d[e.id.value]].y},p={x:d.d3po.edges[c[e.id.value]].x,y:d.d3po.edges[c[e.id.value]].y},h=p.x-f.x,v=p.y-f.y;r={x:p.x-h/2,y:p.y-v/2},i=Math.atan2(v,h)*(180/Math.PI),s=n=Math.sqrt(h*h+v*v),l=r.x,u=r.y}s+=2*e.labels.padding;var g=0;e.edges.arrows.value&&(g="number"==typeof e.edges.arrows.value?e.edges.arrows.value:8,s-=2*(g/=e.zoom.behavior.scaleExtent()[1])),(i<-90||i>90)&&(i-=180),s*e.zoom.behavior.scaleExtent()[0]>20&&(t.d3po_label={x:l,y:u,translate:{x:l,y:u},w:s,h:15+2*e.labels.padding,angle:i,anchor:"middle",valign:"center",color:e.edges.color,resize:!1,names:[e.format.value(t[e.edges.label])],background:1})}}var g=e.edges.arrows.value?"string"==typeof e.edges.size.value?["default_0","default_1","default_2","highlight_0","highlight_1","highlight_2","focus_0","focus_1","focus_2"]:["default","highlight","focus"]:[];if("string"==typeof e.edges.size.value)for(var m=r(e.edges.scale.range(),4),y=[],x=0;x<3;x++)y.push(m[x+1]+(m[1]-m[0])*(x+2)*2);else{var b="number"==typeof e.edges.arrows.value?e.edges.arrows.value:8;y="number"==typeof e.edges.size.value?e.edges.size.value/b:b}var j=e.defs.selectAll(".d3po_edge_marker").data(g,String),w=function(t){t.attr("d",(function(t){var n=t.split("_");if(2==n.length&&e.edges.scale){n=parseInt(n[1]);var r=y[n]}else r=y;return"target"==e.edges.arrows.direction.value?"M 0,-"+r/2+" L "+.85*r+",0 L 0,"+r/2+" L 0,-"+r/2:"M 0,-"+r/2+" L -"+.85*r+",0 L 0,"+r/2+" L 0,-"+r/2})).attr("fill",(function(t){var n=t.split("_")[0];return"default"==n?e.edges.color:"focus"==n?e.color.focus:e.color.primary})).attr("transform","scale("+1/n+")")};e.draw.timing?(j.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),j.select("path").transition().duration(e.draw.timing).attr("opacity",1).call(w)):(j.exit().remove(),j.select("path").attr("opacity",1).call(w));var _=e.draw.timing?0:1,k=j.enter().append("marker").attr("id",(function(e){return"d3po_edge_marker_"+e})).attr("class","d3po_edge_marker").attr("orient","auto").attr("markerUnits","userSpaceOnUse").style("overflow","visible").append("path").attr("opacity",_).attr("vector-effect","non-scaling-stroke").call(w);e.draw.timing&&k.transition().duration(e.draw.timing).attr("opacity",1);var z="string"==typeof e.edges.size.value?r(e.edges.scale.domain(),4):null,A=e.edges.arrows.direction.value,M=t.filter((function(t){if(t.d3po||(t.d3po={}),t.d3po.id="edge_"+t[e.edges.source][e.id.value]+"_"+t[e.edges.target][e.id.value],!0!==t.d3po.spline){if(z){var r=t[e.edges.size.value];t.d3po.bucket=r<z[1]?0:r<z[2]?1:2;var o=.85*y[t.d3po.bucket]/n}else{delete t.d3po.bucket;o=.85*y/n}var i=t[e.edges.source],s=t[e.edges.target];if(!i.d3po||!s.d3po)return!1;var l=Math.atan2(i.d3po.y-s.d3po.y,i.d3po.x-s.d3po.x),u=Math.atan2(s.d3po.y-i.d3po.y,s.d3po.x-i.d3po.x),c="source"==A&&e.edges.arrows.value?i.d3po.r+o:i.d3po.r,d="target"==A&&e.edges.arrows.value?s.d3po.r+o:s.d3po.r,f=a(l,c,e.shape.value),p=a(u,d,e.shape.value);return"edges"in i.d3po||(i.d3po.edges={}),i.d3po.edges[s[e.id.value]]={x:i.d3po.x-f.x,y:i.d3po.y-f.y},"edges"in s.d3po||(s.d3po.edges={}),s.d3po.edges[i[e.id.value]]={x:s.d3po.x-p.x,y:s.d3po.y-p.y},!0}return!1})),O=e.g.edges.selectAll("g.d3po_edge_line").data(M,(function(e){return e.d3po.id})),F=t.filter((function(t){if(t.d3po.spline){if(z){var r=t[e.edges.size.value];t.d3po.bucket=r<z[1]?0:r<z[2]?1:2;var o=.85*y[t.d3po.bucket]/n}else{delete t.d3po.bucket;o=.85*y/n}var i=t[e.edges.source],s=t[e.edges.target],l=i.d3po.edges&&i.d3po.edges[s[e.id.value]]||{},u=s.d3po.edges&&s.d3po.edges[i[e.id.value]]||{},c=e.edges.arrows.value&&"source"==A?o:0,d=e.edges.arrows.value&&"target"==A?o:0,f=i.d3po.x>s.d3po.x?.9:1.1,p=i.d3po.x>s.d3po.x?1.1:.9,h="number"==typeof l.angle?l.angle:Math.atan2(i.d3po.y-s.d3po.y,i.d3po.x-s.d3po.x)*f,v=a(h,i.d3po.r+c,e.shape.value),g="number"==typeof u.angle?u.angle:Math.atan2(s.d3po.y-i.d3po.y,s.d3po.x-i.d3po.x)*p,m=a(g,s.d3po.r+d,e.shape.value),x=[i.d3po.x-v.x,i.d3po.y-v.y],b=!!l.offset&&a(h,l.offset),j=b?[x[0]-b.x,x[1]-b.y]:x,w=[s.d3po.x-m.x,s.d3po.y-m.y],_=!!u.offset&&a(g,u.offset),k=_?[w[0]-_.x,w[1]-_.y]:w,M=k[0]-j[0],O=k[1]-j[1],F="number"==typeof l.radius?l.radius:Math.sqrt(M*M+O*O)/4,E="number"==typeof u.radius?u.radius:Math.sqrt(M*M+O*O)/4,S=a(h,F-i.d3po.r-2*c),B=a(g,E-s.d3po.r-2*d);t.d3po.spline=[x,w];var T=Math.abs(Math.atan2(i.d3po.y-s.d3po.y,i.d3po.x-s.d3po.x)).toFixed(5),N=Math.abs(h).toFixed(5),I=Math.abs(g-Math.PI).toFixed(5);return(N!==I||[N,I].indexOf(T)<0)&&(t.d3po.spline.splice(1,0,[j[0]-S.x,j[1]-S.y],[k[0]-B.x,k[1]-B.y]),b&&t.d3po.spline.splice(1,0,j),_&&t.d3po.spline.splice(t.d3po.spline.length-1,0,k)),!0}return!1})),E=e.g.edges.selectAll("g.d3po_edge_path").data(F,(function(e){return e.d3po.id}));e.draw.timing?(O.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),E.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),O.selectAll("text.d3po_label, rect.d3po_label_bg").transition().duration(e.draw.timing/2).attr("opacity",0).remove(),E.selectAll("text.d3po_label, rect.d3po_label_bg").transition().duration(e.draw.timing/2).attr("opacity",0).remove(),O.selectAll("line").data((function(e){return[e]})).transition().duration(e.draw.timing).call(f).call(d).each("end",v),E.selectAll("path").data((function(e){return[e]})).transition().duration(e.draw.timing).call(h).call(d).each("end",v),O.enter().append("g").attr("class","d3po_edge_line").append("line").call(f).call(c).transition().duration(e.draw.timing).call(d).each("end",v),E.enter().append("g").attr("class","d3po_edge_path").append("path").call(h).call(c).transition().duration(e.draw.timing).call(d).each("end",v)):(O.exit().remove(),E.exit().remove(),O.selectAll("text.d3po_label, rect.d3po_label_bg").remove(),E.selectAll("text.d3po_label, rect.d3po_label_bg").remove(),O.selectAll("line").data((function(e){return[e]})).call(f).call(d).call(v),E.selectAll("path").data((function(e){return[e]})).call(h).call(d).call(v),O.enter().append("g").attr("class","d3po_edge_line").append("line").call(f).call(c).call(d).call(v),E.enter().append("g").attr("class","d3po_edge_path").append("path").call(h).call(c).call(d).call(v))}},{"../../../geom/offset.js":147,"../../../util/buckets.js":190}],210:[function(e,t,n){var r=e("../../../util/copy.js"),a=e("../../../core/fetch/color.js"),o=(e("../../../core/fetch/value.js"),e("./segments.js")),i=e("./style.js");t.exports=function(e,t,n,s){function l(e){e.attr("x",0).attr("y",0).attr("width",0).attr("height",0)}function u(t,n){n||(n=0),t.attr("x",(function(e){return-(e.d3po.r?2*e.d3po.r:e.d3po.width)/2-n/2})).attr("y",(function(e){return-(e.d3po.r?2*e.d3po.r:e.d3po.height)/2-n/2})).attr("width",(function(e){return(e.d3po.r?2*e.d3po.r:e.d3po.width)+n})).attr("height",(function(e){return(e.d3po.r?2*e.d3po.r:e.d3po.height)+n})).attr("rx",(function(t){var r=t.d3po.r?2*t.d3po.r:t.d3po.width;return["circle"].indexOf(e.shape.value)>=0?(r+n)/2:0})).attr("ry",(function(t){var r=t.d3po.r?2*t.d3po.r:t.d3po.height;return["circle"].indexOf(e.shape.value)>=0?(r+n)/2:0})).attr("shape-rendering",(function(t){return["square"].indexOf(e.shape.value)>=0?e.shape.rendering.value:"auto"}))}t.each((function(t){var n=o(e,t,"active"),s=o(e,t,"temp"),c=o(e,t,"total"),d=d3.select(this),f=a(e,t),p=[],h=[];if(c&&e.types[e.type.value].fill){var v;if(s)(v=r(t)).d3po.shape="temp",p.push(v),h=["temp"];if(n&&(n<c||s))(v=r(t)).d3po.shape="active",p.push(v)}function g(t){t.attr("stroke",f).attr("stroke-width",1).attr("shape-rendering",e.shape.rendering.value)}var m=e.defs.selectAll("pattern#d3po_hatch_"+t.d3po.id).data(h);e.draw.timing?(m.selectAll("rect").transition().duration(e.draw.timing).style("fill",f),m.selectAll("line").transition().duration(e.draw.timing).style("stroke",f)):(m.selectAll("rect").style("fill",f),m.selectAll("line").style("stroke",f));var y=m.enter().append("pattern").attr("id","d3po_hatch_"+t.d3po.id).attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","10").attr("height","10").append("g");y.append("rect").attr("x","0").attr("y","0").attr("width","10").attr("height","10").attr("fill",f).attr("fill-opacity",.25),y.append("line").attr("x1","0").attr("x2","10").attr("y1","0").attr("y2","10").call(g),y.append("line").attr("x1","-1").attr("x2","1").attr("y1","9").attr("y2","11").call(g),y.append("line").attr("x1","9").attr("x2","11").attr("y1","-1").attr("y2","1").call(g);var x=p.length?[t]:[],b=d.selectAll("#d3po_clip_"+t.d3po.id).data(x);b.enter().insert("clipPath",".d3po_mouse").attr("id","d3po_clip_"+t.d3po.id).append("rect").attr("class","d3po_clipping").call(l),e.draw.timing?(b.selectAll("rect").transition().duration(e.draw.timing).call(u),b.exit().transition().delay(e.draw.timing).remove()):(b.selectAll("rect").call(u),b.exit().remove());var j=d.selectAll("path.d3po_fill").data(p);j.transition().duration(e.draw.timing).call(i,e),j.enter().insert("path","rect.d3po_mouse").attr("class","d3po_fill").attr("clip-path","url(#d3po_clip_"+t.d3po.id+")").transition().duration(0).call(i,e).transition().duration(e.draw.timing).call(i,e),j.exit().transition().duration(e.draw.timing).remove()}))}},{"../../../core/fetch/color.js":57,"../../../core/fetch/value.js":61,"../../../util/copy.js":193,"./segments.js":216,"./style.js":217}],211:[function(e,t,n){e("../../../util/copy.js");var r=e("../../../core/fetch/text.js"),a=e("../../../core/fetch/value.js"),o=e("../../../color/mix.js"),i=e("../../../core/console/print.js"),s=(e("../../../client/rtl.js"),e("./segments.js")),l=e("./color.js"),u=e("../../../string/list.js"),c=e("../../../color/text.js"),d=e("../../../textwrap/textwrap.js");t.exports=function(e,t){var n=e.types[e.type.value].zoom?e.zoom.behavior.scaleExtent():[1,1],f=e.g[t].selectAll("g"),p=function(t){t.attr("opacity",(function(t){var r=parseFloat(d3.select(this).attr("font-size"),10);return t.visible=r*(e.zoom.scale/n[1])>=2,t.visible?1:0}))},h=function(t){e.draw.timing?t.transition().duration(e.draw.timing).attr("opacity",0).remove():t.remove()},v=function(t){e.labels.valign.value;t.attr("font-weight",e.labels.font.weight).attr("font-family",e.labels.font.family.value).attr("stroke","none").attr("pointer-events",(function(e){return e.mouse?"auto":"none"})).attr("fill",(function(t){if(t.color)return t.color;var n=l(t.parent,e),r=c(n),a=t.text?0:1;return o(n,r,.2,a)})).each((function(t){if(t.resize instanceof Array)t.resize[0],t.resize[1];var r=t.resize,a=!0;t.resize instanceof Array||(r=[7,n[1]/n[0]*32],a=t.resize);var o="bottom"===e.labels.valign.value?t.share:0;isNaN(t.percentage)?d().align(t.anchor||e.labels.align.value).container(d3.select(this)).height(t.h*n[1]-t.share).padding(t.padding/2).resize(a).size(r).shape(t.shape||"square").text(t.names).valign(e.labels.valign.value).width(t.w*n[1]).x(t.x-t.w*n[1]/2+t.padding/2).y(t.y-t.h*n[1]/2+t.padding/2+o).draw():d().align(t.anchor||e.labels.align.value).container(d3.select(this)).height(t.h*n[1]-t.share).padding(t.padding/2).resize(a).size(r).shape(t.shape||"square").text(t.names+"\n"+e.format.value(100*t.percentage,{key:"share",vars:e})).valign(e.labels.valign.value).width(t.w*n[1]).x(t.x-t.w*n[1]/2+t.padding/2).y(t.y-t.h*n[1]/2+t.padding/2+o).draw()})).attr("transform",(function(e){var t=d3.select(this).attr("transform")||"",r=e.angle||0,a=e.translate&&e.translate.x?e.translate.x:0,o=e.translate&&e.translate.y?e.translate.y:0;return t.length&&(t=t.split(")").slice(-3).join(")")),"rotate("+r+","+a+","+o+")scale("+1/n[1]+")translate("+(e.x*n[1]-e.x)+","+(e.y*n[1]-e.y)+")"+t}))};if("edges"===t||e.labels.value){if(e.dev.value){var g="drawing "+t+" labels";i.time(g)}f.each((function(t){var o=t.d3po&&"label"in t.d3po&&!t.d3po.label,i=t.d3po_label||null,l=t.d3po.text?t.d3po.text:i&&i.names?i.names:e.labels.text.value?a(e,t,e.labels.text.value):r(e,t),c=i&&"group"in i?i.group:d3.select(this),d=e.types[e.type.value].fill;if(l instanceof Array||(l=[l]),i)if(["line","area"].indexOf(e.shape.value)>=0)var f=!0;else if(t&&"d3po"in t){var g=s(e,t,"active"),m=s(e,t,"temp"),y=s(e,t,"total");f=!m&&!g||g>=y||!g&&m>=y}if(o||!(i&&i.force||f)&&d)delete t.d3po_label,d3.select(this).selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h),e.g.labels.selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h);else if(i&&(i.resize=!1!==e.labels.resize.value&&(!i||!("resize"in i)||i.resize),i.padding="number"==typeof i.padding?i.padding:e.labels.padding),i&&i.w*n[1]-i.padding>=20&&i.h*n[1]-i.padding>=10&&l.length){for(var x=e.format.locale.value.ui.and,b=e.format.locale.value.ui.more,j=0;j<l.length;j++)l[j]instanceof Array&&(l[j]=u(l[j],x,3,b));i.names=l,i.share=0,i.percentage=t.d3po.share,i.parent=t;var w=c.selectAll("text#d3po_label_"+t.d3po.id).data([i],(function(e){return!!e&&e.names})),_=i.resize?void 0:e.labels.font.size*n[0]+"px";if(e.draw.timing&&1===e.zoom.scale?(w.transition().duration(e.draw.timing/2).call(v).call(p),w.enter().append("text").attr("font-size",_).attr("id","d3po_label_"+t.d3po.id).attr("class","d3po_label").attr("opacity",0).call(v).transition().duration(e.draw.timing/2).delay(e.draw.timing/2).call(p)):(w.attr("opacity",1).call(v).call(p),w.enter().append("text").attr("font-size",_).attr("id","d3po_label_"+t.d3po.id).attr("class","d3po_label").call(v).call(p)),w.exit().call(h),0===w.size()||0===w.selectAll("tspan").size())delete t.d3po_label,d3.select(this).selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h),e.g.labels.selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h);else{if(i.background){var k=["background"],z=w.node().getBBox();(M={height:z.height,width:z.width,x:z.x,y:z.y>0?z.y:-z.height/2}).width+=e.labels.padding*n[0],M.height+=e.labels.padding*n[0],M.x-=e.labels.padding*n[0]/2,M.y-=e.labels.padding*n[0]/2;var A=w.attr("transform").match(/translate\(([^a-z]+)\)/gi)[0];(A=(A=A.replace(/([^a-z])\s([^a-z])/gi,"$1,$2")).split(",")).length>1&&(A=(A=A[A.length-1]).substring(0,A.length-1),M.y+=parseFloat(A))}else{k=[];var M={}}var O=c.selectAll("rect#d3po_label_bg_"+t.d3po.id).data(k),F="number"==typeof i.background?i.background:"string"==typeof i.background?1:.6;function E(t){var n="string"==typeof i.background?i.background:"none"===e.background.value?"#ffffff":e.background.value,r="string"==typeof i.background?i.background:n,a=w.attr("transform").split(")");a.pop(),a.pop(),a.push(""),a=a.join(")"),t.attr("fill",r).attr(M).attr("transform",a)}e.draw.timing?(O.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),O.transition().duration(e.draw.timing).attr("opacity",F).call(E),O.enter().insert("rect",".d3po_label").attr("id","d3po_label_bg_"+t.d3po.id).attr("class","d3po_label_bg").attr("opacity",0).call(E).transition().duration(e.draw.timing).attr("opacity",F)):(O.exit().remove(),O.enter().insert("rect",".d3po_label").attr("id","d3po_label_bg_"+t.d3po.id).attr("class","d3po_label_bg"),O.attr("opacity",F).call(E))}}else delete t.d3po_label,d3.select(this).selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h),e.g.labels.selectAll("text#d3po_label_"+t.d3po.id+", rect#d3po_label_bg_"+t.d3po.id).call(h)})),e.dev.value&&i.timeEnd(g)}else{if(e.dev.value){g="removing "+t+" labels";i.time(g)}f.selectAll("text.d3po_label, rect.d3po_label_bg").call(h),e.g.labels.selectAll("text.d3po_label, rect.d3po_label_bg").call(h),e.dev.value&&i.timeEnd(g)}}},{"../../../client/rtl.js":35,"../../../color/mix.js":41,"../../../color/text.js":45,"../../../core/console/print.js":47,"../../../core/fetch/text.js":60,"../../../core/fetch/value.js":61,"../../../string/list.js":160,"../../../textwrap/textwrap.js":186,"../../../util/copy.js":193,"./color.js":206,"./segments.js":216}],212:[function(e,t,n){var r=e("../../../util/copy.js"),a=e("../../../util/closest.js"),o=e("../../../client/pointer.js"),i=e("./style.js"),s=e("../../../core/fetch/value.js");function l(e){e.attr("x",(function(e){return e.d3po.x})).attr("y",(function(e){return e.d3po.y})).attr("width",0).attr("height",0)}function u(e){e.attr("cx",(function(e){return e.d3po.x})).attr("cy",(function(e){return e.d3po.y})).attr("r",3)}function c(e,t){void 0===t&&(t=0),e.attr("x",(function(e){var n=e.d3po.r?2*e.d3po.r:e.d3po.width;return e.d3po.x-(n/2+t/2)})).attr("y",(function(e){var n=e.d3po.r?2*e.d3po.r:e.d3po.height;return e.d3po.y-(n/2+t/2)})).attr("width",(function(e){return(e.d3po.r?2*e.d3po.r:e.d3po.width)+t})).attr("height",(function(e){return(e.d3po.r?2*e.d3po.r:e.d3po.height)+t})).attr("rx",(function(e){return((e.d3po.r?2*e.d3po.r:e.d3po.width)+t)/2})).attr("ry",(function(e){return((e.d3po.r?2*e.d3po.r:e.d3po.height)+t)/2}))}function d(e,t,n,r){var a=e.draw.timing?e.timing.mouseevents:0;void 0===r&&(r=0),a?(d3.select(t.parentNode).selectAll("path.d3po_line").transition().duration(a).style("stroke-width",(function(t){var a=n;if(a.constructor!==Number){var o=s(e,t,n);a=o&&o.length?d3.max(o):e.data.stroke.width}return a+r})),d3.select(t.parentNode).selectAll("rect").transition().duration(a).style("stroke-width",(function(t){var r=n;if(r.constructor!==Number){var a=s(e,t,n);r=a&&a.length?d3.max(a):e.data.stroke.width}return r})).call(c,r)):(d3.select(t.parentNode).selectAll("path.d3po_line").style("stroke-width",(function(t){var a=n;if(a.constructor!==Number){var o=s(e,t,n);a=o&&o.length?d3.max(o):e.data.stroke.width}return a+r})),d3.select(t.parentNode).selectAll("rect").style("stroke-width",(function(t){var r=n;if(r.constructor!==Number){var a=s(e,t,n);r=a&&a.length?d3.max(a):e.data.stroke.width}return r})).call(c,r))}t.exports=function(e,t,n,f){var p=d3.svg.line().x((function(e){return e.d3po.x})).y((function(e){return e.d3po.y})).interpolate(e.shape.interpolate.value);e.data.stroke.width=2;var h=e.size.value||e.data.stroke.width,v=e[e.axes.discrete],g=function(t){var n=h;if(n.constructor!==Number){var r=s(e,t,h);n=r&&r.length?d3.max(r):e.data.stroke.width}return n<15?15:n},m=v.ticks.values.map((function(e){return e.constructor===Date?e.getTime():e}));t.each((function(t){var n=!1,f=[],y=[],x=r(t),b=d3.select(this);x.values=[],x.segment_key=x.key,t.values.forEach((function(o,i,l){var u=s(e,o,v.value);u.constructor===Date&&(u=u.getTime());var c=m.indexOf(a(m,u));!1===n||n===c-1?(x.values.push(o),x.segment_key+="_"+c):(x.values.length>1?f.push(x):y.push(x.values[0]),(x=r(t)).values=[o]),i===l.length-1&&(x.values.length>1?f.push(x):y.push(x.values[0])),n=c}));var j=b.selectAll("path.d3po_line").data(f,(function(e){return e.d3po||(e.d3po={}),e.d3po.shape="line",e.segment_key})),w=b.selectAll("rect.d3po_anchor").data(y,(function(e){return e.d3po||(e.d3po={}),e.d3po.r=h,e.d3po.id})),_=b.selectAll("circle.d3po_circle").data(t.values);e.draw.timing?(j.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),j.transition().duration(e.draw.timing).attr("d",(function(e){return p(e.values)})).call(i,e),j.enter().append("path").attr("class","d3po_line").style("stroke-linecap","round").attr("d",(function(e){return p(e.values)})).call(i,e).attr("opacity",0).transition().duration(e.draw.timing).attr("opacity",1),w.enter().append("rect").attr("class","d3po_anchor").attr("id",(function(e){return e.d3po.id})).call(l).call(i,e),w.transition().duration(e.draw.timing).call(c).call(i,e),w.exit().transition().duration(e.draw.timing).call(l).remove(),_.exit().remove(),_.transition().duration(e.draw.timing).call(u).call(i,e).attr("fill","white"),_.enter().append("circle").attr("class","d3po_circle").call(u).call(i,e).attr("fill","white")):(j.exit().remove(),j.enter().append("path").attr("class","d3po_line").style("stroke-linecap","round"),j.attr("d",(function(e){return p(e.values)})).call(i,e),w.enter().append("rect").attr("class","d3po_anchor").attr("id",(function(e){return e.d3po.id})),w.exit().remove(),w.call(c).call(i,e),_.exit().remove(),_.enter().append("circle").attr("class","d3po_circle"),_.call(u).call(i,e).attr("fill","white"));var k=b.selectAll("path.d3po_mouse").data(f,(function(e){return e.segment_key}));k.enter().append("path").attr("class","d3po_mouse").attr("d",(function(e){return p(e.values)})).style("stroke","black").style("stroke-width",g).style("fill","none").style("stroke-linecap","round").attr("opacity",0),k.on(o.over,(function(t){!e.draw.frozen&&e.mouse.value&&e.mouse.over.value&&d(e,this,h,2)})).on(o.out,(function(t){!e.draw.frozen&&e.mouse.value&&e.mouse.out.value&&d(e,this,h,0)})),e.draw.timing?k.transition().duration(e.draw.timing).attr("d",(function(e){return p(e.values)})).style("stroke-width",g):k.attr("d",(function(e){return p(e.values)})).style("stroke-width",g),k.exit().remove()}))}},{"../../../client/pointer.js":33,"../../../core/fetch/value.js":61,"../../../util/closest.js":192,"../../../util/copy.js":193,"./style.js":217}],213:[function(e,t,n){t.exports=function(e){var t=e.returned.edges||[],n=e.g.edges.selectAll("g.d3po_edge_path").data(t,(function(t){return t.d3po.id="path_"+t[e.edges.source][e.id.value]+"_"+t[e.edges.target][e.id.value],t.d3po.id}));function r(t){t.attr("d",e.edges.path).style("stroke-width",(function(e){return Math.max(1,e.dy)})).style("stroke","#ddd").style("fill","none").attr("transform",(function(e){return"translate("+e.d3po.x+","+e.d3po.y+")"}))}e.draw.timing?(n.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),n.selectAll("text.d3po_label, rect.d3po_label_bg").transition().duration(e.draw.timing/2).attr("opacity",0).remove(),n.selectAll("path").data((function(e){return[e]})).transition().duration(e.draw.timing).call(r),n.enter().append("g").attr("class","d3po_edge_path").append("path").style("stroke-width",0).transition().duration(e.draw.timing).call(r)):(n.exit().remove(),n.selectAll("text.d3po_label, rect.d3po_label_bg").remove(),n.selectAll("path").data((function(e){return[e]})).call(r),n.enter().append("g").attr("class","d3po_edge_path").append("path").call(r))}},{}],214:[function(e,t,n){(function(){var n,r,a,o;o=e("./style.js"),a={},n={},r={r:{},a:{}},t.exports=function(e,t,i,s){var l,u,c,d,f;c=e.id.nesting[e.depth.value+1],d=d3.svg.line.radial().interpolate("linear-closed").radius((function(e){return e.d3po.r})).angle((function(e){return e.d3po.a})),l=function(t){return e.labels.value&&(t.d3po.label?t.d3po_label=t.d3po.label:delete t.d3po_label),[t]},e.draw.timing?(t.each((function(t){var n,r,a,o,i;for(i=[],r=0,a=(o=t[c]).length;r<a;r++)n=o[r],i.push(n.d3po.id=n[e.id.value]+"_"+n[c]);return i})),u=d3.svg.line.radial().interpolate("linear-closed").radius((function(e,t){return void 0===a[e.d3po.id]&&(a[e.d3po.id]=0),isNaN(a[e.d3po.id])&&(a[e.d3po.id]=e.d3po.r),a[e.d3po.id]})).angle((function(e,t){return void 0===n[e.d3po.id]&&(n[e.d3po.id]=e.d3po.a),isNaN(n[e.d3po.id])&&(n[e.d3po.id]=e.d3po.a),n[e.d3po.id]})),f=function(e,t){return e.attrTween("d",(function(e){var o,i,s,l,d,f,p;for(p=e[c],s=l=0,d=p.length;l<d;s=++l)o=(i=p[s]).d3po.a,void 0===t?f=i.d3po.r:0===t&&(f=0),r.a[i.d3po.id]=d3.interpolate(n[i.d3po.id],o),r.r[i.d3po.id]=d3.interpolate(a[i.d3po.id],f);return function(t){var o,l,d;for(d=e[c],s=o=0,l=d.length;o<l;s=++o)i=d[s],n[i.d3po.id]=r.a[i.d3po.id](t),a[i.d3po.id]=r.r[i.d3po.id](t);return u(e[c])}}))},i.append("path").attr("class","d3po_data").call(o,e).attr("d",(function(e){return u(e[c])})),t.selectAll("path.d3po_data").data(l).transition().duration(e.draw.timing).call(o,e).call(f),s.selectAll("path.d3po_data").transition().duration(e.draw.timing).call(f,0)):(i.append("path").attr("class","d3po_data"),t.selectAll("path.d3po_data").data(l).call(o,e).attr("d",(function(e){return d(e[c])})))}}).call(this)},{"./style.js":217}],215:[function(e,t,n){(function(){var n;n=e("./style.js"),t.exports=function(e,t,r,a){var o,i,s;return o=function(t){var n,r;return e.labels.value&&!t.d3po.label?(r=t.d3po.r?2*t.d3po.r:t.d3po.width,n=t.d3po.r?2*t.d3po.r:t.d3po.height,t.d3po_label={w:r,h:n,x:0,y:0},t.d3po_share={w:r,h:n,x:0,y:0},t.d3po_label.shape="circle"===t.d3po.shape?"circle":"square"):t.d3po.label?t.d3po_label=t.d3po.label:delete t.d3po_label,[t]},i=function(e){return e.attr("x",(function(e){return e.d3po.init&&"x"in e.d3po.init?e.d3po.init.x:e.d3po.init&&"width"in e.d3po.init?-e.d3po.width/2:0})).attr("y",(function(e){return e.d3po.init&&"y"in e.d3po.init?e.d3po.init.y:e.d3po.init&&"height"in e.d3po.init?-e.d3po.height/2:0})).attr("width",(function(e){return e.d3po.init&&"width"in e.d3po.init?e.d3po.init.width:0})).attr("height",(function(e){return e.d3po.init&&"height"in e.d3po.init?e.d3po.init.height:0}))},s=function(t){return t.attr("x",(function(e){return-(e.d3po.r?2*e.d3po.r:e.d3po.width)/2})).attr("y",(function(e){return-(e.d3po.r?2*e.d3po.r:e.d3po.height)/2})).attr("width",(function(e){return e.d3po.r?2*e.d3po.r:e.d3po.width})).attr("height",(function(e){return e.d3po.r?2*e.d3po.r:e.d3po.height})).attr("rx",(function(e){var t,n;return t="circle"===e.d3po.shape,n=e.d3po.r?2*e.d3po.r:e.d3po.width,t?(n+2)/2:0})).attr("ry",(function(e){var t,n;return n="circle"===e.d3po.shape,t=e.d3po.r?2*e.d3po.r:e.d3po.height,n?(t+2)/2:0})).attr("transform",(function(e){return"rotate"in e.d3po?"rotate("+e.d3po.rotate+")":""})).attr("shape-rendering",(function(t){return"square"!==t.d3po.shape||"rotate"in t.d3po?"auto":e.shape.rendering.value}))},e.draw.timing?(r.append("rect").attr("class","d3po_data").call(i).call(n,e),t.selectAll("rect.d3po_data").data(o).transition().duration(e.draw.timing).call(s).call(n,e),a.selectAll("rect.d3po_data").transition().duration(e.draw.timing).call(i)):(r.append("rect").attr("class","d3po_data"),t.selectAll("rect.d3po_data").data(o).call(s).call(n,e))}}).call(this)},{"./style.js":217}],216:[function(e,t,n){(function(){var n;n=e("../../../core/fetch/value.js"),t.exports=function(e,t,r){var a;return(a=e[r].value)?r in t.d3po?t.d3po[r]:n(e,t,a):t.d3po[r]}}).call(this)},{"../../../core/fetch/value.js":61}],217:[function(e,t,n){(function(){var n,r,a;n=e("./color.js"),r=e("../../../client/ie.js"),a=e("../../../core/fetch/value.js"),t.exports=function(e,t){return e.attr("fill",(function(e){return e.d3po&&e.d3po.spline?"none":n(e,t)})).style("stroke",(function(e){var r;return e.d3po&&e.d3po.stroke?e.d3po.stroke:(r=e.values?n(e.values[0],t):n(e,t,!0),d3.rgb(r).darker(.6))})).style("stroke-width",(function(e){var n;if(r&&t.types[t.type.value].zoom)return 0;if("line"===e.d3po.shape&&t.size.value){if(t.size.value.constructor===Number)return t.size.value;if((n=a(t,e,t.size.value))&&n.length)return d3.max(n)}return t.data.stroke.width})).attr("opacity",t.data.opacity).attr("vector-effect","non-scaling-stroke")}}).call(this)},{"../../../client/ie.js":32,"../../../core/fetch/value.js":61,"./color.js":206}],218:[function(e,t,n){(function(){t.exports=function(e,t,n,r){var a,o,i,s,l,u,c,d,f;o=function(e){return e.d3po.text?e.d3po_label={w:d,h:d,x:0,y:0,background:"#fff",resize:!1,angle:["left","right"].indexOf(e.d3po.position)>=0?90:0}:e.d3po.label?e.d3po_label=e.d3po.label:delete e.d3po_label,[e]},f=function(t){return t.style("stroke-width",e.data.stroke.width).style("stroke","#444").attr("fill","none").attr("shape-rendering",e.shape.rendering.value)},i=function(e){return e.attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",0)},c=function(e){return e.attr("x1",(function(e){var t,n;return["top","bottom"].indexOf(e.d3po.position)>=0?0:(t=e.d3po.offset||0,n=e.d3po.width||0,(t<0?-n:n)+t)})).attr("x2",(function(e){return["top","bottom"].indexOf(e.d3po.position)>=0?0:e.d3po.offset||0})).attr("y1",(function(e){var t,n;return["left","right"].indexOf(e.d3po.position)>=0?0:(n=e.d3po.offset||0,t=e.d3po.height||0,(n<0?-t:t)+n)})).attr("y2",(function(e){return["left","right"].indexOf(e.d3po.position)>=0?0:e.d3po.offset||0})).attr("marker-start","url(#d3po_whisker_marker)")},(s=e.defs.selectAll("#d3po_whisker_marker").data([0])).enter().append("marker").attr("id","d3po_whisker_marker").attr("markerUnits","userSpaceOnUse").style("overflow","visible").append("line"),(a=t.datum())?(u=a.d3po.position,l=["top","bottom"].indexOf(u)>=0?"horizontal":"vertical",d="horizontal"===l?a.d3po.width:a.d3po.height):(l="horizontal",d=0),s.select("line").attr("x1","horizontal"===l?-d/2:0).attr("x2","horizontal"===l?d/2:0).attr("y1","vertical"===l?-d/2:0).attr("y2","vertical"===l?d/2:0).call(f).style("stroke-width",2*e.data.stroke.width),e.draw.timing?(n.append("line").attr("class","d3po_data").call(f).call(i),t.selectAll("line.d3po_data").data(o).transition().duration(e.draw.timing).call(f).call(c),r.selectAll("line.d3po_data").transition().duration(e.draw.timing).call(i)):(n.append("line").attr("class","d3po_data"),t.selectAll("line.d3po_data").data(o).call(f).call(c))}}).call(this)},{}],219:[function(e,t,n){var r=e("../../../client/pointer.js"),a=e("../../../client/prefix.js"),o=e("../../../core/console/print.js"),i=e("../../../client/touch.js"),s=e("../zoom/propagation.js");t.exports=function(e){e.dev.value&&o.time("creating SVG elements"),e.svg=e.container.value.selectAll("svg#d3po").data([0]),e.svg.enter().insert("svg","#d3po_message").attr("id","d3po").attr("width",e.width.value).attr("height",e.height.value).attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink"),e.g.bg=e.svg.selectAll("rect#bg").data(["bg"]),e.g.bg.enter().append("rect").attr("id","bg").attr("fill",e.background.value).attr("stroke","none").attr("width",e.width.value).attr("height",e.height.value),e.g.legend=e.svg.selectAll("g#key").data(["key"]),e.g.legend.enter().append("g").attr("id","key").attr("transform","translate(0,"+e.height.value+")"),e.g.footer=e.svg.selectAll("g#footer").data(["footer"]),e.g.footer.enter().append("g").attr("id","footer").attr("transform","translate(0,"+e.height.value+")");var t="clipping_"+e.container.id;e.g.clipping=e.svg.selectAll("#clipping").data(["clipping"]),e.g.clipping.enter().append("clipPath").attr("id",t).append("rect").attr("width",e.width.viz).attr("height",e.height.viz),e.g.container=e.svg.selectAll("g#container").data(["container"]),e.g.container.enter().append("g").attr("id","container").attr("clip-path","url(#"+t+")").attr("transform","translate("+e.margin.left+","+e.margin.top+")"),e.g.zoom=e.g.container.selectAll("g#zoom").data(["zoom"]),e.g.zoom.enter().append("g").attr("id","zoom"),e.g.viz=e.g.zoom.selectAll("g#d3po_viz").data(["d3po_viz"]),e.g.viz.enter().append("g").attr("id","d3po_viz"),e.g.overlay=e.g.viz.selectAll("rect#d3po_overlay").data([{id:"d3po_overlay"}]),e.g.overlay.enter().append("rect").attr("id","d3po_overlay").attr("width",e.width.value).attr("height",e.height.value).attr("opacity",0),e.g.overlay.on(r.move,(function(t){i&&s(e,d3.event),e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?d3.select(this).style("cursor",a()+"grab"):d3.select(this).style("cursor","auto")})).on(r.up,(function(t){i&&s(e,d3.event),e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?d3.select(this).style("cursor",a()+"grab"):d3.select(this).style("cursor","auto")})).on(r.down,(function(t){i&&s(e,d3.event),e.types[e.type.value].zoom&&e.zoom.pan.value&&e.zoom.behavior.scaleExtent()[0]<e.zoom.scale?d3.select(this).style("cursor",a()+"grabbing"):d3.select(this).style("cursor","auto")})),e.g.app=e.g.viz.selectAll("g#app").data(["app"]),e.g.app.enter().append("g").attr("id","app"),e.g.edges=e.g.viz.selectAll("g#edges").data(["edges"]),e.g.edges.enter().append("g").attr("id","edges").attr("opacity",0),e.g.edge_focus=e.g.viz.selectAll("g#focus").data(["focus"]),e.g.edge_focus.enter().append("g").attr("id","focus"),e.g.edge_hover=e.g.viz.selectAll("g#edge_hover").data(["edge_hover"]),e.g.edge_hover.enter().append("g").attr("id","edge_hover").attr("opacity",0),e.g.data=e.g.viz.selectAll("g#data").data(["data"]),e.g.data.enter().append("g").attr("id","data").attr("opacity",0),e.g.data_focus=e.g.viz.selectAll("g#data_focus").data(["data_focus"]),e.g.data_focus.enter().append("g").attr("id","data_focus"),e.g.labels=e.g.viz.selectAll("g#d3po_labels").data(["d3po_labels"]),e.g.labels.enter().append("g").attr("id","d3po_labels"),e.defs=e.svg.selectAll("defs").data(["defs"]),e.defs.enter().append("defs"),e.dev.value&&o.timeEnd("creating SVG elements")}},{"../../../client/pointer.js":33,"../../../client/prefix.js":34,"../../../client/touch.js":38,"../../../core/console/print.js":47,"../zoom/propagation.js":234}],220:[function(e,t,n){var r=e("../../../core/console/print.js");t.exports=function(e){e.dev.value&&r.time("updating SVG elements"),e.draw.timing?(e.container.value.transition().duration(e.draw.timing).style("width",e.width.value+"px").style("height",e.height.value+"px"),e.svg.transition().duration(e.draw.timing).attr("width",e.width.value).attr("height",e.height.value),e.g.bg.transition().duration(e.draw.timing).attr("width",e.width.value).attr("height",e.height.value).attr("fill",e.background.value),e.g.clipping.select("rect").transition().duration(e.draw.timing).attr("width",e.width.viz).attr("height",e.height.viz),e.g.container.transition().duration(e.draw.timing).attr("transform","translate("+e.margin.left+","+e.margin.top+")")):(e.container.value.style("width",e.width.value+"px").style("height",e.height.value+"px"),e.svg.attr("width",e.width.value).attr("height",e.height.value),e.g.bg.attr("width",e.width.value).attr("height",e.height.value).attr("fill",e.background.value),e.g.clipping.select("rect").attr("width",e.width.viz).attr("height",e.height.viz),e.g.container.attr("transform","translate("+e.margin.left+","+e.margin.top+")")),e.dev.value&&r.timeEnd("updating SVG elements")}},{"../../../core/console/print.js":47}],221:[function(e,t,n){var r=e("../../../array/sort.js"),a=e("../../../tooltip/create.js"),o=e("../../../core/data/nest.js"),i=e("./data.js"),s=e("../../../core/fetch/color.js"),l=e("../../../core/fetch/text.js"),u=e("../../../core/fetch/value.js"),c=e("../../../object/merge.js"),d=e("../../../tooltip/remove.js"),f=e("../shapes/segments.js"),p=e("../../../client/scroll.js"),h=e("../../../util/uniques.js"),v=e("../../../object/validate.js"),g=e("../zoom/direction.js");t.exports=function(e){"d3po"in e.data||(e.data.d3po={});var t=e.vars,n=e.data,m="d3po"in n&&"depth"in n.d3po?n.d3po.depth:t.depth.value,y=(e.ex,!!e.mouseevents&&e.mouseevents),x=!("arrow"in e)||e.arrow,b=u(t,n,t.id.value),j=e.id||t.type.value;if(d3.event&&"click"==d3.event.type&&(t.tooltip.html.value||t.tooltip.value.long)&&!("fullscreen"in e)){var w=!0,_=(x=!1,y=!0,"long"),k=t.footer.value;t.covered=!0}else{w=!1;var z=e.anchor||t.tooltip.anchor,A=(_=e.length||"short",g(n,t));if(-1===A){var M=t.id.nesting[m-1];u(t,b,M)}var O="";if(t.mouse.click.value&&(!t.mouse.viz||!1!==t.mouse.viz.click))if(1===A&&t.zoom.value)O=t.format.value(t.format.locale.value.ui.expand);else if(-1===A&&t.zoom.value&&t.history.states.length&&!t.tooltip.value.long)O=t.format.value(t.format.locale.value.ui.collapse);else if(t.small||"short"!=_||!t.tooltip.html.value&&!t.tooltip.value.long||1===t.focus.value.length&&t.focus.value[0]==b){if("long"==_)O=t.footer.value||""}else var O=t.format.locale.value.ui.moreInfo;k=!!O.length&&t.format.value(O,{key:"footer",vars:t})}if("x"in e)var F=e.x;else if("static"===t.types[t.type.value].tooltip){F=n.d3po.x;t.zoom.translate&&t.zoom.scale&&(F=t.zoom.translate[0]+F*t.zoom.scale),F+=t.margin.left,"long"!==e.length&&(E+=p.x(),F+=t.container.value.node().getBoundingClientRect().left,F+=parseFloat(t.container.value.style("padding-left"),10))}else F=d3.mouse(d3.select("html").node())[0];if("y"in e)var E=e.y;else if("static"==t.types[t.type.value].tooltip){E=n.d3po.y;t.zoom.translate&&t.zoom.scale&&(E=t.zoom.translate[1]+E*t.zoom.scale),E+=t.margin.top,"long"!==e.length&&(E+=p.y(),E+=t.container.value.node().getBoundingClientRect().top,E+=parseFloat(t.container.value.style("padding-top"),10))}else E=d3.mouse(d3.select("html").node())[1];if("offset"in e)var S=e.offset;else if("static"==t.types[t.type.value].tooltip){S=n.d3po.r?n.d3po.r:n.d3po.height/2;t.zoom.scale&&(S*=t.zoom.scale)}else S=3;function B(p){var g,b="depth"in e?e.depth:m,A={},M=t.id.nesting[b+1]in n?b+1:b,O=t.id.nesting[M],B="merged"in n.d3po?n.d3po.merged:n[O];B instanceof Array||(B=[B]);var T=u(t,n,t.size.value);if(t.tooltip.children.value){if((B=B.slice(0)).length>1&&v(B[0])&&(B=o(t,B,[O])),t.size.value&&v(B[0])){var N=[],I=B.filter((function(e){if(!(null===u(t,e,t.size.value)||"d3po"in e&&e.d3po.merged))return!0;N.push(e)}));r(I,t.size.value,"desc",[],t),B=I.concat(N)}var C=!0===t.tooltip.children.value?3:t.tooltip.children.value,q="short"===_?C:t.data.large,V=B.length,D=d3.min([V,q]);g={values:[]};for(var U=0;U<D&&B.length;U++){var P=B.shift(),L=l(t,P,M)[0],R=v(P)?u(t,P,O,M):P;if(R!==n[t.id.nesting[b]]&&L&&!g[L]){var H=v(P)?u(t,P,t.size.value,O):null,Y=s(t,P,O);g[L]=!H||H instanceof Array?"":t.format.value(H,{key:t.size.value,vars:t,data:P});var X={};X[L]=g[L],g.values.push(X),Y&&(g.d3po_colors||(g.d3po_colors={}),g.d3po_colors[L]=Y)}else U--}V>D&&(g.d3poMore=V-D)}function G(e){return"string"==typeof t[e].value?t[e].value:t.format.locale.value.method[e]}n.d3po.tooltip&&(A=c(A,n.d3po.tooltip)),t.tooltip.size.value&&(T&&"number"!=typeof t.size.value&&(A[G("size")]=T),t.axes.opposite&&t[t.axes.opposite].value!==t.size.value&&(A[G(t.axes.opposite)]=u(t,n,t[t.axes.opposite].value)),t.axes.opposite&&t[t.axes.opposite+"2"].value!==t.size.value&&(A[G(t.axes.opposite+"2")]=u(t,n,t[t.axes.opposite+"2"].value)),t.color.valueScale&&(A[G("color")]=u(t,n,t.color.value)));var W=f(t,n,"active"),Q=f(t,n,"temp"),Z=f(t,n,"total");"number"==typeof W&&W>0&&Z&&(A[G("active")]=W+"/"+Z+" ("+t.format.value(W/Z*100,{key:"share",vars:t,data:n})+")"),"number"==typeof Q&&Q>0&&Z&&(A[G("temp")]=Q+"/"+Z+" ("+t.format.value(Q/Z*100,{key:"share",vars:t,data:n})+")"),t.tooltip.share.value&&n.d3po.share&&(A.share=t.format.value(100*n.d3po.share,{key:"share",vars:t,data:n}));M="depth"in e?e.depth:m;var K=e.title||l(t,n,M)[0],J=h(n,t.icon.value,u,t,t.id.nesting[M]),$=e.titleOnly?[]:i(t,n,_,A,g,M);if(J=1===J.length&&"string"==typeof J[0]&&J[0],$.length>0||k||!n.d3po_label&&"short"==_&&K||n.d3po_label&&(!("visible"in n.d3po_label)||"visible"in n.d3po_label&&!1===n.d3po_label.visible)){if(K||(K=t.format.value(R,{key:t.id.value,vars:t})),(M="d3po"in n&&"merged"in n.d3po?m-1:"depth"in e?e.depth:m)<0&&(M=0),M=t.id.nesting[M],"string"==typeof t.icon.style.value)var ee=t.icon.style.value;else if("object"==typeof t.icon.style.value&&t.icon.style.value[M])ee=t.icon.style.value[M];else ee="default";var te=t.tooltip.small;e.width?te=e.width:w&&(te=t.tooltip.large);var ne=!w&&"long"!==e.length||w&&t.tooltip.fullscreen.value?d3.select("body"):t.container.value;!e.description&&n&&t.tooltip.sub.value&&(e.description=u(t,n,t.tooltip.sub.value)),a({align:z,arrow:x,locale:t.format.locale.value,background:t.tooltip.background,curtain:t.tooltip.curtain.color,curtainopacity:t.tooltip.curtain.opacity,fontcolor:t.tooltip.font.color,fontfamily:t.tooltip.font.family.value,fontsize:t.tooltip.font.size,fontweight:t.tooltip.font.weight,data:$,color:s(t,n),allColors:!0,footer:!1===e.footer?e.footer:k,fullscreen:w,html:p,js:e.js,icon:J,id:j,max_height:e.maxheight,max_width:te,mouseevents:y,offset:S,parent:ne,stacked:t.tooltip.stacked.value,style:ee,title:K,description:e.description,width:e.width||w||0!=$.length?te:"auto",x:F,y:E})}else d(j)}if(w||"long"===e.length)if("string"==typeof t.tooltip.html.value)B(t.tooltip.html.value);else if("function"==typeof t.tooltip.html.value)B(t.tooltip.html.value(b));else if(t.tooltip.html.value&&"object"==typeof t.tooltip.html.value&&t.tooltip.html.value.url){var T=t.tooltip.html.value.url;"function"==typeof T&&(T=T(b)),d3.json(T,(function(e){B(t.tooltip.html.value.callback?t.tooltip.html.value.callback(e):e)}))}else B(e.html);else B(e.html)}},{"../../../array/sort.js":29,"../../../client/scroll.js":36,"../../../core/data/nest.js":54,"../../../core/fetch/color.js":57,"../../../core/fetch/text.js":60,"../../../core/fetch/value.js":61,"../../../object/merge.js":157,"../../../object/validate.js":158,"../../../tooltip/create.js":187,"../../../tooltip/remove.js":189,"../../../util/uniques.js":196,"../shapes/segments.js":216,"../zoom/direction.js":231,"./data.js":222}],222:[function(e,t,n){var r=e("../../../util/copy.js"),a=e("../../../core/fetch/value.js"),o=e("../../../core/fetch/color.js"),i=e("../../../core/fetch/text.js"),s=e("../../../color/legible.js"),l=e("../../../object/merge.js"),u=e("../../../client/prefix.js"),c=e("../../../string/format.js"),d=e("../../../object/validate.js");t.exports=function(e,t,n,f,p,h){if(e.small)return[];if(!n)n="long";if("long"==n)var v="short";else v="long";var g={};if(f&&"string"==typeof f)f=[f];else if(f&&"object"==typeof f){g=l(g,f);f=[];for(var m in g)f.push(m)}else if(!f)f=[];var y=[];if(e.tooltip.value instanceof Array)var x=e.tooltip.value;else if("string"==typeof e.tooltip.value)x=[e.tooltip.value];else{if(e.tooltip.value[e.id.nesting[h]])x=e.tooltip.value[e.id.nesting[h]];else x=e.tooltip.value;x instanceof Array||(x=x[n]?x[n]:x[v]?[]:l({"":[]},x)),"string"==typeof x?x=[x]:x instanceof Array||(x=l({"":[]},x))}function b(n,r){if(e.attrs.value[r])var o=r;else o=null;r&&(r=e.format.value(r));var i=g[n]||a(e,t,n,o);if(d(i))j.push({name:e.format.value(n),value:e.format.value(i.value,{key:i.key,vars:e}),group:r});else if(null!=i&&"undefined"!=i&&!(i instanceof Array)&&("string"==typeof i&&i.indexOf("d3po_other")<0||"string"!=typeof i)){var s=e.format.locale.value.ui[n]?e.format.value(e.format.locale.value.ui[n]):e.format.value(n),l=y.indexOf(n)>=0;i instanceof Array?i.forEach((function(r){r=e.format.value(r,{key:n,vars:e,data:t})})):i=e.format.value(i,{key:n,vars:e,data:t});var u={name:s,value:i,highlight:l,group:r};if(e.descs.value)if("function"==typeof e.descs.value){var c=e.descs.value(n);"string"==typeof c&&(u.desc=c)}else n in e.descs.value&&(u.desc=e.descs.value[n]);j.push(u)}}var j=[];if(x.constructor===Array&&(x={"":x}),e.id.nesting.length&&h<e.id.nesting.length-1){x=r(x);e.id.nesting.forEach((function(e,t){t>h&&x[e]&&delete x[e]}))}for(var w in x){x[w].constructor!==Array&&(x[w]=[x[w]]);for(var _=f.length;_>0;_--)x[w].indexOf(f[_-1])>=0&&f.splice(_-1,1)}if(e.tooltip.value.long&&"object"==typeof e.tooltip.value.long){for(var w in e.tooltip.value.long)for(_=f.length;_>0;_--){var k=f[_-1];e.tooltip.value.long[w].indexOf(k)>=0&&(x[w]||(x[w]=[]),x[w].push(k),f.splice(_-1,1))}}for(var w in f.length&&(x[""]||(x[""]=[]),x[""]=x[""].concat(f)),x)x[w].forEach((function(e){b(e,w)}));if(p){var z=e.format.locale.value.ui.including,A=p.d3po_colors;p.values.forEach((function(t){var n=d3.keys(t)[0];j.push({group:e.format.value(z),highlight:!(!A||!A[n])&&A[n],name:n,value:t[n]})})),p.d3poMore&&j.push({group:e.format.value(z),highlight:!0,name:c(e.format.locale.value.ui.more,p.d3poMore),value:""})}if(e.tooltip.connections.value&&"long"===n){var M=e.edges.connections(t[e.id.value],e.id.value,!0);M.length&&M.forEach((function(t){var n=(n=e.data.viz.filter((function(n){return n[e.id.value]===t[e.id.value]}))).length?n[0]:t,r=i(e,n)[0],a=o(e,n),l=e.tooltip.font.size,c="square"==e.shape.value?0:l;styles=["background-color: "+a,"border-color: "+s(a),"border-style: solid","border-width: "+e.data.stroke.width+"px","display: inline-block","height: "+l+"px","left: 0px","position: absolute","width: "+l+"px","top: 0px",u()+"border-radius: "+c+"px"],node="<div style='"+styles.join("; ")+";'></div>";j.push({group:e.format.value(e.format.locale.value.ui.primary),highlight:!1,link:function(){e.self.focus([n[e.id.value]]).draw()},name:"<div id='d3potooltipfocuslink_"+n[e.id.value]+"' class='d3po_tooltip_focus_link' style='position:relative;padding-left:"+1.5*l+"px;'>"+node+r+"</div>"})}))}return j}},{"../../../client/prefix.js":34,"../../../color/legible.js":39,"../../../core/fetch/color.js":57,"../../../core/fetch/text.js":60,"../../../core/fetch/value.js":61,"../../../object/merge.js":157,"../../../object/validate.js":158,"../../../string/format.js":159,"../../../util/copy.js":193}],223:[function(e,t,n){(function(){var n;n=e("../../../core/console/print.js"),t.exports=function(e){var t,r,a,o,i,s,l,u,c;if(e.group=e.g.apps[e.type.value],e.mouse.viz=!1,e.edges.path=!1,o=!(a=((c=e.types[e.type.value]).requirements||[]).indexOf("data")>=0)||a&&e.data.viz.length,!e.error.internal&&o){for(t=e.format.locale.value.visualization[e.type.value],e.dev.value&&n.time("running "+t),i=0,s=(l=e.data.viz).length;i<s;i++)(r=l[i]).d3po&&(delete r.d3po.shape,delete r.d3po.label,delete r.d3po.rotate,delete r.d3po.share);u=c(e),e.dev.value&&n.timeEnd("running "+t)}else u=null;e.returned={nodes:[],edges:null},u instanceof Array?e.returned.nodes=u:u&&(u.nodes&&(e.returned.nodes=u.nodes),u.edges&&(e.returned.edges=u.edges))}}).call(this)},{"../../../core/console/print.js":47}],224:[function(e,t,n){var r=e("../../../util/copy.js"),a=e("../../../form/form.js"),o=e("../../../core/console/print.js"),i=e("../../../object/validate.js");t.exports=function(e){var t=e.ui.value&&e.ui.value.length,n=e.ui.position.value;e.dev.value&&t&&o.time("drawing custom UI elements");var s=e.container.value.selectAll("div#d3po_drawer").data(["d3po_drawer"]);s.enter().append("div").attr("id","d3po_drawer");var l={};e.ui.position.accepted.forEach((function(t){l[t]=t==n?e.margin.bottom+"px":"auto"})),s.style("text-align",e.ui.align.value).style("position","absolute").style("width",e.width.value-2*e.ui.padding+"px").style("height","auto").style(l);var u=s.selectAll("div.d3po_drawer_ui").data(t?e.ui.value:[],(function(e){return e.method||!1}));u.exit().remove(),u.enter().append("div").attr("class","d3po_drawer_ui").style("display","inline-block"),u.style("padding",e.ui.padding+"px").each((function(t){var n,o;t.form||(t.form=a().container(d3.select(this)).data({sort:!1}).id("id").text("text")),"string"==typeof t.method&&t.method in e?(n=e[t.method].value,o=function(n){n!==e[t.method].value&&e.self[t.method](n).draw()}):(n=t.focus||t.value[0],i(n)&&(n=n[d3.keys(n)[0]]),"function"==typeof t.method&&(o=function(r){r!==n&&(n=r,t.focus=r,t.method(r,e.self))}));var s,l=[];t.label?s=t.label:"string"==typeof t.method&&t.method in e&&(s=e.format.locale.value.method[t.method]||t.method),t.value.forEach((function(t){var n={};i(t)?(n.id=t[d3.keys(t)[0]],n.text=e.format.value(d3.keys(t)[0])):(n.id=t,n.text=e.format.value(t)),l.push(n)}));var u=r(e.ui.font);u.align=r(e.font.align),u.secondary=r(u),t.form.data(l).font(u).focus(t.value.length>1&&n).focus({callback:o}).format(e.format.locale.language).format({number:e.format.number.value,text:e.format.text.value}).title(e.format.value(s)).type(t.type||"auto").ui({align:e.ui.align.value,border:e.ui.border,color:{primary:e.ui.color.primary.value,secondary:e.ui.color.secondary.value},padding:e.ui.padding,margin:0}).width(t.width||!1).draw()}));var c=s.node().offsetHeight||s.node().getBoundingClientRect().height;c&&(e.margin[n]+=c),e.dev.value&&t&&o.timeEnd("drawing custom UI elements")}},{"../../../core/console/print.js":47,"../../../form/form.js":90,"../../../object/validate.js":158,"../../../util/copy.js":193}],225:[function(e,t,n){(function(){var n,r,a,o;n=e("../../../client/pointer.js"),r=e("../../../color/lighter.js"),a=e("../../../core/console/print.js"),o=e("../../../client/css.js"),t.exports=function(e){var t,i,s,l,u,c,d,f,p,h,v,g,m,y;return!e.small&&e.history.value&&e.history.states.length>0?(e.dev.value&&a.time("drawing back button"),t=e.container.value.selectAll("div#d3po_back_button").data(["d3po_back_button"]).style("position","relative").style("z-index",1900),f=e.title.sub.font.size,i=e.title.sub.font.color,l=e.title.sub.font.family.value,y=e.title.sub.font.weight,d=e.title.sub.padding,v=!1,e.title.sub.value&&["start","left"].indexOf(e.title.sub.font.align)<0?v="sub":e.title.total.value&&["start","left"].indexOf(e.title.total.font.align)<0?v="total":e.title.value&&["start","left"].indexOf(e.title.font.align)<0&&(v="title"),v?(p=function(e){var t;return t=(t=(t=(t=e.attr("transform").match(/translate\(([^a-z]+)\)/gi)[0]).replace(/([^a-z])\s([^a-z])/gi,"$1,$2")).split(","))[t.length-1],parseFloat(t.substring(0,t.length-1))},g=e.svg.select(".d3po_title."+v),m=p(g)+p(g.select("text"))):(m=e.margin.top-e.title.padding,c=f+2*d,e.margin.top+=c),s=parseFloat(e.container.value.style("padding-top"),10),m+=s,s=parseFloat(e.container.value.style("padding-left"),10),u=e.margin.left+f/2+s,h=function(e){return e.style("position","absolute").style("left",u+"px").style("top",m+"px").style("color",i).style("font-family",l).style("font-weight",y).style("font-size",f+"px")},t.enter().append("div").attr("id","d3po_back_button").style("opacity",0).call(h).html((function(){var t;return o("font-awesome")&&0===e.icon.back.value.indexOf("fa-")?(t="<i class='fa "+e.icon.back.value,t+="' style='margin-top:2px;margin-right:4px;'></i>"):t=e.icon.back.value+" ",t+e.format.value(e.format.locale.value.ui.back)})),t.on(n.over,(function(){if(!e.small&&e.history.states.length>0)return d3.select(this).style("cursor","pointer").transition().duration(e.timing.mouseevents).style("color",r(i,.25))})).on(n.out,(function(){if(!e.small&&e.history.states.length>0)return d3.select(this).style("cursor","auto").transition().duration(e.timing.mouseevents).style("color",i)})).on(n.click,(function(){return e.history.back()})).transition().duration(e.draw.timing).style("opacity",1).call(h),e.dev.value?a.timeEnd("drawing back button"):void 0):e.container.value.selectAll("div#d3po_back_button").transition().duration(e.draw.timing).style("opacity",0).remove()}}).call(this)},{"../../../client/css.js":31,"../../../client/pointer.js":33,"../../../color/lighter.js":40,"../../../core/console/print.js":47}],226:[function(e,t,n){var r=e("../../../array/sort.js"),a=e("../../../util/buckets.js"),o=e("../../../util/copy.js"),i=e("../tooltip/create.js"),s=e("../../../core/data/nest.js"),l=e("../../../util/dataurl.js"),u=e("../../../client/pointer.js"),c=e("../../../core/fetch/value.js"),d=e("../../../core/fetch/color.js"),f=e("../../../core/fetch/text.js"),p=e("../../../core/console/print.js"),h=e("../../../tooltip/remove.js"),v=e("../../../color/text.js"),g=e("../../../util/uniques.js"),m=e("../../../client/scroll.js"),y=e("../../../string/strip.js"),x=e("../../../textwrap/textwrap.js"),b=(e("../../../client/touch.js"),e("../../../object/validate.js"));t.exports=function(e){var t=!0,n=0;if(!e.error.internal&&e.color.value&&!e.small&&e.legend.value)if(e.color.valueScale)if(e.color.valueScale){e.dev.value&&p.time("drawing color scale"),e.g.legend.selectAll("g.d3po_color").transition().duration(e.draw.timing).attr("opacity",0).remove();var j=e.color.valueScale.domain();P=e.color.valueScale.range();j.length<=2&&(j=a(j,6));var w=e.g.legend.selectAll("g.d3po_scale").data(["scale"]);w.enter().append("g").attr("class","d3po_scale").attr("opacity",0);var _=e.container.id+"_legend_heatmap",k=w.selectAll("#"+_).data(["heatmap"]);k.enter().append("linearGradient").attr("id",_).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("spreadMethod","pad");var z=k.selectAll("stop").data(d3.range(0,P.length));z.enter().append("stop").attr("stop-opacity",1),z.attr("offset",(function(e){return Math.round(e/(P.length-1)*100)+"%"})).attr("stop-color",(function(e){return P[e]})),z.exit().remove();var A=w.selectAll("rect#gradient").data(["gradient"]);A.enter().append("rect").attr("id","gradient").attr("x",(function(t){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0})).attr("y",e.ui.padding).attr("width",0).attr("height",e.legend.gradient.height).attr("stroke",e.legend.font.color).attr("stroke-width",1).style("fill","url(#"+_+")");var M=w.selectAll("text.d3po_tick").data(d3.range(0,j.length));M.enter().append("text").attr("class","d3po_tick").attr("stroke","none").attr("x",(function(t){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0})).attr("y",(function(t){return this.getBBox().height+e.legend.gradient.height+2*e.ui.padding}));var O=0;if(M.order().attr("font-weight",e.legend.font.weight).attr("font-family",e.legend.font.family.value).attr("font-size",e.legend.font.size+"px").style("text-anchor",e.legend.font.align).attr("fill",e.legend.font.color).text((function(t){return e.format.value(j[t],{key:e.color.value,vars:e})})).attr("y",(function(t){return this.getBBox().height+e.legend.gradient.height+2*e.ui.padding})).each((function(e){var t=Math.ceil(this.getBBox().width);t>O&&(O=t)})),O+=2*e.labels.padding,(R=O*(j.length-1))+O<e.width.value){R+O<e.width.value/2&&(R=e.width.value/2,O=R/j.length,R-=O),X="start"==e.legend.align?e.ui.padding:"end"==e.legend.align?e.width.value-e.ui.padding-R:e.width.value/2-R/2,M.transition().duration(e.draw.timing).attr("x",(function(e){return X+O*e})),M.exit().transition().duration(e.draw.timing).attr("opacity",0).remove();var F=w.selectAll("rect.d3po_tick").data(d3.range(0,j.length));F.enter().append("rect").attr("class","d3po_tick").attr("x",(function(t){return"middle"==e.legend.align?e.width.value/2:"end"==e.legend.align?e.width.value:0})).attr("y",e.ui.padding).attr("width",0).attr("height",e.ui.padding+e.legend.gradient.height).attr("fill",e.legend.font.color),F.transition().duration(e.draw.timing).attr("x",(function(e){return X+O*e-(0===e?1:0)})).attr("y",e.ui.padding).attr("width",1).attr("height",e.ui.padding+e.legend.gradient.height).attr("fill",e.legend.font.color),F.exit().transition().duration(e.draw.timing).attr("width",0).remove(),A.transition().duration(e.draw.timing).attr("x",(function(t){return"middle"==e.legend.align?e.width.value/2-R/2:"end"==e.legend.align?e.width.value-R-e.ui.padding:e.ui.padding})).attr("y",e.ui.padding).attr("width",R).attr("height",e.legend.gradient.height),w.transition().duration(e.draw.timing).attr("opacity",1),e.dev.value&&p.timeEnd("drawing color scale")}else t=!1}else t=!1;else{var E;if(e.dev.value&&p.time("grouping data by colors"),e.nodes.value&&e.types[e.type.value].requirements.indexOf("nodes")>=0){if(E=o(e.nodes.restriced||e.nodes.value),e.data.viz.length)for(var S=0;S<E.length;S++){var B=e.data.viz.filter((function(t){return t[e.id.value]===E[S][e.id.value]}));B.length&&(E[S]=B[0])}}else E=e.data.viz;E.length&&"key"in E[0]&&"values"in E[0]&&(E=d3.merge(E.map((function(e){return e.values}))));var T=function(t){return d(e,t,N)},N=0,I=e.id.value,C=e.id.nesting.indexOf(e.color.value);if(C>=0)N=C,I=e.id.nesting[C];else for(var q=0;q<=e.depth.value;q++){N=q,I=e.id.nesting[q];var V=g(E,(function(t){return c(e,t,I)})),D=g(E,T);if(V.length>=D.length&&D.length>1)break}var U=[e.color.value],P=s(e,E,U,!1);e.dev.value&&p.timeEnd("grouping data by color");var L=e.width.value,R=(n=e.legend.size)*P.length+e.ui.padding*(P.length+1);if(n instanceof Array){e.dev.value&&p.time("calculating legend size");for(S=n[1];S>=n[0];S--)if(L>=(R=S*P.length+e.ui.padding*(P.length+1))){n=S;break}e.dev.value&&p.timeEnd("calculating legend size")}else"number"!=typeof n&&!1!==n&&(n=30);if(L<R||1==P.length)t=!1;else{if(R-=2*e.ui.padding,e.dev.value&&p.time("sorting legend"),"function"==typeof e.legend.order.value)P=e.legend.order.value(P);else{var H=e[e.legend.order.value].value,Y=e.color.value;H?"color"!==e.legend.order.value&&(Y=[]):H=e[e.color.value].value,r(P,H,e.legend.order.sort.value,Y,e,N)}var X;function G(t){t.attr("transform",(function(t,r){return"translate("+(X+r*(e.ui.padding+n))+","+e.ui.padding+")"}))}function W(t){t.attr("width",n).attr("height",n).attr("fill",(function(t){d3.select(this.parentNode).select("text").remove();var r,a=g(t,e.icon.value,c,e,I),o=d(e,t,I);if(e.legend.icons.value&&1===a.length&&"string"==typeof a[0]){a=a[0];var i=y(a+"_"+o),s=e.icon.style.value,u=e.defs.selectAll("pattern#"+i).data([i]);o="knockout"==("string"==typeof s?e.icon.style.value:b(s)&&s[I]?s[I]:"default")?o:"none",u.select("rect").transition().duration(e.draw.timing).attr("fill",o).attr("width",n).attr("height",n),u.select("image").transition().duration(e.draw.timing).attr("width",n).attr("height",n);var p=u.enter().append("pattern").attr("id",i).attr("width",n).attr("height",n);return p.append("rect").attr("fill",o).attr("stroke","none").attr("width",n).attr("height",n),p.append("image").attr("xlink:href",a).attr("width",n).attr("height",n).each((function(e){0===a.indexOf("/")||a.indexOf(window.location.hostname)>=0?l(a,(function(e){u.select("image").attr("xlink:href",e)})):u.select("image").attr("xlink:href",a)})),"url(#"+i+")"}if(e.legend.labels.value&&1===(r=e.legend.text.value?[c(e,t,e.legend.text.value,N)]:f(e,t,N)).length&&!(r[0]instanceof Array)&&r[0].length){var h=d3.select(this.parentNode).append("text"),m=e.legend.font.size;m instanceof Array||(m=[m]),h.attr("font-size",m[m.length-1]+"px").attr("font-weight",e.legend.font.weight).attr("font-family",e.legend.font.family.value).attr("stroke","none").attr("fill",v(o)).attr("x",0).attr("y",0).each((function(t){x().align("middle").container(d3.select(this)).height(n).padding(e.ui.padding).resize(m.length>1).size(m).text(r[0]).width(n).valign("middle").draw()})),h.select("tspan").empty()&&h.remove()}return o}))}e.dev.value&&p.timeEnd("sorting legend"),e.dev.value&&p.time("drawing legend"),X="start"==e.legend.align?e.ui.padding:"end"==e.legend.align?L-e.ui.padding-R:L/2-R/2,e.g.legend.selectAll("g.d3po_scale").transition().duration(e.draw.timing).attr("opacity",0).remove();var Q={},Z=e.g.legend.selectAll("g.d3po_color").data(P,(function(t){var n=d(e,t,I);return n in Q||(Q[n]=-1),Q[n]++,Q[n]+"_"+n}));Z.enter().append("g").attr("class","d3po_color").attr("opacity",0).call(G).append("rect").attr("class","d3po_color").attr("stroke","none").call(W),Z.order().transition().duration(e.draw.timing).call(G).attr("opacity",1).selectAll("rect.d3po_color").call(W),Z.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),e.legend.tooltip.value&&Z.on(u.over,(function(t,r){d3.select(this).style("cursor","pointer");var a,o,s,l=this.getBoundingClientRect(),d=l.left+n/2+m.x(),p=l.top+n/2+m.y()+5,h=c(e,t,I),v=e.id.nesting.indexOf(I);if(a=e.legend.title.value?c(e,t,e.legend.title.value,N):v>=0?f(e,t,v)[0]:e.format.value(c(e,t,e.color.value,I),{key:e.color.value,vars:e,data:t}),e.legend.filters.value&&!(h instanceof Array)){o="<div style='text-align:center;'>";var g=e.format.locale.value;o+="<div class='mute'>"+e.format.value(g.method.mute)+"</div>",o+="<div class='solo'>"+e.format.value(g.method.solo)+"</div>",o+="</div>",s=function(t){var n={border:"1px solid #ccc",display:"inline-block",margin:"1px 2px",padding:"3px 5px"};t.select(".mute").style(n).on(u.over,(function(){d3.select(this).style("cursor","pointer")})).on(u.click,(function(){var t=e.id.mute.value;e.history.states.push((function(){e.self.id({mute:t}).draw()})),e.self.id({mute:h}).draw()})),t.select(".solo").style(n).on(u.over,(function(){d3.select(this).style("cursor","pointer")})).on(u.click,(function(){var t=e.id.solo.value;e.history.states.push((function(){e.self.id({solo:t}).draw()})),e.self.id({solo:h}).draw()}))}}i({data:t,html:o,js:s,depth:N,footer:!1,vars:e,x:d,y:p,mouseevents:this,title:a,titleOnly:!e.legend.data.value,offset:.4*n})})).on(u.out,(function(t){h(e.type.value)})),e.dev.value&&p.timeEnd("drawing legend")}}else t=!1;if(e.legend.value&&key&&t){if(e.dev.value&&p.time("positioning legend"),n)var K=n+e.ui.padding;else{var J=e.g.legend.node().getBBox();K=J.height+J.y}0===e.margin.bottom&&(e.margin.bottom+=e.ui.padding),e.margin.bottom+=K,e.g.legend.transition().duration(e.draw.timing).attr("transform","translate(0,"+(e.height.value-e.margin.bottom)+")"),e.dev.value&&p.timeEnd("positioning legend")}else e.dev.value&&p.time("hiding legend"),e.g.legend.transition().duration(e.draw.timing).attr("transform","translate(0,"+e.height.value+")"),e.dev.value&&p.timeEnd("hiding legend")}},{"../../../array/sort.js":29,"../../../client/pointer.js":33,"../../../client/scroll.js":36,"../../../client/touch.js":38,"../../../color/text.js":45,"../../../core/console/print.js":47,"../../../core/data/nest.js":54,"../../../core/fetch/color.js":57,"../../../core/fetch/text.js":60,"../../../core/fetch/value.js":61,"../../../object/validate.js":158,"../../../string/strip.js":161,"../../../textwrap/textwrap.js":186,"../../../tooltip/remove.js":189,"../../../util/buckets.js":190,"../../../util/copy.js":193,"../../../util/dataurl.js":195,"../../../util/uniques.js":196,"../tooltip/create.js":221}],227:[function(e,t,n){t.exports=function(e,t){function n(e){e.on("mouseover",(function(){d3.select(this).style("background-color","rgb(214, 214, 214)")})).on("mouseout",(function(){d3.select(this).style("background-color","rgb(244, 244, 244)")}))}var r,a,o,i,s=e.margin.top>30?e.margin.top-30:e.margin.top;return r={position:"absolute",display:"flex","align-items":"center","justify-content":"center","font-size":"18px","font-family":"sans-serif",color:"rgb(68, 68, 68)","background-color":"rgb(244, 244, 244)","border-radius":"3px",border:"1px solid rgb(144, 144, 144)",height:"30px",padding:"0 5px","z-index":3e3},(o=e.container.value.selectAll("div.d3po_menu").data([0]).enter().append("div").attr("class","d3po_menu").attr("name","download")).append("div").style(r).style("right",e.margin.right+"px").style("top",s+"px").style("cursor","pointer").call(n).on("click",(function(){i.style("opacity")>0?i.transition().duration(100).style("opacity",0):i.transition().duration(100).style("opacity",1)})).append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("width",24).attr("height",24).append("path").attr("d","M4 7a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H5a1 1 0 0 1-1-1zm0 5a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H5a1 1 0 0 1-1-1zm0 5a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H5a1 1 0 0 1-1-1z").attr("fill","#0D0D0D").on("click",(function(){i.style("opacity")>0?i.transition().duration(100).style("opacity",0):i.transition().duration(100).style("opacity",1)})),a={display:"flex","align-items":"center","justify-content":"left",color:"rgb(68, 68, 68)","border-radius":"3px",height:"30px",padding:"0 10px"},(i=o.append("div").style(r).style("display","block").style("right",e.margin.right+"px").style("top",s+30+"px").style("font-size","12px").style("min-width","130px").style("height","auto").style("padding",0).style("opacity",0)).append("div").style(a).style("cursor","pointer").html("Download SVG image").call(n).on("click",(function(){var t=e.svg.node().outerHTML,n=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),r=URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download="diagram.svg",document.body.appendChild(a),a.click(),document.body.removeChild(a)})),o}},{}],228:[function(e,t,n){e("../../../client/pointer.js");var r=e("../../../color/text.js");t.exports=function(e,t){t=e.messages.value?t:null;var n=e.messages.style.value||(t===e.error.internal?"large":e.messages.style.backup);if("large"===n)var a=e.messages,o="center";else{if(e.footer.value)a=e.footer;else if(e.title.value)a=e.title;else if(e.title.sub.value)a=e.title.sub;else if(e.title.total.value)a=e.title.total;else a=e.title.sub;o=a.position}a={color:a.font.color,"font-family":a.font.family.value,"font-weight":a.font.weight,"font-size":a.font.size+"px",padding:a.padding+"px"};var i=e.messages.background.value;i||"none"!==(i=e.background.value)&&"transparent"!==i||(i=r(a.color)),e.g.message=e.container.value.selectAll("div#d3po_message").data(["message"]),e.g.message.enter().append("div").attr("id","d3po_message").attr("opacity",0).append("div").attr("class","d3po_message_text").style("display","block"),e.g.message.select(".d3po_message_text").text(t||e.g.message.text());navigator.onLine;e.g.message.style("display",t?"inline-block":"none").call((function(t){t.style(a).style("position","absolute").style("background-color",i).style("text-align","center").style("left",(function(){return"center"==o?"50%":"0px"})).style("width",(function(){return"center"==o?"auto":e.width.value+"px"})).style("margin-left",(function(){return"center"==o?-this.offsetWidth/2+"px":"0px"})).style("top",(function(){return"center"==o?"50%":"top"==o?"0px":"auto"})).style("bottom",(function(){return"bottom"==o?"0px":"auto"})).style("margin-top",(function(){return"large"==n?-(this.offsetHeight||this.getBoundingClientRect().height)/2+"px":"0px"}))})).style("opacity",t?1:0)}},{"../../../client/pointer.js":33,"../../../color/text.js":45}],229:[function(e,t,n){var r=e("../../../client/pointer.js"),a=e("../../../core/fetch/value.js"),o=e("../../../core/console/print.js"),i=e("../../../client/rtl.js"),s=e("../../../textwrap/textwrap.js");t.exports=function(e){var t=e.size.value?e.size.value:"number"===e.color.type&&e.color.value;if(e.data.viz&&e.title.total.value&&!e.small)if(t){e.dev.value&&o.time("calculating total value");var n=e.data.pool;e.focus.value.length&&(n=e.data.viz.filter((function(t){return t[e.id.value]==e.focus.value[0]})));var l=e.aggs.value[t]||"sum";if(l.constructor===Function?p=l(n):(n=n.reduce((function(n,r){var o=a(e,r,t);return o instanceof Array?n=n.concat(o):n.push(o),n}),[]),p=d3[l](n)),0!==p&&null!=p||(p=!1),"number"==typeof p){var u="";if(e.data.mute.length||e.data.solo.length||e.focus.value.length){var c=d3.sum(e.data.value,(function(n){if(e.time.solo.value.length>0)var r=e.time.solo.value.indexOf(a(e,n,e.time.value))>=0;else if(e.time.mute.value.length>0)r=e.time.solo.value.indexOf(a(e,n,e.time.value))<0;else r=!0;if(r)return a(e,n,t)}));if(c>p){u=p/c*100;var d=e.format.value(c,{key:e.size.value,vars:e});u=" ("+e.format.value(u,{key:"share",vars:e})+" "+e.format.locale.value.dev.of+" "+d+")"}}p=e.format.value(p,{key:e.size.value,vars:e});var f=e.title.total.value;p=(f.prefix||e.format.value(e.format.locale.value.ui.total)+": ")+p,f.suffix&&(p+=f.suffix),p+=u}e.dev.value&&o.timeEnd("calculating total value")}else p=!1;else var p=!1;var h=[];if(e.footer.value&&h.push({link:e.footer.link,style:e.footer,type:"footer",value:e.footer.value}),!e.small){var v;if(e.title.value)"function"==typeof(v=e.title.value)&&(v=v(e.self)),h.push({link:e.title.link,style:e.title,type:"title",value:v});if(e.title.sub.value)"function"==typeof(v=e.title.sub.value)&&(v=v(e.self)),h.push({link:e.title.sub.link,style:e.title.sub,type:"sub",value:v});e.title.total.value&&p&&h.push({link:e.title.total.link,style:e.title.total,type:"total",value:p})}function g(t){t.attr("font-size",(function(e){return e.style.font.size})).attr("fill",(function(t){return t.link?e.links.font.color:t.style.font.color})).attr("font-family",(function(t){return t.link?e.links.font.family.value:t.style.font.family.value})).attr("font-weight",(function(t){return t.link?e.links.font.weight:t.style.font.weight})).style("text-decoration",(function(t){return t.link?e.links.font.decoration.value:t.style.font.decoration.value})).style("text-transform",(function(t){return t.link?e.links.font.transform.value:t.style.font.transform.value}))}e.dev.value&&o.time("drawing titles");var m=e.svg.selectAll("g.d3po_title").data(h,(function(e){return e.type})),y=e.title.width||e.width.value-e.margin.left-e.margin.right;function x(e){var t=e.style.font.align;return"center"==t?"middle":"left"==t&&!i||"right"==t&&i?"start":"left"==t&&i||"right"==t&&!i?"end":t}m.enter().append("g").attr("class",(function(e){return"d3po_title "+e.type})).attr("opacity",0).append("text").attr("stroke","none").call(g),m.each((function(t){var n=d3.select(this).select("text").call(g),r=x(t);s().align(r).container(n).height(e.height.value/2).size(!1).text(t.value).width(y).draw(),t.y=e.margin[t.style.position],e.margin[t.style.position]+=this.getBBox().height+2*t.style.padding})).on(r.over,(function(t){t.link&&d3.select(this).transition().duration(e.timing.mouseevents).style("cursor","pointer").select("text").attr("fill",e.links.hover.color).attr("font-family",e.links.hover.family.value).attr("font-weight",e.links.hover.weight).style("text-decoration",e.links.hover.decoration.value).style("text-transform",e.links.hover.transform.value)})).on(r.out,(function(t){t.link&&d3.select(this).transition().duration(e.timing.mouseevents).style("cursor","auto").select("text").call(g)})).on(r.click,(function(e){if(e.link){var t="/"!=e.link.charAt(0)?"_blank":"_self";window.open(e.link,t)}})).attr("opacity",1).attr("transform",(function(t){var n=t.style.position,r="top"==n?0+t.y:e.height.value-t.y;"bottom"==n?r-=this.getBBox().height+t.style.padding:r+=t.style.padding;var a=x(t);if("start"===a)var o=e.margin.left+e.title.padding;else{d3.select(this).select("text").node().getBBox().width;o="middle"===a?e.width.value/2-y/2:e.width.value-y-e.margin.right-e.title.padding}return"translate("+o+","+r+")"})),m.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),e.margin.top>0&&(e.margin.top+=e.title.padding),e.margin.bottom>0&&(e.margin.bottom+=e.title.padding);var b=e.title.height;b&&e.margin[e.title.position]<b&&(e.margin[e.title.position]=b),e.dev.value&&o.timeEnd("drawing titles")}},{"../../../client/pointer.js":33,"../../../client/rtl.js":35,"../../../core/console/print.js":47,"../../../core/fetch/value.js":61,"../../../textwrap/textwrap.js":186}],230:[function(e,t,n){(function(){var n,r;n=e("./labels.js"),r=e("./transform.js"),t.exports=function(e,t,a){var o,i,s,l,u,c,d,f;return t||(t=e.zoom.bounds),"number"!=typeof a&&(a=e.timing.transitions),e.zoom.size={height:t[1][1]-t[0][1],width:t[1][0]-t[0][0]},f=e.types[e.type.value],o="auto"===(s=e.coords.fit.value)||f.requirements.indexOf("coords")<0?d3.max([e.zoom.size.width/e.width.viz,e.zoom.size.height/e.height.viz]):e.zoom.size[s]/e["app_"+s],c=((u=d3.min([e.width.viz,e.height.viz]))-(f.zoom?2*e.coords.padding:0))/u/o,(i=e.zoom.behavior.scaleExtent())[0]!==i[1]&&t!==e.zoom.bounds||e.zoom.behavior.scaleExtent([c,16*c]),c>(l=e.zoom.behavior.scaleExtent()[1])&&(c=l),e.zoom.scale=c,d=[e.width.viz/2-e.zoom.size.width*c/2-t[0][0]*c,e.height.viz/2-e.zoom.size.height*c/2-t[0][1]*c],e.zoom.translate=d,e.zoom.behavior.translate(d).scale(c),e.zoom.size={height:e.zoom.bounds[1][1]-e.zoom.bounds[0][1],width:e.zoom.bounds[1][0]-e.zoom.bounds[0][0]},e.zoom.reset=!1,(e.labels.value||e.labels.changed)&&n(e),r(e,a)}}).call(this)},{"./labels.js":232,"./transform.js":235}],231:[function(e,t,n){(function(){t.exports=function(e,t){var n,r,a;return r=t.id.nesting.length-1,n=t.depth.value,a=t.id.nesting[n+1],!1===t.types[t.type.value].nesting?0:!(e.d3po.merged||a in e&&n<r)||e&&!(a in e)?!(n===r&&n>0||e&&a&&!(a in e))||!t.small&&t.tooltip.html.value?0:-1:1}}).call(this)},{}],232:[function(e,t,n){(function(){var n;n=e("../../../core/console/print.js"),t.exports=function(e){var t,r;if(e.dev.value&&n.time("determining label visibility"),r=e.zoom.behavior.scaleExtent(),t=function(t){return t.attr("opacity",(function(t){var n;return t||(t={}),n=parseFloat(d3.select(this).attr("font-size"),10),t.visible=n*(e.zoom.scale/r[1])>=2,t.visible?1:0}))},e.draw.timing?e.g.viz.selectAll("text.d3po_label").transition().duration(e.draw.timing).call(t):e.g.viz.selectAll("text.d3po_label").call(t),e.dev.value)return n.timeEnd("determining label visibility")}}).call(this)},{"../../../core/console/print.js":47}],233:[function(e,t,n){(function(){var n,r,a;n=e("./labels.js"),r=e("../../../tooltip/remove.js"),a=e("./transform.js"),t.exports=function(e){var t,o,i,s,l,u,c,d,f,p,h;return o=d3.event.sourceEvent?d3.event.sourceEvent.type:null,l=d3.event.translate,s=d3.event.scale,i=e.zoom.bounds,c=(d=(e.width.viz-e.zoom.size.width*s)/2)>0?d:0,u=d>0?e.width.viz-d:e.width.viz,p=(h=(e.height.viz-e.zoom.size.height*s)/2)>0?h:0,f=h>0?e.height.viz-h:e.height.viz,l[0]+i[0][0]*s>c?l[0]=-i[0][0]*s+c:l[0]+i[1][0]*s<u&&(l[0]=u-i[1][0]*s),l[1]+i[0][1]*s>p?l[1]=-i[0][1]*s+p:l[1]+i[1][1]*s<f&&(l[1]=f-i[1][1]*s),e.zoom.behavior.translate(l).scale(s),e.zoom.translate=l,e.zoom.scale=s,"wheel"===o&&r(e.type.value),(e.labels.value||e.labels.changed)&&("wheel"===o?(t=e.draw.timing?100:250,clearTimeout(e.zoom.wheel),e.zoom.wheel=setTimeout((function(){return n(e)}),t)):n(e)),a(e,"dblclick"===o?e.timing.transitions:0)}}).call(this)},{"../../../tooltip/remove.js":189,"./labels.js":232,"./transform.js":235}],234:[function(e,t,n){(function(){t.exports=function(e,t){var n,r,a;r=e.zoom,t||(t=d3.event),a=r.scale>r.behavior.scaleExtent()[0],n=e.types[e.type.value].zoom&&r.value&&r.scroll.value,t.touches&&t.touches.length>1&&n||a||t.stopPropagation()}}).call(this)},{}],235:[function(e,t,n){(function(){t.exports=function(e,t){var n;return"number"!=typeof t&&(t=e.timing.transitions),n="translate("+e.zoom.translate+")",n+="scale("+e.zoom.scale+")",t?e.g.viz.transition().duration(t).attr("transform",n):e.g.viz.attr("transform",n)}}).call(this)},{}],236:[function(e,t,n){(function(){var n;n=e("../../core/methods/filter.js"),t.exports={accepted:[!1,Function,Object,String],mute:n(!0),solo:n(!0),spotlight:{accepted:[Boolean],value:!1},value:!1}}).call(this)},{"../../core/methods/filter.js":67}],237:[function(e,t,n){(function(){t.exports={accepted:[Object],objectAccess:!1,value:{}}}).call(this)},{}],238:[function(e,t,n){(function(){var n;n=e("../../core/methods/process/data.js"),t.exports={accepted:[!1,Array,Object,String],delimiter:{accepted:String,value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},keys:{},process:n,value:!1}}).call(this)},{"../../core/methods/process/data.js":73}],239:[function(e,t,n){(function(){var n,r;n=e("../../core/methods/process/margin.js"),r=e("../../core/methods/rendering.js"),t.exports={background:{color:"#fafafa",rendering:r(),stroke:{color:"#ccc",width:1}},margin:{accepted:[Number,Object,String],process:function(e){var t;return void 0===e&&(e=this.value),t=e,n(e,this),t},value:10},mirror:{accepted:[Boolean],value:!1},ticks:{accepted:[Boolean],value:!0}}}).call(this)},{"../../core/methods/process/margin.js":76,"../../core/methods/rendering.js":78}],240:[function(e,t,n){(function(){t.exports={accepted:[String],value:"#ffffff"}}).call(this)},{}],241:[function(e,t,n){(function(){t.exports={accepted:[Function,String],value:!1}}).call(this)},{}],242:[function(e,t,n){(function(){var n,r;n=e("../../core/methods/filter.js"),r=e("../../color/scale.js"),t.exports={accepted:[!1,Array,Function,Object,String],domain:{accepted:[!1,Array],value:!1},focus:"#444444",heatmap:["#282F6B","#419391","#AFD5E8","#EACE3F","#B35C1E","#B22200"],missing:"#eeeeee",mute:n(!0),primary:"#d74b03",range:["#B22200","#FFEE8D","#759143"],scale:{accepted:[Array,Function,"d3po","category10","category20","category20b","category20c"],process:function(e){return e instanceof Array?d3.scale.ordinal().range(e):"d3po"===e?r:"string"==typeof e?d3.scale[e]():e},value:"d3po"},solo:n(!0),secondary:"#e5b3bb",value:!1}}).call(this)},{"../../color/scale.js":43,"../../core/methods/filter.js":67}],243:[function(e,t,n){t.exports={accepted:[Array,Function,String],index:{accepted:[Boolean],value:!0},process:function(e,t){return"string"==typeof e&&(e=[e]),e},value:!1}},{}],244:[function(e,t,n){arguments[4][94][0].apply(n,arguments)},{dup:94}],245:[function(e,t,n){(function(){var n;n=e("../../util/d3selection.js"),t.exports={accepted:[!1,Array,Object,String],id:"default",process:function(e,t){return!1!==e&&("default"===t.container.id&&t.self.container({id:"d3po_"+ +new Date}),n(e)?e.append("div"):e instanceof Array?d3.select(e[0][0]).append("div"):(this.selector=e,d3.select(e).append("div")))},value:!1}}).call(this)},{"../../util/d3selection.js":194}],246:[function(e,t,n){(function(){var n,r;n=e("../../core/methods/filter.js"),r=e("../../core/methods/process/data.js"),t.exports={accepted:[!1,Array,Function,Object,String],center:[0,0],filetype:{accepted:["json"],value:"json"},fit:{accepted:["auto","height","width"],value:"auto"},key:!1,mute:n(!1),padding:20,process:r,projection:{accepted:["albers","albersUsa","azimuthalEqualArea","azimuthalEquidistant","conicConformal","conicEqualArea","conicEquidistant","equirectangular","gnomonic","mercator","orthographic","stereographic","transverseMercator",Function],value:"mercator"},simplify:{accepted:[Boolean],value:!0},solo:n(!1),threshold:{accepted:[Number],value:.9},value:!1}}).call(this)},{"../../core/methods/filter.js":67,"../../core/methods/process/data.js":73}],247:[function(e,t,n){(function(){var n,r,a;n=e("../../core/fetch/value.js"),r=e("../../client/ie.js"),a=e("../../string/strip.js"),t.exports={accepted:[void 0,!0,Array,String],chainable:!1,data:[],process:function(e,t){var o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B,T,N,I,C,q,V,D;if(void 0===t.returned)return[];if((e=e||t.cols.value)instanceof Array?l=e:"string"==typeof e&&(l=[e]),c=[],q=[],t.title.value?("function"==typeof(C=t.title.value)&&(C=C(t.self)),250,C=(C=a(C)).substr(0,250)):C="d3po Visualization Data",!0===e)for(l=d3.keys(t.data.keys),c.push(l),h=0,m=(B=t.data.value).length;h<m;h++){for(d=B[h],I=[],v=0,y=l.length;v<y;v++)D=d[i=l[v]],"string"===t.data.keys[i]&&(D='"'+D+'"'),I.push(D);c.push(I)}else{for(l||(l=[t.id.value],t.time.value&&l.push(t.time.value),t.size.value&&l.push(t.size.value),t.text.value&&l.push(t.text.value)),g=0,x=l.length;g<x;g++)i=l[g],q.push(t.format.value(i));for(c.push(q),A=0,b=(T=t.returned.nodes).length;A<b;A++)if(null!=(O=T[A]).values&&O.values instanceof Array)for(M=0,j=(N=O.values).length;M<j;M++){for(D=N[M],I=[],F=0,w=l.length;F<w;F++)s=l[F],"string"==typeof(D=n(t,D,s))&&(D='"'+D+'"'),I.push(D);c.push(I)}else{for(I=[],E=0,_=l.length;E<_;E++)s=l[E],I.push(n(t,O,s));c.push(I)}}for(u="",p=S=0,k=c.length;S<k;p=++S)f=(i=c[p]).join(","),u+=p<c.length?f+"\n":f;return o=new Blob([u],{type:"text/csv;charset=utf-8;"}),r?navigator.msSaveBlob(o,C+".csv"):(z=document.createElement("a"),V=URL.createObjectURL(o),z.setAttribute("href",V),z.setAttribute("download",C+".csv"),z.style="visibility:hidden",document.body.appendChild(z),z.click(),document.body.removeChild(z)),this.data=c,l},value:void 0}}).call(this)},{"../../client/ie.js":32,"../../core/fetch/value.js":61,"../../string/strip.js":161}],248:[function(e,t,n){(function(){var n;n=e("../../core/methods/process/data.js"),t.exports={accepted:[!1,Array,Function,String],cache:{},delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},filters:[],keys:{},mute:[],large:400,opacity:.9,padding:{accepted:[Number],value:1},process:function(e,t){return n(e,t,this)},solo:[],stroke:{width:1},value:!1}}).call(this)},{"../../core/methods/process/data.js":73}],249:[function(e,t,n){(function(){t.exports={accepted:[Function,Number],value:0}}).call(this)},{}],250:[function(e,t,n){(function(){t.exports={accepted:[!1,Function,Object],value:!1}}).call(this)},{}],251:[function(e,t,n){arguments[4][98][0].apply(n,arguments)},{dup:98}],252:[function(e,t,n){var r=e("../../core/console/print.js"),a=e("../../string/format.js");t.exports={accepted:[void 0,Function],first:!0,frozen:!1,process:function(e,t){if(!1===this.initialized)return this.initialized=!0,e;if(void 0===e&&"function"==typeof this.value&&(e=this.value),!1===t.container.value){var n=t.format.locale.value.dev.setContainer;r.warning(n,"container")}else if(t.container.value.empty()){n=t.format.locale.value.dev.noContainer;var o=t.container.selector||"";r.warning(a(n,'"'+o+'"'),"container")}else t.dev.value&&r.time("total draw time"),t.container.value.call(t.self);if("function"==typeof e&&t.history.chain.length){var i={};t.history.chain.forEach((function(e){var t=e.method;delete e.method,i[t]=e})),e(i),t.history.chain=[]}return e},update:!0,value:void 0}},{"../../core/console/print.js":47,"../../string/format.js":159}],253:[function(e,t,n){var r=e("../../core/methods/process/data.js");t.exports={accepted:[!1,Array,Function,String],arrows:{accepted:[Boolean,Number],direction:{accepted:["source","target"],value:"target"},value:!1},color:"#d0d0d0",connections:function(e,t,n){var r=this;if(!r.value)return[];if(!t)t="id";var a=r.restricted||r.value,o=[];if(!e)return a;var i=a.filter((function(a){var i=!1;return a[r.source][t]==e?(i=!0,n&&o.push(a[r.target])):a[r.target][t]==e&&(i=!0,n&&o.push(a[r.source])),i}));return n?o:i},delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},interpolate:{accepted:["basis","cardinal","linear","monotone","step"],value:"basis"},label:!1,large:100,limit:{accepted:[!1,Function,Number],value:!1},opacity:{accepted:[Function,Number,String],min:{accepted:[Number],value:.25},scale:{accepted:[Function],value:d3.scale.linear()},value:1},process:r,size:{accepted:[!1,Number,String],min:1,scale:.5,value:!1},source:"source",strength:{accepted:[!1,Function,Number,String],value:!1},target:"target",value:!1}},{"../../core/methods/process/data.js":73}],254:[function(e,t,n){(function(){t.exports={accepted:[Boolean,String],value:!1}}).call(this)},{}],255:[function(e,t,n){(function(){t.exports={accepted:[!1,Array,Function,Number,String],process:function(e){return!1===e?[]:e instanceof Array?e:[e]},tooltip:{accepted:[Boolean],value:!0},value:[]}}).call(this)},{}],256:[function(e,t,n){(function(){var n,r,a,o;n=e("../../core/methods/font/align.js"),r=e("../../core/methods/font/decoration.js"),a=e("../../core/methods/font/family.js"),o=e("../../core/methods/font/transform.js"),t.exports={align:n(),color:"#444444",decoration:r(),family:a(),secondary:{align:n(),color:"#444444",decoration:r(),family:a(),size:12,spacing:0,transform:o(),weight:400},size:12,spacing:0,transform:o(),weight:400}}).call(this)},{"../../core/methods/font/align.js":68,"../../core/methods/font/decoration.js":69,"../../core/methods/font/family.js":70,"../../core/methods/font/transform.js":72}],257:[function(e,t,n){(function(){var n,r,a;r=e("../../core/methods/font/family.js"),n=e("../../core/methods/font/decoration.js"),a=e("../../core/methods/font/transform.js"),t.exports={accepted:[!1,Number,String],font:{align:"center",color:"#444",decoration:n(),family:r(),size:11,transform:a(),weight:400},link:!1,padding:0,position:"bottom",value:!1}}).call(this)},{"../../core/methods/font/decoration.js":69,"../../core/methods/font/family.js":70,"../../core/methods/font/transform.js":72}],258:[function(e,t,n){(function(){var n,r,a,o;n=e("../../number/format.js"),r=e("../../core/locale/locale.js"),a=e("../../object/merge.js"),o=e("../../string/title.js"),t.exports={accepted:[Function,String],affixes:{accepted:[Object],objectAccess:!1,value:{}},locale:{accepted:function(){return d3.keys(r)},process:function(e){var t;return"en_US",t=r.en_US,"en_US"!==e&&(t=a(t,r[e])),this.language=e,t},value:"en_US"},number:{accepted:[!1,Function],value:!1},process:function(e,t){if("string"==typeof e)t.self.format({locale:e});else if("function"==typeof e)return e;return this.value},text:{accepted:[!1,Function],value:!1},value:function(e,t){var r,a;return t||(t={}),t.locale||(t.locale=this.locale.value),(a=t.vars||{}).time&&a.time.value&&t.key===a.time.value?(r=e.constructor===Date?e:new Date(e),a.data.time.format(r)):"number"==typeof e?(this.number.value||n)(e,t):"string"==typeof e?(this.text.value||o)(e,t):JSON.stringify(e)}}}).call(this)},{"../../core/locale/locale.js":65,"../../number/format.js":156,"../../object/merge.js":157,"../../string/title.js":162}],259:[function(e,t,n){(function(){t.exports={accepted:[!1,Number],max:600,secondary:!1,small:200,value:!1}}).call(this)},{}],260:[function(e,t,n){(function(){var n,r,a,o,i,s,l,u;n=e("../../../core/methods/font/align.js"),r=e("../../../core/methods/font/decoration.js"),a=e("../../../core/methods/font/family.js"),o=e("../../../core/methods/filter.js"),s=e("../../../core/methods/font/position.js"),l=e("../../../core/methods/rendering.js"),u=e("../../../core/methods/font/transform.js"),i={x:"bottom",x2:"top",y:"left",y2:"right"},t.exports=function(e){return{accepted:[Array,Boolean,Function,Object,String],affixes:{accepted:[Boolean],separator:{accepted:[Boolean,Array],value:!0},value:!1},axis:{accepted:[Boolean],color:"#444",font:{color:!1,decoration:r(!1),family:a(""),size:!1,spacing:0,transform:u(!1),weight:!1},rendering:l(),value:!0},dataFilter:!0,domain:{accepted:[!1,Array],value:!1},grid:{accepted:[Boolean],color:"#ccc",rendering:l(),value:!0},label:{accepted:[Boolean,String],fetch:function(t){return!0===this.value?t.format.value(t[e].value,{key:e,vars:t}):this.value},font:{color:"#444",decoration:r(),family:a(),size:12,spacing:0,transform:u(),weight:400},padding:3,value:!0},lines:{accept:[!1,Array,Number,Object],dasharray:{accepted:[Array,String],process:function(e){return e instanceof Array&&(e=(e=e.filter((function(e){return!isNaN(e)}))).length?e.join(", "):"none"),e},value:"10, 10"},color:"#888",font:{align:n("right"),color:"#444",background:{accepted:[Boolean],value:!0},decoration:r(),family:a(),padding:{accepted:[Number],value:10},position:s("middle"),size:12,transform:u(),weight:400},process:Array,rendering:l(),width:1,value:[]},mouse:{accept:[Boolean],dasharray:{accepted:[Array,String],process:function(e){return e instanceof Array&&(e=(e=e.filter((function(e){return!isNaN(e)}))).length?e.join(", "):"none"),e},value:"none"},rendering:l(),width:2,value:!0},mute:o(!0),orient:{accepted:["top","right","bottom","left"],value:i[e]},padding:{accepted:[Number],value:.1},persist:{position:{accepted:[Boolean],value:!1},size:{accepted:[Boolean],value:!0}},range:{accepted:[!1,Array],value:!1},scale:{accepted:["linear","log","discrete","share"],process:function(t,n){var r,a,o,i;for(r=0,a=(o=["log","discrete","share"]).length;r<a;r++)(i=o[r])===t?n.axes[i]=e:n.axes[i]===e&&(n.axes[i]=!1);return"discrete"===t&&(n.axes.opposite=0===e.indexOf("x")?"y":"x"),t},value:"linear"},solo:o(!0),stacked:{accepted:[Boolean],process:function(t,n){return t||n.axes.stacked!==e?t&&(n.axes.stacked=e):n.axes.stacked=!1,t},value:!1},ticks:{accepted:[!1,Array],color:"#ccc",font:{color:"#666",decoration:r(),family:a(),size:10,spacing:0,transform:u(),weight:400},labels:{accepted:[Boolean,Array],value:!0},rendering:l(),size:10,width:1,value:!1},value:!1,zerofill:{accepted:[Boolean],value:!1}}}}).call(this)},{"../../../core/methods/filter.js":67,"../../../core/methods/font/align.js":68,"../../../core/methods/font/decoration.js":69,"../../../core/methods/font/family.js":70,"../../../core/methods/font/position.js":71,"../../../core/methods/font/transform.js":72,"../../../core/methods/rendering.js":78}],261:[function(e,t,n){(function(){t.exports={accepted:[Boolean],back:function(){if(this.states.length)return this.states.pop()()},chain:[],reset:function(){var e;for(e=[];this.states.length;)e.push(this.states.pop()());return e},states:[],value:!0}}).call(this)},{}],262:[function(e,t,n){(function(){var n;n=e("../../core/methods/process/icon.js"),t.exports={accepted:[!1,Array,Function,Object,String],back:{accepted:[!1,String],fallback:"&#x276e;",opacity:1,process:n,rotate:0,value:"fa-angle-left"},style:{accepted:[Object,String],value:"default"},value:!1}}).call(this)},{"../../core/methods/process/icon.js":75}],263:[function(e,t,n){(function(){var n;n=e("../../core/methods/filter.js"),t.exports={accepted:[Array,String],dataFilter:!0,grouping:{accepted:[Boolean],value:!0},mute:n(!0),nesting:["id"],solo:n(!0),value:"id"}}).call(this)},{"../../core/methods/filter.js":67}],264:[function(e,t,n){(function(){var n,r,a;n=e("../../core/methods/font/decoration.js"),r=e("../../core/methods/font/family.js"),a=e("../../core/methods/font/transform.js"),t.exports={accepted:[Boolean],align:{accepted:["start","middle","end","left","center","right"],process:function(e){var t;return(t=["left","center","right"].indexOf(e))>=0&&(e=this.accepted[t]),e},value:"center"},color:{accepted:[!1,String],value:!1},font:{decoration:n(),family:r(),size:11,transform:a(),weight:400},padding:7,resize:{accepted:[Boolean],value:!0},text:{accepted:[!1,Function,String],value:!1},segments:2,valign:{accepted:[!1,"top","middle","bottom"],value:"middle"},value:!0}}).call(this)},{"../../core/methods/font/decoration.js":69,"../../core/methods/font/family.js":70,"../../core/methods/font/transform.js":72}],265:[function(e,t,n){(function(){var n;n=e("../../core/methods/font/family.js"),t.exports={accepted:[Boolean],align:"middle",data:{accepted:[Boolean],value:!0},filters:{accepted:[Boolean],value:!1},font:{align:"middle",color:"#444444",family:n(),size:[8,14],weight:400},gradient:{height:10},icons:{accepted:[Boolean],value:!0},labels:{accepted:[Boolean],value:!0},order:{accepted:["color","id","size","text",Function],sort:{accepted:["asc","desc"],value:"asc"},value:"color"},size:[8,30],tooltip:{accepted:[Boolean],value:!0},text:{accepted:[!1,Function,String],value:!1},title:{accepted:[!1,Function,String],value:!1},value:!0}}).call(this)},{"../../core/methods/font/family.js":70}],266:[function(e,t,n){(function(){var n,r,a;n=e("../../core/methods/font/decoration.js"),r=e("../../core/methods/font/family.js"),a=e("../../core/methods/font/transform.js"),t.exports={font:{color:"#444444",decoration:n(),family:r(),transform:a(),weight:400},hover:{color:"#444444",decoration:n(),family:r(),transform:a(),weight:400}}}).call(this)},{"../../core/methods/font/decoration.js":69,"../../core/methods/font/family.js":70,"../../core/methods/font/transform.js":72}],267:[function(e,t,n){arguments[4][109][0].apply(n,arguments)},{"../../core/methods/process/margin.js":76,dup:109}],268:[function(e,t,n){(function(){var n,r,a;n=e("../../core/methods/font/decoration.js"),r=e("../../core/methods/font/family.js"),a=e("../../core/methods/font/transform.js"),t.exports={accepted:[Boolean,String],background:{accepted:[!1,String],value:!1},font:{color:"#444",decoration:n(),family:r(),size:16,transform:a(),weight:400},padding:5,style:{accepted:[!1,"small","large"],value:!1},value:!0}}).call(this)},{"../../core/methods/font/decoration.js":69,"../../core/methods/font/family.js":70,"../../core/methods/font/transform.js":72}],269:[function(e,t,n){(function(){t.exports={accepted:[Boolean],click:{accepted:[Boolean,Function],value:!0},move:{accepted:[Boolean,Function],value:!0},out:{accepted:[Boolean,Function],value:!0},over:{accepted:[Boolean,Function],value:!0},value:!0}}).call(this)},{}],270:[function(e,t,n){(function(){var n;n=e("../../core/methods/process/data.js"),t.exports={accepted:[!1,Array,Function,String],delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},overlap:.6,process:n,value:!1}}).call(this)},{"../../core/methods/process/data.js":73}],271:[function(e,t,n){(function(){t.exports={accepted:[Boolean,Function,String],agg:{accepted:[!1,Function,"sum","min","max","mean","median"],value:!1},sort:{accepted:["asc","desc"],value:"desc"},value:!1}}).call(this)},{}],272:[function(e,t,n){(function(){t.exports={accepted:[Boolean],value:!1,timeout:400,process:function(e,t){var n,r,a;return!!e&&(n=null,r=function(){var e,n,r;if(r=(n=t.container.value.node().parentNode.getBoundingClientRect()).width,e=n.height,t.self.width(r),t.self.height(e),t.width.changed||t.height.changed)return t.self.draw()},d3.select(window).on("resize."+t.container.id,(a=this,function(e){return clearTimeout(n),n=setTimeout(r,a.timeout)})),e)}}}).call(this)},{}],273:[function(e,t,n){(function(){var n;n=e("../../core/methods/rendering.js"),t.exports={accepted:function(e){var t;return!(t=e.types[e.type.value].shapes)||t instanceof Array||(t=[t]),t.length?t:["square"]},interpolate:{accepted:["basis","basis-open","cardinal","cardinal-open","linear","monotone","step","step-before","step-after"],value:"linear"},rendering:n(),value:!1}}).call(this)},{"../../core/methods/rendering.js":78}],274:[function(e,t,n){(function(){var n;n=e("../../core/methods/filter.js"),t.exports={accepted:[!1,Function,Number,Object,String],dataFilter:!0,mute:n(!0),scale:{accepted:[Function],domain:{min:{accepted:[!1,Number],value:!1},max:{accepted:[!1,Number],value:!1}},range:{max:{accepted:[Function,Number],value:function(e){return Math.floor(d3.max([d3.min([e.width.viz,e.height.viz])/15,6]))}},min:{accepted:[Function,Number],value:3}},value:d3.scale.sqrt()},solo:n(!0),threshold:{accepted:[Boolean,Function,Number],value:!1},value:!1}}).call(this)},{"../../core/methods/filter.js":67}],275:[function(e,t,n){(function(){t.exports={value:!1}}).call(this)},{}],276:[function(e,t,n){(function(){var n;n=e("../../core/methods/filter.js"),t.exports={accepted:[!1,Function,Object,String],mute:n(!0),solo:n(!0),value:!1}}).call(this)},{"../../core/methods/filter.js":67}],277:[function(e,t,n){(function(){var n;n=e("../../core/methods/filter.js"),t.exports={accepted:[Array,Boolean,Function,Object,String],nesting:!0,mute:n(!0),solo:n(!0),value:!1}}).call(this)},{"../../core/methods/filter.js":67}],278:[function(e,t,n){(function(){var n;n=e("../../core/methods/filter.js"),t.exports={accepted:[Array,Boolean,Function,Object,String],dataFilter:!0,fixed:{accepted:[Boolean],value:!1},format:{accepted:[!1,Array,Function,String],value:!1},mute:n(!1),solo:n(!1),value:!1}}).call(this)},{"../../core/methods/filter.js":67}],279:[function(e,t,n){(function(){t.exports={mouseevents:60,transitions:600,ui:200}}).call(this)},{}],280:[function(e,t,n){(function(){var n,r,a,o;n=e("../../core/methods/font/decoration.js"),r=e("../../core/methods/font/family.js"),o=e("../../core/methods/font/transform.js"),a=e("../../string/strip.js"),t.exports={accepted:[!1,Function,String],font:{align:"center",color:"#444444",decoration:n(),family:r(),size:20,transform:o(),weight:400},height:!1,link:!1,padding:2,position:"top",process:function(e,t){var n;return 0===t.container.id.indexOf("default")&&e&&(n=a(e).toLowerCase(),t.self.container({id:n})),e},sub:{accepted:[!1,Function,String],font:{align:"center",color:"#444444",decoration:n(),family:r(),size:12,transform:o(),weight:400},link:!1,padding:1,position:"top",value:!1},total:{accepted:[Boolean,Object],font:{align:"center",color:"#444444",decoration:n(),family:r(),size:12,transform:o(),weight:400,value:!1},link:!1,padding:1,position:"top",value:!1},width:!1,value:!1}}).call(this)},{"../../core/methods/font/decoration.js":69,"../../core/methods/font/family.js":70,"../../core/methods/font/transform.js":72,"../../string/strip.js":161}],281:[function(e,t,n){(function(){var n,r;n=e("../../core/methods/font/family.js"),r=e("../../core/methods/font/transform.js"),t.exports={accepted:[Boolean,Array,Function,Object,String],anchor:"top center",background:"#f4f4f4",children:{accepted:[Boolean,Number],value:!0},connections:{accepted:[Boolean],value:!0},curtain:{color:"#ddd",opacity:.8},extent:{accepted:[Boolean],value:!0},font:{color:"#444",family:n(),size:12,transform:r(),weight:400},fullscreen:{accepted:[Boolean],value:!1},html:{accepted:[!1,Function,Object,String],value:!1},iqr:{accepted:[Boolean],value:!0},large:250,share:{accepted:[Boolean],value:!0},size:{accepted:[Boolean],value:!0},small:225,stacked:{accepted:[Boolean],value:!1},sub:{accepted:[!1,Function,String],value:!1},value:!0}}).call(this)},{"../../core/methods/font/family.js":70,"../../core/methods/font/transform.js":72}],282:[function(e,t,n){arguments[4][276][0].apply(n,arguments)},{"../../core/methods/filter.js":67,dup:276}],283:[function(e,t,n){(function(){t.exports={accepted:function(e){return d3.keys(e.types)},mode:{accepted:function(e){return e.types[e.type.value].modes||[!1]},value:!1},value:"treemap"}}).call(this)},{}],284:[function(e,t,n){(function(){var n,r,a,o;a=e("../../core/methods/font/family.js"),n=e("../../core/methods/font/align.js"),r=e("../../core/methods/font/decoration.js"),o=e("../../core/methods/font/transform.js"),t.exports={accepted:[Array,Boolean],align:n("center"),border:1,color:{primary:{process:function(e,t){var n;return n=this.value,t.ui.color.secondary.value||(t.ui.color.secondary.value=d3.rgb(n).darker(.75).toString()),e},value:"#ffffff"},secondary:{value:!1}},display:{acceped:["block","inline-block"],value:"inline-block"},font:{align:"center",color:"#444",decoration:r(),family:a(),size:11,transform:o(),weight:400},margin:5,padding:5,position:{accepted:["top","right","bottom","left"],value:"bottom"},value:!1}}).call(this)},{"../../core/methods/font/align.js":68,"../../core/methods/font/decoration.js":69,"../../core/methods/font/family.js":70,"../../core/methods/font/transform.js":72}],285:[function(e,t,n){(function(){t.exports={accepted:[!1,Number],secondary:!1,small:200,value:!1}}).call(this)},{}],286:[function(e,t,n){t.exports={accepted:[Boolean],behavior:d3.behavior.zoom().scaleExtent([1,1]).duration(0),click:{accepted:[Boolean],value:!0},pan:{accepted:[Boolean],value:!0},scroll:{accepted:[Boolean],value:!0},value:!0}},{}],287:[function(e,t,n){(function(){var n,r,a,o,i,s,l;e("../../util/closest.js"),r=e("../../core/fetch/value.js"),a=e("./helpers/graph/draw.js"),o=e("./helpers/graph/nest.js"),i=e("../../array/sort.js"),s=e("./helpers/graph/stack.js"),l=e("../../core/data/threshold.js"),(n=function(e){var t,n,o,l,u,c,d,f,p,h;if(a(e,{buffer:e.axes.opposite,zero:!0}),e.x.domain.viz.concat(e.y.domain.viz).indexOf(void 0)>=0)return[];for(n=i(e.data.viz,null,null,null,e),o=e[e.axes.discrete],f=e[e.axes.opposite],l=0,c=n.length;l<c;l++)for((p=n[l]).d3po||(p.d3po={}),u=0,d=(h=p.values).length;u<d;u++)(t=h[u]).d3po||(t.d3po={}),t.d3po.x=o.scale.viz(r(e,t,o.value)),t.d3po.x+=e.axes.margin.viz.left,t.d3po.y=f.scale.viz(r(e,t,f.value)),t.d3po.y+=e.axes.margin.viz.top,t.d3po.merged instanceof Array&&(p.d3po.merged||(p.d3po.merged=[]),p.d3po.merged=p.d3po.merged.concat(t.d3po.merged)),t.d3po.text&&!p.d3po.text&&(p.d3po.text=t.d3po.text);return s(e,n)}).filter=function(e,t){return o(e,l(e,t,e[e.axes.discrete].value))},n.requirements=["data","x","y"],n.setup=function(e){var t,n,r;return e.axes.discrete||(t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"})),e[e.axes.discrete].zerofill.value||e.self[e.axes.discrete]({zerofill:!0}),e[e.axes.opposite].stacked.value||"stacked"!==e.type.value||e.self[e.axes.opposite]({stacked:!0}),r=e[e.axes.opposite],n=e.size,!r.value&&n.value||n.changed&&n.previous===r.value?e.self[e.axes.opposite](n.value):!n.value&&r.value||r.changed&&r.previous===n.value?e.self.size(r.value):void 0},n.shapes=["area"],n.threshold=function(e){return 20/e.height.viz},n.tooltip="static",t.exports=n}).call(this)},{"../../array/sort.js":29,"../../core/data/threshold.js":55,"../../core/fetch/value.js":61,"../../util/closest.js":192,"./helpers/graph/draw.js":291,"./helpers/graph/nest.js":297,"./helpers/graph/stack.js":298}],288:[function(e,t,n){(function(){var n,r,a,o,i,s,l,u=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};r=e("../../util/buckets.js"),a=e("../../core/fetch/value.js"),o=e("./helpers/graph/draw.js"),i=e("./helpers/graph/nest.js"),s=e("./helpers/graph/stack.js"),l=e("../../util/uniques.js"),(n=function(e){var t,n,i,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B,T,N,I,C,q,V,D,U,P,L,R,H,Y;if(v="x"===(f=e.axes.discrete)?"height":"width",R="x"===f?"width":"height",I=e.axes.opposite,i="x"===f?"left":"top",E="x"===f?"top":"left",o(e,{buffer:!0,zero:I}),e.x.domain.viz.concat(e.y.domain.viz).indexOf(void 0)>=0)return[];if(O=e.data.viz,e.axes.stacked)for(y=0,j=O.length;y<j;y++)V=O[y],s(e,V.values);for(P=e.axes[R]/e[e.axes.discrete].ticks.values.length,(q=e[e.axes.discrete].padding.value)<1&&(q*=P),2*q>P&&(q=.1*P),A=P-2*q,e.axes.stacked||(e[f].persist.position.value?(D=e[f].value,S=P/2-(A/=h=u.call(e.id.nesting,D)>=0?d3.max(O,(function(e){return e.values.length})):l(O,e.id.value,a,e).length)/2-q,H=d3.scale.ordinal(),1===h?H.domain([0]).range([0]):H.domain([0,h-1]).range([-S,S])):H=d3.scale.linear()),d=[],B=(T=e[I]).scale.viz.domain().slice(),0===I.indexOf("y")&&(B=B.reverse()),B[0]<=0&&B[1]>=0?Y=0:B[0]<0?Y(d3.max(B)):Y=d3.min(B),e[f].persist.position.value&&!e.axes.stacked&&(m=l(d3.merge(O.map((function(e){return e.values}))),e.id.value,a,e,e.id.value,!1),H.domain(m),1===m.length?H.range([0]):H.range(r(H.range(),m.length))),z=d3.max(O,(function(e){return e.values.length})),x=0,w=O.length;x<w;x++)for(C=O[x],e.axes.stacked?(t=1,F=A):e[f].persist.position.value?(t=h,F=A):(t=C.values.length,S=e[f].persist.size.value?P/2-(F=A/z)/2*(z-t)-F/2-q:P/2-(F=A/t)/2-q,H.domain([0,t-1]),H.range([-S,S])),g=b=0,_=(U=C.values).length;b<_;g=++b){if(c=U[g],T=e[I],M=e.axes.stacked?0:e[f].persist.position.value?H(a(e,c,e.id.value)):H(g%t),e.axes.stacked)L=c.d3po[I],n=c.d3po[I+"0"];else{if(null===(N=a(e,c,T.value))&&(T=e[I+"2"],N=a(e,c,T.value)),0===N)continue;"log"===T.scale.value&&(Y=N<0?-1:1),L=T.scale.viz(N),n=T.scale.viz(Y)}p=a(e,c,e[f].value),c.d3po[f]=e[f].scale.viz(p),c.d3po[f]+=e.axes.margin.viz[i]+M,k=n-L,c.d3po[I]=n-k/2,e.axes.stacked||(c.d3po[I]+=e.axes.margin.viz[E]),delete c.d3po.r,c.d3po[R]=F,c.d3po[v]=Math.abs(k),c.d3po.init={},c.d3po.init[I]=T.scale.viz(Y),c.d3po.init[I]-=c.d3po[I],c.d3po.init[I]+=e.axes.margin.viz[E],c.d3po.init[R]=c.d3po[R],e.text.value?delete c.d3po.label:c.d3po.label=!1,d.push(c)}return d}).filter=function(e,t){return i(e,t,e[e.axes.discrete].value)},n.requirements=["data","x","y"],n.setup=function(e){var t,n,r;return e.axes.discrete||(t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"})),r=e[e.axes.opposite],n=e.size,!r.value&&n.value||n.changed&&n.previous===r.value?e.self[e.axes.opposite](n.value):!n.value&&r.value||r.changed&&r.previous===n.value?e.self.size(r.value):void 0},n.shapes=["square"],t.exports=n}).call(this)},{"../../core/fetch/value.js":61,"../../util/buckets.js":190,"../../util/uniques.js":196,"./helpers/graph/draw.js":291,"./helpers/graph/nest.js":297,"./helpers/graph/stack.js":298}],289:[function(e,t,n){(function(){var n,r,a,o,i,s;r=e("../../core/fetch/value.js"),a=e("./helpers/graph/draw.js"),o=e("../../string/format.js"),i=e("../../string/strip.js"),s=e("../../util/uniques.js"),(n=function(e){var t,n,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M;return a(e,{buffer:!0}),e.x.domain.viz.concat(e.y.domain.viz).indexOf(void 0)>=0?[]:(l=e.axes.discrete,x=e.axes.opposite,n="x"===l?e.axes.margin.viz.left:e.axes.margin.viz.top,y="x"===x?e.axes.margin.viz.left:e.axes.margin.viz.top,u="x"===l?"height":"width",M="x"===l?"width":"height",z=e.axes[M]/e[l].ticks.values.length,k="number"==typeof(k=e.size.value)?k:100,z=d3.min([z-2*e.labels.padding,k]),(g=e.type.mode.value)instanceof Array||(g=[g,g]),h=function(t){var n,a,o;for(n in a={},e.data.keys)o=s(t,n,r,e),a[n]=1===o.length?o[0]:o;return a},m=!1,f=[],c=e.format.value(e.format.locale.value.ui.iqr),d=e.format.value(e.format.locale.value.ui.max),v=e.format.value(e.format.locale.value.ui.min),b=e.format.value(e.format.locale.value.ui.percentile),t=e.format.value(e.format.locale.value.ui.tukey_bottom),A=e.format.value(e.format.locale.value.ui.tukey_top),j=e.format.value(e.format.locale.value.ui.quartile_first),w=e.format.value(e.format.locale.value.ui.quartile_third),p=e.format.value(e.format.locale.value.ui.median),_=[],d3.nest().key((function(t){return r(e,t,e[l].value)})).rollup((function(a){var k,O,F,E,S,B,T,N,I,C,q,V,D,U,P,L,R,H,Y,X,G,W,Q,Z,K,J,$,ee,te;for(X=e[x].scale.viz,($=a.map((function(t){return r(e,t,e[x].value)}))).sort((function(e,t){return e-t})),s($),N=d3.quantile($,.25),P=d3.quantile($,.5),G=d3.quantile($,.75),W={},"tukey"===g[1]?(Q=G-1.5*(N-G),Z=A):"extent"===g[1]?(Q=d3.max($),Z=d):"number"==typeof g[1]&&(Q=d3.quantile($,(100-g[1])/100),Z=o(b,g[1])),Q=d3.min([d3.max($),Q]),e.tooltip.extent.value&&(W[Z]={key:e[x].value,value:Q}),e.tooltip.iqr.value&&(W[w]={key:e[x].value,value:G},W[p]={key:e[x].value,value:P},W[j]={key:e[x].value,value:N}),"tukey"===g[0]?(k=N+1.5*(N-G),O=t):"extent"===g[0]?(k=d3.min($),O=v):"number"==typeof g[0]&&(k=d3.quantile($,g[0]/100),Z=o(b,g[0])),k=d3.max([d3.min($),k]),e.tooltip.extent.value&&(W[O]={key:e[x].value,value:k}),E=[],F=[],K=[],Y=[],I=0,D=a.length;I<D;I++)S=a[I],(J=r(e,S,e[x].value))>=N&&J<=G?E.push(S):J>=k&&J<N?F.push(S):J<=Q&&J>G?K.push(S):Y.push(S);for(q=r(e,a[0],e[l].value),ee=e[l].scale.viz(q),ee+=n,V=e.format.value(q,{key:e[l].value,vars:e}),q.constructor===Date&&(q=q.getTime()),q=i(q),(E=h(E)).d3po={color:"white",id:"box_"+q,init:{},label:!1,shape:"square",stroke:"#444",text:o(c,V)},E.d3po[M]=z,E.d3po.init[M]=z,E.d3po[u]=Math.abs(X(N)-X(G)),E.d3po[l]=ee,te=d3.min([X(N),X(G)])+E.d3po[u]/2,te+=y,E.d3po[x]=te,E.d3po.tooltip=W,_.push(E),R={d3po:{id:"median_line_"+q,position:"height"===u?"top":"right",shape:"whisker",static:!0}},V={background:"#fff",names:[e.format.value(P,{key:e[x].value,vars:e})],padding:0,resize:!1,x:0,y:0},B=Math.abs(X(P)-X(N)),T=Math.abs(X(P)-X(G)),H=2*d3.min([B,T]),L=2*e.data.stroke.width+2*e.labels.padding,V["width"===M?"w":"h"]=z-L,V["width"===u?"w":"h"]=H-L,R.d3po.label=V,R.d3po[M]=z,R.d3po[l]=ee,R.d3po[x]=X(P)+y,_.push(R),(F=h(F)).d3po={id:"bottom_whisker_line_"+q,offset:E.d3po[u]/2,position:"height"===u?"bottom":"left",shape:"whisker",static:!0},"x"===x&&(F.d3po.offset*=-1),F.d3po[u]=Math.abs(X(k)-X(N)),F.d3po[M]=z,F.d3po[l]=ee,F.d3po[x]=te,_.push(F),(K=h(K)).d3po={id:"top_whisker_line_"+q,offset:E.d3po[u]/2,position:"height"===u?"top":"right",shape:"whisker",static:!0},"y"===x&&(K.d3po.offset*=-1),K.d3po[u]=Math.abs(X(Q)-X(G)),K.d3po[M]=z,K.d3po[l]=ee,K.d3po[x]=te,_.push(K),C=0,U=Y.length;C<U;C++)(S=Y[C]).d3po[l]=ee,S.d3po[x]=X(r(e,S,e.y.value)),S.d3po[x]+=y,S.d3po.r=4,S.d3po.shape=e.shape.value;return m=!Y.length&&Q-k==0,f.push(P),_=_.concat(Y),a})).entries(e.data.viz),m&&1===s(f).length?[]:_)}).modes=["tukey","extent",Array,Number],n.requirements=["data","x","y"],n.shapes=["circle","square"],n.setup=function(e){var t;if(!e.axes.discrete)return t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"})},t.exports=n}).call(this)},{"../../core/fetch/value.js":61,"../../string/format.js":159,"../../string/strip.js":161,"../../util/uniques.js":196,"./helpers/graph/draw.js":291}],290:[function(e,t,n){(function(){var n,r,a;n=e("../../../../core/fetch/color.js"),r=e("../../../../color/legible.js"),a=e("../../../../core/console/print.js"),t.exports=function(e){var t,o,i,s,l,u,c,d,f,p,h,v;for(t=e.axes,c=e.axes.margin.viz,v=2*(s=t.stacked||!t.ticks.value?[]:e.data.viz).length>e.data.large?0:e.draw.timing,f=function(a,o){return 0===o.indexOf("y")?a.attr("x1",-2).attr("x2",-8).attr("y1",(function(e){return e.d3po.y-c.top})).attr("y2",(function(e){return e.d3po.y-c.top})):a.attr("x1",(function(e){return e.d3po.x-c.left})).attr("x2",(function(e){return e.d3po.x-c.left})).attr("y1",t.height+2).attr("y2",t.height+8),a.style("stroke",(function(t){return r(n(e,t))})).style("stroke-width",e.data.stroke.width).attr("shape-rendering",e.shape.rendering.value)},e.dev.value&&a.time("creating axis tick groups"),(h=e.group.select("g#d3po_graph_plane").selectAll("g.d3po_data_tick").data(s,(function(n){var r;return r=t.discrete?"_"+n.d3po[t.discrete]:"","tick_"+n[e.id.value]+"_"+n.d3po.depth+r}))).enter().append("g").attr("class","d3po_data_tick").attr("opacity",0),e.dev.value&&a.timeEnd("creating axis tick groups"),l=0,u=(d=["x","y"]).length;l<u;l++)o=d[l],e.dev.value&&v&&a.time("creating "+o+" ticks"),i=v&&o!==t.discrete?s:[],p=h.selectAll("line.d3po_data_"+o).data(i,(function(t){return"tick_"+t[e.id.value]+"_"+t.d3po.depth})),e.dev.value&&v&&a.timeEnd("creating "+o+" ticks"),e.dev.value&&v&&a.time("styling "+o+" ticks"),v>0?p.transition().duration(v).call(f,o):p.call(f,o),p.enter().append("line").attr("class","d3po_data_"+o).call(f,o),e.dev.value&&v&&a.timeEnd("styling "+o+" ticks");v>0?(h.transition().duration(v).attr("opacity",1),h.exit().transition().duration(v).attr("opacity",0).remove()):(h.attr("opacity",1),h.exit().remove())}}).call(this)},{"../../../../color/legible.js":39,"../../../../core/console/print.js":47,"../../../../core/fetch/color.js":57}],291:[function(e,t,n){(function(){var n,r,a,o;n=e("./includes/axes.js"),r=e("./includes/svg.js"),a=e("./includes/mouse.js"),o=e("./includes/plot.js"),t.exports=function(e,t){void 0===t&&(t={}),n(e,t),o(e,t),r(e,t),e.mouse.viz=!0===t.mouse&&a}}).call(this)},{"./includes/axes.js":292,"./includes/mouse.js":294,"./includes/plot.js":295,"./includes/svg.js":296}],292:[function(e,t,n){(function(){var n,r,a,o,i,s,l,u,c,d,f,p;n=e("../../../../../array/sort.js"),o=e("./buffer.js"),a=e("../../../../../util/buckets.js"),s=e("../../../../../core/fetch/data.js"),l=e("../../../../../core/fetch/value.js"),d=e("../../../../../core/console/print.js"),p=e("../../../../../util/uniques.js"),t.exports=function(e,t){var n,a,s,h,v,g,m,y,x,b,j,w;for(!(s=i(e))&&e.axes.dataset||(e.axes.dataset=u(e)),e.axes.scale=!(!t.buffer||!0===t.buffer)&&f(e,t.buffer),v=0,m=(n=e.width.viz>e.height.viz?["y","y2","x","x2"]:["x","x2","y","y2"]).length;v<m;v++)x=0===(a=n[v]).indexOf("x")?"y":"x",j=e.order.changed||e.order.sort.changed||!0===e.order.value&&e[x].changed,e[a].value&&(!e[a].ticks.values||s||j||e[a].value===e.time.value&&e.time.fixed.value)&&(e.dev.value&&d.time("calculating "+a+" axis"),e[a].reset=!0,e[a].ticks.values=!1,a===e.axes.discrete&&e[a].value!==e.time.value&&(e[a].ticks.values=p(e.axes.dataset,e[a].value,l,e)),w=!0===t.zero||0===a.indexOf(t.zero),b=r(e,a,w),0===a.indexOf("y")&&(b=b.reverse()),e[a].scale.viz=c(e,a,b),e[a].domain.viz=b,e.dev.value&&d.timeEnd("calculating "+a+" axis"));if(e.axes.mirror.value&&(h=d3.extent(e.y.domain.viz.concat(e.x.domain.viz)),e.x.domain.viz=h,e.x.scale.viz.domain(h),h=h.slice().reverse(),e.y.domain.viz=h,e.y.scale.viz.domain(h)),t.buffer)for(g=0,y=n.length;g<y;g++)(a=n[g])!==e.axes.discrete&&o(e,a,t.buffer)},i=function(e){var t,n,r,a,o,i,s,l,u,c,d,f;if((n=!e.time.fixed.value&&(e.time.solo.changed||e.time.mute.changed))||(n=e.id.solo.changed||e.id.mute.changed),n)return n;for(a=0,s=(r=["data","time","id","depth","type","width","height","x","y","x2","y2"]).length;a<s;a++)if(e[r[a]].changed){n=!0;break}if(n)return n;for(f=["mute","range","scale","solo","stacked","zerofill"],o=0,l=(c=["x","y","x2","y2"]).length;o<l;o++)for(t=c[o],i=0,u=f.length;i<u;i++)if(d=f[i],e[t][d].changed){n=!0;break}return n},u=function(e){var t,n;return e.time.fixed.value?(n=d3.range(0,e.id.nesting.length),d3.merge(d3.merge([function(){var r,a,o;for(o=[],r=0,a=n.length;r<a;r++)t=n[r],o.push(s(e,"all",t));return o}()]))):e.data.viz},r=function(e,t,r,a){var o,i,s,u,c,d,f,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B,T,N;if(k=0===t.indexOf("x")?"y":"x",e[t].range.value&&2===e[t].range.value.length)return e[t].range.value.slice();if("share"===e[t].scale.value)return e[t].ticks.values=d3.range(0,1.1,.1),[0,1];if(e[t].stacked.value){for(S=[],h=0,y=(z=e.axes.dataset).length;h<y;h++)(f=z[h]).values?S=S.concat(f.values):S.push(f);return c=d3.nest().key((function(t){return l(e,t,e[k].value)})).rollup((function(n){var r;return r=d3.sum(n,(function(n){var r;return(r=l(e,n,e[t].value))>0?r:0})),[d3.sum(n,(function(n){var r;return(r=l(e,n,e[t].value))<0?r:0})),r]})).entries(S),N=d3.merge(c.map((function(e){return e.values}))),d3.extent(N)}if(e[t].value===e.time.value)return e.time.solo.value.length?d3.extent(e.time.solo.value).map((function(e){return e.constructor!==Date?(4===(e+="").length&&parseInt(e)+""===e&&(e+="/01/01"),new Date(e)):e})):d3.extent(e.data.time.ticks);for(N=[],v=0,x=(A=e.axes.dataset).length;v<x;v++)f=A[v],(T=l(e,f,e[t].value))instanceof Array?N=N.concat(T):N.push(T);if(N=N.filter((function(e){return null!==e})),t===e.axes.discrete){if(E=!0===e.order.value?e[k].value:e.order.value){for(F=e.order.sort.value,i=typeof(o=e.order.agg.value||e.aggs.value[E]||"max"),d=N.reduce((function(e,t){return e[t]=[],e}),{}),m=0,b=(M=e.axes.dataset).length;m<b;m++)if((f=M[m]).values)for(w=0,j=(O=f.values).length;w<j;w++)B=O[w],d[l(e,B,e[t].value)].push(l(e,B,E));else d[l(e,f,e[t].value)].push(l(e,f,E));for(g in d)B=d[g],"string"===i?d[g]=d3[o](B):"function"===i&&(d[g]=o(B,E));return d=(d=n(d3.entries(d),"value",F)).reduce((function(e,t){return e.push(t.key),e}),[])}return N[0].constructor===String?p(N).sort((function(e,t){return""+e.localeCompare(""+t)})):p(N).sort((function(e,t){return e-t}))}return N.sort((function(e,t){return e-t})),"log"===e[t].scale.value&&(0===N[0]&&(N[0]=1),0===N[N.length-1]&&(N[N.length-1]=-1)),r&&(u=N.every((function(e){return e>0})),s=N.every((function(e){return e<0})),(u||s)&&(_=u?1:-1,N.push("log"===e[t].scale.value?_:0))),d3.extent(N)},c=function(e,t,n){var r,o,i,s,l;return o=0===t.indexOf("x")?e.width.viz:e.height.viz,s=e[t].scale.value,["discrete","share"].indexOf(s)>=0&&(s="linear"),l=10,"string"==typeof n[0]?(s="ordinal",r=a([0,o],n.length)):(r=[0,o],"linear"===e[t].scale.value&&(l=Math.floor(o/(4*e[t].ticks.font.size)))),e[t].scale.ticks=l,"clamp"in(i=d3.scale[s]().domain(n).range(r))&&i.clamp(!0),i},f=function(e,t){var n,r,a;return!0===t&&(t="size"),t in e&&(t=e[t].value),"function"==typeof(a=e.size.scale.range.min.value)&&(a=a(e)),"function"==typeof(r=e.size.scale.range.max.value)&&(r=r(e)),!1===t?e.size.scale.value.domain([0,1]).rangeRound([r,r]):"number"==typeof t?e.size.scale.value.domain([0,1]).rangeRound([t,t]):t?(e.dev.value&&d.time("calculating buffer scale"),(n=d3.extent(e.axes.dataset,(function(n){return l(e,n,t)||0})))[0]===n[1]&&(a=r),e.dev.value&&d.timeEnd("calculating buffer scale"),e.size.scale.value.domain(n).rangeRound([a,r])):void 0}}).call(this)},{"../../../../../array/sort.js":29,"../../../../../core/console/print.js":47,"../../../../../core/fetch/data.js":58,"../../../../../core/fetch/value.js":61,"../../../../../util/buckets.js":190,"../../../../../util/uniques.js":196,"./buffer.js":293}],293:[function(e,t,n){(function(){var n,r;n=e("../../../../../util/buckets.js"),r=e("../../../../../util/closest.js"),t.exports=function(e,t,a){var o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B,T,N;if("share"!==e[t].scale.value&&!e[t].range.value&&e[t].reset){if("clamp"in(O=e[t].scale.viz.copy())&&O.clamp(!1),t===e.axes.discrete){if("string"==typeof(p=O.domain())[0]){for(m=p.length;m>=0;)p.splice(m,0,"d3po_buffer_"+m),m--;return k=O.range(),k=n(d3.extent(k),p.length),e[t].scale.viz.domain(p).range(k)}if(0===t.indexOf("y")&&(p=p.slice().reverse()),1===e[t].ticks.values.length)p=[p[0],p[0]],e[t].value===e.time.value&&1!==e.data.time.ticks.length?(u=r(e.data.time.ticks,p[0]),(F=e.data.time.ticks.indexOf(u))>0?p[0]=e.data.time.ticks[F-1]:(f=e.data.time.ticks[F+1]-u,p[0]=new Date(u.getTime()-f)),F<e.data.time.ticks.length-1?p[1]=e.data.time.ticks[F+1]:(f=u-e.data.time.ticks[F-1],p[1]=new Date(u.getTime()+f))):(p[0]-=1,p[1]+=1);else if(e.axes.scale)i=Math.abs(p[1]-p[0])/(e[t].ticks.values.length-1),i/=2,z=O.range()[1],w=1.5*e.axes.scale.range()[1],g=O.invert(-w),v=O.invert(z+w),p[0]-i<g?(p[0]=p[0]-i,p[p.length-1]=p[p.length-1]+i):(p=[g,v],0===t.indexOf("y")&&(p=p.reverse()),(h=(h=O.domain())[1]-h[0])||(p[0]-=1,p[1]+=1));else if(e[t].value===e.time.value)i=Math.abs(p[1]-p[0])/(e[t].ticks.values.length-1),i/=2,p[0]=p[0]-i,p[1]=p[1]+i;else{for(o=Math.abs(p[1]-p[0])/2,m=p.length,_=p.slice();m>=0;)d=m?_[m-1]+o:_[m]-o,p.splice(m,0,d),m--;k=O.range(),k=n(d3.extent(k),p.length),e[t].scale.viz.domain(p).range(k)}return 0===t.indexOf("y")&&(p=p.reverse()),e[t].scale.viz.domain(p)}if("x"===a&&0===t.indexOf("x")||"y"===a&&0===t.indexOf("y")||!0===a)return l=(p=O.domain())[0]>=0&&p[1]>=0,s=p[0]<=0&&p[1]<=0,"log"===e[t].scale.value?(N=l?1:-1,l&&0===t.indexOf("y")&&(p=p.slice().reverse()),b=Math.pow(10,parseInt(Math.abs(p[0])).toString().length-1)*N,y=x=p[0]%b,x&&y/b<=.1&&(y+=b*N),j=0===x?b:y,p[0]-=j,0===p[0]&&(p[0]=N),B=Math.pow(10,parseInt(Math.abs(p[1])).toString().length-1)*N,S=p[1]%B,E=Math.abs(B-S),S&&E/B<=.1&&(E+=B*N),T=0===S?B:E,p[1]+=T,0===p[1]&&(p[1]=N),l&&0===t.indexOf("y")&&(p=p.reverse())):(N=0,0===t.indexOf("y")&&(p=p.slice().reverse()),M=p.filter((function(e){return e.constructor===String})),i=.05*Math.abs(p[1]-p[0])||1,M.length||(p[0]=p[0]-i,p[1]=p[1]+i,(l&&p[0]<N||s&&p[0]>N)&&(p[0]=N),(l&&p[1]<N||s&&p[1]>N)&&(p[1]=N)),0===t.indexOf("y")&&(p=p.reverse())),e[t].scale.viz.domain(p);if(e.axes.scale)return c=!1,e.axes.mirror.value&&(c=e[0===t.indexOf("y")?"x":"y"].scale.viz,A=e.width.viz>e.height.viz?"x":"y"),t===A&&c?p=c.domain().slice().reverse():(z=O.range()[1],w=e.axes.scale.range()[1],p=[g=O.invert(1.5*-w),v=O.invert(z+1.5*w)],0===t.indexOf("y")&&(p=p.reverse()),(h=(h=O.domain())[1]-h[0])||(p[0]-=1,p[1]+=1),0===t.indexOf("y")&&(p=p.reverse())),e[t].scale.viz.domain(p)}}}).call(this)},{"../../../../../util/buckets.js":190,"../../../../../util/closest.js":192}],294:[function(e,t,n){(function(){var n,r,a,o,i;e("../../../../../util/copy.js"),n=e("../../../../../client/pointer.js"),r=e("../../../../../core/fetch/color.js"),a=e("../../../../../core/fetch/value.js"),o=e("../../../../../color/legible.js"),i=e("../../../../../color/text.js"),t.exports=function(e,t){var s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z;return s=d3.event.type===n.click&&(t.tooltip.value.long||t.tooltip.html.value),u=[n.over,n.move].indexOf(d3.event.type)>=0,k=e.d3po.x,z=e.d3po.y,m=e.d3po.r||0,b=t.types[t.type.value].scale||1,m*=b,c=t.axes,g=t.axes.margin.viz,_=t.draw.timing?t.timing.mouseevents:0,!s&&u?(l=o(r(t,e)),d=["x","y","x2","y2"].filter((function(n){var r;return(r=a(t,e,t[n].value))&&!(r instanceof Array)&&n!==t.axes.stacked&&t[n].mouse.value}))):d=[],f=function(e){return e.attr("x1",(function(e){return 0===e.indexOf("x")?k:k-m})).attr("y1",(function(e){return 0===e.indexOf("y")?z:z+m})).attr("x2",(function(e){return 0===e.indexOf("x")?k:k-m})).attr("y2",(function(e){return 0===e.indexOf("y")?z:z+m})).attr("opacity",0)},p=function(e){return e.style("stroke",(function(e){return"area"===t.shape.value?"white":l})).attr("stroke-dasharray",(function(e){return t[e].mouse.dasharray.value})).attr("shape-rendering",(function(e){return t[e].mouse.rendering.value})).style("stroke-width",(function(e){return t[e].mouse.width}))},h=function(n){return n.attr("x1",(function(e){return 0===e.indexOf("x")?k:k-m})).attr("y1",(function(e){return 0===e.indexOf("y")?z:z+m})).attr("x2",(function(n){return 0===n.indexOf("x")?k:e.d3po.x0?e.d3po.x0:"y"===n?g.left-t[n].ticks.size:g.left+c.width+t[n].ticks.size})).attr("y2",(function(n){return 0===n.indexOf("y")?z:e.d3po.y0?e.d3po.y0:"x"===n?c.height+g.top+t[n].ticks.size:g.top-t[n].ticks.size})).style("opacity",1)},v=t.g.labels.selectAll("line.d3po_mouse_axis_label").data(d),_?(v.enter().append("line").attr("class","d3po_mouse_axis_label").attr("pointer-events","none").call(f).call(p),v.transition().duration(_).call(h).call(p),v.exit().transition().duration(_).call(f).remove()):(v.call(h).call(p),v.enter().append("line").attr("class","d3po_mouse_axis_label").attr("pointer-events","none").call(f).call(p),v.exit().remove()),j=function(n){return n.attr("font-size",(function(e){return t[e].ticks.font.size+"px"})).attr("font-family",(function(e){return t[e].ticks.font.family.value})).attr("font-weight",(function(e){return t[e].ticks.font.weight})).attr("x",(function(e){return 0===e.indexOf("x")?k:"y"===e?g.left-5-t[e].ticks.size:g.left+c.width+5+t[e].ticks.size})).attr("y",(function(n){return 0===n.indexOf("y")?z:e.d3po.y0?e.d3po.y+(e.d3po.y0-e.d3po.y)/2+g.top-6:"x"===n?c.height+g.top+5+t[n].ticks.size:g.top-5-t[n].ticks.size-1.35*t[n].ticks.font.size})).attr("fill","area"===t.shape.value?"white":i(l))},(w=t.g.labels.selectAll("text.d3po_mouse_axis_label").data(d)).enter().append("text").attr("class","d3po_mouse_axis_label").attr("id",(function(e){return e+"_d3pomouseaxislabel"})).attr("dy",(function(e){return 0===e.indexOf("y")?.35*t[e].ticks.font.size:t[e].ticks.font.size})).style("text-anchor",(function(e){return"y"===e?"end":"y2"===e?"start":"middle"})).attr("opacity",0).attr("pointer-events","none").call(j),w.text((function(n){var r,o;return r=t.axes.stacked||n,o=a(t,e,t[r].value),t.format.value(o,{key:t[r].value,vars:t,labels:t[r].affixes.value})})),_?(w.transition().duration(_).delay(_).attr("opacity",1).call(j),w.exit().transition().duration(_).attr("opacity",0).remove()):(w.attr("opacity",1).call(j),w.exit().remove()),y=function(n){var r;return r=function(e){var t;return(t=d3.select("text#"+e+"_d3pomouseaxislabel")).size()?t.node().getBBox():{width:0,height:0}},n.attr("x",(function(e){var n;return n=r(e).width,0===e.indexOf("x")?k-n/2-5:"y"===e?g.left-t[e].ticks.size-n-10:g.left+c.width+t[e].ticks.size})).attr("y",(function(n){var a;return a=r(n).height,0===n.indexOf("y")?z-(a/2+5):e.d3po.y0?e.d3po.y+(e.d3po.y0-e.d3po.y)/2+g.top-(a/2+5):"x"===n?c.height+g.top+t[n].ticks.size:g.top-t[n].ticks.size-a-10})).attr("width",(function(e){return r(e).width+10})).attr("height",(function(e){return r(e).height+10})).style("stroke","area"===t.shape.value?"transparent":l).attr("fill",l).attr("shape-rendering",(function(e){return t[e].mouse.rendering.value})).style("stroke-width",(function(e){return t[e].mouse.width}))},x=t.g.labels.selectAll("rect.d3po_mouse_axis_label").data(d),_?(x.enter().insert("rect","text.d3po_mouse_axis_label").attr("class","d3po_mouse_axis_label").attr("pointer-events","none").attr("opacity",0).call(y),x.transition().duration(_).delay(_).attr("opacity",1).call(y),x.exit().transition().duration(_).attr("opacity",0).remove()):(x.attr("opacity",1).call(y),x.enter().insert("rect","text.d3po_mouse_axis_label").attr("class","d3po_mouse_axis_label").attr("pointer-events","none").call(y),x.exit().remove())}}).call(this)},{"../../../../../client/pointer.js":33,"../../../../../color/legible.js":39,"../../../../../color/text.js":45,"../../../../../core/fetch/color.js":57,"../../../../../core/fetch/value.js":61,"../../../../../util/copy.js":193}],295:[function(e,t,n){(function(){var n,r,a,o,i,s,l,u,c;n=e("../../../../../util/buckets.js"),r=e("./buffer.js"),o=e("../../../../../core/fetch/value.js"),i=e("../../../../../font/sizes.js"),u=e("../../../../../textwrap/textwrap.js"),c=e("../../../../../core/data/time.js"),e("../../../../../util/uniques.js"),t.exports=function(e,t){var n,i,s,u,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A;for(e.axes.margin.viz={top:e.axes.margin.top,right:e.axes.margin.right,bottom:e.axes.margin.bottom,left:e.axes.margin.left},e.axes.height=e.height.viz,e.axes.width=e.width.viz,d=0,h=(n=e.width.viz>e.height.viz?["y","y2","x","x2"]:["x","x2","y","y2"]).length;d<h;d++)if(e[i=n[d]].value){if(!1===e[i].ticks.values)if(e[i].value===e.time.value){for(k=(k=e.time.solo.value).length?k.map((function(e){return e.constructor!==Date&&(4===(e+="").length&&parseInt(e)+""===e&&(e+="/01/01"),e=new Date(e)),e})):e.data.time.values,u=d3.extent(k),j=e.data.time.stepType,k=[u[0]],_=u[0];_<u[1];)m=new Date(_),_=new Date(m["set"+j](m["get"+j]()+1)),k.push(_);e[i].ticks.values=k}else 1===i.indexOf("2")?(x=e[i.slice(0,1)].scale.viz,b=e[i].scale.viz,k=e[i.slice(0,1)].scale.ticks,e[i].ticks.values=x.ticks(k).map((function(e){return parseFloat(d3.format(".5f")(b.invert(x(e))))}))):e[i].ticks.values=e[i].scale.viz.ticks(e[i].scale.ticks);e[i].ticks.values.length||((A=o(e,e.data.viz,e[i].value))instanceof Array||(A=[A]),e[i].ticks.values=A),y=0===i.indexOf("x")?"y":"x",(1===e[i].ticks.values.length||t.buffer&&t.buffer!==y&&i===e.axes.discrete&&!0===e[i].reset)&&r(e,i,t.buffer),e[i].reset=!1,e[i].value===e.time.value?(s={"font-family":e[i].ticks.font.family.value,"font-weight":e[i].ticks.font.weight,"font-size":e[i].ticks.font.size+"px","text-transform":e[i].ticks.font.transform.value,"letter-spacing":e[i].ticks.font.spacing+"px"},z=c(e,{values:e[i].ticks.values,limit:e.width.viz,style:s}),e[i].ticks.value?e[i].ticks.visible=e[i].ticks.value.map(Number):e[i].ticks.labels.value.constructor===Array?e[i].ticks.visible=e[i].ticks.labels.value.map(Number):e[i].ticks.visible=z.values.map(Number),e[i].ticks.format=z.format):e[i].ticks.value?(e[i].ticks.values=e[i].ticks.value,e[i].ticks.labels.value.constructor===Array?e[i].ticks.visible=e[i].ticks.labels.value:e[i].ticks.visible=e[i].ticks.value):e[i].ticks.labels.value.constructor===Array?e[i].ticks.visible=e[i].ticks.labels.value:"log"===e[i].scale.value?(w=(k=e[i].ticks.values).filter((function(e){return"1"===Math.abs(e).toString().charAt(0)}))).length<3?e[i].ticks.visible=k:e[i].ticks.visible=w:e[i].ticks.visible=e[i].ticks.values,e[i].value===e.time.value&&(e[i].ticks.visible=e[i].ticks.visible.map((function(e){return e.constructor===Number&&(""+e).length>4?e:(4===(e+="").length&&parseInt(e)+""===e&&(e+="/01/01"),new Date(e).getTime())})))}if(e.small)for(e.axes.width-=e.axes.margin.viz.left+e.axes.margin.viz.right,e.axes.height-=e.axes.margin.viz.top+e.axes.margin.viz.bottom,f=0,v=n.length;f<v;f++)e[i=n[f]].label.height=0;else e.small||l(e);for(p=0,g=n.length;p<g;p++)e[i=n[p]].axis.svg=a(e,i)},l=function(e){var t,r,a,o,l,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B,T,N;for(b=e.x.scale.viz.domain(),E=e.y.scale.viz.domain(),e.x2.value&&(g=e.x2.scale.viz.domain()),e.y2.value&&(M=e.y2.scale.viz.domain()),r=0,l=(f=["y","y2"]).length;r<l;r++)e[t=f[r]].value&&(d="y"===t?"left":"right",O={"font-size":e[t].ticks.font.size+"px","font-family":e[t].ticks.font.family.value,"font-weight":e[t].ticks.font.weight,"text-transform":e[t].ticks.font.transform.value,"letter-spacing":e[t].ticks.font.spacing+"px"},N=e[t].ticks.visible,"log"===e[t].scale.value?T=N.map((function(e){return s(e)})):"share"===e[t].scale.value?T=N.map((function(n){return e.format.value(100*n,{key:"share",vars:e,output:t})})):e[t].value===e.time.value?T=N.map((function(n,r){return e[t].ticks.format(new Date(n))})):("string"==typeof N[0]&&(N=e[t].scale.viz.domain().filter((function(e){return 0!==e.indexOf("d3po_buffer_")}))),T=N.map((function(n){return e.format.value(n,{key:e[t].value,vars:e,labels:e[t].affixes.value,output:t})}))),e[t].ticks.labels.value?(e[t].ticks.hidden=!1,(F=d3.max(i(T,O),(function(e){return e.width})))&&(F=Math.ceil(F+e.labels.padding),e.axes.margin.viz[d]+=F)):e[t].ticks.hidden=!0,(S=e[t].label.fetch(e))?(B={"font-family":e[t].label.font.family.value,"font-weight":e[t].label.font.weight,"font-size":e[t].label.font.size+"px","text-transform":e[t].label.font.transform.value,"letter-spacing":e[t].label.font.spacing+"px"},e[t].label.height=i([S],B)[0].height):e[t].label.height=0,e[t].label.value&&(e.axes.margin.viz[d]+=e[t].label.height,e.axes.margin.viz[d]+=2*e[t].label.padding));for(e.axes.width-=e.axes.margin.viz.left+e.axes.margin.viz.right,e.x.scale.viz.range(n([0,e.axes.width],b.length)),g&&e.x2.scale.viz.range(n([0,e.axes.width],g.length)),a=0,c=(p=["x","x2"]).length;a<c;a++)e[t=p[a]].value&&(d="x"===t?"bottom":"top",e[t].ticks.labels.value?(e[t].ticks.hidden=!1,m={"font-size":e[t].ticks.font.size+"px","font-family":e[t].ticks.font.family.value,"font-weight":e[t].ticks.font.weight,"text-transform":e[t].ticks.font.transform.value,"letter-spacing":e[t].ticks.font.spacing+"px"},A=e[t].ticks.visible,"log"===e[t].scale.value?z=A.map((function(e){return s(e)})):"share"===e[t].scale.value?z=A.map((function(n){return e.format.value(100*n,{key:"share",vars:e,output:t})})):e[t].value===e.time.value?z=A.map((function(n,r){return e[t].ticks.format(new Date(n))})):("string"==typeof A[0]&&(A=e[t].scale.viz.domain().filter((function(e){return 0!==e.indexOf("d3po_buffer_")}))),z=A.map((function(n){return e.format.value(n,{key:e[t].value,vars:e,labels:e[t].affixes.value,output:t})}))),k=i(z,m),x=d3.max(k,(function(e){return e.width})),y=d3.max(k,(function(e){return e.height})),1===A.length?_=e.axes.width:(_=e[t].scale.viz(A[1])-e[t].scale.viz(A[0]),_=Math.abs(_)),x>_&&z.join("").indexOf(" ")>0?(e[t].ticks.wrap=!0,k=i(z,m,{mod:function(t){return u().container(d3.select(t)).height(e.axes.height/2).width(_).draw()}}),x=d3.max(k,(function(e){return e.width})),y=d3.max(k,(function(e){return e.height}))):e[t].ticks.wrap=!1,e[t].ticks.baseline="auto",x<=_?e[t].ticks.rotate=0:x<e.axes.height/2?(k=i(z,m,{mod:function(t){return u().container(d3.select(t)).width(e.axes.height/2).height(_).draw()}}),y=d3.max(k,(function(e){return e.width})),x=d3.max(k,(function(e){return e.height})),e[t].ticks.rotate=-90):(x=0,y=0),x&&y||(e[t].ticks.hidden=!0,e[t].ticks.rotate=0),x=Math.ceil(x),y=Math.ceil(y),e[t].ticks.maxHeight=y,e[t].ticks.maxWidth=x,y&&(e.axes.margin.viz[d]+=y+e.labels.padding),o=e[t].ticks.visible[e[t].ticks.visible.length-1],h=e[t].scale.viz(o),(h+=x/2+e.axes.margin.viz.left)>e.width.value&&(v=h-e.width.value+e.axes.margin.viz.right,e.axes.width-=v,e.axes.margin.viz.right+=v)):e[t].ticks.hidden=!0,(j=e[t].label.fetch(e))?(w={"font-family":e[t].label.font.family.value,"font-weight":e[t].label.font.weight,"font-size":e[t].label.font.size+"px","text-transform":e[t].label.font.transform.value,"letter-spacing":e[t].label.font.spacing+"px"},e[t].label.height=i([j],w)[0].height):e[t].label.height=0,e[t].label.value&&(e.axes.margin.viz[d]+=e[t].label.height,e.axes.margin.viz[d]+=2*e[t].label.padding));if(e.axes.height-=e.axes.margin.viz.top+e.axes.margin.viz.bottom,e.x.scale.viz.range(n([0,e.axes.width],b.length)),g&&e.x2.scale.viz.range(n([0,e.axes.width],g.length)),e.y.scale.viz.range(n([0,e.axes.height],E.length)),M)return e.y2.scale.viz.range(n([0,e.axes.height],M.length))},a=function(e,t){return d3.svg.axis().tickSize(e[t].ticks.size).tickPadding(5).orient(e[t].orient.value).scale(e[t].scale.viz).tickValues(e[t].ticks.values).tickFormat((function(n,r){var a,o;return e[t].ticks.hidden?null:(o=e[t].scale.value,a=n.constructor===Date?+n:n,e[t].ticks.visible.indexOf(a)>=0?"share"===o?e.format.value(100*n,{key:"share",vars:e,labels:e[t].affixes.value,output:t}):n.constructor===Date?e[t].ticks.format(n):"log"===o?s(n):e.format.value(n,{key:e[t].value,vars:e,labels:e[t].affixes.value,output:t}):null)}))},s=function(e){var t,n,r;return n=Math.round(Math.log(Math.abs(e))/Math.LN10),r=Math.abs(e).toString().charAt(0),t="10 "+(n+"").split("").map((function(e){return""[e]})).join(""),"1"!==r&&(t=r+" x "+t),e<0?"-"+t:t}}).call(this)},{"../../../../../core/data/time.js":56,"../../../../../core/fetch/value.js":61,"../../../../../font/sizes.js":88,"../../../../../textwrap/textwrap.js":186,"../../../../../util/buckets.js":190,"../../../../../util/uniques.js":196,"./buffer.js":293}],296:[function(e,t,n){(function(){var n,r,a;n=e("../../../../../color/mix.js"),r=e("../../../../../textwrap/textwrap.js"),a=e("../../../../../object/validate.js"),t.exports=function(e){var t,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B,T,N,I,C,q,V,D,U,P,L,R,H,Y,X,G,W,Q,Z,K,J,$,ee,te,ne,re,ae,oe,ie,se,le;if(e.x.domain.viz.concat(e.y.domain.viz).indexOf(void 0)>=0)return null;for(d={width:e.axes.width,height:e.axes.height,fill:e.axes.background.color,stroke:e.axes.background.stroke.color,"stroke-width":e.axes.background.stroke.width,"shape-rendering":e.axes.background.rendering.value},o={left:"start",center:"middle",right:"end"},s=e.small?[]:[0],ae=function(t,n){return t.attr("x1",(function(t){return 0===n.indexOf("x")?e.x.scale.viz(t):0})).attr("x2",(function(t){return 0===n.indexOf("x")?e.x.scale.viz(t):e.axes.width})).attr("y1",(function(t){return 0===n.indexOf("y")?e.y.scale.viz(t):0})).attr("y2",(function(t){return 0===n.indexOf("y")?e.y.scale.viz(t):e.axes.height}))},oe=function(t,r,a){var o,i,s;return o=a?e[r].grid.color:e[r].ticks.color,i="log"===e[r].scale.value,s=e[r].ticks.visible||[],t.attr("stroke",(function(t){return 0===t?e[r].axis.color:(t.constructor===Date&&(t=+t),!(s.indexOf(t)>=0)||i&&"1"!==Math.abs(t).toString().charAt(0)?a&&"transparent"!==e.axes.background.color?n(o,e.axes.background.color,.4,1):"transparent"!==e.background.value?n(o,e.background.value,.4,1):n(o,"white",.4,1):o)})).attr("stroke-width",e[r].ticks.width).attr("shape-rendering",e[r].ticks.rendering.value)},h=function(t,n,r){var a;return a=0===n?"axis":"ticks",(n=e[t][a].font[r])&&(n.length||"number"==typeof n)?n:e[t].ticks.font[r]},re=function(t,r){var a;return a="log"===e[r].scale.value,t.attr("font-size",(function(e){return h(r,e,"size")+"px"})).attr("stroke","none").attr("fill",(function(t){var o;return o=h(r,t,"color"),a&&"1"!==Math.abs(t).toString().charAt(0)?n(o,e.background.value,.4,1):o})).attr("font-family",(function(e){return h(r,e,"family").value})).attr("font-weight",(function(e){return h(r,e,"weight")})).style("text-transform",(function(e){return h(r,e,"transform").value})).style("letter-spacing",(function(e){return h(r,e,"spacing")+"px"}))},N=function(t,n){var r,a;return r=0===n.indexOf("x")?"height":"width",a=0===n.indexOf("x")?"y":"x",t.attr(a+"1",0).attr(a+"2",e.axes[r]).attr(n+"1",(function(e){return e.coords.line})).attr(n+"2",(function(e){return e.coords.line})).attr("stroke",(function(t){return t.color||e[n].lines.color})).attr("stroke-width",e[n].lines.width).attr("shape-rendering",e[n].lines.rendering.value).attr("stroke-dasharray",e[n].lines.dasharray.value)},S=function(t,n){var r;return r=0===n.indexOf("x")?"y":"x",t.attr(r,(function(e){return e.coords.text[r]+"px"})).attr(n,(function(e){return e.coords.text[n]+"px"})).attr("dy",e[n].lines.font.position.value).attr("text-anchor",o[e[n].lines.font.align.value]).attr("transform",(function(e){return e.transform})).attr("font-size",e[n].lines.font.size+"px").attr("fill",(function(t){return t.color||e[n].lines.color})).attr("font-family",e[n].lines.font.family.value).attr("font-weight",e[n].lines.font.weight)},L="translate("+e.axes.margin.viz.left+","+e.axes.margin.viz.top+")",(P=e.group.selectAll("g#d3po_graph_plane").data([0])).transition().duration(e.draw.timing).attr("transform",L),P.enter().append("g").attr("id","d3po_graph_plane").attr("transform",L),(c=P.selectAll("rect#d3po_graph_background").data([0])).transition().duration(e.draw.timing).attr(d),c.enter().append("rect").attr("id","d3po_graph_background").attr("x",0).attr("y",0).attr(d),(V=P.selectAll("path#d3po_graph_mirror").data([0])).enter().append("path").attr("id","d3po_graph_mirror").attr("fill","#000").attr("fill-opacity",.03).attr("stroke-width",1).attr("stroke","#ccc").attr("stroke-dasharray","10,10").attr("opacity",0),V.transition().duration(e.draw.timing).attr("opacity",(function(){return e.axes.mirror.value?1:0})).attr("d",(function(){var e,t;return"M "+(t=d.width)+" "+(e=d.height)+" L 0 "+e+" L "+t+" 0 Z"})),K=0!==e.x.ticks.rotate,se=function(t,n){var a,o;return o="x"===n?e.axes.height:0,(a=t.attr("transform","translate(0,"+o+")").call(e[n].axis.svg.scale(e[n].scale.viz)).selectAll("g.tick")).selectAll("line").attr("y2",(function(t){var r;return t.constructor===Date&&(t=+t),r=d3.select(this).attr("y2"),e[n].ticks.visible.indexOf(t)>=0?r:r/2})),a.select("text").style("text-anchor",K&&"x"===n?"end":K?"start":"middle").call(re,n).each((function(t){if(d3.select(this).attr("dy","0px").attr("font-size",(function(e){return h(n,e,"size")+"px"})),t.constructor===Date&&(t=+t),!e[n].ticks.hidden&&e[n].ticks.visible.indexOf(t)>=0)return r().container(d3.select(this)).rotate(e[n].ticks.rotate).align(K?"end":"center").valign(K?"middle":"x"===n?"top":"bottom").width(e[n].ticks.maxWidth+2).height(e[n].ticks.maxHeight).padding(0).x(-e[n].ticks.maxWidth/2).y("x2"===n?-(e[n].ticks.maxHeight+2*e.labels.padding):0).draw()}))},le=function(t,n){var r,a;return a="y2"===n?e.axes.width:0,(r=t.attr("transform","translate("+a+", 0)").call(e[n].axis.svg.scale(e[n].scale.viz)).selectAll("g.tick")).selectAll("line").attr("y2",(function(t){var n;return t.constructor===Date&&(t=+t),n=d3.select(this).attr("y2"),e.x.ticks.visible.indexOf(t)>=0?n:n/2})),r.select("text").call(re,n)},y=0,k=(G=["x","x2","y","y2"]).length;y<k;y++)$=0===(i=G[y]).indexOf("x")?se:le,H=s.length&&e[i].value?[0]:[],(l=P.selectAll("g#d3po_graph_"+i+"ticks").data(H)).transition().duration(e.draw.timing).call($,i),l.selectAll("line").transition().duration(e.draw.timing).call(oe,i),(m=l.enter().append("g").attr("id","d3po_graph_"+i+"ticks").call($,i)).selectAll("path").attr("fill","none").attr("stroke","none"),m.selectAll("line").call(oe,i),l.exit().transition().duration(e.data.timing).attr("opacity",0).remove();for(_=function(t,n){return t.attr("x",0===n.indexOf("x")?e.width.viz/2:-(e.axes.height/2+e.axes.margin.viz.top)).attr("y","x"===n?e.height.viz-e[n].label.height/2-e[n].label.padding:"y2"===n?e.width.viz-e[n].label.height/2-e[n].label.padding:e[n].label.height/2+e[n].label.padding).attr("transform",0===n.indexOf("y")?"rotate(-90)":null).attr("font-family",e[n].label.font.family.value).attr("font-weight",e[n].label.font.weight).attr("font-size",e[n].label.font.size+"px").attr("fill",e[n].label.font.color).style("text-anchor","middle").attr("dominant-baseline","central").style("text-transform",e[n].label.font.transform.value).style("letter-spacing",e[n].label.font.spacing+"px")},x=0,z=(W=["x","y"]).length;x<z;x++)e[i=W[x]].grid.value?g=e[i].ticks.value?e[i].ticks.value:e[i].ticks.values:(g=[],U="x"===i?"y":"x",e[i].ticks.values.indexOf(0)>=0&&e[U].axis.value&&(g=[0])),e[i].value===e.time.value&&(g=g.map((function(e){return 4===(e+="").length&&parseInt(e)+""===e&&(e+="/01/01"),new Date(e).getTime()}))),(v=P.selectAll("g#d3po_graph_"+i+"grid").data([0])).enter().append("g").attr("id","d3po_graph_"+i+"grid"),(I=v.selectAll("line").data(g,(function(e,t){return e.constructor===Date?e.getTime():e}))).transition().duration(e.draw.timing).call(ae,i).call(oe,i,!0),I.enter().append("line").style("opacity",0).call(ae,i).call(oe,i,!0).transition().duration(e.draw.timing).delay(e.draw.timing/2).style("opacity",1),I.exit().transition().duration(e.draw.timing/2).style("opacity",0).remove();for(b=0,A=(Q=["x","x2","y","y2"]).length;b<A;b++)e[i=Q[b]].value?(u=e[i].label.fetch(e),w=s&&u&&!e.small?[0]:[],t=e.format.affixes.value[e[i].value],u&&!e[i].affixes.value&&t&&(!0===(J=e[i].affixes.separator.value)?J=["[","]"]:!1===J&&(J=["",""]),u+=" "+J[0]+t[0]+" "+t[1]+J[1])):(u="",w=[]),(j=e.group.selectAll("text#d3po_graph_"+i+"label").data(w)).text(u).transition().duration(e.draw.timing).call(_,i),j.enter().append("text").attr("stroke","none").attr("id","d3po_graph_"+i+"label").text(u).call(_,i),j.exit().transition().duration(e.data.timing).attr("opacity",0).remove();for(q=0,M=(Z=["x","y","x2","y2"]).length;q<M;q++)if(e[i=Z[q]].value){for((B=P.selectAll("g#d3po_graph_"+i+"_userlines").data([0])).enter().append("g").attr("id","d3po_graph_"+i+"_userlines"),p=e[i].scale.viz.domain(),0===i.indexOf("y")&&(p=p.slice().reverse()),ee=[],E=[],D=0,O=(ie=e[i].lines.value||[]).length;D<O;D++)F=ie[D],f=a(F)?F.position:F,(i===e.axes.discrete?p.indexOf(f)>=0:f>=p[0]&&f<=p[1])&&((f=a(F)?F:{position:f}).coords={line:e[i].scale.viz(f.position)},E.push(f),f.text&&(f.axis=i,f.padding=.5*e[i].lines.font.padding.value,f.align=e[i].lines.font.align.value,te="middle"===(R=e[i].lines.font.position.text)?0:2*f.padding,"top"===R&&(te=-te),0===i.indexOf("x")?(ne="left"===f.align?e.axes.height:"center"===f.align?e.axes.height/2:0,"left"===f.align&&(ne-=2*f.padding),"right"===f.align&&(ne+=2*f.padding)):(ne="left"===f.align?0:"center"===f.align?e.axes.width/2:e.axes.width,"right"===f.align&&(ne-=2*f.padding),"left"===f.align&&(ne+=2*f.padding)),f.coords.text={},f.coords.text[0===i.indexOf("x")?"y":"x"]=ne,f.coords.text[i]=e[i].scale.viz(f.position)+te,f.transform=0===i.indexOf("x")?"rotate(-90,"+f.coords.text.x+","+f.coords.text.y+")":null,ee.push(f)));(I=B.selectAll("line.d3po_graph_"+i+"line").data(E,(function(e){return e.position}))).enter().append("line").attr("class","d3po_graph_"+i+"line").attr("opacity",0).call(N,i),I.transition().duration(e.draw.timing).attr("opacity",1).call(N,i),I.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),(C=B.selectAll("text.d3po_graph_"+i+"line_text").data(ee,(function(e){return e.position}))).enter().append("text").attr("class","d3po_graph_"+i+"line_text").attr("id",(function(e){var t;return t=(t=(t=e.position+"").replace("-","neg")).replace(".","p"),"d3po_graph_"+i+"line_text_"+t})).attr("opacity",0).call(S,i),C.text((function(e){return e.text})).transition().duration(e.draw.timing).attr("opacity",1).call(S,i),C.exit().transition().duration(e.draw.timing).attr("opacity",0).remove(),X=function(t){var n;return n=function(e){var t;return t=(t=(t=e.position+"").replace("-","neg")).replace(".","p"),P.select("text#d3po_graph_"+e.axis+"line_text_"+t).node().getBBox()},t.attr("x",(function(e){return n(e).x-e.padding})).attr("y",(function(e){return n(e).y-e.padding})).attr("transform",(function(e){return e.transform})).attr("width",(function(e){return n(e).width+2*e.padding})).attr("height",(function(e){return n(e).height+2*e.padding})).attr("fill","transparent"!==e.axes.background.color?e.axes.background.color:"white")},Y=e[i].lines.font.background.value?ee:[],(T=B.selectAll("rect.d3po_graph_"+i+"line_rect").data(Y,(function(e){return e.position}))).enter().insert("rect","text.d3po_graph_"+i+"line_text").attr("class","d3po_graph_"+i+"line_rect").attr("pointer-events","none").attr("opacity",0).call(X),T.transition().delay(e.draw.timing).each("end",(function(t){return d3.select(this).transition().duration(e.draw.timing).attr("opacity",1).call(X)})),T.exit().transition().duration(e.draw.timing).attr("opacity",0).remove()}}}).call(this)},{"../../../../../color/mix.js":41,"../../../../../object/validate.js":158,"../../../../../textwrap/textwrap.js":186}],297:[function(e,t,n){(function(){var n,r,a;n=e("../../../../core/fetch/value.js"),r=e("../../../../string/strip.js"),a=e("../../../../util/uniques.js"),t.exports=function(e,t,o){var i,s,l,u,c,d,f;return void 0===o?o=e.id.nesting.slice(0,e.depth.value+1):o.constructor!==Array&&(o=[o]),void 0===s&&(s=[]),t||(t=e.data.viz),i=e[e.axes.discrete],u=e[e.axes.opposite],(f=i.value===e.time.value)?(d=e.data.time.ticks,l=e.time.solo.value.length?"solo":"mute",e.time[l].value.length&&(c=e.time[l].value.slice().map((function(e){return e.constructor!==Date&&(4===(e+="").length&&parseInt(e)+""===e&&(e+="/01/01"),e=new Date(e)),+e})),d=d.filter((function(e){return"solo"===l?c.indexOf(+e)>=0:c.indexOf(+e)<0})))):d=i.ticks.values?i.ticks.values:a(t,i.value,n,e),d3.nest().key((function(t){var a,i,s,l,u;for(l="nesting",i=0,s=o.length;i<s;i++)a=o[i],(u=n(e,t,a))instanceof Array&&(u=u.join("_")),l+="_"+r(u);return l})).rollup((function(t){var r,o,s,c,p,h,v,g,m,y,x;if((r=a(t,i.value,n,e)).length&&r[0].constructor===Date&&(r=r.map(Number)),i.zerofill.value)for(o="log"===i.scale.value?u.scale.viz.domain().every((function(e){return e<0}))?-1:1:0,s=c=0,h=d.length;c<h;s=++c)if(x=d[s],y=f?+x:x,r.indexOf(y)<0){for(g={d3po:{}},p=0,v=(m=e.id.nesting).length;p<v;p++)(l=m[p])in t[0]&&(g[l]=t[0][l]);g[i.value]=x,g[u.value]=0,g[u.value]=o,t.splice(s,0,g)}return"string"==typeof t[0][i.value]?t:t.sort((function(t,r){var a;return(a=n(e,t,i.value)-n(e,r,i.value))?a:n(e,t,u.value)-n(e,r,u.value)}))})).entries(t)}}).call(this)},{"../../../../core/fetch/value.js":61,"../../../../string/strip.js":161,"../../../../util/uniques.js":196}],298:[function(e,t,n){(function(){var n;n=e("../../../../core/fetch/value.js"),t.exports=function(e,t){var r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y;for(m=e.axes.stacked||e.axes.opposite,a=e[m].scale.viz(0),v=e[m].scale.value,p="x"===m?"y":"x",u="y"===m?e.axes.margin.viz.top:e.axes.margin.viz.left,f="share"===v?"expand":"zero",g=d3.layout.stack().values((function(e){return e.values||[e]})).offset(f).x((function(e){return e.d3po[p]})).y((function(t){return a-e[m].scale.viz(n(e,t,e[m].value))})).out((function(t,r,o){return n(e,t,e[m].value)<0,"share"===v?(t.d3po[m+"0"]=(1-r)*a,t.d3po[m]=t.d3po[m+"0"]-o*a):(t.d3po[m+"0"]=a,e.axes.stacked&&(t.d3po[m+"0"]-=r),t.d3po[m]=t.d3po[m+"0"]-o),t.d3po[m]+=u,t.d3po[m+"0"]+=u})),h=[],d=[],o=0,s=t.length;o<s;o++)if(r=t[o],(y=n(e,r,e[m].value))instanceof Array){for(c=!0,i=0,l=y.length;i<l;i++)if(y[i]>=0){c=!1;break}c?d.push(r):h.push(r)}else y>=0&&h.push(r),y<0&&d.push(r);return 0===h.length||0===d.length?g(t):(h.length&&(h=g(h)),d.length&&(d=g(d)),h.concat(d))}}).call(this)},{"../../../../core/fetch/value.js":61}],299:[function(e,t,n){(function(){var n,r,a,o,i,s;n=e("../../core/fetch/value.js"),r=e("./helpers/graph/draw.js"),o=e("./helpers/graph/nest.js"),i=e("../../array/sort.js"),s=e("./helpers/graph/stack.js"),(a=function(e){var t,a,o,l,u,c,d,f,p;if(r(e,{buffer:e.axes.opposite,mouse:!0}),e.x.domain.viz.concat(e.y.domain.viz).indexOf(void 0)>=0)return[];for(o=0,u=(a=i(e.data.viz,null,null,null,e)).length;o<u;o++)for(l=0,c=(d=a[o].values).length;l<c;l++)t=d[l],null!==(f=n(e,t,e.x.value))?(t.d3po.x2=!1,t.d3po.x=e.x.scale.viz(f)):(t.d3po.x2=!0,t.d3po.x=e.x2.scale.viz(n(e,t,e.x2.value))),t.d3po.x+=e.axes.margin.viz.left,null!==(p=n(e,t,e.y.value))?(t.d3po.y2=!1,t.d3po.y=e.y.scale.viz(p)):(t.d3po.y2=!0,t.d3po.y=e.y2.scale.viz(n(e,t,e.y2.value))),t.d3po.y+=e.axes.margin.viz.top;return e.axes.stacked?s(e,a):a}).filter=function(e,t){return o(e,t)},a.requirements=["data","x","y"],a.setup=function(e){var t;e.axes.discrete||(t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"}))},a.shapes=["line"],a.tooltip="static",t.exports=a}).call(this)},{"../../array/sort.js":29,"../../core/fetch/value.js":61,"./helpers/graph/draw.js":291,"./helpers/graph/nest.js":297,"./helpers/graph/stack.js":298}],300:[function(e,t,n){(function(){var n=e("../../network/smallestgap.js"),r=e("../../core/fetch/value.js"),a=function(e){var t=e.nodes.restricted||e.nodes.value,a=e.edges.restricted||e.edges.value||[],o=d3.extent(t,(function(e){return e.x})),i=d3.extent(t,(function(e){return e.y})),s=[1,1];if("number"==typeof e.size.value?s=[e.size.value,e.size.value]:e.size.value&&(s=d3.extent(t,(function(t){var n=r(e,t,e.size.value);return 0===n?null:n}))),void 0===s[0]&&(s=[1,1]),"number"==typeof e.size.value)var l=e.size.value,u=e.size.value;else{var c=(l=n(t,{accessor:function(e){return[e.x,e.y]}}))/2;if(l*=e.size.value?e.nodes.overlap:.4,e.edges.arrows.value&&(l*=.5),s[0]===s[1]){u=c;l=c}else{var d=o[1]+1.1*l-(o[0]-1.1*l),f=i[1]+1.1*l-(i[0]-1.1*l),p=d/f;if(e.width.viz/e.height.viz>p)var h=e.height.viz/f;else h=e.width.viz/d;(u=.25*l)*h<2&&(u=2/h)}}var v=e.size.scale.value.domain(s).range([u,l]);e.zoom.bounds=[[o[0]-1.1*l,i[0]-1.1*l],[o[1]+1.1*l,i[1]+1.1*l]];var g=[],m={};return t.forEach((function(t){var n=e.data.viz.filter((function(n){return n[e.id.value]==t[e.id.value]}))[0]||{};n[e.id.value]=t[e.id.value],n.d3po={},n.d3po.x=t.x,n.d3po.y=t.y;var a=r(e,n,e.size.value);n.d3po.r=a?v(a):v.range()[0],m[n[e.id.value]]={x:n.d3po.x,y:n.d3po.y,r:n.d3po.r},g.push(n)})),g.sort((function(e,t){return t.d3po.r-e.d3po.r})),a.forEach((function(t,n){t.d3po&&delete t.d3po.spline,t[e.edges.source].d3po={};var r=m[t[e.edges.source][e.id.value]];void 0!==r?(t[e.edges.source].d3po.r=r.r,t[e.edges.source].d3po.x=r.x,t[e.edges.source].d3po.y=r.y):delete t[e.edges.source].d3po,t[e.edges.target].d3po={};var a=m[t[e.edges.target][e.id.value]];void 0!==a?(t[e.edges.target].d3po.r=a.r,t[e.edges.target].d3po.x=a.x,t[e.edges.target].d3po.y=a.y):delete t[e.edges.target].d3po})),{nodes:g,edges:a}};a.nesting=!1,a.requirements=["nodes","edges"],a.scale=1.05,a.shapes=["circle"],a.tooltip="static",a.zoom=!0,t.exports=a}).call(this)},{"../../core/fetch/value.js":61,"../../network/smallestgap.js":154}],301:[function(e,t,n){(function(){var n,r,a,o,i=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};r=e("../../network/shortestpath.js"),n=e("../../core/fetch/value.js"),a=e("../../util/uniques.js"),(o=function(e){var t,r,a,s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_,k,z,A,M,O,F,E,S,B,T,N,I,C,q,V,D,U,P,L,R,H,Y,X,G,W,Q,Z,K,J,$,ee,te,ne,re,ae,oe,ie,se,le,ue,ce,de;for(h=[],(H={})[e.focus.value[0]]=0,H[e.focus.value[1]]=0,Y={all:[[e.focus.value[0]],[e.focus.value[1]]]},R=m=0,_=(Q=o.paths).length;m<_;R=++m)for(L=Q[R],h=h.concat(L.edges),w=e.focus.value[0],Y[R]=[w],p=y=0,k=(Z=L.edges).length;y<k;p=++y)(f=Z[p])[e.edges.source]=e.data.viz.filter((function(t){return f[e.edges.source][e.id.value]===t[e.id.value]}))[0],f[e.edges.target]=e.data.viz.filter((function(t){return f[e.edges.target][e.id.value]===t[e.id.value]}))[0],C=f[e.edges.source][e.id.value]===w?"target":"source",void 0===H[q=f[e.edges[C]][e.id.value]]&&(H[q]=R),Y[R].push(q),w=q;for(R in ae=0,Y)if(L=Y[R],"all"!==R){for(N=0,v=x=0,z=L.length;x<z;v=++x)if(g=L[v],0!==v&&v!==L.length-1&&H[g]===parseFloat(R)){for(N=1,X=L[v-1],I=L[v+1],G=null,V=null,u=S=0,A=(K=Y.all).length;S<A;u=++S)l=K[u],i.call(l,X)>=0&&(G=u),i.call(l,I)>=0&&(V=u);null!==G&&null===V?G+1===Y.all.length-1?Y.all.splice(G+1,0,[g]):Y.all[G+1].push(g):V-G==1?Y.all.splice(V,0,[g]):V-G>1&&Y.all[V-1].push(g)}ae+=N}for(re=Math.floor(e.height.viz/ae),de=[],v=0;v<ae;)v%2==0?de.push(v):de.unshift(v),v++;for(b=e.size.value&&!e.small?30:0,ce=d3.scale.ordinal().domain(de).range(d3.range(re/2-b,e.height.viz+re/2-b,(e.height.viz-re)/(ae-1))),d=Y.all.length,c=Math.floor(e.width.viz/d),le=d3.scale.linear().domain([0,d-1]).rangeRound([c/2,e.width.viz-c/2]),5,B=.4*d3.min([c,re-b]),ie=d3.extent(e.data.viz,(function(t){return n(e,t,e.size.value)||0})),oe=e.size.scale.value.domain(ie).rangeRound([5,B]),T=0,M=(J=e.data.viz).length;T<M;T++){for(null==(D=J[T]).d3po&&(D.d3po={}),u=U=0,O=($=Y.all).length;U<O;u=++U)l=$[u],ee=D[e.id.value],i.call(l,ee)>=0&&(D.d3po.x=le(u));D.d3po.y=ce(H[D[e.id.value]]),e.size.value?(se=n(e,D,e.size.value),D.d3po.r=se?oe(se):5):D.d3po.r=B,D.d3po.r<.1*c&&!e.small?D.d3po.label={x:0,y:D.d3po.r+2*e.labels.padding,w:.6*c,h:b+B-D.d3po.r,resize:!1}:delete D.d3po.label}for(R=P=0,F=(te=o.paths).length;P<F;R=++P)for(L=te[R],w=e.focus.value[0],p=W=0,E=(ne=L.edges).length;W<E;p=++W)j="target"===(C=(f=ne[p])[e.edges.source][e.id.value]===w?"target":"source")?"source":"target",q=f[e.edges[C]][e.id.value],H[w]!==H[q]?(f.d3po={spline:!0},null==(t=f[e.edges.source]).d3po&&(t.d3po={}),null==(r=f[e.edges.source].d3po).edges&&(r.edges={}),null==(a=f[e.edges.target]).d3po&&(a.d3po={}),null==(s=f[e.edges.target].d3po).edges&&(s.edges={}),ue=f[C].d3po.x-f[j].d3po.x,f[j].d3po.edges[f[C][e.id.value]]={angle:Math.PI,radius:c/2},f[C].d3po.edges[f[j][e.id.value]]={angle:0,radius:c/2,offset:ue-c}):delete f.d3po,w=q;return{nodes:e.data.viz,edges:h}}).filter=function(e,t){var i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,j,w,_;for(u=e.edges.filtered||e.edges.value,o.paths=r(u,e.focus.value[0],{target:e.focus.value[1],distance:e.edges.size.value||void 0,nodeid:e.id.value,startpoint:e.edges.source,endpoint:e.edges.target,K:e.edges.limit.value||5}),o.nodes=[],i=[],f=0,v=(x=o.paths).length;f<v;f++)for(p=0,g=(b=x[f].edges).length;p<g;p++)w=(l=b[p])[e.edges.source],_=l[e.edges.target],i.indexOf(w[e.id.value])<0&&(o.nodes.push(w),i.push(w[e.id.value])),i.indexOf(_[e.id.value])<0&&(o.nodes.push(_),i.push(_[e.id.value]));for(j=[],h=0,m=(d=a(o.nodes,e.id.value,n,e)).length;h<m;h++)c=d[h],(s=t.filter((function(t){return t[e.id.value]===c})))[0]?j.push(s[0]):((y={d3po:{}})[e.id.value]=c,j.push(y));return j},o.nesting=!1,o.requirements=[function(e){return{status:2===e.focus.value.length,text:e.format.locale.value.method.focus+" x 2"}},"edges"],o.scale=1,o.shapes=["circle","square"],o.tooltip="static",t.exports=o}).call(this)},{"../../core/fetch/value.js":61,"../../network/shortestpath.js":153,"../../util/uniques.js":196}],302:[function(e,t,n){(function(){var n,r,a,o;n=e("../../array/comparator.js"),r=e("../../core/data/threshold.js"),a=e("../../core/data/group.js"),(o=function(e){var t,r,o,i,s,l,u;for(s=d3.layout.pie().value((function(e){return e.value})).sort((function(t,r){return e.order.value?n(t.d3po,r.d3po,[e.order.value],e.order.sort.value,[],e):e.id.nesting.length>1?n(t.d3po,r.d3po,e.id.nesting.concat([e.size.value]),void 0,[],e):n(t.d3po,r.d3po,[e.size.value],"desc",[],e)}))(a(e,e.data.viz,[])),u=[],l=d3.min([e.width.viz,e.height.viz])/2-2*e.labels.padding,r=0,i=s.length;r<i;r++)(o=(t=s[r]).data.d3po).d3po.startAngle=t.startAngle,o.d3po.endAngle=t.endAngle,o.d3po.r_inner=0,o.d3po.r_outer=l,o.d3po.x=e.width.viz/2,o.d3po.y=e.height.viz/2,o.d3po.share=(t.endAngle-t.startAngle)/(2*Math.PI),u.push(o);return u}).filter=r,o.requirements=["data","size"],o.shapes=["arc"],o.threshold=function(e){return 1600/(e.width.viz*e.height.viz)},t.exports=o}).call(this)},{"../../array/comparator.js":27,"../../core/data/group.js":51,"../../core/data/threshold.js":55}],303:[function(e,t,n){(function(){var n,r,a,o,i;n=e("../../core/fetch/value.js"),r=e("./helpers/graph/draw.js"),e("../../core/console/print.js"),o=e("../../array/sort.js"),i=e("./helpers/graph/dataticks.js"),(a=function(e){var t,a,s,l;if(r(e,{buffer:"size",mouse:!0}),e.x.domain.viz.concat(e.y.domain.viz).indexOf(void 0)>=0)return[];for(a=0,s=(l=e.data.viz).length;a<s;a++)(t=l[a]).d3po.x=e.x.scale.viz(n(e,t,e.x.value)),t.d3po.x+=e.axes.margin.viz.left,t.d3po.y=e.y.scale.viz(n(e,t,e.y.value)),t.d3po.y+=e.axes.margin.viz.top,"number"!=typeof e.size.value&&e.size.value?t.d3po.r=e.axes.scale(n(e,t,e.size.value)):t.d3po.r=e.axes.scale(0);return i(e),o(e.data.viz,e.order.value||e.size.value||e.id.value,"desc"===e.order.sort.value?"asc":"desc",e.color.value||[],e)}).fill=!0,a.requirements=["data","x","y"],a.scale=1.1,a.setup=function(e){if(e.time.value&&!e.axes.discrete&&(e.time.value===e.x.value&&e.self.x({scale:"discrete"}),e.time.value===e.y.value))return e.self.y({scale:"discrete"})},a.shapes=["circle"],a.tooltip="static",t.exports=a}).call(this)},{"../../array/sort.js":29,"../../core/console/print.js":47,"../../core/fetch/value.js":61,"./helpers/graph/dataticks.js":290,"./helpers/graph/draw.js":291}],304:[function(e,t,n){(function(){var n,r,a,o;n=e("../../core/data/threshold.js"),r=e("../../core/data/group.js"),a=e("../../object/merge.js"),(o=function(e){var t,n,o,i,s,l,u;if(o=r(e,e.data.viz),(n=d3.layout.treemap().mode(e.type.mode.value).round(!0).size([e.width.viz,e.height.viz]).children((function(e){return e.values})).padding(e.data.padding.value).sort((function(e,t){var n;return 0===(n=e.value-t.value)?e.id<t.id:n})).nodes({name:"root",values:o}).filter((function(e){return!e.values&&e.area}))).length){for(u=n[0];u.parent;)u=u.parent;for(l=[],i=0,s=n.length;i<s;i++)(t=n[i]).d3po.d3po=a(t.d3po.d3po,{x:t.x+t.dx/2,y:t.y+t.dy/2,width:t.dx,height:t.dy,share:t.value/u.value}),l.push(t.d3po)}return l}).filter=n,o.modes=["squarify","slice","dice","slice-dice"],o.requirements=["data","size"],o.shapes=["square"],o.threshold=function(e){return 1600/(e.width.viz*e.height.viz)},t.exports=o}).call(this)},{"../../core/data/group.js":51,"../../core/data/threshold.js":55,"../../object/merge.js":157}],305:[function(e,t,n){(function(){var n,r,a,o,i,s;n=e("../core/methods/attach.js"),r=e("./methods/helpers/axis.js"),o=e("./helpers/ui/message.js"),i=e("./helpers/drawSteps.js"),s=e("../core/console/print.js"),a=e("./helpers/container.js"),e("../object/validate.js"),t.exports=function(){var t;return(t={g:{apps:{}},types:{area:e("./types/area.js"),bar:e("./types/bar.js"),box:e("./types/box.js"),line:e("./types/line.js"),paths:e("./types/paths.js"),pie:e("./types/pie.js"),scatter:e("./types/scatter.js"),stacked:e("./types/area.js"),treemap:e("./types/treemap.js"),network:e("./types/network.js")}}).self=function(e){return e.each((function(){var e,n,r,l,u,c,d;t.draw.frozen=!0,t.error.internal=null,"timing"in t.draw||(t.draw.timing=t.timing.transitions),t.error.value&&(t.draw.timing=0),a(t),c=t.width.value<=t.width.small,u=t.height.value<=t.height.small,t.small=c||u,t.width.viz=t.width.value,t.height.viz=t.height.value,e=!1,n=function(){d.length?l():t.dev.value&&(s.groupEnd(),s.timeEnd("total draw time"),s.log("\n"))},r=function(e,r){e[r=r||"function"]instanceof Array?e[r].forEach((function(e){e(t,n)})):"function"==typeof e[r]&&e[r](t,n),e.wait||n()},l=function(){var a,i,l,u;u=d.shift(),l=t.g.message&&e===u.message,"function"==typeof(i=!("check"in u)||u.check)&&(i=i(t)),i?l?r(u):(t.dev.value&&(!1!==e&&s.groupEnd(),s.group(u.message)),"string"==typeof t.messages.value?(e=t.messages.value,a=t.messages.value):(e=u.message,a=t.format.value(u.message)),t.draw.update?(o(t,a),t.error.value?r(u):setTimeout((function(){return r(u)}),10)):r(u)):"otherwise"in u?t.error.value?r(u,"otherwise"):setTimeout((function(){return r(u,"otherwise")}),10):n()},t.messages.style.backup=t.group&&"1"===t.group.attr("opacity")?"small":"large",d=i(t),l()})),t.self},n(t,{active:e("./methods/active.js"),aggs:e("./methods/aggs.js"),attrs:e("./methods/attrs.js"),axes:e("./methods/axes.js"),background:e("./methods/background.js"),class:e("./methods/class.js"),color:e("./methods/color.js"),cols:e("./methods/cols.js"),config:e("./methods/config.js"),container:e("./methods/container.js"),coords:e("./methods/coords.js"),csv:e("./methods/csv.js"),data:e("./methods/data.js"),depth:e("./methods/depth.js"),descs:e("./methods/descs.js"),dev:e("./methods/dev.js"),draw:e("./methods/draw.js"),edges:e("./methods/edges.js"),error:e("./methods/error.js"),focus:e("./methods/focus.js"),font:e("./methods/font.js"),footer:e("./methods/footer.js"),format:e("./methods/format.js"),height:e("./methods/height.js"),history:e("./methods/history.js"),icon:e("./methods/icon.js"),id:e("./methods/id.js"),labels:e("./methods/labels.js"),legend:e("./methods/legend.js"),links:e("./methods/links.js"),margin:e("./methods/margin.js"),messages:e("./methods/messages.js"),mouse:e("./methods/mouse.js"),nodes:e("./methods/nodes.js"),order:e("./methods/order.js"),resize:e("./methods/resize.js"),shape:e("./methods/shape.js"),size:e("./methods/size.js"),style:e("./methods/style.js"),temp:e("./methods/temp.js"),text:e("./methods/text.js"),time:e("./methods/time.js"),timing:e("./methods/timing.js"),title:e("./methods/title.js"),tooltip:e("./methods/tooltip.js"),total:e("./methods/total.js"),type:e("./methods/type.js"),ui:e("./methods/ui.js"),width:e("./methods/width.js"),x:r("x"),x2:r("x2"),y:r("y"),y2:r("y2"),zoom:e("./methods/zoom.js")}),t.self}}).call(this)},{"../core/console/print.js":47,"../core/methods/attach.js":66,"../object/validate.js":158,"./helpers/container.js":197,"./helpers/drawSteps.js":198,"./helpers/ui/message.js":228,"./methods/active.js":236,"./methods/aggs.js":237,"./methods/attrs.js":238,"./methods/axes.js":239,"./methods/background.js":240,"./methods/class.js":241,"./methods/color.js":242,"./methods/cols.js":243,"./methods/config.js":244,"./methods/container.js":245,"./methods/coords.js":246,"./methods/csv.js":247,"./methods/data.js":248,"./methods/depth.js":249,"./methods/descs.js":250,"./methods/dev.js":251,"./methods/draw.js":252,"./methods/edges.js":253,"./methods/error.js":254,"./methods/focus.js":255,"./methods/font.js":256,"./methods/footer.js":257,"./methods/format.js":258,"./methods/height.js":259,"./methods/helpers/axis.js":260,"./methods/history.js":261,"./methods/icon.js":262,"./methods/id.js":263,"./methods/labels.js":264,"./methods/legend.js":265,"./methods/links.js":266,"./methods/margin.js":267,"./methods/messages.js":268,"./methods/mouse.js":269,"./methods/nodes.js":270,"./methods/order.js":271,"./methods/resize.js":272,"./methods/shape.js":273,"./methods/size.js":274,"./methods/style.js":275,"./methods/temp.js":276,"./methods/text.js":277,"./methods/time.js":278,"./methods/timing.js":279,"./methods/title.js":280,"./methods/tooltip.js":281,"./methods/total.js":282,"./methods/type.js":283,"./methods/ui.js":284,"./methods/width.js":285,"./methods/zoom.js":286,"./types/area.js":287,"./types/bar.js":288,"./types/box.js":289,"./types/line.js":299,"./types/network.js":300,"./types/paths.js":301,"./types/pie.js":302,"./types/scatter.js":303,"./types/treemap.js":304}]},{},[149]);</script>
<script>HTMLWidgets.widget({

  name: 'd3po',

  type: 'output',

  factory: function(el, width, height) {

    var chart;

    return {

      renderValue: function(x) {

        document.getElementById(el.id).innerHTML = "";
    
        // visualization method
        chart = new d3po.viz();
        chart.container("#" + el.id);

        // type
        chart.type(x.type);
    
        // add id if data present
        // network may just be constituted of edges
        if(x.data){
          chart.id(x.group);
          chart.data(x.data);
        }
        
        if (x.size) {
          chart.size(x.size);
        }
    
        // bar/line chart
        if (x.x) {
          chart.x(x.x);
        }
        if (x.y) {
          chart.y(x.y);
        }
    
        // title
        if (x.title) {
          chart.title(x.title);
        }
        
        // legend
        if(x.legend === undefined) {
          x.legend = false;
        }
        chart.legend(x.legend);
        
        // aesthetic parameters
        if (x.color) {
          chart.color(x.color);
        }
        
        if (x.labels) {
          chart.labels({"align": x.labels.align, "valign": x.labels.valign, "resize":x.labels.resize,
            "font": {"family": x.labels.font.family, "size": x.labels.font.size, "transform": x.labels.font.transform}
          });
        }

        if(x.edges)
          chart.edges(x.edges);

        if(x.nodes)
          chart.nodes(x.nodes);
          
          
        if(x.font) {
          chart.font({"family": x.font.family, "size": x.font.size, "transform": x.font.transform});
        }
        
        if(x.background)
          chart.background(x.background);
        
        chart.resize(true);
        
        chart.draw();

      },

      getChart: function(){
        return chart;
      }

    };
  }
});

function get_chart(id){

  var htmlWidgetsObj = HTMLWidgets.find("#" + id);

  var g;

  if (typeof htmlWidgetsObj != 'undefined') {
    g = htmlWidgetsObj.getChart();
  }

  return(g);
}

if (HTMLWidgets.shinyMode) {

  Shiny.addCustomMessageHandler('d3po-title',
    function(msg) {
      var chart = get_chart(msg.id);
      if (typeof chart != 'undefined') {
        chart.title(msg.title);
      }
  });

}
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to d3po</h1>



<p>The package <code>d3po</code> integrates well with
<code>dplyr</code>. All the examples here use the pipe,
<code>%&gt;%</code>, both to filter/summarise data and create the
charts.</p>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>Lets start by loading packages.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(d3po)</span></code></pre></div>
</div>
<div id="pokemon-dataset" class="section level1">
<h1>Pokemon dataset</h1>
<p>The included dataset <code>pokemon</code> has the present
structure:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(pokemon)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Rows: 151</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Columns: 15</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ id              &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ name            &lt;chr&gt; &quot;Bulbasaur&quot;, &quot;Ivysaur&quot;, &quot;Venusaur&quot;, &quot;Charmander&quot;, &quot;Cha</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ height          &lt;dbl&gt; 0.7, 1.0, 2.0, 0.6, 1.1, 1.7, 0.5, 1.0, 1.6, 0.3, 0.7,</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ weight          &lt;dbl&gt; 6.9, 13.0, 100.0, 8.5, 19.0, 90.5, 9.0, 22.5, 85.5, 2.</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ base_experience &lt;int&gt; 64, 142, 236, 62, 142, 240, 63, 142, 239, 39, 72, 178,</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ type_1          &lt;chr&gt; &quot;grass&quot;, &quot;grass&quot;, &quot;grass&quot;, &quot;fire&quot;, &quot;fire&quot;, &quot;fire&quot;, &quot;wa</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ type_2          &lt;chr&gt; &quot;poison&quot;, &quot;poison&quot;, &quot;poison&quot;, NA, NA, &quot;flying&quot;, NA, NA</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ attack          &lt;int&gt; 49, 62, 82, 52, 64, 84, 48, 63, 83, 30, 20, 45, 35, 25</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ defense         &lt;int&gt; 49, 63, 83, 43, 58, 78, 65, 80, 100, 35, 55, 50, 30, 5</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ hp              &lt;int&gt; 45, 60, 80, 39, 58, 78, 44, 59, 79, 45, 50, 60, 40, 45</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ special_attack  &lt;int&gt; 65, 80, 100, 60, 80, 109, 50, 65, 85, 20, 25, 90, 20, </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ special_defense &lt;int&gt; 65, 80, 100, 50, 65, 85, 64, 80, 105, 20, 25, 80, 20, </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ speed           &lt;int&gt; 45, 60, 80, 65, 80, 100, 43, 58, 78, 45, 30, 70, 50, 3</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ color_1         &lt;chr&gt; &quot;#78C850&quot;, &quot;#78C850&quot;, &quot;#78C850&quot;, &quot;#F08030&quot;, &quot;#F08030&quot;,</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ color_2         &lt;chr&gt; &quot;#A040A0&quot;, &quot;#A040A0&quot;, &quot;#A040A0&quot;, NA, NA, &quot;#A890F0&quot;, NA</span></span></code></pre></div>
</div>
<div id="box-and-whiskers" class="section level1">
<h1>Box and Whiskers</h1>
<p>To compare the distribution of <code>weight</code> by
<code>type_1</code>, the <code>pokemon</code> dataset doesnt need
additional aggregation or transformation, just to use the Pokemon
<code>name</code> as the grouping variable and (optionally) the
<code>color</code> variable:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">d3po</span>(pokemon) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_box</span>(<span class="fu">daes</span>(<span class="at">x =</span> type_1, <span class="at">y =</span> speed, <span class="at">group =</span> name, <span class="at">color =</span> color_1)) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_title</span>(<span class="st">&quot;Distribution of Pokemon Speed by Type&quot;</span>)</span></code></pre></div>
<div class="d3po html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-95dc222984e74e5b2b9c" style="width:288px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-95dc222984e74e5b2b9c">{"x":{"type":"box","data":[{"type_1":"grass","speed":45,"name":"Bulbasaur","color_1":"#78C850"},{"type_1":"grass","speed":60,"name":"Ivysaur","color_1":"#78C850"},{"type_1":"grass","speed":80,"name":"Venusaur","color_1":"#78C850"},{"type_1":"fire","speed":65,"name":"Charmander","color_1":"#F08030"},{"type_1":"fire","speed":80,"name":"Charmeleon","color_1":"#F08030"},{"type_1":"fire","speed":100,"name":"Charizard","color_1":"#F08030"},{"type_1":"water","speed":43,"name":"Squirtle","color_1":"#6890F0"},{"type_1":"water","speed":58,"name":"Wartortle","color_1":"#6890F0"},{"type_1":"water","speed":78,"name":"Blastoise","color_1":"#6890F0"},{"type_1":"bug","speed":45,"name":"Caterpie","color_1":"#A8B820"},{"type_1":"bug","speed":30,"name":"Metapod","color_1":"#A8B820"},{"type_1":"bug","speed":70,"name":"Butterfree","color_1":"#A8B820"},{"type_1":"bug","speed":50,"name":"Weedle","color_1":"#A8B820"},{"type_1":"bug","speed":35,"name":"Kakuna","color_1":"#A8B820"},{"type_1":"bug","speed":75,"name":"Beedrill","color_1":"#A8B820"},{"type_1":"normal","speed":56,"name":"Pidgey","color_1":"#A8A878"},{"type_1":"normal","speed":71,"name":"Pidgeotto","color_1":"#A8A878"},{"type_1":"normal","speed":101,"name":"Pidgeot","color_1":"#A8A878"},{"type_1":"normal","speed":72,"name":"Rattata","color_1":"#A8A878"},{"type_1":"normal","speed":97,"name":"Raticate","color_1":"#A8A878"},{"type_1":"normal","speed":70,"name":"Spearow","color_1":"#A8A878"},{"type_1":"normal","speed":100,"name":"Fearow","color_1":"#A8A878"},{"type_1":"poison","speed":55,"name":"Ekans","color_1":"#A040A0"},{"type_1":"poison","speed":80,"name":"Arbok","color_1":"#A040A0"},{"type_1":"electric","speed":90,"name":"Pikachu","color_1":"#F8D030"},{"type_1":"electric","speed":110,"name":"Raichu","color_1":"#F8D030"},{"type_1":"ground","speed":40,"name":"Sandshrew","color_1":"#E0C068"},{"type_1":"ground","speed":65,"name":"Sandslash","color_1":"#E0C068"},{"type_1":"poison","speed":41,"name":"Nidoran-F","color_1":"#A040A0"},{"type_1":"poison","speed":56,"name":"Nidorina","color_1":"#A040A0"},{"type_1":"poison","speed":76,"name":"Nidoqueen","color_1":"#A040A0"},{"type_1":"poison","speed":50,"name":"Nidoran-M","color_1":"#A040A0"},{"type_1":"poison","speed":65,"name":"Nidorino","color_1":"#A040A0"},{"type_1":"poison","speed":85,"name":"Nidoking","color_1":"#A040A0"},{"type_1":"fairy","speed":35,"name":"Clefairy","color_1":"#EE99AC"},{"type_1":"fairy","speed":60,"name":"Clefable","color_1":"#EE99AC"},{"type_1":"fire","speed":65,"name":"Vulpix","color_1":"#F08030"},{"type_1":"fire","speed":100,"name":"Ninetales","color_1":"#F08030"},{"type_1":"normal","speed":20,"name":"Jigglypuff","color_1":"#A8A878"},{"type_1":"normal","speed":45,"name":"Wigglytuff","color_1":"#A8A878"},{"type_1":"poison","speed":55,"name":"Zubat","color_1":"#A040A0"},{"type_1":"poison","speed":90,"name":"Golbat","color_1":"#A040A0"},{"type_1":"grass","speed":30,"name":"Oddish","color_1":"#78C850"},{"type_1":"grass","speed":40,"name":"Gloom","color_1":"#78C850"},{"type_1":"grass","speed":50,"name":"Vileplume","color_1":"#78C850"},{"type_1":"bug","speed":25,"name":"Paras","color_1":"#A8B820"},{"type_1":"bug","speed":30,"name":"Parasect","color_1":"#A8B820"},{"type_1":"bug","speed":45,"name":"Venonat","color_1":"#A8B820"},{"type_1":"bug","speed":90,"name":"Venomoth","color_1":"#A8B820"},{"type_1":"ground","speed":95,"name":"Diglett","color_1":"#E0C068"},{"type_1":"ground","speed":120,"name":"Dugtrio","color_1":"#E0C068"},{"type_1":"normal","speed":90,"name":"Meowth","color_1":"#A8A878"},{"type_1":"normal","speed":115,"name":"Persian","color_1":"#A8A878"},{"type_1":"water","speed":55,"name":"Psyduck","color_1":"#6890F0"},{"type_1":"water","speed":85,"name":"Golduck","color_1":"#6890F0"},{"type_1":"fighting","speed":70,"name":"Mankey","color_1":"#C03028"},{"type_1":"fighting","speed":95,"name":"Primeape","color_1":"#C03028"},{"type_1":"fire","speed":60,"name":"Growlithe","color_1":"#F08030"},{"type_1":"fire","speed":95,"name":"Arcanine","color_1":"#F08030"},{"type_1":"water","speed":90,"name":"Poliwag","color_1":"#6890F0"},{"type_1":"water","speed":90,"name":"Poliwhirl","color_1":"#6890F0"},{"type_1":"water","speed":70,"name":"Poliwrath","color_1":"#6890F0"},{"type_1":"psychic","speed":90,"name":"Abra","color_1":"#F85888"},{"type_1":"psychic","speed":105,"name":"Kadabra","color_1":"#F85888"},{"type_1":"psychic","speed":120,"name":"Alakazam","color_1":"#F85888"},{"type_1":"fighting","speed":35,"name":"Machop","color_1":"#C03028"},{"type_1":"fighting","speed":45,"name":"Machoke","color_1":"#C03028"},{"type_1":"fighting","speed":55,"name":"Machamp","color_1":"#C03028"},{"type_1":"grass","speed":40,"name":"Bellsprout","color_1":"#78C850"},{"type_1":"grass","speed":55,"name":"Weepinbell","color_1":"#78C850"},{"type_1":"grass","speed":70,"name":"Victreebel","color_1":"#78C850"},{"type_1":"water","speed":70,"name":"Tentacool","color_1":"#6890F0"},{"type_1":"water","speed":100,"name":"Tentacruel","color_1":"#6890F0"},{"type_1":"rock","speed":20,"name":"Geodude","color_1":"#B8A038"},{"type_1":"rock","speed":35,"name":"Graveler","color_1":"#B8A038"},{"type_1":"rock","speed":45,"name":"Golem","color_1":"#B8A038"},{"type_1":"fire","speed":90,"name":"Ponyta","color_1":"#F08030"},{"type_1":"fire","speed":105,"name":"Rapidash","color_1":"#F08030"},{"type_1":"water","speed":15,"name":"Slowpoke","color_1":"#6890F0"},{"type_1":"water","speed":30,"name":"Slowbro","color_1":"#6890F0"},{"type_1":"electric","speed":45,"name":"Magnemite","color_1":"#F8D030"},{"type_1":"electric","speed":70,"name":"Magneton","color_1":"#F8D030"},{"type_1":"normal","speed":60,"name":"Farfetchd","color_1":"#A8A878"},{"type_1":"normal","speed":75,"name":"Doduo","color_1":"#A8A878"},{"type_1":"normal","speed":100,"name":"Dodrio","color_1":"#A8A878"},{"type_1":"water","speed":45,"name":"Seel","color_1":"#6890F0"},{"type_1":"water","speed":70,"name":"Dewgong","color_1":"#6890F0"},{"type_1":"poison","speed":25,"name":"Grimer","color_1":"#A040A0"},{"type_1":"poison","speed":50,"name":"Muk","color_1":"#A040A0"},{"type_1":"water","speed":40,"name":"Shellder","color_1":"#6890F0"},{"type_1":"water","speed":70,"name":"Cloyster","color_1":"#6890F0"},{"type_1":"ghost","speed":80,"name":"Gastly","color_1":"#705898"},{"type_1":"ghost","speed":95,"name":"Haunter","color_1":"#705898"},{"type_1":"ghost","speed":110,"name":"Gengar","color_1":"#705898"},{"type_1":"rock","speed":70,"name":"Onix","color_1":"#B8A038"},{"type_1":"psychic","speed":42,"name":"Drowzee","color_1":"#F85888"},{"type_1":"psychic","speed":67,"name":"Hypno","color_1":"#F85888"},{"type_1":"water","speed":50,"name":"Krabby","color_1":"#6890F0"},{"type_1":"water","speed":75,"name":"Kingler","color_1":"#6890F0"},{"type_1":"electric","speed":100,"name":"Voltorb","color_1":"#F8D030"},{"type_1":"electric","speed":140,"name":"Electrode","color_1":"#F8D030"},{"type_1":"grass","speed":40,"name":"Exeggcute","color_1":"#78C850"},{"type_1":"grass","speed":55,"name":"Exeggutor","color_1":"#78C850"},{"type_1":"ground","speed":35,"name":"Cubone","color_1":"#E0C068"},{"type_1":"ground","speed":45,"name":"Marowak","color_1":"#E0C068"},{"type_1":"fighting","speed":87,"name":"Hitmonlee","color_1":"#C03028"},{"type_1":"fighting","speed":76,"name":"Hitmonchan","color_1":"#C03028"},{"type_1":"normal","speed":30,"name":"Lickitung","color_1":"#A8A878"},{"type_1":"poison","speed":35,"name":"Koffing","color_1":"#A040A0"},{"type_1":"poison","speed":60,"name":"Weezing","color_1":"#A040A0"},{"type_1":"ground","speed":25,"name":"Rhyhorn","color_1":"#E0C068"},{"type_1":"ground","speed":40,"name":"Rhydon","color_1":"#E0C068"},{"type_1":"normal","speed":50,"name":"Chansey","color_1":"#A8A878"},{"type_1":"grass","speed":60,"name":"Tangela","color_1":"#78C850"},{"type_1":"normal","speed":90,"name":"Kangaskhan","color_1":"#A8A878"},{"type_1":"water","speed":60,"name":"Horsea","color_1":"#6890F0"},{"type_1":"water","speed":85,"name":"Seadra","color_1":"#6890F0"},{"type_1":"water","speed":63,"name":"Goldeen","color_1":"#6890F0"},{"type_1":"water","speed":68,"name":"Seaking","color_1":"#6890F0"},{"type_1":"water","speed":85,"name":"Staryu","color_1":"#6890F0"},{"type_1":"water","speed":115,"name":"Starmie","color_1":"#6890F0"},{"type_1":"psychic","speed":90,"name":"Mr-Mime","color_1":"#F85888"},{"type_1":"bug","speed":105,"name":"Scyther","color_1":"#A8B820"},{"type_1":"ice","speed":95,"name":"Jynx","color_1":"#98D8D8"},{"type_1":"electric","speed":105,"name":"Electabuzz","color_1":"#F8D030"},{"type_1":"fire","speed":93,"name":"Magmar","color_1":"#F08030"},{"type_1":"bug","speed":85,"name":"Pinsir","color_1":"#A8B820"},{"type_1":"normal","speed":110,"name":"Tauros","color_1":"#A8A878"},{"type_1":"water","speed":80,"name":"Magikarp","color_1":"#6890F0"},{"type_1":"water","speed":81,"name":"Gyarados","color_1":"#6890F0"},{"type_1":"water","speed":60,"name":"Lapras","color_1":"#6890F0"},{"type_1":"normal","speed":48,"name":"Ditto","color_1":"#A8A878"},{"type_1":"normal","speed":55,"name":"Eevee","color_1":"#A8A878"},{"type_1":"water","speed":65,"name":"Vaporeon","color_1":"#6890F0"},{"type_1":"electric","speed":130,"name":"Jolteon","color_1":"#F8D030"},{"type_1":"fire","speed":65,"name":"Flareon","color_1":"#F08030"},{"type_1":"normal","speed":40,"name":"Porygon","color_1":"#A8A878"},{"type_1":"rock","speed":35,"name":"Omanyte","color_1":"#B8A038"},{"type_1":"rock","speed":55,"name":"Omastar","color_1":"#B8A038"},{"type_1":"rock","speed":55,"name":"Kabuto","color_1":"#B8A038"},{"type_1":"rock","speed":80,"name":"Kabutops","color_1":"#B8A038"},{"type_1":"rock","speed":130,"name":"Aerodactyl","color_1":"#B8A038"},{"type_1":"normal","speed":30,"name":"Snorlax","color_1":"#A8A878"},{"type_1":"ice","speed":85,"name":"Articuno","color_1":"#98D8D8"},{"type_1":"electric","speed":100,"name":"Zapdos","color_1":"#F8D030"},{"type_1":"fire","speed":90,"name":"Moltres","color_1":"#F08030"},{"type_1":"dragon","speed":50,"name":"Dratini","color_1":"#7038F8"},{"type_1":"dragon","speed":70,"name":"Dragonair","color_1":"#7038F8"},{"type_1":"dragon","speed":80,"name":"Dragonite","color_1":"#7038F8"},{"type_1":"psychic","speed":130,"name":"Mewtwo","color_1":"#F85888"},{"type_1":"psychic","speed":100,"name":"Mew","color_1":"#F85888"}],"x":"type_1","y":"speed","group":"name","color":"color_1","title":"Distribution of Pokemon Speed by Type"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="bar" class="section level1">
<h1>Bar</h1>
<p>Lets start by counting Pokemon by type:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pokemon_count <span class="ot">&lt;-</span> pokemon <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(type_1, color_1) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">count</span>()</span></code></pre></div>
<p>Now we can create a bar chart by using <code>type_1</code> both for
the <code>x</code> axis and the <code>group_by</code> variable provided
this data has no <code>year</code> column or similar:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">d3po</span>(pokemon_count) <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_bar</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">daes</span>(<span class="at">x =</span> type_1, <span class="at">y =</span> n, <span class="at">group =</span> type_1, <span class="at">color =</span> color_1)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_title</span>(<span class="st">&quot;Count of Pokemon by Type&quot;</span>)</span></code></pre></div>
<div class="d3po html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-06117323bef56a29c47d" style="width:288px;height:288px;"></div>
<script type="application/json" data-for="htmlwidget-06117323bef56a29c47d">{"x":{"type":"bar","data":[{"type_1":"bug","n":12,"color_1":"#A8B820"},{"type_1":"dragon","n":3,"color_1":"#7038F8"},{"type_1":"electric","n":9,"color_1":"#F8D030"},{"type_1":"fairy","n":2,"color_1":"#EE99AC"},{"type_1":"fighting","n":7,"color_1":"#C03028"},{"type_1":"fire","n":12,"color_1":"#F08030"},{"type_1":"ghost","n":3,"color_1":"#705898"},{"type_1":"grass","n":12,"color_1":"#78C850"},{"type_1":"ground","n":8,"color_1":"#E0C068"},{"type_1":"ice","n":2,"color_1":"#98D8D8"},{"type_1":"normal","n":22,"color_1":"#A8A878"},{"type_1":"poison","n":14,"color_1":"#A040A0"},{"type_1":"psychic","n":8,"color_1":"#F85888"},{"type_1":"rock","n":9,"color_1":"#B8A038"},{"type_1":"water","n":28,"color_1":"#6890F0"}],"x":"type_1","y":"n","group":"type_1","color":"color_1","title":"Count of Pokemon by Type"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="treemap" class="section level1">
<h1>Treemap</h1>
<p>By using the <code>pokemon_count</code> table created for the bar
chart, the logic is exactly the same and we only need to change the
function and specify the <code>size</code> instead of <code>x</code> and
<code>y</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">d3po</span>(pokemon_count) <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_treemap</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">daes</span>(<span class="at">size =</span> n, <span class="at">group =</span> type_1, <span class="at">color =</span> color_1)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_title</span>(<span class="st">&quot;Share of Pokemon by Type&quot;</span>)</span></code></pre></div>
<div class="d3po html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f06888936ede1e34c697" style="width:288px;height:288px;"></div>
<script type="application/json" data-for="htmlwidget-f06888936ede1e34c697">{"x":{"type":"treemap","data":[{"n":12,"type_1":"bug","color_1":"#A8B820"},{"n":3,"type_1":"dragon","color_1":"#7038F8"},{"n":9,"type_1":"electric","color_1":"#F8D030"},{"n":2,"type_1":"fairy","color_1":"#EE99AC"},{"n":7,"type_1":"fighting","color_1":"#C03028"},{"n":12,"type_1":"fire","color_1":"#F08030"},{"n":3,"type_1":"ghost","color_1":"#705898"},{"n":12,"type_1":"grass","color_1":"#78C850"},{"n":8,"type_1":"ground","color_1":"#E0C068"},{"n":2,"type_1":"ice","color_1":"#98D8D8"},{"n":22,"type_1":"normal","color_1":"#A8A878"},{"n":14,"type_1":"poison","color_1":"#A040A0"},{"n":8,"type_1":"psychic","color_1":"#F85888"},{"n":9,"type_1":"rock","color_1":"#B8A038"},{"n":28,"type_1":"water","color_1":"#6890F0"}],"size":"n","group":"type_1","color":"color_1","title":"Share of Pokemon by Type"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="pie" class="section level1">
<h1>Pie</h1>
<p>Use these plots with caution because polar coordinates has major
perceptual problems. Use with <em>EXTREME</em> caution.</p>
<p>This method is exactly the same as <code>treemap</code> but changing
the function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">d3po</span>(pokemon_count) <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_pie</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">daes</span>(<span class="at">size =</span> n, <span class="at">group =</span> type_1, <span class="at">color =</span> color_1)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_title</span>(<span class="st">&quot;Share of Pokemon by Type&quot;</span>)</span></code></pre></div>
<div class="d3po html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-30d14afda236bd67e5f3" style="width:288px;height:288px;"></div>
<script type="application/json" data-for="htmlwidget-30d14afda236bd67e5f3">{"x":{"type":"pie","data":[{"n":12,"type_1":"bug","color_1":"#A8B820"},{"n":3,"type_1":"dragon","color_1":"#7038F8"},{"n":9,"type_1":"electric","color_1":"#F8D030"},{"n":2,"type_1":"fairy","color_1":"#EE99AC"},{"n":7,"type_1":"fighting","color_1":"#C03028"},{"n":12,"type_1":"fire","color_1":"#F08030"},{"n":3,"type_1":"ghost","color_1":"#705898"},{"n":12,"type_1":"grass","color_1":"#78C850"},{"n":8,"type_1":"ground","color_1":"#E0C068"},{"n":2,"type_1":"ice","color_1":"#98D8D8"},{"n":22,"type_1":"normal","color_1":"#A8A878"},{"n":14,"type_1":"poison","color_1":"#A040A0"},{"n":8,"type_1":"psychic","color_1":"#F85888"},{"n":9,"type_1":"rock","color_1":"#B8A038"},{"n":28,"type_1":"water","color_1":"#6890F0"}],"size":"n","group":"type_1","color":"color_1","title":"Share of Pokemon by Type"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="line" class="section level1">
<h1>Line</h1>
<p>Lets start by obtaining the decile for the Pokemon
<code>weight</code> just for the grass, fire and water type:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pokemon_decile <span class="ot">&lt;-</span> pokemon <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type_1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;grass&quot;</span>, <span class="st">&quot;fire&quot;</span>, <span class="st">&quot;water&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type_1 ,color_1) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">decile =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="fu">quantile</span>(weight, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dplyr 1.1.0.</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Please use `reframe()` instead.</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  When switching from `summarise()` to `reframe()`, remember that `reframe()`</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   always returns an ungrouped data frame and adjust accordingly.</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;type_1&#39;, &#39;color_1&#39;. You can override using</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; the `.groups` argument.</span></span></code></pre></div>
<p>Now we can create an area chart by using the <code>variable</code>
and <code>color</code> columns created above:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">d3po</span>(pokemon_decile) <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_line</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">daes</span>(<span class="at">x =</span> decile, <span class="at">y =</span> weight, <span class="at">group =</span> type_1, <span class="at">color =</span> color_1)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_title</span>(<span class="st">&quot;Decile of Pokemon Weight by Type&quot;</span>)</span></code></pre></div>
<div class="d3po html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2651404713f68385c10f" style="width:288px;height:288px;"></div>
<script type="application/json" data-for="htmlwidget-2651404713f68385c10f">{"x":{"type":"line","data":[{"decile":0,"weight":8.5,"type_1":"fire","color_1":"#F08030"},{"decile":1,"weight":10.81,"type_1":"fire","color_1":"#F08030"},{"decile":2,"weight":19,"type_1":"fire","color_1":"#F08030"},{"decile":3,"weight":19.27,"type_1":"fire","color_1":"#F08030"},{"decile":4,"weight":21.94,"type_1":"fire","color_1":"#F08030"},{"decile":5,"weight":27.5,"type_1":"fire","color_1":"#F08030"},{"decile":6,"weight":38.7,"type_1":"fire","color_1":"#F08030"},{"decile":7,"weight":55.35,"type_1":"fire","color_1":"#F08030"},{"decile":8,"weight":84.4,"type_1":"fire","color_1":"#F08030"},{"decile":9,"weight":94.55,"type_1":"fire","color_1":"#F08030"},{"decile":10,"weight":155,"type_1":"fire","color_1":"#F08030"},{"decile":0,"weight":2.5,"type_1":"grass","color_1":"#78C850"},{"decile":1,"weight":4.14,"type_1":"grass","color_1":"#78C850"},{"decile":2,"weight":5.6,"type_1":"grass","color_1":"#78C850"},{"decile":3,"weight":6.55,"type_1":"grass","color_1":"#78C850"},{"decile":4,"weight":7.58,"type_1":"grass","color_1":"#78C850"},{"decile":5,"weight":10.8,"type_1":"grass","color_1":"#78C850"},{"decile":6,"weight":14.5,"type_1":"grass","color_1":"#78C850"},{"decile":7,"weight":17.67,"type_1":"grass","color_1":"#78C850"},{"decile":8,"weight":31.72,"type_1":"grass","color_1":"#78C850"},{"decile":9,"weight":93.5,"type_1":"grass","color_1":"#78C850"},{"decile":10,"weight":120,"type_1":"grass","color_1":"#78C850"},{"decile":0,"weight":4,"type_1":"water","color_1":"#6890F0"},{"decile":1,"weight":8.7,"type_1":"water","color_1":"#6890F0"},{"decile":2,"weight":13.44,"type_1":"water","color_1":"#6890F0"},{"decile":3,"weight":20.25,"type_1":"water","color_1":"#6890F0"},{"decile":4,"weight":28.2,"type_1":"water","color_1":"#6890F0"},{"decile":5,"weight":37.5,"type_1":"water","color_1":"#6890F0"},{"decile":6,"weight":54.2,"type_1":"water","color_1":"#6890F0"},{"decile":7,"weight":74.94,"type_1":"water","color_1":"#6890F0"},{"decile":8,"weight":83.3,"type_1":"water","color_1":"#6890F0"},{"decile":9,"weight":123.75,"type_1":"water","color_1":"#6890F0"},{"decile":10,"weight":235,"type_1":"water","color_1":"#6890F0"}],"x":"decile","y":"weight","group":"type_1","color":"color_1","title":"Decile of Pokemon Weight by Type"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="area" class="section level1">
<h1>Area</h1>
<p>Lets start by obtaining the density for the Pokemon
<code>weight</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pokemon_density <span class="ot">&lt;-</span> <span class="fu">density</span>(pokemon<span class="sc">$</span>weight, <span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>pokemon_density <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a> <span class="at">x =</span> pokemon_density<span class="sc">$</span>x,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a> <span class="at">y =</span> pokemon_density<span class="sc">$</span>y,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a> <span class="at">variable =</span> <span class="st">&quot;weight&quot;</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a> <span class="at">color =</span> <span class="st">&quot;#5377e3&quot;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Now we can create an area chart by using the <code>variable</code>
and <code>color</code> columns created above:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">d3po</span>(pokemon_density) <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">po_area</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">daes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">group =</span> variable, <span class="at">color =</span> color)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a> ) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">po_title</span>(<span class="st">&quot;Approximated Density of Pokemon Weight&quot;</span>)</span></code></pre></div>
<div class="d3po html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ffaeb1e37450a23660cf" style="width:288px;height:288px;"></div>
<script type="application/json" data-for="htmlwidget-ffaeb1e37450a23660cf">{"x":{"type":"area","data":[{"x":-34.138388444083,"y":3.20905661541855e-05,"variable":"weight","color":"#5377e3"},{"x":-15.9184995858704,"y":0.00186548635970611,"variable":"weight","color":"#5377e3"},{"x":2.30138927234222,"y":0.0117159201483653,"variable":"weight","color":"#5377e3"},{"x":20.5212781305548,"y":0.0137356938046998,"variable":"weight","color":"#5377e3"},{"x":38.7411669887675,"y":0.00976435837744151,"variable":"weight","color":"#5377e3"},{"x":56.9610558469801,"y":0.00633427324995039,"variable":"weight","color":"#5377e3"},{"x":75.1809447051927,"y":0.00363625793294446,"variable":"weight","color":"#5377e3"},{"x":93.4008335634053,"y":0.00225343252250074,"variable":"weight","color":"#5377e3"},{"x":111.620722421618,"y":0.00158739911422691,"variable":"weight","color":"#5377e3"},{"x":129.840611279831,"y":0.00127214969196276,"variable":"weight","color":"#5377e3"},{"x":148.060500138043,"y":0.000405661530331513,"variable":"weight","color":"#5377e3"},{"x":166.280388996256,"y":0.000147254269528739,"variable":"weight","color":"#5377e3"},{"x":184.500277854468,"y":4.86417954557536e-05,"variable":"weight","color":"#5377e3"},{"x":202.720166712681,"y":0.000456040445634336,"variable":"weight","color":"#5377e3"},{"x":220.940055570894,"y":0.000631808226297796,"variable":"weight","color":"#5377e3"},{"x":239.159944429106,"y":0.000291036871401994,"variable":"weight","color":"#5377e3"},{"x":257.379833287319,"y":3.55434985997577e-05,"variable":"weight","color":"#5377e3"},{"x":275.599722145532,"y":2.41802287356286e-05,"variable":"weight","color":"#5377e3"},{"x":293.819611003744,"y":0.000199800855904024,"variable":"weight","color":"#5377e3"},{"x":312.039499861957,"y":0.000132869564687455,"variable":"weight","color":"#5377e3"},{"x":330.259388720169,"y":6.99765207915754e-06,"variable":"weight","color":"#5377e3"},{"x":348.479277578382,"y":2.92284908027754e-08,"variable":"weight","color":"#5377e3"},{"x":366.699166436595,"y":9.69414362821695e-12,"variable":"weight","color":"#5377e3"},{"x":384.919055294807,"y":1.03395150959981e-13,"variable":"weight","color":"#5377e3"},{"x":403.13894415302,"y":1.00375124371527e-09,"variable":"weight","color":"#5377e3"},{"x":421.358833011233,"y":7.722406603017e-07,"variable":"weight","color":"#5377e3"},{"x":439.578721869445,"y":4.70230524996806e-05,"variable":"weight","color":"#5377e3"},{"x":457.798610727658,"y":0.000226843842429473,"variable":"weight","color":"#5377e3"},{"x":476.01849958587,"y":8.67709146087996e-05,"variable":"weight","color":"#5377e3"},{"x":494.238388444083,"y":2.63380941651608e-06,"variable":"weight","color":"#5377e3"}],"x":"x","y":"y","group":"variable","color":"color","title":"Approximated Density of Pokemon Weight"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="scatterplot" class="section level1">
<h1>Scatterplot</h1>
<p>Lets explore the balance between defense and attack by Pokemon
type:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pokemon_def_vs_att <span class="ot">&lt;-</span> pokemon <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type_1, color_1) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_def =</span> <span class="fu">mean</span>(defense),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_att =</span> <span class="fu">mean</span>(attack),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_pkmn =</span> <span class="fu">n</span>()</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;type_1&#39;. You can override using the</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `.groups` argument.</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">d3po</span>(pokemon_def_vs_att) <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_scatter</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">daes</span>(<span class="at">x =</span> mean_att, <span class="at">y =</span> mean_def, <span class="at">size =</span> n_pkmn, <span class="at">group =</span> type_1, <span class="at">color =</span> color_1)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_title</span>(<span class="st">&quot;Average Attack vs Average Defense by Type&quot;</span>)</span></code></pre></div>
<div class="d3po html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f75ddcc400506acd0bb1" style="width:288px;height:288px;"></div>
<script type="application/json" data-for="htmlwidget-f75ddcc400506acd0bb1">{"x":{"type":"scatter","data":[{"mean_att":63.75,"mean_def":57.0833333333333,"n_pkmn":12,"type_1":"bug","color_1":"#A8B820"},{"mean_att":94,"mean_def":68.3333333333333,"n_pkmn":3,"type_1":"dragon","color_1":"#7038F8"},{"mean_att":62,"mean_def":64.6666666666667,"n_pkmn":9,"type_1":"electric","color_1":"#F8D030"},{"mean_att":57.5,"mean_def":60.5,"n_pkmn":2,"type_1":"fairy","color_1":"#EE99AC"},{"mean_att":102.857142857143,"mean_def":61,"n_pkmn":7,"type_1":"fighting","color_1":"#C03028"},{"mean_att":83.9166666666667,"mean_def":62.5833333333333,"n_pkmn":12,"type_1":"fire","color_1":"#F08030"},{"mean_att":50,"mean_def":45,"n_pkmn":3,"type_1":"ghost","color_1":"#705898"},{"mean_att":70.6666666666667,"mean_def":69.5833333333333,"n_pkmn":12,"type_1":"grass","color_1":"#78C850"},{"mean_att":81.875,"mean_def":86.25,"n_pkmn":8,"type_1":"ground","color_1":"#E0C068"},{"mean_att":67.5,"mean_def":67.5,"n_pkmn":2,"type_1":"ice","color_1":"#98D8D8"},{"mean_att":67.7272727272727,"mean_def":53.5454545454545,"n_pkmn":22,"type_1":"normal","color_1":"#A8A878"},{"mean_att":74.4285714285714,"mean_def":67,"n_pkmn":14,"type_1":"poison","color_1":"#A040A0"},{"mean_att":60.125,"mean_def":57.5,"n_pkmn":8,"type_1":"psychic","color_1":"#F85888"},{"mean_att":82.2222222222222,"mean_def":110,"n_pkmn":9,"type_1":"rock","color_1":"#B8A038"},{"mean_att":70.25,"mean_def":77.5,"n_pkmn":28,"type_1":"water","color_1":"#6890F0"}],"x":"mean_att","y":"mean_def","size":"n_pkmn","group":"type_1","color":"color_1","title":"Average Attack vs Average Defense by Type"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="network" class="section level1">
<h1>Network</h1>
<p>This visualization method is different to the rest, as it can work
with a single <code>data</code> object or <code>data</code>,
<code>nodes</code> and <code>edges</code> objects by separate.</p>
<p>Lets create an igraph object:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tr <span class="ot">&lt;-</span> <span class="fu">make_tree</span>(<span class="dv">40</span>, <span class="at">children =</span> <span class="dv">3</span>, <span class="at">mode =</span> <span class="st">&quot;undirected&quot;</span>)</span></code></pre></div>
<p>To visualize is as simple as:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">d3po</span>(tr) <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_layout</span>() <span class="co"># optional</span></span></code></pre></div>
<div class="d3po html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f58e4cfc88cdcaad7533" style="width:288px;height:288px;"></div>
<script type="application/json" data-for="htmlwidget-f58e4cfc88cdcaad7533">{"x":{"group":"name","type":"network","edges":[{"source":1,"target":2},{"source":1,"target":3},{"source":1,"target":4},{"source":2,"target":5},{"source":2,"target":6},{"source":2,"target":7},{"source":3,"target":8},{"source":3,"target":9},{"source":3,"target":10},{"source":4,"target":11},{"source":4,"target":12},{"source":4,"target":13},{"source":5,"target":14},{"source":5,"target":15},{"source":5,"target":16},{"source":6,"target":17},{"source":6,"target":18},{"source":6,"target":19},{"source":7,"target":20},{"source":7,"target":21},{"source":7,"target":22},{"source":8,"target":23},{"source":8,"target":24},{"source":8,"target":25},{"source":9,"target":26},{"source":9,"target":27},{"source":9,"target":28},{"source":10,"target":29},{"source":10,"target":30},{"source":10,"target":31},{"source":11,"target":32},{"source":11,"target":33},{"source":11,"target":34},{"source":12,"target":35},{"source":12,"target":36},{"source":12,"target":37},{"source":13,"target":38},{"source":13,"target":39},{"source":13,"target":40}],"data":[{"name":1},{"name":2},{"name":3},{"name":4},{"name":5},{"name":6},{"name":7},{"name":8},{"name":9},{"name":10},{"name":11},{"name":12},{"name":13},{"name":14},{"name":15},{"name":16},{"name":17},{"name":18},{"name":19},{"name":20},{"name":21},{"name":22},{"name":23},{"name":24},{"name":25},{"name":26},{"name":27},{"name":28},{"name":29},{"name":30},{"name":31},{"name":32},{"name":33},{"name":34},{"name":35},{"name":36},{"name":37},{"name":38},{"name":39},{"name":40}],"nodes":[{"name":1,"x":-0.0377756224224959,"y":2.34583607829431},{"name":2,"x":-4.45692918301221,"y":2.84451271524588},{"name":3,"x":2.53847849159122,"y":6.44505246083651},{"name":4,"x":1.41046975523068,"y":-2.23264950476847},{"name":5,"x":-6.15962416886615,"y":0.57241010436865},{"name":6,"x":-7.73362960890805,"y":3.13343517764298},{"name":7,"x":-5.90454831211794,"y":5.43869442171822},{"name":8,"x":4.49467624571915,"y":9.23747694057138},{"name":9,"x":5.52751909675866,"y":6.54065218619292},{"name":10,"x":1.64148193851955,"y":9.53708413158269},{"name":11,"x":-0.113058970711953,"y":-5.25932115535248},{"name":12,"x":2.59674486958199,"y":-5.17615259647791},{"name":13,"x":4.30211152758188,"y":-2.96541902814478},{"name":14,"x":-7.81806750473407,"y":0.0828507507095526},{"name":15,"x":-7.36292545282157,"y":-0.885875700689754},{"name":16,"x":-6.20503561469047,"y":-0.992131336025459},{"name":17,"x":-9.25012974150998,"y":4.18883664144795},{"name":18,"x":-9.76384741499497,"y":3.30329617099172},{"name":19,"x":-9.38593982820945,"y":2.34860618792047},{"name":20,"x":-5.66808778372676,"y":7.00819569591868},{"name":21,"x":-7.48463016468563,"y":6.273322108873},{"name":22,"x":-6.83295229664291,"y":7.11314684509466},{"name":23,"x":5.71833971250257,"y":10.9335793180889},{"name":24,"x":6.17227975660357,"y":10.0319159911525},{"name":25,"x":4.71965523630722,"y":11.0694622663908},{"name":26,"x":7.00888345137955,"y":7.51938355585744},{"name":27,"x":7.43625156247913,"y":6.58124632661652},{"name":28,"x":6.86547451175065,"y":5.62229116058127},{"name":29,"x":2.11227009071556,"y":11.2558211799674},{"name":30,"x":0.376013587758871,"y":10.6646548032852},{"name":31,"x":1.10795543944148,"y":11.4864055118946},{"name":32,"x":-1.59131190411803,"y":-6.25675833872715},{"name":33,"x":-0.0233523949355648,"y":-7.14402350792975},{"name":34,"x":-1.01715398646694,"y":-7.13836266501942},{"name":35,"x":4.04456156112537,"y":-6.25851295010139},{"name":36,"x":3.39284861737828,"y":-7.03685260897201},{"name":37,"x":2.39269507548679,"y":-6.92998446384276},{"name":38,"x":5.56015465181861,"y":-4.24773874563004},{"name":39,"x":6.16265792495538,"y":-3.40593222091548},{"name":40,"x":5.78442379603898,"y":-2.34353014174348}]},"evals":[],"jsHooks":[]}</script>
<p>Another option is to work with a <code>data.frame</code> or
<code>tibble</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">as_data_frame</span>(tr, <span class="st">&quot;edges&quot;</span>)</span></code></pre></div>
<p>Which is also visualized in a straightforward manner:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">d3po</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_edges</span>(<span class="at">data =</span> edges)</span></code></pre></div>
<div class="d3po html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e308f9d791cb8b9623a6" style="width:288px;height:288px;"></div>
<script type="application/json" data-for="htmlwidget-e308f9d791cb8b9623a6">{"x":{"type":"network","edges":[{"source":1,"target":2},{"source":1,"target":3},{"source":1,"target":4},{"source":2,"target":5},{"source":2,"target":6},{"source":2,"target":7},{"source":3,"target":8},{"source":3,"target":9},{"source":3,"target":10},{"source":4,"target":11},{"source":4,"target":12},{"source":4,"target":13},{"source":5,"target":14},{"source":5,"target":15},{"source":5,"target":16},{"source":6,"target":17},{"source":6,"target":18},{"source":6,"target":19},{"source":7,"target":20},{"source":7,"target":21},{"source":7,"target":22},{"source":8,"target":23},{"source":8,"target":24},{"source":8,"target":25},{"source":9,"target":26},{"source":9,"target":27},{"source":9,"target":28},{"source":10,"target":29},{"source":10,"target":30},{"source":10,"target":31},{"source":11,"target":32},{"source":11,"target":33},{"source":11,"target":34},{"source":12,"target":35},{"source":12,"target":36},{"source":12,"target":37},{"source":13,"target":38},{"source":13,"target":39},{"source":13,"target":40}]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="aesthetics" class="section level1">
<h1>Aesthetics</h1>
<p>Going back to the treemap example, it is possible to move the labels
and also use any font that you like:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">d3po</span>(pokemon_count) <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_treemap</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">daes</span>(<span class="at">size =</span> n, <span class="at">group =</span> type_1, <span class="at">color =</span> color_1, <span class="at">align =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_title</span>(<span class="st">&quot;Share of Pokemon by Type&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_font</span>(<span class="st">&quot;Fira Sans&quot;</span>, <span class="dv">12</span>, <span class="st">&quot;uppercase&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">po_labels</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;top&quot;</span>, F, <span class="st">&quot;Times&quot;</span>, <span class="dv">30</span>, <span class="st">&quot;uppercase&quot;</span>)</span></code></pre></div>
<div class="d3po html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d17afa23774ad6ceb667" style="width:288px;height:288px;"></div>
<script type="application/json" data-for="htmlwidget-d17afa23774ad6ceb667">{"x":{"type":"treemap","data":[{"n":12,"type_1":"bug","color_1":"#A8B820"},{"n":3,"type_1":"dragon","color_1":"#7038F8"},{"n":9,"type_1":"electric","color_1":"#F8D030"},{"n":2,"type_1":"fairy","color_1":"#EE99AC"},{"n":7,"type_1":"fighting","color_1":"#C03028"},{"n":12,"type_1":"fire","color_1":"#F08030"},{"n":3,"type_1":"ghost","color_1":"#705898"},{"n":12,"type_1":"grass","color_1":"#78C850"},{"n":8,"type_1":"ground","color_1":"#E0C068"},{"n":2,"type_1":"ice","color_1":"#98D8D8"},{"n":22,"type_1":"normal","color_1":"#A8A878"},{"n":14,"type_1":"poison","color_1":"#A040A0"},{"n":8,"type_1":"psychic","color_1":"#F85888"},{"n":9,"type_1":"rock","color_1":"#B8A038"},{"n":28,"type_1":"water","color_1":"#6890F0"}],"size":"n","group":"type_1","color":"color_1","title":"Share of Pokemon by Type","font":{"family":"Fira Sans","size":12,"transform":"uppercase"},"labels":{"align":"left","valign":"top","resize":false,"font":{"family":"Times","size":30,"transform":"uppercase"}}},"evals":[],"jsHooks":[]}</script>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
